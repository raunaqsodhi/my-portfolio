"use strict";(self.webpackChunkcircle=self.webpackChunkcircle||[]).push([["9020"],{62684:function(e,t,r){r.d(t,{Y:()=>i});var n=r(93199),o=r(95533),i={index:function(e){var t=e.formId,r=e.params;return(0,n.UT)(o.a.submissions.index({formId:t,params:r}))},create:function(e){var t=e.formId,r=e.payload;return(0,n.Cu)(o.a.submissions.create({formId:t}),r)},export_csv:function(e){return(0,n.Cu)(o.a.submissions.export_csv({formId:e}))}}},72721:function(e,t,r){r.d(t,{z:()=>l});var n=r(85893),o=r(1168),i=r(41553),l=function(e){var t=e.title,r=e.body,l=e.textColor,a=e.backgroundColor,u=e.uid,s=e.isPreview,c=e.isUsedOnPages,d=e.formHeight,f=e.isModal;return(0,n.jsxs)("div",{id:"thank-you-".concat(u),style:{height:d,backgroundColor:a},className:(0,o.A)("flex h-full w-full flex-col items-center justify-center gap-2 px-8 py-12 text-center",{"border-primary max-h-[440px] rounded-lg border":void 0!==s&&s,"!pt-0":void 0!==f&&f,"max-w-[600px]":!(void 0!==c&&c)}),children:[l&&(0,n.jsx)("style",{children:"#thank-you-".concat(u," h4, #thank-you-").concat(u," p { color: ").concat(l,"; }")}),(0,n.jsx)(i.Z.TitleMd,{children:t}),(0,n.jsx)(i.Z.BodyMd,{children:r})]})}},87496:function(e,t,r){r.d(t,{l:()=>W});var n=r(85893),o=r(38484),i=r(67294),l=r(96486),a=r(72721),u=r(88767),s=r(84326),c=r(62684),d=r(36808),f=r.n(d),m=function(e){return"".concat("circle_modal_form_closed","_").concat(e)},p=function(e,t){f().set(m(e),"true",{expires:t,sameSite:"None",secure:!0})},b=function(e){var t,r=e.form;return{shouldSuppressPopupForm:(t=r.uid,void 0!==f().get(m(t))),suppressPopupForm:(0,i.useCallback)(function(){0!==r.popup_frequency&&p(r.uid,r.popup_frequency)},[r])}},y=r(60878);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var v=function(e){var t={},r=0;return e.elements.forEach(function(e){"field"===e.type&&(t[e.elementable_id]=r,r++)}),t},g=function(e){var t,r=e.form,n=e.index,o=e.setErrors,l=e.isModal,a=(0,y.pm)(),d=b({form:r}).suppressPopupForm,f=(t=(0,i.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],l=!0,a=!1;try{for(o=o.call(e);!(l=(r=o.next()).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){a=!0,n=e}finally{try{l||null==o.return||o.return()}finally{if(a)throw n}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return h(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=f[0],p=f[1],g=v(r),x=(0,u.useMutation)({mutationFn:function(e){return c.Y.create({formId:r.id,payload:e})},onSuccess:function(){l&&d(),"thank_you_page"===r.after_submission_action?p(!0):"redirect"===r.after_submission_action&&window.parent.postMessage({type:"redirect",formUid:r.uid,formIndex:n,url:r.redirect_url},"*")},onError:function(e){e.errorDetails&&Array.isArray(e.errorDetails)&&e.errorDetails.length>0?o(e.errorDetails.reduce(function(e,t){return e[g[t.elementable_id]]=t.error,e},{})):429===e.status?a.error((0,s.t)("settings.forms.errors.too_many_submissions")):a.error(e.message)}});return{mutate:x.mutate,isSubmitting:x.isLoading,shouldRenderThankYouPage:m}},x=r(97398),_=r(41342),j=r(1724),w=r(1168),S=r(51466),C=r(39905),P=function(e){var t=e.element,r=e.isPreview,o=void 0!==r&&r,i=e.isSubmitting,a=e.className;return(0,n.jsx)(C.z,{variant:"circle",full:!0,large:!0,className:a,type:o?"button":"submit",disabled:void 0!==i&&i,onClick:o?l.noop:void 0,style:{color:t.attributes.text_color,backgroundColor:t.attributes.background_color,borderColor:t.attributes.background_color},children:t.attributes.label})},k=r(52293),I=r(72530),A=function(e){var t=e.element,r=e.initialFocusRef,o=e.fieldIndex,a=e.errors,u=e.className,c=(0,k.Gc)().setError,d=(0,i.useMemo)(function(){var e={};return"contact_email"===t.attributes.field_type?(e.pattern={value:I.CU,message:(0,s.t)("settings.forms.errors.valid_email")},t.attributes.required&&(e.required=(0,s.t)("settings.forms.errors.required_email"))):"contact_name"===t.attributes.field_type&&(e.minLength={value:2,message:(0,s.t)("settings.forms.errors.min_length_2")}),t.attributes.required&&(e.required=(0,s.t)("settings.forms.errors.required",{field_name:t.attributes.label.toLowerCase()})),e},[t]),f=t.attributes.label.trim();"contact_email"===t.attributes.field_type?f=f||(0,s.t)("settings.forms.default_contact_email_label"):"contact_name"===t.attributes.field_type&&(f=f||(0,s.t)("settings.forms.default_contact_name_label"));var m="elements[".concat(o,"][id]"),p="elements[".concat(o,"][value]");return((0,i.useEffect)(function(){a&&a[o]&&c("elements[".concat(o,"][value]"),{type:"server",message:a[o]})},[a,o,c]),t.attributes.hidden)?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.l.Item,{id:p,name:p,hideDescription:!0,hideBorder:!0,hideLabel:(0,l.isEmpty)(f),label:f,rules:d,forceRequiredLabel:t.attributes.required,className:u,errorClassName:"form-group__error !mb-0",placeholder:t.attributes.placeholder||(0,s.t)("settings.forms.edit.defaults.field_placeholder",{field_label:f.toLowerCase()}),children:(0,n.jsx)(S.l.Input,{type:"text",name:p,autoComplete:"off",ref:r})}),(0,n.jsx)(S.l.Input,{wrapperClassName:"hidden",type:"hidden",name:m,value:t.id})]})},O=r(41553),E=function(e){var t=e.element;if(!t.attributes.value)return null;var r="title"===t.attributes.text_type?O.Z.TitleMd:"subtitle"===t.attributes.text_type?O.Z.TitleSm:"paragraph"===t.attributes.text_type?O.Z.BodySm:O.Z.TitleMd;return(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)(r,{children:t.attributes.value})})},M=function(e){var t=e.element,r=e.isPreview,o=e.isSubmitting,i=e.initialFocusRef,l=e.fieldIndex,a=e.errors,u=e.className;switch(t.type){case"text":return(0,n.jsx)(E,{element:t});case"field":return(0,n.jsx)(A,{element:t,initialFocusRef:i,fieldIndex:l,className:u,errors:a});case"button":return(0,n.jsx)(P,{element:t,isPreview:r,isSubmitting:o,className:u});default:return null}},F=function(e){var t=e.formElements,r=e.isPreview,o=e.initialFocusRef,i=e.isSubmitting,l=e.errors,a=0,u=t.filter(function(e){return"text"===e.type}),s=t.filter(function(e){return"text"!==e.type}),c=s.findIndex(function(e){return"field"===e.type});return(0,n.jsxs)(n.Fragment,{children:[u.map(function(e){return(0,n.jsx)(M,{element:e,isPreview:r,isSubmitting:i,errors:l,fieldIndex:-1},e.id)}),(0,n.jsx)("div",{className:"flex flex-col gap-0 sm:flex-row sm:items-end sm:gap-3",children:s.map(function(e,t){var u="field"===e.type?a++:-1;return(0,n.jsx)(M,{element:e,isPreview:r,isSubmitting:i,errors:l,initialFocusRef:t===c?o:void 0,fieldIndex:u,className:(0,w.A)({"mt-4 !h-auto whitespace-nowrap !py-3 sm:mb-2 sm:mt-0 sm:!w-auto sm:justify-between":"button"===e.type,"w-full":"field"===e.type})},e.id)})})]})},N=function(e){var t=e.formElements,r=e.isPreview,o=e.initialFocusRef,i=e.isSubmitting,l=e.errors,a=t.findIndex(function(e){return"field"===e.type}),u=0;return(0,n.jsx)(n.Fragment,{children:t.map(function(e,t){var s="field"===e.type?u++:-1;return(0,n.jsx)(M,{element:e,isPreview:r,isSubmitting:i,errors:l,initialFocusRef:t===a?o:void 0,fieldIndex:s,className:(0,w.A)({"mt-4 !h-auto !py-3":"button"===e.type})},e.id)})})};function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],l=!0,a=!1;try{for(o=o.call(e);!(l=(r=o.next()).done)&&(i.push(r.value),!t||i.length!==t);l=!0);}catch(e){a=!0,n=e}finally{try{l||null==o.return||o.return()}finally{if(a)throw n}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var U=function(e){var t=e.form,r=e.index,o=e.formElements,u=e.isPreview,s=e.isModal,c=e.isUsedOnPages,d=void 0!==c&&c,f=e.initialFocusRef,m=e.setShouldHideTitle,p=e.textColor,b=e.backgroundColor,y=R((0,i.useState)(0),2),h=y[0],v=y[1],C=R((0,i.useState)({}),2),P=C[0],k=C[1],I=(0,i.useRef)(null),A=(0,_.wh)().currentCommunitySettings,O=!(null==A?void 0:A.forms_turnstile_enabled)||u,E=(0,x.D)(O),M=E.turnstileRef,T=E.dispatch,U=E.canUseTurnstile,H=E.shouldShowTurnstile,D=s?o.filter(function(e){return"text"!==e.type||"title"!==e.attributes.text_type}):o,q=g({form:t,index:r,setErrors:k,isModal:s}),z=q.mutate,B=q.isSubmitting,L=q.shouldRenderThankYouPage;(0,i.useEffect)(function(){var e;v((null==(e=I.current)?void 0:e.scrollHeight)||0)},[]),(0,i.useEffect)(function(){(0,l.isFunction)(m)&&m(L)},[L,m]);var Z="vertical"===t.orientation?N:F;return L?(0,n.jsx)(a.z,{uid:t.uid,title:t.thank_you_page_title,body:t.thank_you_page_body,backgroundColor:b,textColor:p,isPreview:u,formHeight:h,isModal:s,isUsedOnPages:d}):(0,n.jsx)("div",{ref:I,children:(0,n.jsxs)(S.l,{id:"form-".concat(t.uid),onSubmit:u?function(){}:function(e){var t;z(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({turnstile_token:null==(t=M.current)?void 0:t.getResponse()},e))},className:(0,w.A)("w-full px-0.5",{"max-w-[600px]":!s&&!d,"py-12":!s&&u&&!d,"pb-6 pt-0":s&&!d}),formClassName:"mb-0",style:{backgroundColor:d?void 0:b},children:[!s&&(0,n.jsx)("style",{children:"#form-".concat(t.uid," label > span, #form-").concat(t.uid," h4, #form-").concat(t.uid," h5 { color: ").concat(p,"; }")}),(0,n.jsx)(Z,{formElements:D,isPreview:u,isSubmitting:B,initialFocusRef:f,errors:P}),U&&(0,n.jsx)("div",{className:(0,w.A)("mt-6 flex w-full justify-center",{hidden:!H}),children:(0,n.jsx)(j.u,{turnstileRef:M,dispatch:T,shouldShowTurnstile:H})})]})})},H=r(57105),D=r(34519),q=r(61720),z=function(e){return"text"===e.type&&"title"===e.attributes.text_type&&e.attributes.value},B=function(e){var t=e.form,r=e.handleClose,o=e.shouldHideTitle,i=t.elements.find(z),l=!o&&i;return(0,n.jsx)(D.u_.Header,{className:(0,w.A)("border-none",{"!justify-end":!l}),children:l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(D.u_.Title,{children:i.attributes.value}),(0,n.jsx)(D.u_.HeaderActions,{children:(0,n.jsx)(D.u_.CloseButton,{id:"form-modal-close-button",onClick:r})})]}):(0,n.jsx)(D.u_.CloseButton,{id:"form-modal-close-button",onClick:r})})};function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Z=function(e){var t,r=e.form,o=e.index,l=e.formElements,a=e.isPreview,u=e.handleModalClose,s=(t=(0,i.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],l=!0,a=!1;try{for(o=o.call(e);!(l=(r=o.next()).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){a=!0,n=e}finally{try{l||null==o.return||o.return()}finally{if(a)throw n}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return L(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=s[0],d=s[1],f=(0,i.useRef)(null),m=(0,H.dd)();if(!m||!m.visible)return null;var p=function(){u(),m.hide(),window.parent.postMessage({type:"resize",formUid:r.uid,formIndex:o,height:"0"},"*")};return(0,n.jsxs)(D.u_,{isOpen:m.visible,contentPortalId:"form-modal-portal",initialFocus:f,children:[(0,n.jsx)(D.u_.Overlay,{onClick:p}),(0,n.jsxs)(D.u_.Content,{size:q.Gr.md,style:{backgroundColor:r.background_color},id:"form-modal-".concat(r.uid),children:[(0,n.jsx)("style",{children:"#form-modal-".concat(r.uid," label > span,\n           #form-modal-").concat(r.uid," h4,\n           #form-modal-").concat(r.uid," h5 {\n             color: ").concat(r.text_color,";\n           }\n           #form-modal-").concat(r.uid," #form-modal-close-button:hover {\n             background-color: ").concat(r.background_color,";\n           }\n           #form-modal-").concat(r.uid," #form-modal-close-button svg {\n             color: ").concat(r.text_color," !important;\n           }")}),(0,n.jsx)(B,{form:r,handleClose:p,shouldHideTitle:c}),(0,n.jsx)(D.u_.Body,{className:"px-8 !pt-0",children:(0,n.jsx)(U,{form:r,index:o,formElements:l,isPreview:a,isModal:!0,textColor:r.text_color,backgroundColor:r.background_color,initialFocusRef:f,setShouldHideTitle:d})})]})]})},Y=H.gk.create(function(e){return(0,n.jsx)(Z,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}({},e))});function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var G=function(e){var t,r=e.form,n=e.index,o=e.popupDelay,l=e.formElements,a=(t=(0,i.useState)(o),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],l=!0,a=!1;try{for(o=o.call(e);!(l=(r=o.next()).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){a=!0,n=e}finally{try{l||null==o.return||o.return()}finally{if(a)throw n}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return $(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=a[0],s=a[1],c=(0,H.dd)(Y),d=b({form:r}),f=d.shouldSuppressPopupForm,m=d.suppressPopupForm;return(0,i.useEffect)(function(){if(!f){if(0===u)return void c.show({form:r,index:n,formElements:l,isPreview:!1,handleModalClose:m});var e=setInterval(function(){s(function(e){return e<=1&&window.parent.postMessage({type:"resize",formUid:r.uid,formIndex:n,height:"100vh"},"*"),e-1})},1e3);return function(){return clearInterval(e)}}},[r,l,o,u]),{countdown:u}},J=function(e){return G({form:e.form,index:e.index,formElements:e.formElements,popupDelay:e.popupDelay}),null},K=r(11899),Q=function(){var e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)},V=function(e){var t=e.form,r=e.index,n=e.isModal;return(0,i.useEffect)(function(){if(t&&!n){var e=new K.do(function(){var e=Q();window.parent.postMessage({type:"resize",formUid:t.uid,formIndex:r,height:"".concat(e,"px")},"*")}),o=document.getElementById("form-".concat(t.uid));if(o)return e.observe(o),function(){return e.disconnect()}}},[t,r]),null},W=function(e){var t=e.id,r=e.index,i=e.form,l=e.isPreview,a=e.isUsedOnPages,u=void 0!==a&&a,s=(0,o.u)({id:t}),c=s.data,d=s.isLoading,f=c||i,m="popup"===(u?"inline":null==f?void 0:f.embed_display_format),p=m?J:U;return(V({form:f,index:r,isModal:m}),!d&&f&&f.elements)?(0,n.jsx)(p,{form:f,formElements:f.elements,isPreview:void 0!==l&&l,isModal:m,isUsedOnPages:u,popupDelay:f.popup_delay,backgroundColor:f.background_color,textColor:f.text_color,index:r}):null}}}]);
//# sourceMappingURL=/packs/js/9020-bc5e6b867c8c4f68.js.map
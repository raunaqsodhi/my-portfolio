"use strict";(self.webpackChunkcircle=self.webpackChunkcircle||[]).push([["7535"],{83031:function(e,t,n){e.exports=n.p+"static/images/avatar-empty-4774907e0bd0f46a.png"},47709:function(e,t,n){e.exports=n.p+"static/images/logo-639eb657099dd684.svg"},52187:function(e,t,n){n.d(t,{b:()=>a});var r=n(93199),o=n(13532);function i(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var a={update:function(e,t,n){return(0,r.aU)(o.av.AccountSubscriptions.update(e,t,n))},renew:function(e){return(0,r.Cu)(o.av.AccountSubscriptions.renew(e))},canDowngrade:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return[4,(0,r.UT)(o.av.AccountSubscriptions.canDowngrade(e))];case 1:return[2,t.sent()]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function s(e){i(a,r,o,s,l,"next",e)}function l(e){i(a,r,o,s,l,"throw",e)}s(void 0)})})()},createEmailHubSubscription:function(){return(0,r.Cu)(o.av.AccountSubscriptions.createEmailHubSubscription())},reactivateEmailHubSubscription:function(){return(0,r.Cu)(o.av.AccountSubscriptions.reactivateEmailHubSubscription())}}},51507:function(e,t,n){n.d(t,{w:()=>i});var r=n(93199),o=n(13532),i={list:function(e){var t=e.params;return(0,r.UT)(o.av.broadcasts.list({params:void 0===t?{}:t}))},create:function(e){return(0,r.Cu)(o.av.broadcasts.create(),e)},show:function(e){var t=e.id;return(0,r.UT)(o.av.broadcasts.show({id:t}))},update:function(e){var t=e.id,n=e.body;return(0,r.aU)(o.av.broadcasts.show({id:t}),n)},sendNow:function(e){var t=e.id;return(0,r.gN)(o.av.broadcasts.sendNow({id:t}))},duplicate:function(e){var t=e.id;return(0,r.aU)(o.av.broadcasts.duplicate({id:t}))},recipientList:function(e){var t=e.id,n=e.params;return(0,r.UT)(o.av.broadcasts.recipientList({id:t,params:void 0===n?{}:n}))},report:function(e){var t=e.id;return(0,r.UT)(o.av.broadcasts.report({id:t}))},recipients:function(e){var t=e.id,n=e.params;return(0,r.UT)(o.av.broadcasts.recipients({id:t,params:void 0===n?{}:n}))},cancelSchedule:function(e){var t=e.id;return(0,r.gN)(o.av.broadcasts.cancelSchedule({id:t}))},rename:function(e){var t=e.id,n=e.body;return(0,r.gN)(o.av.broadcasts.rename({id:t}),n)},sendTestEmail:function(e){var t=e.id;return(0,r.gN)(o.av.broadcasts.sendTestEmail({id:t}))},deleteBroadcast:function(e){var t=e.id;return(0,r.pC)(o.av.broadcasts.deleteBroadcast({id:t}))},updateTemplate:function(e){var t=e.id,n=e.body;return(0,r.gN)(o.av.broadcasts.updateTemplate({id:t}),n)},createFromSource:function(e){return(0,r.Cu)(o.av.broadcasts.createFromSource(),e)}}},36394:function(e,t,n){n.d(t,{MW:()=>i});var r=n(93199),o=n(13532),i={adminMarkAsRead:function(e){var t=e.id;return(0,r.gN)(o.av.communityInbox.adminMarkAsRead({id:t}))},memberMarkAsRead:function(e){var t=e.id;return(0,r.gN)(o.av.communityInbox.memberMarkAsRead({id:t}))},previewChat:function(e){var t=e.community_bot_profile;return(0,r.Cu)(o.av.communityInbox.preview(),{community_bot_profile:t})},fetchChat:function(e){var t=e.id;return(0,r.UT)(o.av.communityInbox.show({id:t}))},pauseAi:function(e){var t=e.id;return(0,r.gN)(o.av.communityInbox.pauseAi({id:t}))},resumeAi:function(e){var t=e.id;return(0,r.gN)(o.av.communityInbox.resumeAi({id:t}))},unreadMemberChatsCount:function(){return(0,r.UT)(o.av.communityInbox.unreadMemberChatsCount())},unreadAdminPausedAiChatsCount:function(){return(0,r.UT)(o.av.communityInbox.unreadAdminPausedAiChatsCount())}}},34962:function(e,t,n){n.d(t,{_u:()=>a,gX:()=>s,x6:()=>i});var r=n(93199),o=n(13532),i=function(e){var t=e.spaceId,n=e.payload;return(0,r.Cu)(o.av.imagePosts.create(t),n)},a=function(e){var t=e.spaceId,n=e.postSlug,i=e.payload;return(0,r.aU)(o.av.imagePosts.update(t,n),i)},s=function(e){var t=e.spaceId,n=e.postSlug,i=e.payload;return(0,r.aU)(o.av.imagePosts.duplicate(t,n),i)}},44102:function(e,t,n){n.d(t,{g:()=>i});var r=n(93199),o=n(13532),i=function(e){var t=e.entityId,n=e.entityType,i=e.mode;return(0,r.Cu)(o.av.masquerading.masquerades.create({entityId:t,entityType:void 0===n?"CommunityMember":n,mode:void 0===i?"view":i}),{method:"POST"})}},71290:function(e,t,n){n.d(t,{O:()=>i});var r=n(93199),o=n(95533),i={create:function(e){var t=e.blobSignedId;return(0,r.Cu)(o.a.mediaTranscodings.create(),{blob_signed_id:t})}}},29980:function(e,t,n){n.d(t,{W:()=>i});var r=n(93199),o=n(13532),i={index:function(e){var t=e.filters,n=e.order,i=e.page,a=e.perPage,s=e.searchKey,l=s?{search_key:s}:{};return function(){return(0,r.UT)(o.av.admin.paywalls.charges.index({params:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({filters:t,page:i,per_page:a,order:n},l)}))}},refundCharge:function(e){var t=e.chargeProcessorId,n=e.params;return(0,r.Cu)(o.av.admin.paywalls.charges.refunds({chargeProcessorId:t}),n)}}},38603:function(e,t,n){n.d(t,{vk:()=>u});var r=n(67294),o=n(96486),i=n(88767),a=n(14218),s=n(93199),l=n(13532);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.params,n=void 0===t?{}:t,u=e.isCalendarView,d=void 0!==u&&u,f=(0,a.d)(),m=f.removeRecord,p=f.findAndReplaceRecord,b=["all","events",n,{type:d?"calendar":"default"}],h=(0,i.useQueryClient)(),v=(0,i.useInfiniteQuery)(b,function(e){var t,r=e.pageParam;return t=void 0===r?1:r,(0,s.UT)(l.av.events.allEvents({params:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({page:t,per_page:d?120:20},n)}))},{select:function(e){var t=e.pages,n=void 0===t?[]:t;return{pages:(0,o.flatten)(n.map(function(e){return e.records})),pageParams:n.map(function(e){return e.page}),pagesList:n}},keepPreviousData:d,getNextPageParam:function(e){return e.has_next_page?Number(e.page)+1:void 0}}),y=v.data,g=void 0===y?{}:y,_=g.pages,x=g.pagesList,j=void 0===x?[]:x,w=v.isLoading,O=v.refetch,S=v.hasNextPage,P=v.fetchNextPage,C=j[j.length-1];(0,r.useEffect)(function(){d&&C&&C.count>C.page*C.per_page&&P()},[C,d,P]);var I=j.map(function(e){return e.records.map(function(e){return e.id})});return{events:void 0===_?[]:_,pagesList:j,isLoading:w,refetchAllEvents:O,hasNextPage:S,fetchNextPage:P,perPageEventIds:I,onEventChange:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.refetch,o=void 0===r||r;return(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:if(t=e,!o)return[3,2];return[4,h.fetchQuery(l.av.posts.show({spaceId:e.space_id,postSlug:e.slug,spaceSlug:e.space_slug}))];case 1:t=n.sent(),n.label=2;case 2:return[2,p(t,b)]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})})()},onEventDestroy:function(e){m(e,b)}}}},34502:function(e,t,n){n.d(t,{p:()=>p});var r=n(67294),o=n(23493),i=n.n(o),a=n(21530),s=n(50636),l=n(41342),c=n(32590);function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)})}}function f(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var m=[25,50,75,90],p=function(e,t){var n=(0,r.useRef)((0,a.Z)()),o=(0,r.useRef)(!1),u=(0,r.useRef)(new Set),p=(0,r.useRef)(new Set),b=(0,c.U)().pageViewId,h=(0,l.wh)(),v=h.masqueradingEntity,y=h.currentCommunity,g=h.currentCommunityMember,_=h.isLoading,x=null==y?void 0:y.id,j=null==g?void 0:g.id,w=!!(v||_||!t);(0,r.useEffect)(function(){t&&(o.current=!1,n.current=(0,a.Z)(),u.current=new Set,p.current=new Set)},[t]);var O=(0,r.useCallback)(function(){return d(function(){var r,i;return f(this,function(a){switch(a.label){case 0:if(w||!e.current||o.current)return[2];return i={community_id:x,community_member_id:j,video_url:(r=e.current).currentSrc,video_duration:Math.round(r.duration),video_view_id:n.current,page_view_id:null!=b?b:"unknown",signed_id:t},[4,s.n.trackVideoView(i)];case 1:return a.sent(),o.current=!0,[2]}})})()},[x,j,w,e,t,b]),S=(0,r.useCallback)(function(r,o){return d(function(){var i,a;return f(this,function(l){switch(l.label){case 0:if(w||!e.current)return[2];return a={community_id:x,community_member_id:j,video_url:(i=e.current).currentSrc,video_duration:Math.round(i.duration),video_view_id:n.current,page_view_id:null!=b?b:"unknown",signed_id:t,progress_percent:r,progress_seconds:o},[4,s.n.trackVideoSegmentView(a)];case 1:return l.sent(),[2]}})})()},[x,j,w,e,t,b]);(0,r.useEffect)(function(){if(e.current&&t){var n=e.current,r=i()(function(){if(!o.current){var e=n.duration,t=n.currentTime;(e<=30&&t>0||e>30&&t>=30)&&O()}},250);return n.addEventListener("timeupdate",r),function(){r.cancel(),n.removeEventListener("timeupdate",r)}}},[O,e,t,b]),(0,r.useEffect)(function(){if(e.current&&t){var n=e.current,r=i()(function(){if(n.duration&&!(n.duration<30)){var e=n.currentTime/n.duration*100,t=m.find(function(t){return e<t});t&&p.current.add(t);var r=m.find(function(t,n){var r=m[n+1]||100;return e>=t&&e<r});r&&!u.current.has(r)&&p.current.has(r)&&(u.current.add(r),S(r,Math.round(n.currentTime)))}},250);return n.addEventListener("timeupdate",r),function(){r.cancel(),n.removeEventListener("timeupdate",r)}}},[S,e,t])}},91735:function(e,t,n){n.d(t,{R:()=>i});var r=n(85893),o=n(1168),i=function(e){var t,n,i=e.children,a=e.className,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["children","className"]);return(0,r.jsx)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},s),n=n={className:(0,o.A)("bg-tertiary text-dark mx-6 mb-3 rounded-lg p-4 text-center text-sm",void 0===a?"":a),children:i},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}},24310:function(e,t,n){n.d(t,{k:()=>h});var r=n(85893),o=n(96486),i=n(70442),a=n(84326),s=n(41342),l=n(80171),c=n(39905),u=n(13532),d=n(90926),f=n(17617),m=n(3697),p=n(57363);function b(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var h=function(e){var t=e.communityMemberId,n=e.shouldAutoNavigate,h=void 0===n||n,v=e.showIcon,y=e.onClick,g=void 0===y?o.noop:y,_=e.variant,x=void 0===_?"button":_,j=(0,i.k6)(),w=(0,s.wh)().isViewOnlyMasquerading,O=(0,d.pB)().findOrCreateChatRoom,S=(0,f.ef)();return(0,r.jsx)(l.T,{placement:"bottom",content:(0,a.t)("post.share.message"),interactive:!1,disabled:"icon"!==x,children:(0,r.jsxs)(c.z,{variant:"secondary",onClick:w?o.noop:function(){var e;return(e=function(){var e;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:return[4,O({kind:m.g8,community_member_ids:[t]})];case 1:return e=n.sent(),null==g||g(e),h&&j.push((0,u.co)({url:(0,u.so)({uuid:e})})),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,s,"next",e)}function s(e){b(i,r,o,a,s,"throw",e)}a(void 0)})})()},"aria-label":(0,a.t)("post.share.message"),"data-testid":"chat-button",children:[(void 0===v||v)&&(0,r.jsx)(p.JO,{type:"16-message",size:16,useWithFillCurrentColor:!0,"aria-hidden":!0}),!S&&"icon"!==x&&(0,r.jsx)("span",{className:"ml-1",children:(0,a.t)("message")})]})})}},35556:function(e,t,n){n.d(t,{z:()=>b});var r=n(85893),o=n(67294),i=n(53731),a=n(1168),s="text-sm font-normal whitespace-pre-line chat-message-word-wrap text-darkest",l=function(e,t,n){return(0,r.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",children:t},n)},c=function(e){var t=e.body,n=e.isPinnedMessageAtTop;return(0,r.jsx)("div",{className:(0,a.A)(s,{"pinned-message-body":void 0!==n&&n}),"data-testid":"message-text",children:(0,r.jsx)(i.default,{componentDecorator:l,children:t})})},u=n(84326),d=n(35756),f=n(41553),m=n(65121),p=function(e){var t=e.editedAt,n=e.shouldScrollIntoView,o=e.isPinnedMessageAtTop,i=void 0!==o&&o,l=e.rich_text_body,c=e.chatRoomAccessArr,p=e.shouldShowPreviewBlocks;return l?(0,r.jsx)(d.S,{renderFunc:function(){return(0,r.jsx)(f.Z.LabelSm,{color:"text-v2-danger",children:(0,u.t)("messaging.message_error")})},children:(0,r.jsx)("div",{className:(0,a.A)(s,{"pinned-message-body":i}),"data-testid":"message-text",children:(0,r.jsx)(m.T,{editable:!1,rich_text_body:l,shouldScrollIntoView:void 0!==n&&n,shouldRefetch:!0,isUpdate:i,editedAt:t,chatRoomAccessArr:c,shouldShowPreviewBlocks:void 0===p||p})})}):null},b=(0,o.memo)(function(e){var t,n=e.message,o=e.shouldScrollIntoView,i=e.isPinnedMessageAtTop,a=void 0!==i&&i,s=e.shouldShowPreviewBlocks;return(a?(t=n.rich_text_body)&&0!==t.body.content.length:n.rich_text_body)?(0,r.jsx)(p,{rich_text_body:n.rich_text_body,shouldScrollIntoView:void 0!==o&&o,isPinnedMessageAtTop:a,editedAt:n.edited_at,chatRoomAccessArr:n.embedded_chat_message_access,shouldShowPreviewBlocks:void 0===s||s}):(0,r.jsx)(c,{body:n.body,isPinnedMessageAtTop:a})});b.displayName="ContentBody"},57092:function(e,t,n){n.d(t,{f:()=>m});var r=n(85893),o=n(96486),i=n(84326),a=n(57105),s=n(1800),l=n(63549),c=n(43340),u=n(21232),d=function(e){var t=e.chatRoom,n=e.currentParticipant,d=e.handleSubmit,f=e.messageId,m=e.isEditMessage,p=e.message,b=e.onConfirm,h=void 0===b?o.noop:b,v=e.participants,y=e.repliesCount,g=(0,a.dd)(),_=(0,s._)().deleteRichTextMessage;return(0,r.jsxs)(l.c,{isOpen:g.visible,onClose:g.visible?g.hide:o.noop,onConfirm:function(){_({chatRoomUuid:t.uuid,messageId:f}),g.hide(),h()},confirmText:(0,i.t)("delete"),confirmVariant:"danger",title:(0,i.t)("messaging.delete_message.title"),children:[(0,r.jsx)("div",{className:"mb-6",children:(0,c.eB)(y)}),(0,r.jsx)("div",{className:"border-primary w-full rounded-md border py-2",children:(0,r.jsx)(u.t,{isModal:!0,handleSubmit:d,currentParticipant:n,message:p,isEditMessage:void 0!==m&&m,chatRoom:t,participants:v,isViewOnlyMasquerading:!0})})]})},f=a.gk.create(function(e){return(0,r.jsx)(d,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),m=function(){return(0,a.dd)(f)}},59481:function(e,t,n){n.d(t,{P:()=>k});var r=n(85893),o=n(67294),i=n(69293),a=n(1168),s=n(43340),l=n(20640),c=n.n(l),u=n(96486),d=n(88767),f=n(70442),m=n(84326),p=n(51630),b=n(8819),h=n(61853),v=n(99385),y=n(80171),g=n(41342),_=n(90926),x=n(26801),j=n(75148),w=n(43544),O=n(60878),S=function(e){var t=e.isPinned,n=void 0!==t&&t,o=e.setEditMessageId,i=e.currentParticipant,a=void 0===i?{}:i,l=e.toggleDeleteConfirmationModal,S=e.message,P=e.chatRoom,C=e.isMessageThread,I=void 0!==C&&C,k=e.canUserModifyMessage,N=e.setUnreadMessageFlow,A=void 0===N?u.noop:N,E=e.isLiveStream,T=void 0!==E&&E,M=e.chatRoomUrl,R=void 0===M?"":M,D=e.setActiveMessageId,L=e.isRenderedOnHeader,F=(0,f.TH)().pathname,U=(0,g.wh)(),B=U.currentCommunity,q=U.currentCommunitySettings,z=null==q?void 0:q.spotlight_chat_messages_enabled,Z=F.includes("/messages"),H=(0,h.CD)().appendUnreadChatRoomUuids,V=S.id,Q=S.chat_room_participant_id,W=S.parent_message_id,G=S.spotlighted,$=a.admin,K=Q===a.id,J=(0,O.pm)(),X="direct"==P.chat_room_kind,Y=(0,g.L2)().data,ee=(0,x.L)([null==Y?void 0:Y.id]).refetchSpaceNotifications,et=(0,d.useQueryClient)(),en=K||P.lesson||T,er=function(e){el({pinned_message_id:n?null:e})},eo=function(e){es({message_id:e}),Z&&(null==B?void 0:B.id)&&H(B.id,P.uuid)},ei=function(){et.invalidateQueries(_.Nh)},ea=function(){et.invalidateQueries((0,v.S)(P.uuid))},es=(0,d.useMutation)(function(e){return p.MS.markAsUnread({uuid:P.uuid,chat_room:e})},{onSuccess:function(){A(!0),ea(),Y?ee():ei(),J.success((0,m.t)("messaging.actions.mark_as_unread_success"))},onError:function(){J.error((0,m.t)("messaging.actions.mark_as_unread_error"))}}).mutate,el=(0,d.useMutation)(function(e){return p.MS.pinMessage({uuid:P.uuid,chat_room:e})},{onError:function(){J.error((0,m.t)("messaging.actions.pin_error"))}}).mutate,ec=(0,b.f)({chatUuid:P.uuid}).spotlightMessage,eu=[{value:"edit-message",label:(0,m.t)("edit"),onClick:function(){return o(V)},hide:!K||G},{value:"pin-message",label:n?(0,m.t)("unpin"):(0,m.t)("pin"),onClick:function(){return er(V)},hide:I||G||!$&&!X},{value:"spotlight-message",label:(0,m.t)("spotlight"),onClick:function(){return ec(V)},hide:!z||G||!T||!$},{value:"unread-message",label:(0,m.t)("unread"),onClick:function(){return eo(V)},hide:en},{value:"copy-link",label:(0,m.t)("messaging.actions.copy_link"),onClick:function(){var e=(0,s.Q1)({id:V,parentMessageId:W,chatRoomUrl:R});c()(e),J.success((0,m.t)("messaging.actions.copy_link_success"))},hide:T},{value:"delete-message",label:(0,m.t)("delete"),onClick:l,color:"text-v2-danger",hide:!(void 0!==k&&k)||G}];if(eu.every(function(e){return e.hide}))return null;var ed=L&&document.getElementById("threads-scroll-view")||document.body,ef=(0,s.h7)(V,I);return(0,r.jsx)(w.Lt,{direction:"bottom-end",transitionWrapperClassName:"z-[9999]",button:(0,r.jsx)(w.Lt.MenuButton,{onClick:function(){return D(ef)},children:(0,r.jsx)(y.T,{content:(0,m.t)("messaging.more_actions"),children:(0,r.jsx)(j.h,{name:"16-menu-dots-horizontal",ariaLabel:(0,m.t)("messaging.more_actions")})})}),options:eu,dataTestId:"message-actions",appendTo:ed})},P=n(65344),C=n(56345),I=function(e){var t=e.message,n=void 0===t?{}:t,o=e.chatRoom,i=e.isMessageThread,a=void 0!==i&&i,l=e.chatThreadsEnabled,c=e.isParentMessage,d=e.isRenderedOnHeader,p=void 0!==d&&d,b=e.currentParticipant,h=e.onBookmarkToggle,v=e.setActiveMessageId,g=n.id,x=n.embedded,w=(0,_.KR)().removeThreadIdUrlParam,O=(0,_.xX)(),S=O.openThreadsRailbar,I=O.setMessageHighlightId,k=O.isLiveStream,N=O.isCourseSpace,A=O.isDrawer,E=k||N,T=window.location.href.includes("threads"),M=(0,u.isFunction)(h)&&!E,R=void 0!==c&&c&&a&&!p&&!E&&!A,D=(0,f.k6)(),L=(b||{}).community_member_id,F=(0,u.throttle)(function(){I(g),(0,s.o7)(g,function(){(0,u.delay)(function(){return I(null)},5e3)})},5e3,{leading:!0,trailing:!1});return(0,r.jsxs)(r.Fragment,{children:[L&&(0,r.jsx)(P.D,{reactions:n.reactions,currentCommunityMemberId:L,reactionableId:n.id,reactionableType:"chat_room_message",setActiveMessageId:v,isMessageThread:a,isRenderedOnHeader:p}),M&&(0,r.jsx)(C.e,{bookmarkType:"message",record:n,onSuccess:function(){return h(n.id)}}),void 0!==l&&l&&!a&&(0,r.jsx)(y.T,{content:(0,m.t)("messaging.reply_in_threads"),dataTestId:"reply-thread",interactive:!1,children:(0,r.jsx)(j.h,{name:"16-open-threads",ariaLabel:(0,m.t)("messaging.reply_in_threads"),onClick:function(){w(),S(n,o)},iconSize:16})}),R&&(0,r.jsx)(y.T,{content:(0,m.t)(x?"messaging.open_in_space":"messaging.open_in_messages"),interactive:!1,children:(0,r.jsx)(j.h,{name:"16-open-in-space",ariaLabel:(0,m.t)(x?"messaging.open_in_space":"messaging.open_in_messages"),onClick:function(){T||p?D.push((0,s.ZZ)(o,n)):F()},iconSize:16})})]})},k=function(e){var t=e.isPinned,n=e.setEditMessageId,l=e.currentParticipant,c=void 0===l?{}:l,u=e.toggleDeleteConfirmationModal,d=e.message,f=e.chatRoom,m=e.isMessageThread,p=void 0!==m&&m,b=e.canUserModifyMessage,h=e.chatThreadsEnabled,v=e.isParentMessage,y=e.isPinnedMessageAtTop,g=e.isRenderedOnHeader,_=void 0!==g&&g,x=e.onBookmarkToggle,j=e.setUnreadMessageFlow,w=e.isLiveStream,O=e.chatRoomUrl,P=e.activeMessageId,C=e.setActiveMessageId,k=(0,o.useRef)(null),N="message-actions-".concat(d.id);(0,i.Z)(k,function(){C(null)});var A=(0,s.XE)({activeMessageId:P,id:d.id,isMessageThread:p});return(0,r.jsx)("div",{className:"absolute right-0 top-0 mb-3",children:(0,r.jsx)("div",{id:N,className:(0,a.A)("border-primary bg-primary -mt-4 mr-4 flex rounded-md border",{"!-mt-1":void 0!==y&&y,invisible:!P||!A,"group-hover/action:visible":!P||A}),children:(0,r.jsx)("div",{ref:k,children:(0,r.jsxs)("div",{className:"flex min-h-[34px] items-center justify-around space-x-1 px-1",children:[(0,r.jsx)(I,{message:d,isMessageThread:p,chatThreadsEnabled:void 0!==h&&h,chatRoom:f,isParentMessage:void 0!==v&&v,isRenderedOnHeader:_,currentParticipant:c,onBookmarkToggle:x,setActiveMessageId:C}),c&&(0,r.jsx)(S,{isPinned:void 0!==t&&t,setEditMessageId:n,currentParticipant:c,toggleDeleteConfirmationModal:u,message:d,chatRoom:f,isMessageThread:p,canUserModifyMessage:void 0!==b&&b,setUnreadMessageFlow:j,isLiveStream:void 0!==w&&w,chatRoomUrl:O,setActiveMessageId:C,isRenderedOnHeader:_})]})})})})}},21232:function(e,t,n){n.d(t,{t:()=>G});var r=n(85893),o=n(67294),i=n(96486),a=n(70442),s=n(84326),l=n(96533),c=n(81085),u=n(60983),d=n(1168),f=n(59413),m=n(57363),p=n(98363),b=n(64470),h=n(43340),v=n(35556),y=n(94184),g=n.n(y),_=n(80171),x=n(34335),j=n(93441),w=function(e,t,n,r){var o=e.findIndex(function(e){return e.id===n});-1!==o&&(e.splice(o,1),e.unshift({id:n,full_name:(0,s.t)("reactions.you")}));var i=e.map(function(e){return e.full_name});return r>5?i.join(", ")+" ".concat((0,s.t)("reactions.and")," ").concat(r-5," ").concat((0,s.t)("reactions.more_reacted_with")," :").concat(t,":"):i.join(", ").replace(/,([^,]*)$/," ".concat((0,s.t)("reactions.and"),"$1"))+" ".concat((0,s.t)("reactions.reacted_with")," :").concat(t,":")};function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var S=function(e){var t,n=e.reaction,a=e.currentCommunityMemberId,s=e.reactionableId,l=e.reactionableType,c=e.isViewOnlyMasquerading,u=n.emoji,d=n.count,f=n.community_member_ids,m=x.V[u],p=(t=(0,o.useState)([]),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return O(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),b=p[0],h=p[1],v=f.includes(a),y=w(b,u,a,d),S=(0,j.z)({currentCommunityMemberId:a,emoji:u,reactionableId:s,reactionableType:l,setCommunityMembers:h,communityMemberIds:f}),P=S.addReaction,C=S.removeReaction,I=S.fetchCommunityMembers,k=S.isLoading;if(!m)return null;var N=(0,r.jsxs)("button",{type:"button",className:g()("text-default border-primary relative flex h-[1.625rem] cursor-pointer items-center justify-center gap-1 rounded-full border px-1.5 text-sm font-semibold",{"!border-circle text-brand hover:border-brand bg-circle/5":v,"hover:border-gray-400":a&&!v}),onClick:c?i.noop:function(){if(a&&!k){var e,t=(l in(e={emoji:u})?Object.defineProperty(e,l,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[l]=s,e);v?C(t):P(t)}},onMouseEnter:function(){return I()},"data-testid":"reaction-content",children:[(0,r.jsx)("div",{children:m}),(0,r.jsx)("div",{children:d})]});return b.length>0?(0,r.jsx)(_.T,{placement:"top",content:y,interactive:!1,children:N}):(0,r.jsx)("div",{children:N})},P=n(65344),C=function(e){var t=e.reactions,n=void 0===t?[]:t,o=e.currentCommunityMemberId,i=e.reactionableId,a=e.reactionableType,s=e.isRenderedOnHeader,l=e.isViewOnlyMasquerading;return(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[n.map(function(e){return(0,r.jsx)(S,{reaction:e,currentCommunityMemberId:o,reactionableId:i,reactionableType:a,isViewOnlyMasquerading:l},e.emoji)}),!!o&&(0,r.jsx)(P.D,{reactions:n,currentCommunityMemberId:o,reactionableId:i,reactionableType:a,showBorder:!0,isRenderedOnHeader:void 0!==s&&s})]})},I=n(3255),k=n(8819),N=function(e){var t=e.message,n=e.chatRoom,o=e.isCurrentSpotlightedItem,i=(0,k.f)({chatUuid:n.uuid}),a=i.removeSpotlightMessage,l=i.isRemovingSpotlightMessage,c=o?(0,s.t)("live_streams.room.qa.questions.stop_spotlight"):(0,s.t)("live_streams.room.qa.questions.remove_from_queue");return(0,r.jsx)(I.K,{variant:"text-only",onClick:function(){a(t.id)},disabled:l,children:c})},A=function(e){var t=e.message,n=e.chatRoom,o=e.currentCommunityMemberId,i=e.isSpotlighted,a=e.isCurrentSpotlightedItem,s=e.isAdmin,l=e.isRenderedOnHeader,c=e.isViewOnlyMasquerading,u=t.reactions.length>0,d=i&&s;return u||d?(0,r.jsxs)("div",{className:"mt-1.5 flex flex-wrap items-center gap-1",children:[u&&(0,r.jsx)(C,{reactions:t.reactions,currentCommunityMemberId:o,reactionableId:t.id,reactionableType:"chat_room_message",isRenderedOnHeader:l,isViewOnlyMasquerading:c}),d&&(0,r.jsx)(N,{message:t,chatRoom:n,isCurrentSpotlightedItem:a})]}):null},E=n(20640),T=n.n(E),M=n(57338),R=n(8683),D=n(60878),L=function(e){var t=e.message,n=e.chatRoomUrl,o=void 0===n?"":n,i=e.isParentMessage,a=e.isMessageThread,l=t.id,c=t.sent_at,u=t.parent_message_id,f=(0,M.H)(c),m=f.day,p=f.time,b=(0,R.TF)(c),v=(0,D.pm)(),y=!!l&&l>0;return(0,r.jsx)("button",{type:"button",className:(0,d.A)("text-timestamp inline min-w-fit text-sm font-medium",y?"hover:underline":"cursor-default"),onClick:function(){if(y){var e=(0,h.Q1)({id:l,parentMessageId:u,chatRoomUrl:o});T()(e),v.success((0,s.t)("messaging.actions.copy_link_success"))}},children:y?void 0!==a&&a?void 0!==i&&i?"".concat(m," at ").concat(p):b:p:(0,s.t)("messaging.sending")})},F=n(52928),U=n(13532),B=function(e){var t=e.message,n=e.chatRoom,o=e.isParentMessage,i=void 0!==o&&o,a=e.isMessageThread,l=e.isRenderedOnHeader,c=t.id,u=t.sent_at,f=(0,M.H)(u),m=f.day,p=f.time,b=(0,R.TF)(u);return(0,r.jsx)(F.rU,{to:(0,U.co)({url:(0,h._z)(n,t),hash:i?(0,h.uo)(t):(0,h.d6)(t),search:i?"":"message_id=".concat(t.id)}),className:(0,d.A)({"inline-flex flex-row items-center":void 0!==l&&l}),children:(0,r.jsx)("span",{className:"text-light inline cursor-pointer text-xs hover:underline",children:c&&c>0?void 0!==a&&a?i?"".concat(m," at ").concat(p):b:p:(0,s.t)("messaging.sending")})})},q=n(3697),z=function(e){var t=e.chatRoomKind,n=e.sender,o=(0,f.x)(),i=o.isChatSpace,a=o.isDmsPage&&t===q.RN,l=!!(null==n?void 0:n.community_admin),c=!!(null==n?void 0:n.moderator);return(i||a)&&(l||c)?(0,r.jsx)(_.T,{className:"flex items-center justify-center",interactive:!1,content:(0,s.t)(i&&l?"admin":"moderator"),children:(0,r.jsx)(m.JO,{type:"14-moderator-icon",size:14,className:(0,d.A)("!w-[14px]",i&&l?"text-[#2563EB]":"text-tertiary")})}):null},Z=n(65121),H=function(e){var t=e.chatRoom,n=e.isRenderedOnHeader,o=e.message,i=e.onDelete,l=e.onSubmit,c=(0,a.TH)().pathname,u=o.rich_text_body||{body:o.body},d=(0,h.$S)(t),f=(0,h.C9)(t),m=c.includes("/messages"),p=(0,h.jr)(m,void 0!==n&&n);return(0,r.jsxs)("div",{className:"chat-message-word-wrap text-dark mb-1 whitespace-pre-line text-sm font-normal","data-testid":"message-text",children:[(0,r.jsx)(Z.T,{autofocus:!0,editable:!0,rich_text_body:u,onSubmit:l,onDelete:i,isUpdate:!0,chatProps:{isThread:!!o.parent_message_id,isDirectMessaging:d,isChatAdminOrModerator:f},portalTargetId:p}),(0,r.jsxs)("div",{className:"-mt-5 text-xs",children:[(0,s.t)("messaging.esc_to")," ",(0,r.jsx)("span",{className:"font-semibold",children:(0,s.t)("cancel")})," ",(0,s.t)("messaging.bullet")," ",(0,s.t)("messaging.enter_to")," ",(0,r.jsx)("span",{className:"font-semibold",children:(0,s.t)("save")})]})]})},V=function(e){var t=e.role;return(0,r.jsx)(_.T,{placement:"top",content:(0,s.t)("live_roles.".concat(t)),children:(0,r.jsx)(m.JO,{type:t,size:16,className:"-ml-1 -mt-1"})})},Q=n(7447),W=function(e){var t,n=e.spotlighted,r=(0,Q.I3)(Q.TQ);return{isSpotlighted:n,isCurrentSpotlightedItem:(null==r?void 0:r.type)==="ChatRoomMessage"&&(null==r||null==(t=r.spotlightable)?void 0:t.id)===e.id}},G=function(e){var t=e.chatRoom,n=e.chatRoomUrl,y=e.currentParticipant,g=void 0===y?{}:y,_=e.handleSubmit,x=e.isEditMessage,j=e.isMessageThread,w=void 0!==j&&j,O=e.isModal,S=e.isParentMessage,P=void 0!==S&&S,C=e.isPinned,I=e.isPinnedMessageAtTop,k=e.isRenderedOnHeader,N=void 0!==k&&k,E=e.message,T=e.messageBodyClassName,M=e.participants,R=void 0===M?[]:M,D=e.roles,F=void 0===D?{}:D,U=e.toggleDeleteConfirmationModal,q=void 0===U?i.noop:U,Z=e.isViewOnlyMasquerading,Q=e.shouldScrollIntoView,G=(0,a.TH)().pathname,$=(0,l.r)(),K=E.chat_room_participant_id,J=W(E),X=J.isSpotlighted,Y=J.isCurrentSpotlightedItem,ee=(0,o.useMemo)(function(){return R.find(function(e){return e.id===K})},[R,K]),et=(0,o.useMemo)(function(){return(0,h.cY)(null==ee?void 0:ee.community_member_id,F)},[null==ee?void 0:ee.community_member_id,F]),en=(0,i.isEmpty)(ee),er=null==ee?void 0:ee.user_public_uid,eo=g||{},ei=eo.community_member_id,ea=eo.admin,es=(0,f.x)().isLiveStream,el=function(){er&&$.show({memberPublicId:ee.user_public_uid,params:{shouldOpenInNewTab:es}})},ec=(0,o.useMemo)(function(){return(null==ee?void 0:ee.id)===(null==g?void 0:g.id)?(0,s.t)("messaging.you"):null==ee?void 0:ee.name},[ee,g]),eu=(0,o.useMemo)(function(){return(null==ee?void 0:ee.deleted_at)?(0,s.t)("messaging.removed_or_left"):""},[null==ee?void 0:ee.deleted_at]),ed=G.endsWith("threads")||N;return(0,r.jsxs)("div",{className:(0,d.A)("flex w-full flex-col",{"px-4 py-3":!N,"px-3 py-1.5":N}),children:[X&&(0,r.jsx)(c.U,{isQueuedForSpotlight:!Y}),(0,r.jsxs)("div",{className:"flex w-full justify-start",children:[(0,r.jsx)("button",{type:"button",className:(0,d.A)("mr-3 mt-1 self-start",{"cursor-default":!er}),"aria-label":(0,s.t)("messaging.open_member_profile_button_aria_label",{name:null==ee?void 0:ee.name}),onClick:el,children:en?(0,r.jsx)(b.qE,{}):(0,r.jsx)(u.C,{communityMemberId:ee.community_member_id,name:ee.name,publicUid:ee.user_public_uid,headline:ee.headline,avatarURL:ee.avatar_url,disabled:!er,children:(0,r.jsx)(p.s,{src:ee.avatar_url,name:ee.name,size:"9"})})}),(0,r.jsxs)("div",{className:(0,d.A)("w-full overflow-x-auto",T),children:[(0,r.jsxs)("div",{className:"mb-px flex items-center gap-1.5",children:[void 0!==C&&C&&(0,r.jsx)(m.JO,{type:"14-pin","aria-label":(0,s.t)("messaging.pinned_message"),"aria-hidden":!1,size:14,className:"text-darkest !w-3.5"}),(0,r.jsx)("button",{type:"button",className:(0,d.A)("text-darkest truncate text-left text-sm font-semibold",{"cursor-default":!er}),onClick:el,"data-testid":"number-of-replies",children:en?(0,r.jsx)(b.X2,{md:!0}):(0,r.jsxs)(r.Fragment,{children:[ec," ",(0,r.jsx)("span",{className:"font-normal",children:eu})]})}),et&&(0,m.Er)(et)&&(0,r.jsx)(V,{role:et}),(0,r.jsx)(z,{chatRoomKind:null==t?void 0:t.chat_room_kind,sender:ee}),ed?(0,r.jsx)(B,{chatRoom:t,message:E,isParentMessage:P,isMessageThread:w,isRenderedOnHeader:N}):(0,r.jsx)(L,{message:E,chatRoomUrl:n,isParentMessage:P,isMessageThread:w})]}),!(void 0!==O&&O)&&void 0!==x&&x?(0,r.jsx)(H,{message:E,onSubmit:_,onDelete:q,chatRoom:t,isRenderedOnHeader:N}):(0,r.jsx)(v.z,{message:E,isPinnedMessageAtTop:void 0!==I&&I,shouldScrollIntoView:void 0!==Q&&Q}),(0,r.jsx)(A,{message:E,chatRoom:t,currentCommunityMemberId:ei,isSpotlighted:X,isCurrentSpotlightedItem:Y,isAdmin:ea,isRenderedOnHeader:N,isViewOnlyMasquerading:Z})]})]})]})}},1771:function(e,t,n){n.d(t,{J:()=>i});var r=n(85893),o=n(84326),i=function(e){var t=e.showDateChangeLine,n=void 0!==t&&t,i=e.showUnreadMessageLine,a=void 0!==i&&i,s=e.day;return n&&a?(0,r.jsxs)("div",{id:"unread-message-breakpoint",className:"before:border-v2-danger relative z-0 mx-5 flex items-center justify-center before:bottom-0 before:left-0 before:top-1/2 before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:[(0,r.jsx)("span",{className:"text-disabled bg-primary text-xxs absolute border-none px-[15px] py-[5px] font-bold uppercase",children:s}),(0,r.jsx)("span",{className:"text-v2-danger text-xxs border-none py-[5px] pl-[10px] font-semibold uppercase",children:(0,o.t)("messaging.new")})]}):n?(0,r.jsx)("div",{className:"before:border-primary relative z-0 mx-5 flex items-center justify-center before:absolute before:bottom-0 before:left-0 before:top-1/2 before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:(0,r.jsx)("span",{className:"bg-primary text-disabled text-xxs border-none px-[15px] py-[5px] font-bold uppercase",children:s})}):a?(0,r.jsx)("div",{id:"unread-message-breakpoint",className:"before:border-v2-danger relative z-0 mx-5 flex items-center justify-center before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:(0,r.jsx)("span",{className:"text-v2-danger text-xxs border-none py-[5px] pl-[10px] font-semibold uppercase",children:(0,o.t)("messaging.new")})}):null}},63424:function(e,t,n){n.d(t,{R:()=>_});var r=n(85893),o=n(67294),i=n(46977),a=n(70442),s=n(36353),l=n(1168),c=n(61853),u=n(1800),d=n(59413),f=n(84326),m=function(){return(0,r.jsx)("div",{id:"unread-thread-message-breakpoint",className:"relative flex items-center justify-center z-0 mx-5 before:w-full before:m-0 before:border-t before:border-solid before:border-v2-danger before:z-[-1] before:content-['']",children:(0,r.jsx)("span",{className:"text-v2-danger border-none py-[5px] pl-[10px] text-xs font-semibold uppercase",children:(0,f.t)("messaging.new")})})},p=n(43340),b=n(57092),h=n(59481),v=n(21232),y=n(78252);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var _=function(e){var t,n=e.chatRoom,f=e.chatThreadsEnabled,_=e.currentParticipant,x=e.isInitialPage,j=e.isParentMessage,w=void 0!==j&&j,O=e.isRenderedOnHeader,S=void 0!==O&&O,P=e.isUnreadMessageLineEnabled,C=e.lastReadMessageId,I=e.message,k=e.onBookmarkToggle,N=e.participants,A=e.roles,E=e.setUnreadMessageFlow,T=e.isLiveStream,M=e.chatRoomUrl,R=e.isViewOnlyMasquerading,D=(0,u._)().updateRichTextMessage,L=(0,c.qN)().setScrollInfo,F=(0,s.Op)().calculateScrollInfo,U=(0,d.x)().messageHighlightId,B=(0,a.TH)().pathname,q=(0,c.AP)().activeMessageId,z=(0,c.G9)().setActiveMessageId,Z=(t=(0,o.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return g(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),H=Z[0],V=Z[1],Q=I.id,W=I.replies_count,G=!!Q&&H===Q,$=(0,y.O5)({message:I,chatRoom:n}).canUserModifyMessage,K=!!_,J=function(){return V(null)};(0,i.y1)("esc",J,{enabled:G,enableOnContentEditable:!0},[G]);var X=function(e){var t=e.body,r=e.attachments;D({chatRoomUuid:n.uuid,messageId:Q,rich_text_body:{body:t,attachments:void 0===r?[]:r}}),L(F({event:"messageUpdated"})),J()},Y=(0,b.f)(),ee=function(){Y.visible?Y.hide():Y.show({chatRoom:n,currentParticipant:_,handleSubmit:X,isEditMessage:G,message:I,messageId:Q,participants:N,repliesCount:W})},et=void 0!==P&&P&&C===I.id,en=(0,p.XE)({activeMessageId:q,id:Q,isMessageThread:!0});return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{id:"thread-".concat(Q),className:(0,l.A)("group/action bg-primary relative mx-2 flex flex-col rounded-md",{relative:!w||"/threads"===B,"hover:bg-secondary-dark":!q&&K,"!bg-secondary-dark":G||en,"message-highlight":(0,p.DH)({id:Q,messageHighlightId:U,isParentMessage:w})}),"data-testid":"message-item",children:[(0,r.jsx)(v.t,{isModal:!1,handleSubmit:X,currentParticipant:_,message:I,shouldScrollIntoView:void 0!==x&&x,isEditMessage:G,toggleDeleteConfirmationModal:ee,isPinned:!1,roles:void 0===A?{}:A,isParentMessage:w,chatRoom:n,chatRoomUrl:M,participants:N,isMessageThread:!0,isRenderedOnHeader:S,messageBodyClassName:"mr-4",isViewOnlyMasquerading:R}),K&&(0,r.jsx)(h.P,{isPinned:!1,setEditMessageId:V,chatRoom:n,toggleDeleteConfirmationModal:ee,message:I,currentParticipant:_,canUserModifyMessage:$,chatThreadsEnabled:void 0!==f&&f,isParentMessage:w,isRenderedOnHeader:S,isMessageThread:!0,onBookmarkToggle:k,setUnreadMessageFlow:E,chatRoomUrl:M,isLiveStream:void 0!==T&&T,activeMessageId:q,setActiveMessageId:z})]}),et&&(0,r.jsx)(m,{})]})};_.displayName="MessageItem"},78252:function(e,t,n){n.d(t,{Sh:()=>m,O1:()=>b,O5:()=>i});var r=n(96486),o=n(3697),i=function(e){var t=e.message,n=e.chatRoom,i=t.id,a=t.chat_room_participant_id,s=n.current_participant,l=void 0===s?{}:s,c=n.chat_room_kind===o.g8,u=a===(null==l?void 0:l.id),d=!(0,r.isNull)(i),f=null==l?void 0:l.admin;c&&(f=!1);var m=!!(d&&u),p=!!(d&&(u||f));return{canUserDeleteMessage:p,canUserEditMessage:m,canUserModifyMessage:m||p}},a=n(67294),s=n(46977),l=n(57338),c=n(90926),u=n(43340),d=n(57092);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){var t,n=e.chatRoom,o=e.chatThreadsEnabled,m=void 0!==o&&o,p=e.currentParticipant,b=e.isLastMessage,h=void 0!==b&&b,v=e.message,y=e.participants,g=e.prevDayRef,_=e.setScrollInfo,x=e.calculateScrollInfo,j=e.isViewOnlyMasquerading,w=(0,c._q)().updateRichTextMessage,O=(t=(0,a.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return f(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),S=O[0],P=O[1],C=v.id,I=v.sent_at,k=v.replies_count,N=(0,l.H)(I).day,A=!(0,r.isFunction)(g)&&(null==g?void 0:g.current)!==N;g&&!(0,r.isFunction)(g)&&(g.current=N);var E=!j&&!!C&&S===C,T=(0,d.f)(),M=i({message:v,chatRoom:n}).canUserModifyMessage,R=!E&&(M||m),D=function(){return P(null)};(0,a.useEffect)(function(){E&&h&&(0,u.o7)(C)},[E]),(0,s.y1)("esc",D,{enabled:E,enableOnContentEditable:!0},[E]);var L=function(e){_(x({event:e}))},F=function(e){var t=e.body,r=e.attachments;w({chatRoomUuid:n.uuid,messageId:C,rich_text_body:{body:t,attachments:void 0===r?[]:r}}),L("messageUpdated"),D()};return{canUserModifyMessage:M,day:N,handleSubmit:F,id:C,isDayChange:A,isEditMessage:E,setEditMessageId:P,shouldShowMessageActions:R,shouldShowRepliesBlock:m&&k>0,toggleDeleteConfirmationModal:function(){T.visible?T.hide():T.show({chatRoom:n,currentParticipant:p,handleSubmit:F,isEditMessage:E,message:v,messageId:C,participants:y,onConfirm:function(){L("messageDeleted")},repliesCount:k})}}},p=n(70442),b=function(){var e=(0,p.k6)(),t=function(t){var n=t.id,r=t.parent_message_id;r?e.push({hash:"message_".concat(r),search:"message_id=".concat(n)}):e.push({hash:"message_".concat(n)})};return{redirectToMessage:t,handlePinnedMessage:function(e){document.getElementById(e.id)?(0,u.o7)(e.id):t(e)}}}},56615:function(e,t,n){n.d(t,{G:()=>c});var r=n(85893),o=n(84326),i=n(90926),a=n(16089),s=n(41553),l=n(43340),c=function(e){var t=e.chatRoomUuid,n=e.userList,c=(0,i.uk)(t),u=c.chatParticipants,d=c.isLoading,f=n||u;if(d)return null;var m=(0,l.jo)(f);return(0,r.jsxs)("div",{className:"block px-5 py-4",children:[(0,r.jsx)("div",{className:"mb-2 flex space-x-2","data-testid":"participants",children:f.map(function(e){var t=e.name,n=e.avatar_url,o=e.id,i=e.status;return(0,r.jsx)(a.g,{src:n,name:t,size:"10",status:i},o)})}),(0,r.jsx)(s.Z.LabelLg,{weight:"medium",color:"text-darkest",dataTestId:"start-conversation",children:(0,o.t)("messaging.start_conversation")}),(0,r.jsxs)(s.Z.BodyMd,{"data-testid":"start-conversation-message",children:[(0,o.t)("messaging.direct_message_history")," ",m]})]})}},7999:function(e,t,n){n.d(t,{$S:()=>A,BR:()=>u,C9:()=>E,DH:()=>O,OG:()=>y,PM:()=>j,Pd:()=>x,VA:()=>v,Vs:()=>h,YQ:()=>_,ZZ:()=>k,_z:()=>P,bZ:()=>b,cY:()=>m,d6:()=>I,eB:()=>S,f9:()=>p,jo:()=>d,jr:()=>T,lC:()=>c,nR:()=>N,o7:()=>f,uR:()=>w,uo:()=>C,wJ:()=>g});var r=n(96486),o=n(84326),i=n(3697),a=n(13532),s=n(19347);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var c=96,u=64,d=function(e){var t="";return e.forEach(function(n,r){t=r==e.length-1?t+n.name+".":r==e.length-2?t+n.name+" and ":t+n.name+", "}),t},f=function(e,t){var n=document.getElementById(e),r=setTimeout(function(){null==n||n.scrollIntoView({behavior:"smooth",block:"center"}),null==t||t()},100);return function(){return clearTimeout(r)}},m=function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=Object.entries(t||[])[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s,c=(s=i.value,function(e){if(Array.isArray(e))return e}(s)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(s,2)||function(e,t){if(e){if("string"==typeof e)return l(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}}(s,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],d=c[1];if(Array.isArray(d)&&d.includes(e))return u}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}},p=function(){return!!document.getElementById("mobile-bottom-toolbar")},b=function(){return!!document.getElementById("bookmarks-bar")},h=function(){return document.getElementById("lesson-hello-bar")?112:s.Mz},v=function(e){return e<20?100:e},y=function(e,t){return e.sender.id===t.id},g=function(e,t){return e&&!!e.id&&e.id>0&&(null==e?void 0:e.creation_uuid)===(null==t?void 0:t.creation_uuid)},_=function(){return(window.location.hash||"").split("#message_")[1]},x=function(e,t){return e&&t},j=function(e){var t=e.id,n=e.isPinned,o=e.disableUnreadMessageLine,i=e.unreadMessageId;return!(0,r.isNull)(t)&&!n&&!o&&i===t},w=function(e){var t=e.id,n=e.messageHashId,r=e.messageHighlightId;return n&&t==n||r&&t==r},O=function(e){var t=e.id,n=e.messageHighlightId;return!e.isParentMessage&&n&&t==n},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>0?"".concat((0,o.t)("messaging.delete_message.description")," ").concat((0,o.t)("messaging.delete_message.threads")):(0,o.t)("messaging.delete_message.description")},P=function(e,t){if((0,r.isEmpty)(e))return"";var n=e.embedded_space,o=e.uuid,i=(n||{}).slug;return t.embedded?(0,a.kr)({spaceSlug:i}):(0,a.so)({uuid:o})},C=function(e){return"message_".concat(e.id)},I=function(e){return"message_".concat(e.parent_message_id)},k=function(e,t){var n=P(e,t);return"".concat(n,"#message_").concat(t.id)},N=function(e,t){var n=[];return e.map(function(e){var r=e.chat_room_participant_id;t.find(function(e){return(null==e?void 0:e.id)===r})||n.includes(r)||n.push(r)}),n},A=function(e){return(null==e?void 0:e.chat_room_kind)===i.g8},E=function(e){var t=(e||{}).current_participant,n=void 0===t?{}:t;return!!((null==n?void 0:n.admin)||(null==n?void 0:n.moderator))},T=function(e,t){var n=null;return e?n="fullscreen-modal-body":t&&(n="chat-threads-header"),n}},61219:function(e,t,n){n.d(t,{Q1:()=>o,XE:()=>i,h7:()=>a,j_:()=>s,ut:()=>l,yf:()=>u});var r=n(13532),o=function(e){var t=e.id,n=e.parentMessageId,r=e.chatRoomUrl;return window.location.protocol+"//"+window.location.host+(r||window.location.pathname)+(n?"?message_id=".concat(t,"#message_").concat(n):"#message_".concat(t))},i=function(e){var t=e.activeMessageId,n=e.id,r=e.isMessageThread;return t===a(n,void 0!==r&&r)},a=function(e,t){return"".concat(t?"thread-":"message-").concat(String(e))},s=function(){return document.getElementById("message-thread-scroll-view")||document.getElementById("message-scroll-view")||document.body},l=function(e,t){var n=e.slug,o=e.uuid,i=t.id,a=t.parent_message_id,s=t.embedded?(0,r.kr)({spaceSlug:n}):(0,r.so)({uuid:o}),l="#message_".concat(i);return a&&(l="?message_id=".concat(i,"#message_").concat(a)),"".concat(s).concat(l)},c=0,u=function(e){var t,n,r=e.chatRoom,o=e.richTextBody,i=e.localAttachments,a=e.localSgidToObjectMap,s=e.parentMessageId,l=e.creationUuid,u=e.sentAt,d=r.current_participant,f=null==d?void 0:d.id;if(!d||!f)return null;var m={id:--c,chat_room_id:r.id,rich_text_body:(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},o),n=n={attachments:i,sgids_to_object_map:a},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t),body:"",chat_room_uuid:r.uuid,chat_room_participant_id:f,creation_uuid:l,sender:d,reactions:[],parent_message_id:null!=s?s:null,updated_at:u,sent_at:u,created_at:u};return s&&(m.parent_message_id=s),m}},43340:function(e,t,n){n.d(t,{cY:()=>r.cY,XE:()=>a.XE,$S:()=>r.$S,DH:()=>r.DH,o7:()=>r.o7,Q1:()=>a.Q1,eB:()=>r.eB,h7:()=>a.h7,_z:()=>r._z,PM:()=>r.PM,uR:()=>r.uR,ZZ:()=>r.ZZ,yf:()=>a.yf,nR:()=>r.nR,d6:()=>r.d6,uo:()=>r.uo,ut:()=>a.ut,jo:()=>r.jo,cj:()=>i,wJ:()=>r.wJ,Pd:()=>r.Pd,j_:()=>a.j_,C9:()=>r.C9,jr:()=>r.jr,YQ:()=>r.YQ});var r=n(7999),o=n(19347),i=function(e){var t=e.searchInputClientHeight,n=void 0===t?0:t,i=e.footerClientHeight,a=e.isSmOrMdScreen,s=e.isLiveStream,l=void 0!==s&&s,c=e.isInCourseSpace,u=void 0!==c&&c,d=e.isDrawer,f=void 0!==d&&d,m=e.isMessagingModalOpen,p=void 0===i?0:i;return n&&(p+=n),(0,r.f9)()&&(p+=o.Q_),!u&&(0,r.bZ)()&&(p+=40),void 0!==a&&a?p+=l||u||f?o.Mz:r.BR+o.Mz:l?p=r.lC:u?p=(0,r.Vs)():f&&(p=o.Mz),void 0!==m&&m&&(p=(0,r.VA)(p)),p},a=n(61219)},28740:function(e,t,n){n.d(t,{x:()=>en});var r=n(85893),o=n(67294),i=n(96486),a=n(61853),s=n(99385),l=n(63271),c=n(41342),u=n(90926),d=n(1800),f=n(84326),m=n(32701),p=n(91735),b=n(61242),h=n(56615),v=function(e){var t=e.userList,n=!(0,m.L7)()&&1===t.length;return(0,r.jsxs)("div",{children:[(0,r.jsx)(h.G,{userList:t}),n?(0,r.jsx)(p.R,{children:(0,f.t)("community_member.member_to_member_messaging_disabled")}):(0,r.jsx)(b.Fx,{userList:t,isChatPreview:!0,portalTargetId:"fullscreen-modal-body"})]})},y=n(70442),g=n(82859),_=n(60589),x=n(95834),j=n(36353),w=n(17617),O=n(18059),S=n(1168),P=n(39295),C=n(48880),I=n(89131),k=n(26801),N=n(76896);n(19347);var A=n(13532),E=n(43340),T=n(59481),M=n(21232),R=n(1771),D=n(61219),L=n(78252),F=function(e){var t=e.children,n=e.id,o=e.isEditMessage,i=void 0!==o&&o,a=e.isPinned,s=void 0!==a&&a,l=e.isPinnedMessageAtTop,c=e.message,d=e.messageHashId,f=e.shouldShowMessageActions,m=void 0!==f&&f,p=e.shouldShowRepliesBlock,b=void 0!==p&&p,h=e.activeMessageId,v=(0,u.xX)().messageHighlightId,y=(0,L.O1)().handlePinnedMessage,g=c.spotlighted,_=(0,D.XE)({activeMessageId:h,id:c.id,isMessageThread:!1}),x="group/action bg-primary mx-2 flex flex-col rounded-md text-left relative z-0";return void 0!==l&&l?(0,r.jsx)("button",{type:"button",id:"pinned","data-testid":"message-item",className:(0,S.A)(x,"cursor-pointer",{"hover:bg-secondary-dark":!h&&m,"!bg-secondary-dark":i||_||g,"bg-message-highlight mt-2":s,"pb-2":b}),onClick:function(){i||y(c)},children:t}):(0,r.jsx)("div",{id:n,"data-testid":"message-item",className:(0,S.A)(x,{"hover:bg-secondary-dark":!h&&m,"!bg-secondary-dark":i||_||g,"bg-message-highlight":s,"message-highlight":(0,E.uR)({id:n,messageHashId:d,messageHighlightId:v}),"pb-2":b}),children:t})},U=n(8683),B=n(59413),q=n(41553),z=n(67142),Z=function(e){var t=e.avatars,n=(void 0===t?[]:t).slice(0,3).map(function(e){return{name:e.name,src:e.avatar_url}});return(0,r.jsx)("div",{className:"border-tertiary isolate flex items-center space-x-1 rounded-lg md:justify-center",children:(0,r.jsx)(z.pB,{size:"5",users:n,isFullRounded:!0})})},H=function(e){var t=e.message,n=e.chatRoom,o=(0,B.x)().openThreadsRailbar,i=t.replies_count,a=t.last_reply_at,s=(0,C.K)().removeThreadIdUrlParam;return(0,r.jsx)("button",{type:"button",className:"hover:border-primary hover:bg-primary group -mt-2 ml-[62px] flex h-[30px] max-w-fit cursor-pointer items-center rounded-2xl border border-transparent px-0.5 md:mr-0 hover:md:mr-[30px]",onClick:function(){s(),o(t,n)},children:(0,r.jsx)("div",{className:"flex items-center justify-between","data-testid":"replies-block",children:(0,r.jsxs)("div",{className:"flex items-center space-x-1.5",children:[(0,r.jsx)(Z,{avatars:t.thread_participants_preview}),(0,r.jsx)(q.Z.LabelXs,{weight:"medium",children:1===i?(0,f.t)("threads.one_reply"):(0,f.t)("threads.many_replies",{count:i})}),a&&(0,r.jsx)("div",{className:"flex items-center pr-2.5 leading-none group-hover:hidden",children:(0,r.jsx)(q.Z.LabelXs,{color:"text-timestamp",weight:"medium",children:(0,U.TF)(a)})}),(0,r.jsx)("div",{className:"hidden pr-2.5 leading-none group-hover:block",children:(0,r.jsx)(q.Z.LabelXs,{color:"text-timestamp",weight:"medium",children:(0,f.t)("messaging.view_thread")})})]})})})},V=(0,o.forwardRef)(function(e,t){var n=e.chatRoom,o=e.chatThreadsEnabled,a=void 0!==o&&o,s=e.currentParticipant,l=e.disableUnreadMessageLine,c=e.displayDayChange,u=e.isInitialPage,d=e.isLastMessage,f=e.isParentMessage,m=void 0!==f&&f,p=e.isPinned,b=void 0!==p&&p,h=e.isPinnedMessageAtTop,v=void 0!==h&&h,y=e.message,g=e.messageBodyClassName,_=e.messageHashId,x=e.onBookmarkToggle,j=e.participants,w=e.roles,O=e.setUnreadMessageFlow,S=e.unreadMessageId,C=e.isLiveStream,I=e.activeMessageId,k=e.setActiveMessageId,N=e.setScrollInfo,D=e.calculateScrollInfo,U=e.isViewOnlyMasquerading,B=(0,L.Sh)({chatRoom:n,chatThreadsEnabled:a,currentParticipant:s,isLastMessage:void 0!==d&&d,message:y,participants:j,prevDayRef:t,setScrollInfo:N,calculateScrollInfo:D,isViewOnlyMasquerading:U}),q=B.canUserModifyMessage,z=B.day,Z=B.handleSubmit,V=B.id,Q=B.isDayChange,W=B.isEditMessage,G=B.setEditMessageId,$=B.shouldShowMessageActions,K=B.shouldShowRepliesBlock,J=B.toggleDeleteConfirmationModal,X=(0,P.q)().isMessaging?(0,A.so)(n):"",Y=void 0!==u&&u&&!(_||S);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(R.J,{showDateChangeLine:(0,E.Pd)(void 0!==c&&c,Q),showUnreadMessageLine:(0,E.PM)({id:V,isPinned:b,disableUnreadMessageLine:void 0!==l&&l,unreadMessageId:S}),day:z}),(0,r.jsxs)(F,{isPinnedMessageAtTop:v,id:V,shouldShowMessageActions:$,isEditMessage:W,isPinned:b,messageHashId:_,shouldShowRepliesBlock:K,message:y,activeMessageId:I,children:[(0,r.jsx)(M.t,{isModal:!1,handleSubmit:Z,currentParticipant:s,message:y,isEditMessage:W,toggleDeleteConfirmationModal:U?i.noop:J,isPinned:b,roles:void 0===w?{}:w,isParentMessage:m,chatRoom:n,isPinnedMessageAtTop:v,participants:j,messageBodyClassName:g,chatRoomUrl:X,isViewOnlyMasquerading:U,shouldScrollIntoView:Y}),(0,r.jsx)(T.P,{isPinned:b,setEditMessageId:G,chatRoom:n,toggleDeleteConfirmationModal:U?i.noop:J,message:y,currentParticipant:s,canUserModifyMessage:q,chatThreadsEnabled:a,isParentMessage:m,isPinnedMessageAtTop:v,onBookmarkToggle:x,setUnreadMessageFlow:O,isLiveStream:C,chatRoomUrl:X,activeMessageId:I,setActiveMessageId:k}),K&&(0,r.jsx)(H,{message:y,chatRoom:n})]})]})});function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function W(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}V.displayName="MessageItem";var $=function(e){var t,n,s,l=e.chatRoom,d=e.displayDayChange,m=void 0===d||d,h=e.isChatPreview,v=e.isChatSpace,A=e.isInCourseSpace,T=e.chatUserSearchRef,M=e.isLiveStream,R=e.isDrawer,D=e.roles,L=void 0===D?{}:D,F=e.messageBodyClassName,U=(0,E.YQ)(),B=G((0,o.useState)(U),2),q=B[0],z=B[1],Z=(0,C.K)().openThreadsRailbarOnThreadsNotification,H=(0,c.L2)().data,Q=(0,c.wh)().isViewOnlyMasquerading,$=G((0,o.useState)(!1),2),K=$[0],J=$[1],X=(0,x.w)().markChatRoomAsRead,Y=(0,k.L)([null==H?void 0:H.id]).refetchSpaceNotifications,ee=(0,O.h4)().spaces,et=(0,_.Xd)(ee,null==H?void 0:H.id),en=(0,y.k6)(),er=G((0,o.useState)(!0),2),eo=er[0],ei=er[1],ea=G((0,o.useState)(!0),2),es=ea[0],el=ea[1],ec=(0,w.ef)();(0,I.t)();var eu=(0,u.uk)(l.uuid,{shouldDisableCache:!0,per_page:100}).chatParticipants,ed=(0,P.q)().isMessaging,ef=l.uuid,em=l.last_message,ep=l.current_participant,eb=void 0===ep?{}:ep,eh=l.pinned_message,ev=l.first_unread_message_id,ey=(0,o.createRef)(),eg=(0,a.AP)(),e_=eg.activeMessageId,ex=eg.hasNextPage,ej=eg.isLoading,ew=eg.isInitialPageLoaded,eO=(0,a.G9)(),eS=eO.setChatRoomMessages,eP=eO.setActiveMessageId,eC=eO.setScrollInfo,eI=eO.appendLastMessage,ek=(0,a.XT)().chatRoomMessages,eN=void 0===ek?[]:ek,eA=(0,j.Op)(),eE=eA.calculateScrollInfo,eT=eA.scrollerId,eM=(0,u.ub)(),eR=eM.fetchChatMessagesFirstPage,eD=eM.adjustScroller,eL=eM.setUnreadMessageFlow,eF=(0,u.Bk)(eN,eS),eU=!v&&0===eN.length,eB=(0,u.Lx)(l),eq=eB.canSendMessage,ez=eB.canParticipantsMessage,eZ=G((0,o.useState)(),2),eH=eZ[0],eV=eZ[1],eQ=(0,o.useRef)(null),eW=eo&&es;(0,o.useEffect)(function(){z(U)},[U]),(0,o.useEffect)(function(){eR(Number(q)||ev),el(!0),ei(!0)},[ef,q,ev]),(0,o.useEffect)(function(){q&&eW&&!ej&&((0,E.o7)(q),Z({messageHashId:q,chatRoomMessages:eN,chatRoom:l}))},[q,ej,eW]);var eG=(0,o.useMemo)(function(){var e=(0,i.uniqBy)(eN,"id");return(0,i.sortBy)(e,"sent_at")},[eN]);(0,o.useEffect)(function(){eW&&q||!ew||(0,i.defer)(eD)},[eG,q,ew]);var e$=function(){!ex&&em&&em.id>0&&eI(em)};(0,o.useEffect)(function(){var e=function(){var e,t;eV((0,E.cj)({searchInputClientHeight:null==T||null==(e=T.current)?void 0:e.clientHeight,footerClientHeight:null==eQ||null==(t=eQ.current)?void 0:t.clientHeight,isSmOrMdScreen:ec,isLiveStream:M,isInCourseSpace:A,isDrawer:R}))};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[T,eU,eq,M,A,ec,null==eQ||null==(s=eQ.current)?void 0:s.clientHeight,R]),(0,o.useEffect)(function(){J(!((v||ed)&&eq))},[eq,v,ed]);var eK=(0,o.useMemo)(function(){return(0,E.nR)(eG,eu)},[eG,eu]);(0,u.gJ)({uuid:l.uuid,ids:eK,enabled:!!(eu.length&&eK.length)});var eJ=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.shouldAppendLastMessage,r=void 0!==n&&n;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:if(!(v&&(null==et?void 0:et.unread_content_count)>0&&!Q))return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,X({uuid:l.uuid})];case 2:return e.sent()&&Y(),[3,4];case 3:return console.error(e.sent()),[3,4];case 4:return q?en.push({}):eR(),r&&(0,i.delay)(e$,100),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){W(i,r,o,a,s,"next",e)}function s(e){W(i,r,o,a,s,"throw",e)}a(void 0)})})()},eX=(0,g.OP)(),eY=(0,o.useMemo)(function(){return{uuid:l.uuid,chat_room_kind:l.chat_room_kind,current_participant:eb,chat_room_participants_count:l.chat_room_participants_count}},[l.uuid,l.chat_room_kind,eb,l.chat_room_participants_count]),e0=(0,o.useMemo)(function(){return(0,i.omit)(l,"last_message")},[l.uuid,l.chat_room_kind,l.identifier,l.chat_room_participants_count,eb,l.chat_room_show_history,l.pinned_message,l.first_unread_message_id,l.chat_room_name,l.chat_room_description]);return(0,r.jsxs)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({id:"scrollWrapper",className:"flex grow flex-col overflow-y-auto border-r-0","data-testid":"chat-room-wrapper"},eH&&{style:{height:"calc(100".concat(eX," - ").concat(eH,"px)")}}),n=n={children:[ew?(0,r.jsxs)(r.Fragment,{children:[eh&&(0,r.jsx)(V,{message:eh,currentParticipant:eb,isPinned:!0,roles:L,chatRoom:e0,chatThreadsEnabled:!h,isLiveStream:M,isPinnedMessageAtTop:!0,participants:eu,messageBodyClassName:F,onBookmarkToggle:eF,setUnreadMessageFlow:eL,setScrollInfo:eC,calculateScrollInfo:eE,activeMessageId:e_,setActiveMessageId:eP,isViewOnlyMasquerading:Q}),(0,r.jsx)(b.Qk,{isLastPage:eo,isFirstPage:es,setIsLastPage:ei,setIsFirstPage:el,componentId:eT,children:eG.map(function(e){var t;return(0,r.jsx)(V,{message:e,displayDayChange:m,ref:ey,currentParticipant:eb,isInitialPage:eW,isLastMessage:(null==(t=(0,i.last)(eN))?void 0:t.id)===e.id,messageHashId:q,roles:L,isPinned:(null==eh?void 0:eh.id)===e.id,disableUnreadMessageLine:K,unreadMessageId:ev,chatRoom:e0,chatThreadsEnabled:!h,isLiveStream:M,participants:eu,messageBodyClassName:F,onBookmarkToggle:eF,setUnreadMessageFlow:eL,activeMessageId:e_,setActiveMessageId:eP,setScrollInfo:eC,calculateScrollInfo:eE,isViewOnlyMasquerading:Q},e.id)})})]}):(0,r.jsx)("div",{id:eT,className:"overflow-hidden pt-0",children:(0,r.jsx)(N.gi,{variant:"chat-room",hideMessageBox:!0})}),ex&&ew&&(0,r.jsx)("div",{className:"relative bottom-8 m-auto h-0",children:(0,r.jsx)(b.E0,{label:(0,f.t)("messaging.latest_messages"),onClick:function(){eJ()}})}),eq?(0,r.jsxs)("div",{ref:eQ,className:(0,S.A)("bg-primary fixed z-[9] w-full md:static md:bottom-auto md:z-auto md:w-auto md:bg-auto",{"bottom-0":!eU||M,"bottom-16":eU&&!M||v,"rounded-b-lg":M}),children:[!ej&&eU&&(0,r.jsx)(b.GW,{isLiveStream:M,isInCourseSpace:A,isMessaging:ed,chatRoomUuid:l.uuid}),(0,r.jsx)(b.Fx,{spaceId:null==H?void 0:H.id,chatRoomData:eY,onClick:function(){(q||ex)&&eJ({shouldAppendLastMessage:!0})},isChatPreview:h,isLiveStream:M,isChatSpace:v,isInCourseSpace:A,isLoading:!ew||ej,participants:eu})]}):(0,r.jsx)("div",{className:"fixed bottom-0 z-[9] h-24 w-full pb-1 pt-2 md:static md:z-auto md:w-auto",ref:eQ,children:(0,r.jsx)(p.R,{children:ez?(0,f.t)("community_member.join_space_to_message"):(0,f.t)("community_member.messaging_disabled")})})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},K=n(2952),J=n(57335),X=n(60878);function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ee=function(){var e=document.getElementById("message-thread-scroll-view")||document.getElementById("message-scroll-view");return!!(null==e?void 0:e.offsetParent)},et=function(e){var t,n=e.uuid,r=e.isLiveStream,i=(0,o.useRef)(),a=(0,o.useRef)(),s=(0,o.useRef)("connected"),l=(0,X.pm)(),c=(t=(0,o.useState)("connected"),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return Y(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],d=c[1],m=(0,K.u)().fetchChatMessagesFirstPage,p=!r||ee(),b=function(e){d(e.subscriptionState)};(0,o.useEffect)(function(){return J.Z.on("chatRoomSubscriptionStateChange",b),function(){J.Z.off("chatRoomSubscriptionStateChange",b)}},[]),(0,o.useEffect)(function(){s.current=u},[u]),(0,o.useEffect)(function(){if("disconnected"===u)a.current=Date.now(),setTimeout(function(){"disconnected"===s.current&&p&&l.error((0,f.t)("websocket_message.unstable_right_now"))},3e3);else if("disconnected"===i.current&&"connected"===u){var e;Date.now()-(null!=(e=a.current)?e:0)>3e3&&p&&l.success((0,f.t)("websocket_message.back_online"),{shouldUseProgress:!1}),m()}i.current=u},[u,n])},en=function(e){var t=e.uuid,n=e.displayDayChange,f=e.onNewChatMessage,m=e.isChatSpace,p=e.chatUserSearchRef,h=e.isLiveStream,y=void 0!==h&&h,g=e.isInCourseSpace,_=e.isDrawer,x=e.roles,j=e.messageBodyClassName,w=e.isChatPreview,O=e.userList,S=void 0===O?[]:O,P=e.isMessaging,C=(0,u.ub)().onEventReceive,I=(0,a.XT)().chatRoomMessages,k=(0,u.QP)().onReactionWebsocketEvent;et({uuid:t,isLiveStream:y});var N=(0,c.N3)(),A=(0,d._)(),E=A.onEventReceive,T=A.onEmbedEventReceive,M=(0,s.m)(t),R=M.chatRoom,D=M.onEventReceive,L=M.isLoading,F=(0,u.aK)((0,a.Kv)(t)),U=(0,u.aK)(a.yf).appendChatRoom;return((0,o.useEffect)(function(){R&&!F&&U(R)},[U,R,F]),(0,l.s)({channel:"Chats::RoomChannel",chat_room_uuid:null==R?void 0:R.uuid,onMessageReceive:function(e){"newMessage"===e.event&&(E(e,null==N?void 0:N.id,t===(null==R?void 0:R.uuid)),f&&(null==e?void 0:e.json_message)&&f(e.json_message)),C(e,I),D(e)},canCreateConnection:!!((null==R?void 0:R.uuid)&&(null==N?void 0:N.id))},[null==R?void 0:R.uuid,null==N?void 0:N.id]),(0,l.s)({channel:"ChatRoomChannel",onMessageReceive:function(e){k(e),T(e)},community_member_id:null==N?void 0:N.id,canCreateConnection:(null==R?void 0:R.uuid)&&(null==N?void 0:N.id)},[null==R?void 0:R.uuid,null==N?void 0:N.id]),F)?(0,r.jsx)($,{chatRoom:F,displayDayChange:void 0===n||n,isChatSpace:void 0!==m&&m,chatUserSearchRef:p,isLiveStream:y,isInCourseSpace:void 0!==g&&g,isDrawer:void 0!==_&&_,roles:void 0===x?{}:x,messageBodyClassName:void 0===j?"":j,isChatPreview:w}):void 0!==P&&P?"new"===t&&(0===S.length||L)?(0,r.jsx)(b.Fx,{onClick:i.noop,disabled:!0}):(0,r.jsx)(v,{userList:S}):null}},90664:function(e,t,n){n.d(t,{V:()=>O});var r=n(85893),o=n(67294),i=n(96486),a=n(84326),s=n(61853),l=n(63271),c=n(41342),u=n(13532),d=n(90926),f=n(39295),m=n(76896),p=n(91735),b=n(63424),h=n(43340),v=n(61242),y=n(38825),g=n(74178),_=function(e){var t=e.children,n=e.isLastPage,o=e.isFirstPage,i=e.setIsFirstPage,a=e.setIsLastPage,l=e.chatRoomUuid,c=e.parentMessage,u=(0,y.T)().fetchChatMessages,d=(0,s.qN)(),f=d.hasNextPage,m=d.hasPrevPage,p=d.isLoading,b=d.firstMessageId,h=d.lastMessageId;return(0,r.jsx)(g.Y,{shouldShowPrevLoader:!n,shouldShowNextLoader:!o,hasNextPage:f,hasPrevPage:m,onNextPage:function(e){u({chatRoomUuid:l,id:e,previousPerPage:0,nextPerPage:20,parentMessage:c}),i(!1)},onPrevPage:function(e){u({chatRoomUuid:l,id:e,parentMessage:c}),a(!1)},firstItemId:b,lastItemId:h,componentId:"message-thread-scroll-view",isLoading:p,children:t})},x=function(e){var t=e.count;return(0,r.jsx)("div",{id:"replies-message-line",className:"before:border-primary relative z-0 mx-5 flex items-center justify-start before:absolute before:bottom-0 before:left-0 before:top-1/2 before:z-[-1] before:m-0 before:w-full before:border-t before:border-solid before:content-['']",children:(0,r.jsx)("span",{className:"bg-primary w-[68px] border-none py-0.5 pr-[10px] text-xs text-gray-400",children:1===t?(0,a.t)("threads.one_reply"):(0,a.t)("threads.many_replies",{count:t})})})};function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var O=function(e){var t=e.parentMessage,n=e.chatRoom,y=w((0,o.useState)(!0),2),g=y[0],j=y[1],O=w((0,o.useState)(!0),2),S=O[0],P=O[1],C=w((0,o.useState)(0),2),I=C[0],k=C[1],N=w((0,o.useState)(!1),2),A=N[0],E=N[1],T=(0,c.wh)().isViewOnlyMasquerading,M=(0,d.KR)().removeThreadIdUrlParam,R=(0,d.uk)(n.uuid).chatParticipants,D=(0,c.L2)().data,L=(0,s.qN)(),F=L.chatMessages,U=L.setChatMessages,B=L.hasPrevPage,q=L.hasNextPage,z=L.isLoading,Z=L.totalMessagesCount,H=L.metaData,V=(0,d.Tl)(),Q=V.fetchChatMessages,W=V.onEventReceive,G=V.adjustScroller,$=V.isInitialPageLoaded,K=V.setIsInitialPageLoaded,J=(0,d.NF)().handleReactionFromWebsocket,X=(0,d.Bk)(F,U),Y=(0,d.xX)(),ee=Y.messageHighlightId,et=Y.isLiveStream,en=(0,f.q)().isMessaging,er=Number((0,h.YQ)())!==ee,eo=en?(0,u.so)(n):"",ei=n.current_participant,ea=(0,d.Lx)(n),es=ea.canSendMessage,el=ea.canParticipantsMessage;(0,o.useEffect)(function(){var e={chatRoomUuid:n.uuid,isInitialPage:!0,parentMessage:t,id:null,nextPerPage:0};return ee&&er&&(e.id=ee,e.nextPerPage=20),K(!1),Q(e),function(){return k(0)}},[t.id,null==n?void 0:n.uuid]),(0,l.s)({channel:"Chats::RoomChannel",chat_room_uuid:null==n?void 0:n.uuid,onMessageReceive:function(e){var n=e.event,r=e.json_message;if("newMessage"===n){if(!(null==r?void 0:r.parent_message_id)||r.parent_message_id!==t.id)return;k(function(e){return e+1})}else"deletedMessage"===n&&k(function(e){return e-1});W(e,F,ei)},canCreateConnection:!!(null==n?void 0:n.uuid)},[null==n?void 0:n.uuid]),(0,o.useEffect)(function(){$&&ee&&er&&(0,h.o7)("thread-".concat(ee))},[$,ee,er]),(0,o.useEffect)(function(){!$||ee&&er||(0,i.defer)(G)},[F,$,ee]);var ec=(0,o.useMemo)(function(){var e=(0,i.uniqBy)(F,"id");return(0,i.sortBy)(e,"sent_at")},[F]),eu=(H||{}).last_read_message_id,ed=(0,i.last)(ec),ef=(0,o.useMemo)(function(){return(0,h.nR)(ec,R)},[ec,R]);(0,d.gJ)({uuid:n.uuid,ids:ef,enabled:!!(R.length&&ef.length)}),(0,o.useEffect)(function(){if(!z&&$){var e=!(0,i.isNull)(eu),t=eu!==(null==ed?void 0:ed.id);E(e&&t)}},[eu,$,t.id,z]),(0,l.s)({channel:"ChatRoomChannel",onMessageReceive:function(e){("createReaction"===e.event||"destroyReaction"===e.event)&&J(e)},community_member_id:null==ei?void 0:ei.community_member_id,canCreateConnection:!!(null==ei?void 0:ei.community_member_id)},[null==ei?void 0:ei.community_member_id]);var em=Z+I,ep=(0,o.useMemo)(function(){return{uuid:n.uuid,chat_room_kind:n.chat_room_kind,current_participant:ei,chat_room_participants_count:n.chat_room_participants_count}},[n.uuid,n.chat_room_kind,ei,n.chat_room_participants_count]);return $?(0,r.jsx)("div",{id:"scrollWrapper",className:"flex h-full grow flex-col border-r-0",children:(0,r.jsxs)(_,{isLastPage:g,isFirstPage:S,setIsLastPage:j,setIsFirstPage:P,chatRoomUuid:n.uuid,parentMessage:t,children:[!B&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.R,{message:t,currentParticipant:ei,chatRoom:n,participants:R,isLiveStream:et,isParentMessage:!0,chatThreadsEnabled:!0,chatRoomUrl:eo,isViewOnlyMasquerading:T}),em>0&&(0,r.jsx)(x,{count:em})]}),ec.map(function(e){return(0,r.jsx)(b.R,{message:e,currentParticipant:ei,chatRoom:n,chatRoomUrl:eo,chatThreadsEnabled:!0,isUnreadMessageLineEnabled:A,lastReadMessageId:eu,participants:R,isLiveStream:et,onBookmarkToggle:X,isViewOnlyMasquerading:T},e.id)}),!q&&(es?(0,r.jsx)(v.Fx,{chatRoomData:ep,parentMessageId:t.id,onClick:M,spaceId:null==D?void 0:D.id,portalTargetId:"rail-content",participants:R,messageBoxId:"threadsMessageTextBox"+String(t.id)}):(0,r.jsx)(p.R,{className:"mt-2",children:el?(0,a.t)("community_member.join_space_to_message"):(0,a.t)("community_member.messaging_disabled")}))]})}):(0,r.jsx)("div",{id:"message-thread-scroll-view",children:(0,r.jsx)(m.gi,{variant:"chat-thread"})})}},92771:function(e,t,n){n.d(t,{I:()=>g});var r=n(85893),o=n(96486),i=n(70442),a=n(84326),s=n(90926),l=n(51630),c=n(71807),u=n(14625),d=n(59413),f=n(33516),m=n(19347),p=n(90664),b=n(17617),h=n(75148),v=n(41553),y=function(e){var t=e.title,n=e.onClose,o=(0,b.kK)(),i=(0,s.xX)(),l=i.isChatSpace,c=i.isCourseSpace,u=i.isLiveStream,d=i.isDrawer;if(o)return(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(h.h,{name:"16-arrow-left",onClick:n,iconClassName:"!text-dark",className:"flex-none",ariaLabel:(0,a.t)("close")}),(0,r.jsx)("div",{className:"flex-auto text-center",children:(0,r.jsx)(v.Z.TitleSm,{as:"h2",weight:"semibold",children:t})})]});if(u||c||d)return(0,r.jsxs)("div",{className:"flex w-full items-center justify-start",children:[(0,r.jsx)(h.h,{name:"20-back",onClick:n,iconSize:20,buttonSize:20,iconClassName:"!text-dark !h-5 !w-5",className:"mr-3 h-8 w-8 flex-none",ariaLabel:(0,a.t)("back")}),(0,r.jsx)(v.Z.TitleSm,{as:"h2",weight:"semibold",children:t})]});var f=l?v.Z.TitleSm:v.Z.LabelMd;return(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(f,{as:"h2",weight:"semibold",children:t}),(0,r.jsx)(h.h,{name:"20-close",iconSize:20,onClick:n,iconClassName:"!text-dark",ariaLabel:(0,a.t)("close")})]})},g=function(e){var t=e.isFullWidth,n=(0,f.T)(),b=n.ref,h=n.height,v=(0,i.k6)(),g=(0,d.x)(),_=g.closeThreadsRailbar,x=g.parentMessage,j=g.chatRoom,w=void 0===j?{}:j,O=g.messageHighlightId,S=g.setMessageHighlightId,P=g.shouldShowRailBar,C=g.isCourseSpace,I=g.isDrawer,k=(0,s.rZ)(),N=k.unreadChatThreadIds,A=k.isUnreadThreadFlow;if(!P||(0,o.isEmpty)(w))return null;var E=C?"portal":I?"drawer":"header";return(0,r.jsxs)(c.x,{position:E,noBorderLeft:C,isFullWidth:void 0!==t&&t,children:[(0,r.jsx)("div",{ref:b,children:(0,r.jsx)(m.S0.Header,{children:(0,r.jsx)(y,{title:(0,a.t)("messaging.thread"),onClose:function(){O&&(v.push({search:(0,u.iO)("message_id")}),S(null)),x.chat_thread_id&&N.includes(x.chat_thread_id)&&!A&&(0,l.ex)(x.chat_thread_id),_()}})})}),(0,r.jsx)(m.S0.Content,{heightGap:h,isCourseSpace:C,noPadding:!0,children:(0,r.jsx)(p.V,{parentMessage:x,chatRoom:w})})]})}},97485:function(e,t,n){n.d(t,{h:()=>l});var r=n(85893),o=n(96486),i=n(57363),a=n(17617),s=n(41553),l=function(e){var t=e.title,n=e.memberCount,l=e.isDirect,c=e.description,u=e.onClose,d=void 0===u?o.noop:u,f=(0,a.BT)();return(0,r.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(s.Z.LabelMd,{as:"h2",weight:"semibold",children:t}),f?(0,r.jsx)("button",{type:"submit",onClick:d,children:(0,r.jsx)(i.JO,{type:"close-v2",className:"text-dark mr-1 mt-2.5",useWithFillCurrentColor:!0})}):(0,r.jsx)(r.Fragment,{children:!l&&n&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"text-default mr-2 pb-0.5",children:(0,r.jsx)(s.Z.LabelSm,{weight:"medium",children:n})}),(0,r.jsx)(i.JO,{type:"space-chat-members",className:"text-dark",useWithFillCurrentColor:!0})]})})]}),!l&&!!c&&(0,r.jsx)("div",{className:"text-default whitespace-pre-line",children:(0,r.jsx)(s.Z.BodySm,{children:c})})]})}},7383:function(e,t,n){n.d(t,{F2:()=>a,bb:()=>s});var r=n(3697);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],n=[];return e.forEach(function(e){e.admin?t.push(e):n.push(e)}),i(t).concat(i(n))},s=function(e){var t=[],n=[],o=[];return e.filter(function(e){return!e.deleted_at}).forEach(function(e){e.status===r.eh.online?t.push(e):e.status===r.eh.idle?o.push(e):n.push(e)}),{onlineParticipants:i(t).concat(i(o)),offlineParticipants:n}}},34560:function(e,t,n){n.d(t,{F:()=>C});var r=n(85893),o=n(67294),i=n(70442),a=n(84326),s=n(3697),l=n(52770),c=n(61853),u=n(65121),d=n(41342),f=n(82859),m=n(1168),p=n(90926),b=n(96486),h=n(7355),v=n(63271),y=function(e){var t,n,r=e.enabled,o=e.chatRoomUuid,i=e.isThread,a=e.currentCommunityMember,s=e.onMessageReceive,l=i?{community_member_id:null==a?void 0:a.id}:{chat_room_uuid:o},c=i?!!(null==a?void 0:a.id):!!o,u=(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({channel:i?"Chats::CommunityMemberThreadsChannel":"Chats::RoomChannel",canCreateConnection:r&&c},l),n=n={onMessageReceive:s},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t),d=(0,v.s)(u);return{subscription:null==d?void 0:d.subscription}};function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var _=function(e){var t,n,r=e.enabled,i=e.chatRoomUuid,a=e.currentParticipant,s=e.parentMessageId,l=e.editorRef,c=e.participants,u=void 0===c?[]:c,d=e.messageBoxId,f=e.currentCommunityMember,m=(t=(0,o.useState)(new Set),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return g(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=m[0],v=m[1],_=(0,o.useRef)(new Map),x=(0,o.useRef)(!1),j=function(e){_.current.has(e)&&clearTimeout(_.current.get(e));var t=setTimeout(function(){return O(e)},3e4);_.current.set(e,t)},w=function(e){_.current.has(e)&&(clearTimeout(_.current.get(e)),_.current.delete(e))},O=function(e){w(e),v(function(t){var n=new Set(t);return n.delete(e),n})},S=y({enabled:r,chatRoomUuid:i,isThread:!!s,currentCommunityMember:f,onMessageReceive:function(e){var t=!(0,b.isUndefined)(s)&&s===e.parent_message_id||(0,b.isUndefined)(s)&&(0,b.isNull)(e.parent_message_id);v(function(n){var r=new Set(n);if(t&&e.chat_room_participant_id!==a.id){var o=e.chat_room_participant_id;"typing"===e.event?(j(o),r.add(e.chat_room_participant_id)):"stopTyping"===e.event&&(w(o),r.delete(e.chat_room_participant_id))}return r})}}).subscription,P=function(){!x.current&&S&&(S.perform("typing",{chat_room_uuid:i,community_member_id:null==f?void 0:f.id,parent_message_id:s}),x.current=!0)},C=function(){x.current&&I()},I=function(){S.perform("stop_typing",{chat_room_uuid:i,community_member_id:null==f?void 0:f.id,parent_message_id:s}),x.current=!1};(0,o.useEffect)(function(){var e=l.current;return r&&e&&e.on("update",function(e){var t=e.transaction;(null==t?void 0:t.docChanged)&&P()}),function(){r&&e&&e.off("update")}},[null==l?void 0:l.current]);var k=document.getElementById(d);null==k||k.addEventListener("keyup",function(e){n&&clearTimeout(n),(null==e?void 0:e.key)==="Enter"&&C(),n=setTimeout(C,3e3)});var N=document.getElementById("tiptap-send");null==N||N.addEventListener("click",function(){n&&clearTimeout(n),C()});var A=Array.from(p).filter(function(e){return!u.some(function(t){return t.id===e})}),E=u.filter(function(e){return p.has(e.id)}).map(function(e){return e.name});return(0,h.g)({uuid:i,ids:A,enabled:A.length>0}),{typingUserNames:E,isTyping:E.length>0}},x=n(60878),j=n(43340),w=n(41553);let O=n.p+"static/react/components/Chat/TypingIndicator/typing-81b0b18d6d56b7da.gif";var S=function(e){var t=e.typingUserNames,n="";return 1===t.length?n=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z.LabelXs,{as:"span",weight:"medium",children:t[0]})," ",(0,r.jsx)(w.Z.LabelXs,{as:"span",children:(0,a.t)("messaging.is_typing")})]}):2===t.length?n=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z.LabelXs,{as:"span",weight:"medium",children:t[0]})," ",(0,r.jsx)(w.Z.LabelXs,{as:"span",children:(0,a.t)("and")})," ",(0,r.jsx)(w.Z.LabelXs,{as:"span",weight:"medium",children:t[1]})," ",(0,r.jsx)(w.Z.LabelXs,{as:"span",children:(0,a.t)("messaging.are_typing")})]}):t.length>2&&(n=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z.LabelXs,{as:"span",weight:"medium",children:t[0]})," ",(0,r.jsxs)(w.Z.LabelXs,{as:"span",children:[(0,a.t)("and")," ",t.length-1," ",(0,a.t)("others")," ",(0,a.t)("messaging.are_typing")]})]})),(0,r.jsx)("div",{className:"flex items-center",children:n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{loading:"eager",src:O,className:"mt-1.5 w-6",alt:""}),(0,r.jsx)("span",{children:n})]})})};function P(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var C=function(e){var t=e.onClick,n=e.autoFocus,b=void 0!==n&&n,h=e.disabled,v=void 0!==h&&h,y=e.spaceId,g=e.chatRoomData,w=e.isChatPreview,O=e.parentMessageId,C=e.userList,I=void 0===C?[]:C,k=e.isLiveStream,N=void 0!==k&&k,A=e.isChatSpace,E=e.isInCourseSpace,T=void 0!==E&&E,M=e.portalTargetId,R=e.isLoading,D=e.participants,L=e.messageBoxId,F=void 0===L?"tiptapMessageTextBox":L,U=(0,i.UO)().uuid,B=(0,d.wh)(),q=B.currentCommunityMember,z=B.isViewOnlyMasquerading,Z=(0,p.aK)(c.iX),H=(0,i.k6)(),V=(0,x.pm)(),Q=(0,p.pB)().findOrCreateChatRoom,W=(0,o.useRef)(null),G=function(e){var t,n=e.richTextBody;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,Q({kind:I.length>1?s.RN:s.g8,community_member_ids:I.map(function(e){return e.id}),rich_text_body:n,shouldNavigate:!0})];case 1:return e.sent(),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){P(i,r,o,a,s,"next",e)}function s(e){P(i,r,o,a,s,"throw",e)}a(void 0)})})()};(0,f.P4)()&&(b=!1);var $=(0,j.$S)(g),K=(0,j.C9)(g),J=(g||{}).current_participant,X=_({enabled:!(w||T),chatRoomUuid:null==g?void 0:g.uuid,currentParticipant:void 0===J?{}:J,editorRef:W,participants:void 0===D?[]:D,parentMessageId:O,messageBoxId:F,currentCommunityMember:q}),Y=X.isTyping,ee=X.typingUserNames;return(0,r.jsxs)("div",{className:(0,m.A)("bg-primary relative px-5 pt-2",{"rounded-b-lg":Y&&N}),children:[(0,r.jsx)(u.T,{autofocus:b,disabled:v||z,onSubmit:function(e){var n=e.body,r=e.attachments,o=e.localAttachments,i=e.localSgidToObjectMap;if(!v)if(null==t||t(),g){if(Z(g.uuid,{body:n,attachments:r},o,i,O).catch(function(e){V.error((0,a.t)("something_went_wrong")),(0,l.d)(e)}),O)return;w&&("new"==U||!U)&&H.push("/messages/".concat(g.uuid))}else G({richTextBody:{body:n,attachments:r}})},spaceId:y,id:F,editorRef:W,portalTargetId:void 0===M?"chat-threads-header":M,isLiveStream:N,isChatSpace:void 0!==A&&A,shouldShowTextModifiersMenu:!(void 0!==R&&R),chatProps:{disableGroupMentions:N||T,isThread:!!O,isDirectMessaging:$,isChatAdminOrModerator:K,chatParticipantsCount:null==g?void 0:g.chat_room_participants_count,isTyping:Y}}),Y&&(0,r.jsx)(S,{typingUserNames:ee})]})}},72048:function(e,t,n){n.d(t,{s:()=>a});var r=n(85893),o=n(84326),i=n(63549),a=function(e){var t=e.shouldShowConfirmationModal,n=e.toggleConfirmationModal,a=e.handleSubmit,s=e.chatParticipantsCount;return(0,r.jsx)(i.c,{isOpen:t,onClose:n,onConfirm:function(){a(!0),n()},confirmText:(0,o.t)("send"),title:(0,o.t)("messaging.send_group_message.title",{participants_count:s}),children:(0,r.jsx)("div",{className:"mb-6",children:(0,o.t)("messaging.send_group_message.description")})})}},54578:function(e,t,n){n.d(t,{u:()=>s});var r=n(85893),o=n(67294),i=n(84326),a=n(63549),s=function(e){var t=e.shouldShowPrivateMessageConfirmationModal,n=e.togglePrivateMessageConfirmationModal,s=e.handleSubmit,l=e.shouldShowPrivateMessageConfirmationOnSubmit,c=e.setShouldShowPrivateMessageConfirmationOnSubmit;return(0,o.useEffect)(function(){l||(s(!0),n())},[l,s,n]),(0,r.jsx)(a.c,{isOpen:t,onClose:n,onConfirm:function(){c(!1)},confirmText:(0,i.t)("send"),title:(0,i.t)("messaging.share_private_message.title"),cancelText:(0,i.t)("messaging.edit_message"),children:(0,r.jsx)("div",{className:"mb-6",children:(0,i.t)("messaging.share_private_message.description")})})}},61242:function(e,t,n){n.d(t,{Qk:()=>f,GW:()=>s,E0:()=>m,Fx:()=>l.F});var r=n(85893),o=n(84326),i=n(24512),a=n(56615),s=function(e){var t=e.isLiveStream,n=e.isInCourseSpace,s=e.isMessaging,l=e.chatRoomUuid,c=(0,i.d)().translatedLabels;return void 0!==s&&s?(0,r.jsx)(a.G,{chatRoomUuid:l}):void 0!==t&&t?(0,r.jsxs)("div",{className:"block px-5 py-4",children:[(0,r.jsx)("div",{className:"text-darkest text-lg font-medium",children:(0,o.t)("messaging.live_stream_start_conversation")}),(0,r.jsx)("div",{className:"text-dark",children:(0,o.t)("messaging.live_stream_start_conversation_description")})]}):void 0!==n&&n?(0,r.jsxs)("div",{className:"block px-5 py-4",children:[(0,r.jsx)("div",{className:"text-darkest text-lg font-medium",children:(0,o.t)("messaging.course_lesson_chat_start_conversation")}),(0,r.jsx)("div",{className:"text-dark",children:(0,o.t)("messaging.course_lesson_chat_start_conversation_description",{lessonSingular:c.lesson.singular.toLowerCase()})})]}):null},l=n(34560),c=n(61853),u=n(2952),d=n(74178),f=function(e){var t=e.children,n=e.isLastPage,o=e.isFirstPage,i=e.setIsFirstPage,a=e.setIsLastPage,s=e.componentId,l=(0,u.u)().fetchChatMessages,f=(0,c.AP)(),m=f.hasNextPage,p=f.hasPrevPage,b=f.isLoading,h=f.firstMessageId,v=f.lastMessageId;return(0,r.jsx)("div",{className:"flex h-auto grow flex-col overflow-auto",children:(0,r.jsx)(d.Y,{shouldShowPrevLoader:!n,shouldShowNextLoader:!o,hasNextPage:m,hasPrevPage:p,onNextPage:function(e){l({id:e,previousPerPage:0,nextPerPage:20,parentMessageId:null}),i(!1)},onPrevPage:function(e){l({id:e,parentMessageId:null}),a(!1)},firstItemId:h,lastItemId:v,componentId:void 0===s?"message-scroll-view":s,isLoading:b,children:t})})},m=function(e){var t=e.label,n=e.onClick;return(0,r.jsx)("button",{type:"submit",className:"bg-circle rounded-2xl px-2.5 py-1 text-xs font-semibold leading-5 text-white hover:opacity-90",onClick:n,children:t})}},93440:function(e,t,n){n.d(t,{G:()=>i});var r=n(85893),o=n(23627),i=function(e){var t=e.tiptapBody;return(0,r.jsx)(o.R,{readOnly:!0,value:t.body,sgidToObjectMap:t.sgids_to_object_map,inlineAttachments:t.inline_attachments,openInternalLinksInCurrentTab:!0,disabledExtensions:["cta"]})}},51805:function(e,t,n){n.d(t,{E:()=>c,z:()=>l});var r=n(67294),o=n(88767),i=n(93199),a=n(13532),s=n(7992),l=function(e){var t=e.postId,n=e.id;return[s.b,t,"hierarchy",String(n)]},c=function(e){var t=e.postId,n=e.id,s=e.postCommentsClosed,c=e.postLikingDisabled,u=(0,o.useQueryClient)(),d=(0,r.useMemo)(function(){return l({postId:t,id:n})},[t,n]);(0,r.useEffect)(function(){u.removeQueries(d)},[s,c,u,d]);var f=(0,o.useQuery)(d,function(){return(0,i.UT)(a.av.comments.commentHierarchy({postId:t,id:null!=n?n:void 0}))},{cacheTime:0,onError:function(e){404===e.status&&u.setQueryData(d,null)},retry:function(e,t){return 404!==t.status&&e<3}}),m=f.data;return{comment:m,isLoading:f.isLoading,updateQueryData:function(e){var t,n;return u.setQueryData(d,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),n=n={replies:m.replies},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}}}},7992:function(e,t,n){n.d(t,{b:()=>r,k:()=>o});var r="comments",o=function(e){var t=e.postId,n=e.parentCommentId,o=e.usedIn;return[r,t,"list",n,void 0===o?null:o].filter(Boolean)}},67919:function(e,t,n){n.d(t,{Q:()=>o,q:()=>r});var r="#comment_wrapper_",o="#all_comments"},96533:function(e,t,n){n.d(t,{r:()=>j});var r=n(85893),o=n(57105),i=n(25362),a=n(84326),s=n(61853),l=n(50175),c=n(81261),u=n(8054),d=n(34519),f=n(51945),m=n(41553),p=n(28740),b=n(92771),h=n(90926),v=n(39295),y=function(e){var t=e.uuid;return(0,r.jsx)("div",{className:"flex grow flex-col overflow-auto",children:(0,r.jsx)(v.A,{chatRoomUuid:t,isMessaging:!0,children:(0,r.jsxs)(h.G5,{isDrawer:!0,children:[(0,r.jsx)(p.x,{uuid:t,displayDayChange:!0,isDrawer:!0}),(0,r.jsx)("div",{id:"rail-bar-drawer"}),(0,r.jsx)(b.I,{})]})})})},g={page_name:c.$q.PROFILE_VIEW},_=function(e){var t,n=e.memberPublicId,o=(0,s.nC)(),c=o.liveChatRoomUuid,p=o.setLiveChatRoomUuid,b=(0,i.dd)(),h=(0,u.P$)({publicId:n,params:g}).getProfileInfoQuery,v=h.data,_=h.isLoading,x=function(){p(null),b.remove()};return(0,r.jsxs)(d.u_,{isOpen:b.visible,onClose:x,contentPortalId:"post-modal-portal",children:[(0,r.jsx)(d.u_.Overlay,{}),(0,r.jsxs)(d.u_.Content,{size:"full",className:"max-w-screen-xl",children:[(0,r.jsxs)("div",{className:"border-primary text-dark flex justify-between border-b !px-9 !py-4",children:[(0,r.jsx)(m.Z.TitleSm,{weight:"semibold",children:c?null!=(t=null==v?void 0:v.name)?t:"":(0,a.t)("profile")}),(0,r.jsx)(f.o,{onClick:x})]}),c?(0,r.jsx)(y,{uuid:c}):(0,r.jsx)(d.u_.Body,{className:"!md:px-0 !md:pt-0 !md:overflow-hidden block grid-cols-12 !p-0 md:grid md:grid-flow-row-dense",children:(0,r.jsx)(l.o,{member:v,isLoading:_,onClose:function(){return b.remove()}})})]})]})},x=o.gk.create(function(e){var t=e.memberPublicId,n=e.params;return(0,r.jsx)(_,{memberPublicId:t,params:n})}),j=function(){return(0,o.dd)(x)}},14735:function(e,t,n){n.d(t,{t:()=>d});var r=n(85893),o=n(67294),i=n(84326),a=n(63549),s=n(79522),l=n(25152);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var u="events.delete.recurring_event_modal",d=function(e){var t,n=e.show,d=e.onConfirm,f=e.onCloseModal,m=e.isDeleting,p=void 0!==m&&m,b=(t=(0,o.useState)(),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return c(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),h=b[0],v=b[1];return(0,r.jsx)(a.c,{title:(0,i.t)("".concat(u,".title")),isOpen:void 0!==n&&n,confirmText:p?(0,i.t)("deleting"):(0,i.t)("".concat(u,".accept")),cancelText:(0,i.t)("".concat(u,".cancel")),onClose:f,onCancel:f,onConfirm:function(){h&&d(h)},disabled:p,confirmVariant:"danger",size:"sm",children:(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(s.S,{defaultChecked:l.HA.CURRENT,name:"recurring_event_settings.frequency_edit",options:[{label:(0,i.t)("".concat(u,".this_event")),value:l.HA.CURRENT},{label:(0,i.t)("".concat(u,".this_and_following")),value:l.HA.REMAINING},{label:(0,i.t)("".concat(u,".all_events")),value:l.HA.ALL}],size:"sm",onChange:function(e){v(e)}})})})}},19338:function(e,t,n){n.d(t,{E:()=>g,e:()=>j});var r,o,i=n(67294),a=n(83894),s=n(52293),l=n(84326),c=n(25152),u=n(42953),d=n(4393),f=n(43945);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||h(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}var v="recurring_setting_attributes.ends_at",y="events.recurring",g=function(e){var t=e.startsAt,n=e.firstLetterCapital,r=void 0===n||n?"frequencies_capital_letter":"frequencies",o=new Date(t).getDate(),i=(0,f.UZ)(t),a=(0,f.ZY)(t),s=(0,f.cz)(t),u=(0,f.Rc)(t);return[{label:(0,l.t)("".concat(y,".").concat(r,".daily"),{dayName:i}),value:c.PB.DAILY},{label:(0,l.t)("".concat(y,".").concat(r,".weekday"),{dayName:i}),value:c.PB.WEEKDAY},{label:(0,l.t)("".concat(y,".").concat(r,".weekly"),{dayName:i}),value:c.PB.WEEKLY},{label:(0,l.t)("".concat(y,".").concat(r,".bi_weekly"),{dayName:i}),value:c.PB.BI_WEEKLY},{label:(0,l.t)("".concat(y,".").concat(r,".monthly"),{dayNumberWithOrdinal:u}),value:c.PB.MONTHLY_WEEK_BASED},{label:(0,l.t)("".concat(y,".").concat(r,".monthly"),{dayNumberWithOrdinal:s}),value:c.PB.MONTHLY},{label:(0,l.t)("".concat(y,".").concat(r,".annually"),{monthName:a,dayNumber:o}),value:c.PB.ANNUALLY}]},_=(p(r={},c.PB.DAILY,60),p(r,c.PB.WEEKDAY,90),p(r,c.PB.WEEKLY,360),p(r,c.PB.BI_WEEKLY,720),p(r,c.PB.MONTHLY,720),p(r,c.PB.MONTHLY_WEEK_BASED,720),p(r,c.PB.ANNUALLY,3600),r),x=(p(o={},c.PB.DAILY,60),p(o,c.PB.WEEKDAY,60),p(o,c.PB.WEEKLY,52),p(o,c.PB.BI_WEEKLY,52),p(o,c.PB.MONTHLY,24),p(o,c.PB.MONTHLY_WEEK_BASED,24),p(o,c.PB.ANNUALLY,10),o),j=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).event,t=(0,s.Gc)().setValue,n=(0,s.qo)({name:"event_setting_attributes.starts_at"}),r=n?new Date(n).toISOString():"",o=(0,s.qo)({name:v}),f=(0,s.qo)({name:"recurring_setting_attributes.range_type"}),p=(0,s.qo)({name:"recurring_setting_attributes.frequency"}),j=(0,s.qo)({name:"event_type"}),w=b((0,i.useState)(!0),2),O=w[0],S=w[1],P=b((0,i.useState)(),2),C=P[0],I=P[1],k=b((0,i.useState)(),2),N=k[0],A=k[1],E=b((0,i.useState)(),2),T=E[0],M=E[1],R=(0,i.useMemo)(function(){return{label:(0,l.t)("".concat(y,".does_not_repeat")),value:!1}},[]),D=b((0,i.useState)([R]),2),L=D[0],F=D[1],U=[{label:(0,l.t)("".concat(y,".ending.on_day")),value:c.pd.ON},{label:(0,l.t)("".concat(y,".ending.after")),value:c.pd.AFTER}];return(0,i.useEffect)(function(){var t=g({startsAt:n});F(e&&(0,u.f0)(e)?t:[R].concat(function(e){if(Array.isArray(e))return m(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||h(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),M(n)},[n,R,e]),(0,i.useEffect)(function(){S(!!p)},[p]),(0,i.useEffect)(function(){if(f==c.pd.ON&&p){t("recurring_setting_attributes.occurrences",null);var e=(0,d.Xz)(n,_[p]);I((0,a.default)(e))}else f==c.pd.AFTER&&p&&(t(v,null),A(x[p]))},[f,p,n,t]),{endsAtMaxDate:C,endsAfterMaxOccurrences:N,isRecurringEvent:j===c.E_.RECURRING,frequencyOptions:L,endingOptions:U,endsAtMinDate:T,endsOnValue:f,shouldShowRecurringFields:O,currentEndsAt:o,startsAtInUTC:r}}},86785:function(e,t,n){n.d(t,{D:()=>v});var r=n(85893),o=n(88767),i=n(70442),a=n(84326),s=n(64282),l=n(17013),c=n(41342),u=n(93199),d=n(13532),f=n(39905),m=n(51466),p=n(26950),b=n(60878);function h(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var v=function(e){var t=e.event,n=e.onClose,v=e.show,y=(0,i.k6)(),g=(0,b.pm)(),_=g.success,x=g.error,j=(0,c.nT)(),w=j.isLoading,O=j.helpers,S=O.findById,P=O.spacesWithEventCreationAllowed;if(w)return null;var C=P(),I=(0,c.L2)().data,k=(0,s.Z)(),N=(0,o.useMutation)(function(e){var n;return(n=function(){var n;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,(0,u.t5)(d.av.events.duplicate({spaceId:t.space_id,slug:t.slug}),{method:"PUT",body:JSON.stringify({event:{event_id:t.id,space_id:e.space_id}}),forReactQuery:!0})];case 1:if(!(n=r.sent())||!("id"in n))throw Error("Failed to duplicate event");return[2,n]}})},function(){var e=this,t=arguments;return new Promise(function(r,o){var i=n.apply(e,t);function a(e){h(i,r,o,a,s,"next",e)}function s(e){h(i,r,o,a,s,"throw",e)}a(void 0)})})()},{onSuccess:function(e){var t=S(e.space_id);if(!t)return void x((0,a.t)("space_not_found"));y.push((0,d.Xq)({spaceSlug:t.slug,eventSlug:e.slug})),setTimeout(function(){k.show({event:e})},500),_((0,a.t)("event_duplicated_successfully"))},onError:function(){x((0,a.t)("event_duplication_failed"))}});return(0,r.jsx)(p.u,{overflowVisible:!0,title:(0,a.t)("duplicate_event_title",{event_title:t.name}),show:v,onClose:n,children:(0,r.jsxs)(m.l,{onSubmit:function(e){N.mutate({space_id:e.space_id})},defaultValues:{space_id:null==I?void 0:I.id},children:[(0,r.jsx)(m.l.Item,{name:"space_id",hideBorder:!0,fullWidth:!0,description:(0,a.t)("duplicate_event_to_space"),rules:{required:(0,a.t)("events.create.form.space_required_error")},children:(0,r.jsx)(l.M,{spaces:C,name:"space_id",variant:"form-input",defaultValue:null==I?void 0:I.id})}),(0,r.jsx)("p",{className:"modal__small text-dark mb-4",children:(0,a.t)("attendees_wont_be_duplicated")}),(0,r.jsx)(f.z,{type:"submit",variant:"primary",children:(0,a.t)("duplicate")})]})})}},59709:function(e,t,n){n.d(t,{E:()=>l});var r=n(85893),o=n(84326),i=n(79840),a=n(43544),s=n(34754),l=function(e){var t=e.canEdit,n=e.event,l=n.pinned_at_top_of_space,c=(0,s.B)({event:n}).onPinToTop;return t?(0,r.jsx)(a.Lt.ItemLink,{onClick:c,children:(0,r.jsx)(i.sI,{label:(0,o.t)("pin_to_space"),field:"pin_to_top",value:l,variant:"small"})}):null}},34754:function(e,t,n){n.d(t,{B:()=>h});var r=n(88767),o=n(84326),i=n(51714),a=n(66205),s=n(42953),l=n(31796),c=n(64282),u=n(41342),d=n(24804),f=n(60878);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=function(e){var t=e.event,n=e.onDestroy,m=(0,u.wh)().isViewOnlyMasquerading,h=(0,a.q)(),v=(0,c.Z)(),y=t.policies||{},g=y.can_destroy_post,_=y.can_update_post,x=y.can_duplicate_post,j=t.pinned_at_top_of_space,w=(0,f.pm)(),O=w.success,S=w.error,P=b((0,d.k)(!1),2),C=P[0],I=P[1],k=b((0,d.k)(!1),2),N=k[0],A=k[1],E=b((0,d.k)(!1),2),T=E[0],M=E[1],R=(0,r.useMutation)(function(e){return i.S.destroy({event:t,params:{delete_mode:e}})},{onSuccess:function(){null==n||n(t.id),O((0,s.Km)(t)),h()},onError:function(){return S((0,o.t)("event_dropdown_actions.delete_failed"))}});return{canEdit:_,onEdit:function(){_&&!m&&v.show({event:t})},canDelete:g,canDuplicate:x,onDelete:R.mutate,isDeleting:R.isLoading,onPinToTop:function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,i.S.pin({event:t,formData:{pin_to_top:!0,is_pinned:!j}})];case 1:return e.sent().ok?(O((0,o.t)(j?"event_unpinned":"event_pinned")),h({shouldInvalidateHomePagePosts:!0})):S((0,o.t)(j?"event_unpinned_error":"event_pinned_error")),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)})})()},onDuplicate:I,onDeleteClickHandler:function(){m||((0,l.H3)(t)?M():A())},isDuplicateEventModalOpen:C,isConfirmationModalOpen:N,toggleConfirmationModal:A,isRecurringModalOpen:T,toggleRecurringModal:M}}},98324:function(e,t,n){n.d(t,{i:()=>w});var r=n(85893),o=n(84326),i=n(27053),a=n(41342),s=n(17617),l=n(57363),c=n(43544),u=n(41553),d=n(39468),f=n(60589),m=n(39905),p=n(79840),b=n(67294),h=n(20640),v=n.n(h),y=n(13532),g=n(60878);function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){var t,n=e.post,r=e.getSharePostLink,i=e.sharePostData,s=(0,g.pm)().success,l=(0,a.wh)().currentCommunity,c=(0,a.L2)().data,u=(t=(0,b.useState)({post:{show_post_teaser:!!(null==n?void 0:n.show_post_teaser),share_to_web:!!(null==n?void 0:n.share_post_enabled),share_post_enabled:!!(null==n?void 0:n.share_post_enabled),minimal_layout:!!(null==n?void 0:n.minimal_layout)}}),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return _(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1],m=(0,y.LM)({spaceSlug:null==n?void 0:n.space_slug,slug:null==n?void 0:n.slug});return(0,b.useEffect)(function(){n.share_post_enabled&&!i&&r({postId:null==n?void 0:n.id,body:d})},[null==n?void 0:n.share_post_enabled,i,d,r,null==n?void 0:n.id]),{onClickCopyLink:function(e){v()(e||window.location.origin+m),s((0,o.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},onChange:function(e){f(function(t){var o={post:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t.post,e)};return r({postId:null==n?void 0:n.id,body:o}),o})},formData:d,currentCommunity:l,currentSpace:c}},j=function(e){var t=e.getSharePostLink,n=e.post,i=e.sharePostData,a=x({post:n,getSharePostLink:t,sharePostData:i}),s=a.onClickCopyLink,b=a.onChange,h=a.formData,v=a.currentCommunity,y=a.currentSpace,g=!!((0,f.$n)(y)||(0,f.WB)(y)||(null==v?void 0:v.is_private));return(null==v?void 0:v.is_private)||(null==y?void 0:y.is_private)?(0,r.jsxs)("div",{children:[(0,r.jsx)(c.Lt.ItemLink,{onClick:function(){b({share_to_web:!h.post.share_to_web})},children:(0,r.jsx)(p.sI,{label:(0,o.t)("post.share.share_to_web"),tooltipText:(0,o.t)("post.share.share_to_web_on_description"),field:"share_to_web",value:h.post.share_to_web,variant:"small"})}),h.post.share_to_web&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex flex-row items-center",children:(0,r.jsx)("div",{className:"mb-2 mt-1 flex-1 px-5",children:(0,r.jsx)(d.I,{disabled:!0,value:null==i?void 0:i.share_post_link,rightAddon:(0,r.jsx)("button",{type:"button",onClick:function(){return s(null==i?void 0:i.share_post_link)},children:(0,r.jsx)(l.JO,{type:"20-copy"})})})})}),g&&(0,r.jsx)("div",{className:"flex flex-row items-center",children:(0,r.jsx)("div",{className:"mb-2 mt-1 flex-1 px-5",children:(0,r.jsx)(u.Z.LabelSm,{children:(null==v?void 0:v.is_private)&&(null==y?void 0:y.visibility)=="open"?(0,o.t)("post.share.share_to_web_open_content_warning"):(0,f.$n)(y)?(0,o.t)("post.share.share_to_web_secret_content_warning"):(0,o.t)("post.share.share_to_web_private_content_warning")})})}),!(null==v?void 0:v.is_private)&&(0,r.jsx)(c.Lt.ItemLink,{onClick:function(){return b({minimal_layout:!h.post.minimal_layout})},children:(0,r.jsx)(p.sI,{label:(0,o.t)("post.share.minimal_layout"),tooltipText:(0,o.t)("post.share.minimal_layout_description"),field:"minimal_layout",value:h.post.minimal_layout,variant:"small"})})]})]}):(0,r.jsxs)("div",{className:"flex flex-row items-center px-4 py-2",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,r.jsx)(u.Z.LabelMd,{weight:"bold",children:(0,o.t)("post.share.share_to_web")}),(0,r.jsx)(u.Z.LabelSm,{children:(0,o.t)("post.share.post_is_public")})]}),(0,r.jsx)("div",{children:(0,r.jsx)(m.z,{type:"button",variant:"secondary",onClick:function(){return s(null)},children:(0,o.t)("copy_link")})})]})},w=function(e){var t=e.onChange,n=e.button,d=(0,i.m)({onChangeSharePost:t}),f=d.showShareOnWebOptions,m=d.post,p=d.getSharePostLink,b=d.sharePostData,h=(0,s.kK)(),v=(0,a.L2)().data,y=null!=n?n:(0,r.jsx)(l.JO,{type:"16-share",size:20});return f(v)?(0,r.jsx)(c.Lt,{size:"extra-large",direction:"bottom-end",menuButtonEl:"button",className:"w-full",buttonClassName:"w-full focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-1 md:p-1 hover:bg-tertiary rounded group flex items-center",button:h?y:(0,r.jsx)(u.Z.LabelSm,{weight:"medium",color:"text-default group-hover:text-dark",children:(0,o.t)("post.share.title")}),children:(0,r.jsx)(j,{post:m,getSharePostLink:p,sharePostData:b})}):null}},25152:function(e,t,n){n.d(t,{Bq:()=>o,E_:()=>a,HA:()=>c,PB:()=>s,Q_:()=>u,_w:()=>d,gP:()=>i,pd:()=>l});var r=n(84326),o={VIRTUAL:"virtual",IN_PERSON:"in_person",TBD:"tbd",LIVE_STREAM:"live_stream",LIVE_ROOM:"live_room"},i={virtual:(0,r.t)("events.location_types.virtual"),in_person:(0,r.t)("events.location_types.in_person"),tbd:(0,r.t)("events.location_types.tbd"),live_stream:(0,r.t)("events.location_types.live_stream"),live_room:(0,r.t)("events.location_types.live_room")},a={SINGLE:"single",RECURRING:"recurring"},s={DAILY:"daily",WEEKDAY:"weekday",WEEKLY:"weekly",BI_WEEKLY:"bi_weekly",MONTHLY:"monthly",MONTHLY_WEEK_BASED:"monthly_weekday_based",ANNUALLY:"annually",YEARLY:"yearly"},l={ON:"on",NEVER:"never",AFTER:"after"},c={CURRENT:"current",REMAINING:"remaining",ALL:"all"},u={PUBLISHED:"published",DRAFT:"draft"},d={INVITED:"invited"}},17534:function(e,t,n){n.d(t,{m:()=>i});var r=n(70442),o=n(41342),i=function(){var e,t=(0,o.nT)(),n=(0,r.UO)().spaceSlug,i=(t.helpers.spacesWithPostCreationAllowed()||[]).filter(function(e){return"event"===e.post_type}),a=(null==(e=i.find(function(e){return e.slug===n}))?void 0:e.id)||null;return{spaces:i,spaceId:a}}},66205:function(e,t,n){n.d(t,{q:()=>o});var r=n(88767),o=function(){var e=(0,r.useQueryClient)();return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.shouldInvalidateHomePagePosts,r=t.shouldInvalidateAllEvents;e.invalidateQueries("post-show"),e.invalidateQueries("posts"),e.invalidateQueries("space-show",{refetchInactive:!0}),void 0!==r&&r&&e.invalidateQueries(["all","events","calendar-view"]),void 0!==n&&n&&e.invalidateQueries("home-page-posts")}}},66403:function(e,t,n){n.d(t,{j:()=>a});var r=n(85893),o=n(84326),i=n(95342),a=function(e){var t=e.rsvpStatus;if(!t)return null;var n="yes"===t?(0,o.t)("events.rsvp.attending"):"invited"===t?(0,o.t)("events.rsvp.invited"):(0,o.t)("events.rsvp.not_attending");return(0,r.jsx)(i.O,{variant:"yes"===t?"success":"default",children:n})}},98869:function(e,t,n){n.d(t,{t:()=>s});var r=n(85893),o=n(84326),i=n(39905),a=n(41553),s=function(e){var t=e.startRecordNumber,n=e.endRecordNumber,s=e.totalRecordCount,l=e.fetchPrevPage,c=e.fetchNextPage,u=e.hasPrevPage,d=e.hasNextPage;return(0,r.jsxs)("div",{className:"flex h-16 w-full items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-end",children:[(0,r.jsx)("div",{children:(0,r.jsx)(a.Z.LabelSm,{children:(0,o.t)("events.edit_modal.pagination.showing")})}),(0,r.jsx)("div",{className:"mx-1",children:(0,r.jsxs)(a.Z.LabelSm,{weight:"semibold",children:[t,"-",n]})}),(0,r.jsx)("div",{className:"mr-1",children:(0,r.jsx)(a.Z.LabelSm,{children:(0,o.t)("events.edit_modal.pagination.of")})}),(0,r.jsx)("div",{children:(0,r.jsx)(a.Z.LabelSm,{weight:"semibold",children:s})})]}),(u||d)&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(i.z,{variant:"secondary",type:"button",className:"mr-3",disabled:!u,onClick:l,children:(0,o.t)("events.edit_modal.pagination.previous")}),(0,r.jsx)(i.z,{variant:"secondary",type:"button",disabled:!d,onClick:c,children:(0,o.t)("events.edit_modal.pagination.next")})]})]})}},37291:function(e,t,n){n.d(t,{x:()=>s});var r=n(70442),o=n(99037),i=n(26371),a=n(43832),s=function(){var e=(0,r.k6)(),t=(0,o.l)(),n=t.mutate,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,["mutate"]),l=(0,a.g)();return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({onSendAnnouncement:function(t){var r=t.eventId,o=t.onSuccess;if(!l){e.push(i.e.list()),null==o||o();return}n({source_content_id:r,source_content_type:"Event"},{onSuccess:function(t){null==o||o(),e.push(i.e.edit({broadcastId:t.broadcast.id}))}})}},s)}},44281:function(e,t,n){n.d(t,{V:()=>f});var r=n(67294),o=n(88767),i=n(84326),a=n(51630),s=n(95533),l=n(60878),c=n(42953);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.a.PARTICIPANT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,u=e||{},f=u.space_id,m=u.slug,p=(0,l.pm)(),b=p.error,h=p.success,v=d((0,r.useState)(1),2),y=v[0],g=v[1],_=d((0,r.useState)(!1),2),x=_[0],j=_[1],w=(0,o.useQuery)({queryKey:s.a.eventAttendees.index({spaceId:f,slug:m,params:{page:y,role:t,per_page:n}}),refetchInterval:!!x&&5e3,refetchIntervalInBackground:!1,keepPreviousData:!0,enabled:!!e}),O=w.isLoading,S=w.isFetching,P=w.data,C=w.refetch,I=w.remove,k=(null==P?void 0:P.records)||[],N=(null==P?void 0:P.count)||0,A=null==P?void 0:P.total_confirmed_record_count,E=null==P?void 0:P.page_count,T=N?Math.ceil(N/10):0,M=y>1,R=!!(null==P?void 0:P.has_next_page),D=(y-1)*10+1,L=(0,o.useMutation)(function(t){return a.S1.bulkRsvp({event:e,params:t})},{onSuccess:function(){g(1),I(),j(!0),h((0,i.t)("events.edit_modal.people.add_attendees_started"))},onError:function(){j(!1),b((0,i.t)("events.edit_modal.people.add_attendees_error"))}});return{page:y,records:k,totalRecordCount:N,totalConfirmedRecordCount:A,pageRecordCount:E,pageCount:T,hasPrevPage:M,hasNextPage:R,startRecordNumber:D,endRecordNumber:D+(null!=E?E:0)-1,isLoading:O,isFetching:S,isWaitingForAttendees:x,isAdding:L.isLoading,addAttendeesAsync:L.mutateAsync,refetch:C,fetchNextPage:function(){g(y+1)},fetchPrevPage:function(){g(Math.max(y-1,1))},resetPage:function(){g(1)}}}},39766:function(e,t,n){n.d(t,{Bq:()=>i,E_:()=>a,HA:()=>c,Mj:()=>s,Q_:()=>u,SA:()=>o,a:()=>d,n4:()=>f,pd:()=>l});var r=n(84326),o={overview:(0,r.t)("events.edit_modal.overview.title"),people:(0,r.t)("events.edit_modal.people.title"),basicInfo:(0,r.t)("events.create.form.basic_info"),details:(0,r.t)("events.edit_modal.details.title"),notifications:(0,r.t)("events.edit_modal.notifications.title"),email:(0,r.t)("events.edit_modal.email.title"),advancedOptions:(0,r.t)("events.edit_modal.advanced_options.title")},i={VIRTUAL:"virtual",IN_PERSON:"in_person",TBD:"tbd",LIVE_STREAM:"live_stream",LIVE_ROOM:"live_room"},a={SINGLE:"single",RECURRING:"recurring"},s={FREE:"free",PAID:"paid"},l={ON:"on",NEVER:"never",AFTER:"after"},c={CURRENT:"current",REMAINING:"remaining",ALL:"all"},u={PUBLISHED:"published",DRAFT:"draft"},d={PARTICIPANT:"participant",COHOST:"cohost",HOST:"host"},f={ATTENDEES:"attendees",COHOSTS:"cohosts"}},31796:function(e,t,n){n.d(t,{H3:()=>y,Km:()=>g,L6:()=>f,Rv:()=>b,UJ:()=>m,VL:()=>p,dy:()=>u,f0:()=>c,hA:()=>v,mv:()=>s,s9:()=>l,yl:()=>h});var r=n(84326),o=n(4393),i=n(37588),a=n(39766),s=function(e){return(null==e?void 0:e.status)===a.Q_.DRAFT},l=function(e){return(null==e?void 0:e.status)===a.Q_.PUBLISHED},c=function(e){return(null==e?void 0:e.event_type)===a.E_.RECURRING},u=function(e){var t;return(null==e||null==(t=e.event_setting_attributes)?void 0:t.location_type)===a.Bq.LIVE_ROOM},d=function(e){var t;return(null==e||null==(t=e.event_setting_attributes)?void 0:t.location_type)===a.Bq.LIVE_STREAM},f=function(e){var t,n;return d(e)&&(null==e||null==(n=e.event_setting_attributes)||null==(t=n.live_stream_room_setting_attributes)?void 0:t.access_type)===i._d.PUBLIC_STREAM},m=function(e){return[a.Bq.LIVE_STREAM,a.Bq.LIVE_ROOM].includes(e)},p=function(e){var t;return!!(e&&(0,o.aA)(null==e||null==(t=e.event_setting_attributes)?void 0:t.ends_at))},b=function(e){var t;return!!(e&&(0,o.aA)(null==e||null==(t=e.event_setting_attributes)?void 0:t.starts_at))},h=function(e){var t;return(null==e||null==(t=e.event_setting_attributes)?void 0:t.ticket_type)==a.Mj.PAID},v=function(e){var t;return e&&(null==e||null==(t=e.paywall_attributes)?void 0:t.published)},y=function(e){return c(e)&&!h(e)},g=function(e){var t=c(e),n=t?(0,r.t)("events.recurring_deletion_successful"):(0,r.t)("event_dropdown_actions.delete_successful");return(p(e)||s(e))&&(n=t?(0,r.t)("events.recurring_draft_deletion_successful"):(0,r.t)("event_dropdown_actions.draft_delete_successful")),n}},42953:function(e,t,n){n.d(t,{Bq:()=>r.Bq,E_:()=>r.E_,HA:()=>r.HA,Km:()=>o.Km,L6:()=>o.L6,Mj:()=>r.Mj,Q_:()=>r.Q_,Rv:()=>o.Rv,SA:()=>r.SA,UJ:()=>o.UJ,VL:()=>o.VL,a:()=>r.a,dy:()=>o.dy,f0:()=>o.f0,hA:()=>o.hA,mv:()=>o.mv,n4:()=>r.n4,pd:()=>r.pd,s9:()=>o.s9,yl:()=>o.yl});var r=n(39766),o=n(31796)},72950:function(e,t,n){n.d(t,{G:()=>n2});var r=n(85893),o=n(67294),i=n(96486);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var l=(0,o.createContext)({isUpdatingAttendees:!1,setIsUpdatingAttendees:i.noop,isEmailNotificationsEnabled:!1,setIsEmailNotificationsEnabled:i.noop,isAutoRsvpInvitedAttendees:!1,setIsAutoRsvpInvitedAttendees:i.noop});l.displayName="EventsContext";var c=function(){return(0,o.useContext)(l)},u=function(e){var t=e.children,n=s((0,o.useState)(!1),2),i=n[0],a=n[1],c=s((0,o.useState)(!0),2),u=c[0],d=c[1],f=s((0,o.useState)(!1),2),m=f[0],p=f[1];return(0,r.jsx)(l.Provider,{value:{isUpdatingAttendees:i,setIsUpdatingAttendees:a,isEmailNotificationsEnabled:u,setIsEmailNotificationsEnabled:d,isAutoRsvpInvitedAttendees:m,setIsAutoRsvpInvitedAttendees:p},children:t})},d=n(1168),f=n(17617),m=n(88663),p=n(37416),b=n(85633),h=n(51466),v=n(84326),y=n(75148),g=n(41553);function _(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var x=function(){var e=(0,o.useRef)(null);return{validateAndSetCurrentSection:function(t,n){var r;return(r=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:if(!(0,i.isFunction)(e.current))return[3,2];return[4,e.current()];case 1:if(!r.sent())return[2];r.label=2;case 2:return n(t),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){_(i,n,o,a,s,"next",e)}function s(e){_(i,n,o,a,s,"throw",e)}a(void 0)})})()},triggerValidationRef:e}},j=n(42953),w=function(e){var t=e.isOpen,n=e.handleClose,o=e.isEditMode,i=(0,m.eW)(),a=i.currentSection,s=i.setCurrentSection,l=x().validateAndSetCurrentSection;return a===j.SA.overview?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.x.HeaderContent,{children:(0,r.jsx)(g.Z.TitleSm,{truncate:!0,weight:"semibold",children:(0,v.t)("edit_event")})}),(0,r.jsx)(b.o,{onClick:n,isVisible:t,className:"!pr-0"})]}):(0,r.jsx)(p.x.HeaderContent,{children:(0,r.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[o&&(0,r.jsx)(y.h,{name:"16-arrow-left",onClick:function(){l(j.SA.overview,s)},ariaLabel:(0,v.t)("back")}),(0,r.jsx)(g.Z.TitleSm,{truncate:!0,weight:"semibold",children:o?(0,v.t)("edit_event"):(0,v.t)("events.create.title")}),(0,r.jsx)(b.o,{onClick:n,isVisible:t})]})})},O=n(41342),S=function(){var e=(0,O.wh)().currentCommunitySettings;return{hasLimitUrlSharingEnabled:!!(null==e?void 0:e.limit_url_sharing_enabled),hasSplitRecurringEventsEnabled:!!(null==e?void 0:e.split_recurring_events_enabled)}},P=n(39905),C=n(31796),I=n(63549),k=n(79522);function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var A="events.edit.recurring_event_modal",E=function(e){var t,n=e.show,i=e.onConfirm,a=e.onCloseModal,s=e.isPublishing,l=void 0!==s&&s,u=e.showCurrentOptionOnly,d=e.showRemainingOptionOnly,f=e.showCurrentAndRemainingOnly,m=e.shouldHideAllEventOption,p=e.defaultSelection,b=e.isDraft,h=(t=(0,o.useState)(p||j.HA.CURRENT),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return N(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),y=h[0],_=h[1],x=c(),w=x.isEmailNotificationsEnabled,O=x.isAutoRsvpInvitedAttendees;(0,o.useEffect)(function(){_(p||j.HA.CURRENT)},[p]);var S=[{label:(0,v.t)("".concat(A,".this_event")),value:j.HA.CURRENT},{label:(0,v.t)("".concat(A,".this_and_following")),value:j.HA.REMAINING},{label:(0,v.t)("".concat(A,".all_events")),value:j.HA.ALL}],P=y===j.HA.ALL||y===j.HA.REMAINING,C=(0,o.useMemo)(function(){return u?S.filter(function(e){return e.value===j.HA.CURRENT}):d?S.filter(function(e){return e.value===j.HA.REMAINING}):f?S.filter(function(e){return e.value===j.HA.CURRENT||e.value===j.HA.REMAINING}):m?S.filter(function(e){return e.value!==j.HA.ALL}):S},[u,d,f,m]),E=w&&P&&l,T=!b&&w&&(f||d)&&y===j.HA.REMAINING,M=y===j.HA.CURRENT&&(u||f);return(0,r.jsxs)(I.c,{title:l?(0,v.t)("".concat(A,".title_publish")):(0,v.t)("".concat(A,".title")),isOpen:void 0!==n&&n,confirmText:(0,v.t)("".concat(A,".accept")),cancelText:(0,v.t)("".concat(A,".cancel")),onClose:a,onCancel:a,onConfirm:function(){i(y)},size:"md",children:[(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(k.S,{defaultChecked:y,name:"recurring_event_settings.frequency_edit",options:C,size:"sm",onChange:function(e){_(e)}})}),E&&(0,r.jsx)("div",{className:"mt-4 leading-4",children:(0,r.jsx)(g.Z.LabelXs,{color:"text-light",weight:"semibold",as:"span",children:O?(0,v.t)("".concat(A,".confirmation_email_notifications")):(0,v.t)("".concat(A,".invitation_email_notifications"))})}),M&&(0,r.jsx)("div",{className:"mt-4 leading-4",children:(0,r.jsx)(g.Z.LabelXs,{color:"text-light",weight:"semibold",as:"span",children:(0,v.t)("".concat(A,".keep_original_series_notice"))})}),T&&(0,r.jsx)("div",{className:"mt-4 leading-4",children:(0,r.jsx)(g.Z.LabelXs,{color:"text-light",weight:"semibold",as:"span",children:(0,v.t)("".concat(A,".update_event_notifications"))})})]})},T=n(57363),M=n(88767),R=n(93199),D=n(13532);function L(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var F=function(e){var t=e||{},n=t.event,r=t.formScheduleValues,o=r||{},i=o.startsAt,a=o.endsAt,s=o.frequency;return(0,M.useQuery)({queryKey:["calculateSchedule",null==n?void 0:n.id,r],queryFn:function(){var e;return(e=function(){var e;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){return n&&i&&a&&s?(e={event:{frequency:s,starts_at:i,event_ends_at:a}},[2,(0,R.UT)(D.av.events.calculateSchedule({slug:n.slug,spaceId:n.space_id,params:e}))]):[2,null]})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){L(i,r,o,a,s,"next",e)}function s(e){L(i,r,o,a,s,"throw",e)}a(void 0)})})()},enabled:!!(n&&i&&a&&s)})},U=n(4393),B=n(34870),q=n(43945),z=function(e){if(!e)return"";var t=new Date(e),n=(0,q.UZ)(e),r=(0,B.w)({dateTime:t,format:"short_time"}),o=(0,U.ED)(void 0,t)||"GMT",i=(0,B.w)({dateTime:t,format:"short_month_and_date"});return"".concat(n,", ").concat(i,", ").concat(r," (").concat(o,")")},Z=function(e){var t;return z(null==(t=e.event_setting_attributes)?void 0:t.starts_at)},H=n(19338),V=function(e){var t=e.frequency,n=e.startsAt,r=e.endsAt,o=e.occurrences;if(!t||!n)return"";var i=(0,H.E)({startsAt:n,firstLetterCapital:!0}).find(function(e){return e.value===t}),a=(null==i?void 0:i.label)||t,s=new Date(n),l=(0,B.w)({dateTime:s,format:"short_time"}),c=(0,U.ED)(void 0,s)||"GMT";if(o)return(0,v.t)("events.recurring.schedule.repeats_with_occurrences_number",{count:o,frequency:a,occurrences:o,time:l,timezone:c});if(r){var u=new Date(r),d=(0,B.w)({dateTime:u,format:"date_time_with_short_timezone"});return(0,v.t)("events.recurring.schedule.ends_on_date",{frequency:a,endDate:d})}return(0,v.t)("events.recurring.schedule.repeats_at_time",{frequency:a,time:l,timezone:c})},Q=n(24455),W=n(24509);function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var $=function(){var e,t=(e=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return G(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],i=t[1];return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)("button",{type:"button",onClick:function(){i(!n)},className:"hover:bg-secondary flex w-full items-center justify-between transition-colors",children:[(0,r.jsx)(g.Z.LabelSm,{weight:"medium",color:"text-primary",children:(0,v.t)("events.edit_modal.schedule_update_modal.attendee_experience_title")}),n?(0,r.jsx)(Q.Z,{className:"h-5 w-5"}):(0,r.jsx)(W.Z,{className:"h-5 w-5"})]}),n&&(0,r.jsxs)("ul",{className:"list-outside list-disc pl-4",children:[(0,r.jsx)("li",{children:(0,r.jsx)(g.Z.LabelSm,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.attendee_experience_1")})}),(0,r.jsx)("li",{children:(0,r.jsx)(g.Z.LabelSm,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.attendee_experience_2")})}),(0,r.jsx)("li",{children:(0,r.jsx)(g.Z.LabelSm,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.attendee_experience_3")})}),(0,r.jsx)("li",{children:(0,r.jsx)(g.Z.LabelSm,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.attendee_experience_4")})})]})]})},K=function(e,t){var n,r,o,i;return t?Z(e):V({frequency:(null==(n=e.recurring_setting_attributes)?void 0:n.frequency)||"",startsAt:(null==(r=e.event_setting_attributes)?void 0:r.starts_at)||"",endsAt:null==(o=e.recurring_setting_attributes)?void 0:o.ends_at,occurrences:null==(i=e.recurring_setting_attributes)?void 0:i.occurrences})},J=function(e){var t,n,o,i=e.event,a=e.isOpen,s=e.onCancel,l=e.onConfirm,c=e.formScheduleValues,u=e.editMode===j.HA.CURRENT,d=F(a&&i&&c&&!u?{event:i,formScheduleValues:c}:void 0),f=d.isLoading,m=d.data,p=d.error,b=null==i?void 0:i.name,h=K(i,u),y=(t=m,n=c,u?z(n.startsAt):(null==t?void 0:t.schedule)?V({frequency:t.schedule.frequency,startsAt:t.schedule.starts_at,endsAt:t.schedule.ends_at,occurrences:t.schedule.occurrences}):""),_=f&&!u,x=!!p&&!u;return(0,r.jsx)(I.c,{title:(0,v.t)("events.edit_modal.schedule_update_modal.title"),isOpen:a,confirmText:(0,v.t)("events.edit_modal.schedule_update_modal.update_schedule"),cancelText:(0,v.t)("events.edit_modal.schedule_update_modal.back"),onClose:s,onCancel:s,onConfirm:l,size:"lg",disabled:!!p||_,children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col rounded-xl border p-4 pt-3 shadow-lg",children:[(0,r.jsxs)("div",{className:"border-primary border-b pb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 pb-2",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"semibold",textTransform:"capitalize",children:b}),(0,r.jsx)(g.Z.BodyMd,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.updated_schedule")})]}),!u&&(0,r.jsx)("div",{className:"pb-2",children:(0,r.jsx)(g.Z.BodySm,{color:"text-secondary",children:(0,v.t)("events.edit_modal.schedule_update_modal.series_update_notice")})})]}),(0,r.jsxs)("div",{className:"border-primary relative flex flex-col gap-2 border-b pb-6 pt-4",children:[(0,r.jsx)(g.Z.LabelSm,{weight:"semibold",color:"text-secondary",children:u?(0,v.t)("events.edit_modal.schedule_update_modal.original_date_time"):(0,v.t)("events.edit_modal.schedule_update_modal.original_series")}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(T.JO,{type:"16-calendar-recurring",size:16,className:"text-default !w-4"}),(0,r.jsx)(g.Z.BodySm,{color:"text-secondary",children:h})]}),(0,r.jsx)("div",{className:"bg-primary absolute left-1/2 top-full flex -translate-x-1/2 -translate-y-1/2 justify-center rounded-full border p-1",children:(0,r.jsx)(T.JO,{type:"16-arrow-down",size:16,className:"!w-4"})})]}),(0,r.jsxs)("div",{className:"border-primary relative flex flex-col gap-2 pb-2 pt-4",children:[(0,r.jsx)(g.Z.LabelSm,{weight:"semibold",color:"text-secondary",children:u?(0,v.t)("events.edit_modal.schedule_update_modal.new_date_time"):(0,v.t)("events.edit_modal.schedule_update_modal.new_series")}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(T.JO,{type:"16-calendar-recurring",size:16,className:"text-default !w-4"}),_?(0,r.jsx)(T.JO,{type:"loader",size:16,className:"animate-spin"}):x?(0,r.jsx)(g.Z.BodySm,{color:"text-v2-danger",children:(null!=(o=Error)&&"undefined"!=typeof Symbol&&o[Symbol.hasInstance]?!!o[Symbol.hasInstance](p):p instanceof o)?p.message:(0,v.t)("events.edit_modal.schedule_update_modal.calculation_failed")}):(0,r.jsx)(g.Z.BodySm,{color:"text-secondary",children:y})]})]})]}),!u&&(0,r.jsx)($,{})]})})};function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var et=function(e){var t,n,i=e.onEditModeConfirm,a=e.isRecurringEvent,s=void 0!==a&&a,l=e.isPublishing,c=e.children,u=e.isStartsAtDirty,d=void 0!==u&&u,f=e.isRepeatsDirty,m=void 0!==f&&f,p=e.shouldHideAllEventOption,b=void 0!==p&&p,h=e.type,v=e.event,y=e.formScheduleValues,g=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["onEditModeConfirm","isRecurringEvent","isPublishing","children","isStartsAtDirty","isRepeatsDirty","shouldHideAllEventOption","type","event","formScheduleValues"]),_=ee((0,o.useState)(!1),2),x=_[0],w=_[1],O=ee((0,o.useState)(!1),2),I=O[0],k=O[1],N=ee((0,o.useState)(null),2),A=N[0],T=N[1],M=S().hasSplitRecurringEventsEnabled;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.z,(t=Y({type:void 0===h?"button":h,onClick:function(){s?w(!0):i(j.HA.CURRENT)}},g),n=n={children:c},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)),(0,r.jsx)(E,Y({show:x,onConfirm:function(e){w(!1),(e===j.HA.REMAINING||e===j.HA.CURRENT)&&(m||d)&&v?(T(e),k(!0)):i(e)},onCloseModal:function(){return w(!1)},isPublishing:void 0!==l&&l,isDraft:!!v&&(0,C.mv)(v)},M?m?{showRemainingOptionOnly:!0,shouldHideAllEventOption:b,defaultSelection:j.HA.REMAINING}:d?{showCurrentAndRemainingOnly:!0,shouldHideAllEventOption:b,defaultSelection:j.HA.CURRENT}:{shouldHideAllEventOption:b,defaultSelection:j.HA.CURRENT}:{showCurrentOptionOnly:d,shouldHideAllEventOption:b})),v&&A&&(0,r.jsx)(J,{isOpen:I,onConfirm:function(){k(!1),A&&(i(A),T(null))},onCancel:function(){k(!1),T(null)},event:v,formScheduleValues:void 0===y?{startsAt:"",endsAt:"",frequency:""}:y,editMode:A})]})},en=function(e){var t=e.event,n=e.isEventDraft,o=t||{},i=o.slug,a=o.space_slug;return(0,r.jsxs)("button",{type:"button",className:"flex cursor-pointer items-center whitespace-nowrap",onClick:function(){window.open((0,D.LM)({spaceSlug:a,slug:i}),"_blank")},children:[(0,r.jsx)(g.Z.LabelSm,{weight:"medium",children:(0,v.t)(n?"events.edit_modal.preview":"events.edit_modal.overview.view_event")}),(0,r.jsx)(T.JO,{type:"16-arrow-top-right",size:16})]})},er=function(e){var t=e.event,n=e.onPublish,o=e.className,i=(0,m.eW)().isSaving,a=(0,j.mv)(t);return(0,r.jsxs)(m.h4.Actions,{className:(0,d.A)("justify-between px-5 pb-6 pt-2 md:justify-end md:p-0",o),children:[t&&(0,r.jsx)(en,{event:t,isEventDraft:a}),a&&(0,r.jsx)(et,{variant:"circle",disabled:i,onEditModeConfirm:n,isRecurringEvent:(0,j.f0)(t),isPublishing:!0,children:(0,v.t)("events.edit_modal.buttons.publish")})]})},eo=n(24304),ei=function(e){var t=e.onChangeSection,n=(0,m.eW)(),o=n.sections,i=n.currentSection,a=n.setCurrentSection,s=o.map(function(e){return{value:e,label:e}});return(0,r.jsx)(m.h4.Actions,{className:"items-center justify-center",children:(0,r.jsx)(eo.S,{value:i,onChange:function(e){t(e,a)},options:s})})},ea=n(24330),es=n(28414);function el(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function ec(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var eu=function(e){var t=e.event,n=e.isCreating,o=e.isEditMode,i=e.actionsProps,a=(0,m.eW)().title,s=(0,j.s9)(t)?(0,v.t)("events.badge_status.published"):(0,v.t)("events.badge_status.draft");return(0,f.kK)()?(0,r.jsxs)("div",{className:"flex w-full flex-col gap-4 px-5 py-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[o&&(0,r.jsx)(ea.g,{label:s}),o&&(0,r.jsx)(er,ec(el({},i),{className:"inline-flex lg:hidden"}))]}),(0,r.jsx)(g.Z.TitleSm,{truncate:!0,weight:"semibold",children:a})]}):(0,r.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-between gap-4",children:[(0,r.jsx)(es.Y,{className:"flex",children:!n&&a&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(g.Z.TitleSm,{truncate:!0,weight:"semibold",children:a}),(0,r.jsx)("div",{className:"flex items-center",children:o&&(0,r.jsx)(ea.g,{label:s})})]})}),o&&(0,r.jsx)(er,ec(el({},i),{className:"lg:hidden"}))]})},ed=function(e){var t,n,o=e.isOpen,i=e.isEditMode,a=e.isCreating,s=e.event,l=e.onPublish,c=e.validateAndSetCurrentSection,u=e.handleClose,d={event:s,isEditMode:i,onPublish:l};return(0,f.kK)()?(0,r.jsx)(w,{isOpen:o,isEditMode:i,handleClose:u}):(0,r.jsxs)(p.x.HeaderContent,{children:[(0,r.jsx)(eu,{event:s,isCreating:a,isEditMode:i,actionsProps:d}),i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.x.HeaderContent.Navigation,{children:(0,r.jsx)(ei,{onChangeSection:c})}),(0,r.jsx)(er,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},d),n=n={className:"hidden lg:flex"},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))]})]})},ef=n(52293),em=n(25152),ep=function(e){var t,n,o=e.children,i=e.name,a=e.rules,s=e.tooltipText,l=e.hidePlaceholder,c=e.placeholder,u=e.inlineReverse,d=e.translationRoot,f=e.hideLabel,m=e.className,p=e.tooltipTextClassName,b=e.errorClassName,v=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["children","name","rules","tooltipText","hidePlaceholder","placeholder","inlineReverse","translationRoot","hideLabel","className","tooltipTextClassName","errorClassName"]);return(0,r.jsx)(h.l.Item,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({name:i,hideDescription:!0,translationRoot:void 0===d?"events.edit_modal":d,rules:void 0===a?{}:a,hideBorder:!0,fullWidth:!0,hidePlaceholder:void 0!==l&&l,placeholder:c,tooltipText:s,inlineReverse:void 0!==u&&u,hideLabel:void 0!==f&&f,className:void 0===m?"":m,tooltipTextClassName:void 0===p?"":p,errorClassName:b},v),n=n={children:o},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},eb=function(){return(0,r.jsx)("div",{className:"w-[100px]",children:(0,r.jsx)(h.l.Item,{name:"event_setting_attributes.rsvp_limit",hideLabel:!0,hideBorder:!0,placeholder:(0,v.t)("events.edit_modal.event_setting_attributes.rsvp_limit_placeholder"),rules:{required:(0,v.t)("events.edit_modal.event_setting_attributes.rsvp_limit_required"),min:{value:1,message:(0,v.t)("events.edit_modal.event_setting_attributes.rsvp_limit_error")}},children:(0,r.jsx)(h.l.Input,{})})})},eh=function(e){var t,n=e.event,o=(0,ef.qo)({name:"event_setting_attributes.rsvp_limit_enabled",defaultValue:null!=(t=null==n?void 0:n.event_setting_attributes.rsvp_limit_enabled)&&t});return(0,r.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,r.jsx)("div",{className:"mb-0 mt-6 md:mb-3 md:mt-8",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.advanced_options.attendees")})}),["event_setting_attributes.rsvp_disabled","event_setting_attributes.hide_attendees","event_setting_attributes.rsvp_limit_enabled"].map(function(e){return(0,r.jsx)(ep,{name:e,tooltipText:(0,v.t)("events.edit_modal.".concat(e,"_tooltip")),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:e})},e)}),o&&(0,r.jsx)(eb,{})]})},ev=n(3697),ey=n(30889),eg=n(6394),e_=n(57462),ex=function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"md:mb-3",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.advanced_options.meta_tags")})}),(0,r.jsxs)("div",{className:"pb-4",children:[(0,r.jsx)(ep,{name:"meta_tag_attributes.meta_title",hidePlaceholder:!0,label:(0,v.t)("events.edit_modal.meta_tag_attributes.meta_title"),tooltipText:(0,v.t)("events.edit_modal.meta_tag_attributes.meta_title_description",{obj:"event"}),children:(0,r.jsx)(h.l.Input,{})}),(0,r.jsx)(ep,{name:"meta_tag_attributes.meta_description",hidePlaceholder:!0,label:(0,v.t)("events.edit_modal.meta_tag_attributes.meta_description"),tooltipText:(0,v.t)("events.edit_modal.meta_tag_attributes.meta_description_description"),children:(0,r.jsx)(h.l.Input,{variant:"textarea"})}),(0,r.jsx)(ep,{name:"meta_tag_attributes.opengraph_title",hidePlaceholder:!0,label:(0,v.t)("events.edit_modal.meta_tag_attributes.opengraph_title"),tooltipText:(0,v.t)("events.edit_modal.meta_tag_attributes.opengraph_title_description",{obj:"event"}),children:(0,r.jsx)(h.l.Input,{})}),(0,r.jsx)(ep,{name:"meta_tag_attributes.opengraph_description",hidePlaceholder:!0,label:(0,v.t)("events.edit_modal.meta_tag_attributes.opengraph_description"),tooltipText:(0,v.t)("events.edit_modal.meta_tag_attributes.opengraph_description_description"),children:(0,r.jsx)(h.l.Input,{variant:"textarea"})}),(0,r.jsx)("div",{className:"mt-4 grid grid-cols-1",children:(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)(ey.Q,{field:"hide_location_from_non_attendees",label:(0,v.t)("events.edit_modal.meta_tag_attributes.opengraph_image"),description:" "}),(0,r.jsx)(eg.D,{name:"meta_tag_attributes[opengraph_image]",alt:(0,v.t)("spaces.form.edit.options.seo.opengraph_image.label"),className:"relative",showAddCoverBtn:!0,aspectRatio:ev.pI.OPEN_GRAPH,changeImageText:(0,v.t)("spaces.form.edit.options.seo.opengraph_image.change"),customAddCoverBtn:(0,r.jsx)(e_.Z,{title:(0,v.t)("spaces.form.edit.options.seo.opengraph_image.add"),description:(0,v.t)("spaces.form.edit.options.seo.opengraph_image.description")})})]})})]})]})},ej=function(){return(0,r.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,r.jsx)("div",{className:"mb-0 mt-6 md:mb-3 md:mt-8",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.advanced_options.permissions")})}),["hide_meta_info","is_comments_disabled","is_liking_disabled","hide_from_featured_areas"].map(function(e){return(0,r.jsx)(ep,{name:e,tooltipText:(0,v.t)("events.edit_modal.".concat(e,"_tooltip")),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:e})},e)})]})},ew=function(e){var t=e.event;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.edit_modal.advanced_options.title")}),(0,r.jsx)(ej,{}),(0,r.jsx)(eh,{event:t}),(0,r.jsx)(ex,{})]})},eO=n(60589),eS=n(17534),eP=n(45308),eC=n(17013),eI=function(e){var t=e.event,n=e.canCreateTopics,o=e.requireTopicSelection,i=(0,eS.m)().spaces,a=!!t,s=o?{required:(0,v.t)("events.create.form.topics_required_error")}:{required:!1},l=(0,(0,ef.Gc)().getValues)("space_id");return(0,r.jsxs)("div",{className:"my-6 md:my-8",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.create.form.event_name")}),(0,r.jsxs)("div",{className:"flex flex-col items-stretch gap-2 md:flex-row",children:[(0,r.jsx)("div",{className:a?"w-full pr-0 md:pr-2 md:w-1/2":"w-full",children:(0,r.jsx)(ep,{name:"name",rules:{required:(0,v.t)("events.create.form.name_required_error"),maxLength:{value:255,message:(0,v.t)("events.create.form.name_length_error")}},placeholder:(0,v.t)("events.create.form.name_placeholder"),translationRoot:"events.create.form",children:(0,r.jsx)(h.l.Input,{autoFocus:!0,"data-testid":"event-title"})})}),a&&(0,r.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,r.jsx)(ep,{name:"slug",hidePlaceholder:!0,rules:{maxLength:{value:255,message:(0,v.t)("events.create.form.slug_length_error")}},tooltipText:(0,v.t)("events.edit_modal.slug_tooltip",{url:window.location.origin}),children:(0,r.jsx)(h.l.Input,{})})})]}),(0,r.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[(0,r.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,r.jsx)(ep,{name:"space_id",rules:{required:(0,v.t)("events.create.form.space_required_error")},translationRoot:"events.create.form",children:(0,r.jsx)(eC.M,{spaces:i,name:"space_id",variant:"form-input",dropdownClassName:"!top-[100%] -mt-1"})})}),(0,r.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,r.jsx)(ep,{name:"user_id",translationRoot:"events.create.form",children:(0,r.jsx)(h.l.CommunityMemberSelect,{name:"user_id",direction:"down",valueField:"user_id",hideIcon:!0})})})]}),(0,r.jsx)("div",{className:"flex flex-col items-stretch md:flex-row",children:(0,r.jsx)(ep,{name:"topics",tooltipText:(0,v.t)("events.edit_modal.topics_tooltip"),rules:s,children:(0,r.jsx)(eP.w,{containerClassName:"bg-primary border-primary rounded-md border",name:"topics",spaceId:l,creatable:n})})})]})},ek=n(6685),eN=n(64608),eA=n(32050),eE=function(e){var t=e.title,n=e.description,o=e.className;return(0,r.jsx)(eA.b,{type:"warning",icon:(0,r.jsx)(T.JO,{type:"20-triangle-exclamation",size:20,className:"mt-1 !self-start text-amber-600"}),title:t,description:n,className:"text-dark mb-4 mt-2 rounded-xl !border !border-amber-400 bg-[rgba(245,158,11,0.05)] [&_span]:!text-sm ".concat(void 0===o?"":o)})};function eT(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eM(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eT(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eT(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var eR=function(e){var t=e.event,n=(0,H.e)({event:t}),i=n.endsAtMaxDate,a=n.endsAfterMaxOccurrences,s=n.frequencyOptions,l=n.endingOptions,c=n.endsAtMinDate,u=n.endsOnValue,d=n.shouldShowRecurringFields,f=n.currentEndsAt,m=n.startsAtInUTC,p=S().hasSplitRecurringEventsEnabled,b=t&&(0,j.VL)(t),y=(0,ef.Gc)(),_=y.setValue,x=y.getValues,w=y.clearErrors,O=(0,ef.cl)(),P=O.isSubmitting,C=O.isSubmitted,I=eM((0,o.useState)(null),2),k=I[0],N=I[1],A=eM((0,o.useState)(!1),2),E=A[0],T=A[1],M=x("recurring_setting_attributes.frequency");(0,o.useEffect)(function(){m&&f&&(0,j.f0)(t)?(new Date(m)>new Date(f)?T(!0):T(!1),w("event_setting_attributes.starts_at")):T(!1)},[m,f]),(0,o.useEffect)(function(){P&&N(M)},[P]),(0,o.useEffect)(function(){P||C||N(null)},[C,P,k]),(0,o.useEffect)(function(){k&&C&&_("recurring_setting_attributes.frequency",k,{shouldDirty:!1})},[k,M,C,_]);var R=((0,j.mv)(t)||(0,j.s9)(t))&&(0,j.f0)(t),D=p?!!t&&!(0,j.f0)(t)||b:!!t;return(0,r.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.create.form.date_and_time")}),(0,r.jsx)("div",{className:"flex flex-col items-stretch md:flex-row",children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(ep,{name:"event_setting_attributes.starts_at",label:(0,v.t)("events.create_modal.event_setting_attributes.starts_at",{timeZone:(0,U.ED)(U.tq)}),translationRoot:"events.create.form",children:(0,r.jsx)(ek.D,{startsAtConfig:{name:"event_setting_attributes.starts_at",minDate:new Date},endsAtConfig:{name:"event_setting_attributes.ends_at"},durationConfig:{name:"event_setting_attributes.duration_in_seconds"},disabled:b})})})}),E&&(0,r.jsx)(eE,{title:(0,v.t)("events.edit_modal.recurring_setting_attributes.starts_at_after_ends_at_warning_title"),description:(0,v.t)("events.edit_modal.recurring_setting_attributes.starts_at_after_ends_at_warning_content")}),(0,r.jsx)("div",{className:"flex items-stretch",children:(0,r.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,r.jsx)(ep,{name:"recurring_setting_attributes.frequency",translationRoot:"events.create.form",children:(0,r.jsx)(h.l.AnimatedSelect,{name:"recurring_setting_attributes.frequency",fullWidth:!0,options:s,disabled:D,dataTestId:"event-repeats"})})})}),(0,r.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[d&&(0,r.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,r.jsx)(ep,{name:"recurring_setting_attributes.range_type",translationRoot:"events.create.form",children:(0,r.jsx)(h.l.AnimatedSelect,{name:"recurring_setting_attributes.range_type",fullWidth:!0,options:l,disabled:R,dataTestId:"event-ends"})})}),d&&(0,r.jsxs)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:[(!u||u===em.pd.ON)&&(0,r.jsx)("div",{className:"mt-0 flex items-end md:mt-7",children:(0,r.jsx)(ep,{name:"recurring_setting_attributes.ends_at",hideLabel:!0,rules:{required:(0,v.t)("events.create.form.ends_at_required")},translationRoot:"events.create.form",children:(0,r.jsx)(eN.x,{name:"recurring_setting_attributes.ends_at",minDate:c?new Date(c):void 0,maxDate:i?new Date(i):void 0,disabled:R,dataTestId:"recurring_event_ends_at",datePlaceholder:(0,v.t)("events.create.form.recurring_setting_attributes.date_placeholder"),timePlaceholder:(0,v.t)("events.create.form.recurring_setting_attributes.time_placeholder")})})}),u===em.pd.AFTER&&(0,r.jsx)("div",{className:"flex items-end",children:(0,r.jsx)("div",{className:"grow",children:(0,r.jsx)(ep,{name:"recurring_setting_attributes.occurrences",rules:{required:!R&&(0,v.t)("events.create.form.occurrences_required"),max:{value:a||1,message:(0,v.t)("events.create.form.max_occurrences_error")}},translationRoot:"events.create.form",children:(0,r.jsx)(h.l.Input,{type:"number",min:1,max:a||1,autoFocus:!0,disabled:R,"data-testid":"event-occurrences",customOpacity:"70"})})})})]})]})]})},eD=n(33382),eL=function(){return(0,eD.H)("location-picker-z-index-override"),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ep,{name:"event_setting_attributes.in_person_location",variant:"extra-bottom-margin",translationRoot:"events.create.form",rules:{required:(0,v.t)("events.create_modal.event_setting_attributes.location_address_required_error")},children:(0,r.jsx)(h.l.LocationPicker,{name:"event_setting_attributes.in_person_location",autoFocus:!0})}),(0,r.jsx)(ep,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:"events.create.form",children:(0,r.jsx)(h.l.ToggleSwitch,{name:"event_setting_attributes.hide_location_from_non_attendees",variant:"small"})})]})},eF=n(91150),eU=n(80926),eB=n(37588),eq=n(43544),ez=function(e){var t=e.name,n=e.roomType,i=void 0===n?eB.H0.STREAM:n,a=(0,eS.m)().spaces,s=(0,eU.oQ)().config,l=null==s?void 0:s.live_room_participants_capacity,c=(0,ef.Gc)(),u=c.control,d=c.getValues,f=c.setValue,m=d("space_id"),p=d("event_setting_attributes.ticket_type"),b=a.find(function(e){return e.id==m}),h=b?b.visibility:"open",y=[{value:eB._d.SECRET,label:(0,v.t)("events.create.form.".concat(h,".access_type_secret")),description:(0,r.jsx)(g.Z.LabelSm,{children:(0,v.t)("events.create.form.".concat(h,".access_type_secret_label"))})}];return p==j.Mj.FREE&&y.push({value:eB._d.OPEN,label:(0,v.t)("events.create.form.".concat(h,".access_type_space")),description:(0,r.jsx)(g.Z.LabelSm,{children:(0,v.t)("events.create.form.".concat(h,".access_type_space_label"),{maxCapacity:l})})}),i===eB.H0.STREAM&&p==j.Mj.FREE&&y.push({value:eB._d.PUBLIC_STREAM,label:(0,v.t)("events.create.form.".concat(h,".access_type_public")),description:(0,r.jsx)(g.Z.LabelSm,{children:(0,v.t)("events.create.form.".concat(h,".access_type_public_label"))})}),(0,o.useEffect)(function(){"paid"==p&&f("event_setting_attributes.live_stream_room_setting_attributes.access_type",eB._d.SECRET,{shouldDirty:!0})},[p,f]),(0,r.jsx)(ef.Qr,{control:u,name:void 0===t?"":t,render:function(e){var t,n=e.field,o=n.onChange,i=(t=n.value,y.find(function(e){return e.value===t})||y[0]);return(0,r.jsx)(eq.Lt,{direction:"bottom-start",linkType:"button",button:(0,r.jsx)(eq.Lt.MenuButton,{className:"form-control relative inline-block w-full text-left",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("div",{className:"content-start",children:(0,r.jsx)(g.Z.LabelMd,{children:null==i?void 0:i.label})}),(0,r.jsx)("div",{className:"flex content-end",children:(0,r.jsx)(T.JO,{type:"cheveron-down"})})]})}),buttonClassName:"w-full",className:"relative w-full",size:eq.wk.EXTRA_LARGE,onChange:o,options:y,labelWeight:"semibold"})}})},eZ=function(e){var t,n,i,a=e.recordingEnabled,s=e.showRecordingToggle,l=e.showAddonsLimits,c=void 0!==l&&l,u=e.roomTypeOverride,d=e.event,f=(0,eU.tm)(),m=f.streamingHoursAvailable,p=f.recordingHoursAvailable,b=f.streamingTotalPlanHours,y=f.recordingTotalPlanHours,_=S().hasLimitUrlSharingEnabled,x=!!d,w=function(){var e,t=(d||{}).event_setting_attributes,n=!!t&&(0,U.aA)(null==t?void 0:t.ends_at),r=null==t||null==(e=t.live_stream_room_setting_attributes)?void 0:e.stream_status;return n||r===eB.LV.LIVE},O=(0,eU.Yq)().currentQuantity,P=(0,eU.$v)().currentQuantity,C=a&&!p,I=c&&C||c&&!m,k=(0,ef.Gc)(),N=k.watch,A=k.setValue,E=N("event_setting_attributes.live_stream_room_setting_attributes.access_type"),T=N("event_setting_attributes.live_stream_room_setting_attributes.auto_post_recording_enabled"),M=N("event_setting_attributes.ticket_type"),R=E===eB._d.PUBLIC_STREAM,D="event_setting_attributes.live_stream_room_setting_attributes.limit_url_sharing",L=(0,o.useRef)(null==d||null==(t=d.event_setting_attributes)?void 0:t.ticket_type),F=x&&L.current==M?null==d||null==(i=d.event_setting_attributes)||null==(n=i.live_stream_room_setting_attributes)?void 0:n.limit_url_sharing:M===j.Mj.PAID;return(0,o.useEffect)(function(){E===eB._d.PUBLIC_STREAM&&A(D,!1,{shouldDirty:!0})},[E,A]),(0,o.useEffect)(function(){A(D,F,{shouldDirty:!0})},[M,A]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-stretch",children:[(0,r.jsx)("div",{className:"w-1/2 pr-2",children:(0,r.jsx)(ep,{name:"event_setting_attributes.live_stream_room_setting_attributes.view_type",labelClassName:"mb-3 text-lg",translationRoot:"events.create.form",children:(0,r.jsx)(eF.b,{roomType:u})})}),(0,r.jsx)("div",{className:"w-1/2 pl-2",children:(0,r.jsx)(ep,{name:"event_setting_attributes.live_stream_room_setting_attributes.access_type",labelClassName:"mb-3 text-lg",translationRoot:"events.create.form",children:(0,r.jsx)(ez,{roomType:u,name:"event_setting_attributes.live_stream_room_setting_attributes.access_type"})})})]}),void 0!==s&&s&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)(ep,{name:"event_setting_attributes.live_stream_room_setting_attributes.recording_enabled",tooltipText:(0,v.t)("events.create_modal.event_setting_attributes.recording_enabled_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",isDisabled:w(),children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",disabled:w(),name:"event_setting_attributes.live_stream_room_setting_attributes.recording_enabled"})}),a&&(0,r.jsx)(ep,{name:"event_setting_attributes.live_stream_room_setting_attributes.auto_post_recording_enabled",tooltipText:(0,v.t)("events.create_modal.event_setting_attributes.auto_post_recording_enabled_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.live_stream_room_setting_attributes.auto_post_recording_enabled"})}),(0,r.jsx)(ep,{name:"event_setting_attributes.live_stream_room_setting_attributes.mute_on_join",inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.live_stream_room_setting_attributes.mute_on_join"})}),(0,r.jsx)(ep,{name:"event_setting_attributes.live_stream_room_setting_attributes.hide_participants_list",tooltipText:(0,v.t)("events.create.form.event_setting_attributes.live_stream_room_setting_attributes.hide_participants_list_tooltip"),inlineReverse:!0,translationRoot:"events.create.form",className:"!pt-1",labelClassName:"!font-normal",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.live_stream_room_setting_attributes.hide_participants_list"})})]}),(0,r.jsx)(ep,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:T?"events.create.form.live_location":"events.create.form",className:"!pt-1",labelClassName:"!font-normal",tooltipText:T&&(0,v.t)("events.create_modal.event_setting_attributes.hide_location_from_non_attendees_tooltip"),children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.hide_location_from_non_attendees"})}),_&&!R&&(0,r.jsx)(ep,{name:D,translationRoot:"events.create.form",tooltipText:(0,v.t)("events.create_modal.event_setting_attributes.limit_url_sharing_tooltip"),inlineReverse:!0,className:"!pt-1",labelClassName:"!font-normal",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:D})}),I&&(0,r.jsxs)("div",{className:"mt-12",children:[C&&(0,r.jsx)("div",{className:"px-1 text-justify",children:(0,r.jsx)(g.Z.BodyXs,{children:(0,v.t)("live_streams.form.upgrade_recording_hours_label",{hours:y+Number(O||0)})})}),!m&&(0,r.jsx)("div",{className:"px-1 text-justify",children:(0,r.jsx)(g.Z.BodyXs,{children:(0,v.t)("live_streams.form.upgrade_streaming_hours_label",{hours:b+Number(P||0)})})})]})]})},eH=n(73622),eV=function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ep,{name:"event_setting_attributes.virtual_location_url",rules:{required:(0,v.t)("events.create_modal.event_setting_attributes.virtual_location_required_error"),pattern:{value:eH.lu,message:(0,v.t)("events.create.form.virtual_location_url_error")}},translationRoot:"events.create.form",children:(0,r.jsx)(h.l.Input,{"data-testid":"url-event-location"})}),(0,r.jsx)(ep,{name:"event_setting_attributes.hide_location_from_non_attendees",inlineReverse:!0,translationRoot:"events.create.form",children:(0,r.jsx)(h.l.ToggleSwitch,{name:"event_setting_attributes.hide_location_from_non_attendees",variant:"small"})})]})},eQ=n(83730),eW=function(e){var t,n,i=e.setLocationType,a=e.event,s=!!a,l=(0,eQ.Y)().setRecordingEnabled,c=(0,ef.Gc)().setValue,u=(0,ef.qo)({name:"event_setting_attributes.location_type"}),d=(0,ef.qo)({name:"event_setting_attributes.live_stream_room_setting_attributes.recording_enabled"}),f=(0,ef.qo)({name:"event_setting_attributes.ticket_type"}),m=(0,o.useRef)(null==a||null==(t=a.event_setting_attributes)?void 0:t.ticket_type),p=s&&m.current==f?null==a||null==(n=a.event_setting_attributes)?void 0:n.hide_location_from_non_attendees:f===j.Mj.PAID;(0,o.useEffect)(function(){[j.Bq.TBD,j.Bq.IN_PERSON].includes(u)||c("event_setting_attributes.hide_location_from_non_attendees",p,{shouldDirty:!0})},[f,c,u]),(0,o.useEffect)(function(){i(u)},[u,i]),(0,o.useEffect)(function(){return l(d)},[d,l]);var b=u===j.Bq.LIVE_ROOM?eB.H0.CONFERENCE:eB.H0.STREAM;switch(u){case j.Bq.IN_PERSON:return(0,r.jsx)(eL,{});case j.Bq.VIRTUAL:return(0,r.jsx)(eV,{});case j.Bq.LIVE_ROOM:case j.Bq.LIVE_STREAM:return(0,r.jsx)(eZ,{recordingEnabled:d,showRecordingToggle:!0,roomTypeOverride:b,event:a});case j.Bq.TBD:default:return null}},eG=function(e){var t,n,o=e.event,i=e.setLocationType,a=(0,O.wh)().currentCommunity,s=null!=(t=null==a?void 0:a.supports_live_streams)&&t,l=null!=(n=null==a?void 0:a.white_label)&&n,c=[{label:(0,v.t)("events.create_modal.event_setting_attributes.location_type_in_person"),value:j.Bq.IN_PERSON},{label:(0,v.t)("events.create_modal.event_setting_attributes.location_type_virtual"),value:j.Bq.VIRTUAL},{label:l?(0,v.t)("events.location_types.live_stream"):(0,v.t)("events.create_modal.event_setting_attributes.location_type_live_stream"),value:j.Bq.LIVE_STREAM,hidden:!s},{label:l?(0,v.t)("events.location_types.live_room"):(0,v.t)("events.create_modal.event_setting_attributes.location_type_live_room"),value:j.Bq.LIVE_ROOM,hidden:!s},{label:(0,v.t)("events.create_modal.event_setting_attributes.location_type_tbd"),value:j.Bq.TBD}];return(0,r.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.create.form.event_location")}),(0,r.jsx)("div",{className:"flex items-stretch",children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(ep,{name:"event_setting_attributes.location_type",placeholder:(0,v.t)("events.create_modal.event_setting_attributes.location_type_placeholder"),rules:{required:(0,v.t)("events.create_modal.event_setting_attributes.location_required_error")},translationRoot:"events.create.form",children:(0,r.jsx)(h.l.AnimatedSelect,{name:"event_setting_attributes.location_type",fullWidth:!0,options:c,allowEmpty:!0,dataTestId:"event-location"})})})}),(0,r.jsx)(eW,{setLocationType:i,event:o})]})},e$=n(29378),eK=n(47075),eJ=function(){return(0,r.jsx)("div",{className:"bg-tertiary mb-16 mt-5 flex h-[208px] w-full items-center justify-center rounded-xl",children:(0,r.jsxs)("div",{className:"flex w-[300px] flex-col space-y-6 text-center",children:[(0,r.jsx)(g.Z.LabelLg,{weight:"medium",children:(0,v.t)("events.create.form.connect_to_stripe_description")}),(0,r.jsx)("div",{className:"mx-6",children:(0,r.jsx)(eK.Q,{href:"/settings/paywalls",variant:"circle",full:!0,children:(0,v.t)("events.create.form.connect_to_stripe")})})]})})},eX=n(34755),eY=n(65631),e0=n(51169),e1=n(92074),e2=n(2056),e3=function(e){var t=e.name,n=e.labelKey,o=e.placeholder,i=e.currency,a=e.isDisabled,s=(0,ef.Gc)().formState.errors[t];if(!i)return null;var l=(0,e1.Bj)(i,{amountInCents:!0}),c=function(e){return l(e)||l(0)||"0"},u=(0,v.t)("settings.paywalls.modal.tabs.pricing.add_price_modal.field_errors.amount",{min:(0,e2.I)(i,i.min_charge_amount,{amountInCents:!0,includeCurrencyCode:!1}),max:(0,e2.I)(i,i.max_charge_amount,{amountInCents:!0,includeCurrencyCode:!1})});return(0,r.jsx)(h.l.Item,{name:t,className:(0,d.A)({"border-red-500":s},"m-0 grow"),label:(0,v.t)("events.create.form.paywall_attributes.".concat(n)),placeholder:o||c(0),rules:{validate:{bounds:function(e){var t=(0,e1.LG)(e);return t>=(null==i?void 0:i.min_charge_amount)&&t<=(null==i?void 0:i.max_charge_amount)||u}}},transformValue:c,labelClassName:"mb-2 text-sm font-semibold leading-5 tighter normal-case text-dark",labelWrapperClassName:"m-0",errorClassName:"mt-1 text-red-500 text-sm",hideDescription:!0,hideBorder:!0,children:(0,r.jsx)(h.l.Input,{"data-testid":"ticket-price",disabled:a})})},e4=function(e){var t,n=e.event,o=(0,ef.Gc)().watch,i=!!n,a=n&&(0,j.Rv)(n),s=o("event_setting_attributes.ticket_type"),l=(0,j.yl)(n)||"paid"==s,c=(0,j.hA)(n),u=i&&l&&c&&!(0,j.mv)(n)||a||(0,j.f0)(n),d=o("paywall_attributes.currency_id")||(null==n||null==(t=n.paywall_attributes)?void 0:t.currency_id),f=(0,eY.K)(),m=f.data;if(f.isLoading)return(0,r.jsx)(e0.a,{});var p=null==m?void 0:m.find(function(e){return e.id.toString()===(null==d?void 0:d.toString())});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col items-stretch md:flex-row",children:[(0,r.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-2",children:(0,r.jsx)(e3,{name:"paywall_attributes.price_amount",labelKey:"price",currency:p,placeholder:(0,v.t)("events.create.form.paywall_attributes.price_placeholder"),isDisabled:a})}),(0,r.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-2",children:(0,r.jsx)(eX.H,{formItemName:"paywall_attributes.currency_id",formItemTranslationRoot:"events.create.form",disabled:u,markDefaultCurrencyDirty:!0})})]}),(0,r.jsx)("div",{className:"flex flex-col items-stretch",children:(0,r.jsx)(ep,{name:"paywall_attributes.description",rules:{maxLength:{value:0xffffff,message:(0,v.t)("events.create.form.paywall_attributes.description_length_error")}},placeholder:(0,v.t)("events.create.form.paywall_attributes.description_placeholder"),translationRoot:"events.create.form",children:(0,r.jsx)(h.l.TextArea,{name:"paywall_attributes.description","data-testid":"event-paywall-description",disabled:a})})})]})},e6=function(e){var t=e.event,n=(0,O.wh)().currentCommunity,o=(0,ef.qo)({name:"event_setting_attributes.ticket_type"});return o===j.Mj.FREE?null:o!==j.Mj.PAID||(0,e$.qF)(n)?(0,r.jsx)(e4,{event:t}):(0,r.jsx)(eJ,{})},e8=function(e){var t=e.event,n=(0,ef.Gc)().watch,o=(0,j.Rv)(t)||(0,j.f0)(t),i=n("event_setting_attributes.ticket_type"),a=n("event_setting_attributes.location_type"),s=i==j.Mj.PAID&&[j.Bq.LIVE_STREAM,j.Bq.LIVE_ROOM].includes(a),l=[{label:(0,v.t)("events.create_modal.event_setting_attributes.free_event"),value:j.Mj.FREE},{label:(0,v.t)("events.create_modal.event_setting_attributes.paid_event"),value:j.Mj.PAID}];return(0,r.jsxs)("div",{className:"my-6 md:mb-8 md:mt-16",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.create.form.event_ticket")}),(0,r.jsx)("div",{className:"flex items-stretch",children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(ep,{name:"event_setting_attributes.ticket_type",placeholder:(0,v.t)("events.create_modal.event_setting_attributes.ticket_type_placeholder"),rules:{required:(0,v.t)("events.create_modal.event_setting_attributes.ticket_type_required_error")},translationRoot:"events.create.form",children:(0,r.jsx)(h.l.AnimatedSelect,{name:"event_setting_attributes.ticket_type",fullWidth:!0,options:l,dataTestId:"event-ticket-type",disabled:o})})})}),s&&(0,r.jsxs)("div",{className:"bg-tertiary my-2.5 flex h-14 w-full flex-none items-center justify-start gap-x-3 rounded-lg",children:[(0,r.jsx)(T.JO,{type:"24-info",size:24,className:"ms-3"}),(0,r.jsx)(g.Z.LabelSm,{color:"bg-tertiary",children:(0,v.t)("events.create.form.event_setting_attributes.live_stream_room_setting_attributes.paid_event_warning_msg")})]}),(0,r.jsx)(e6,{event:t})]})};function e5(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var e9=function(e){var t,n,r,i=(0,O.wh)().currentCommunity,a=(0,ef.Gc)(),s=a.setValue,l=a.getValues,c="event_setting_attributes.live_stream_room_setting_attributes.access_type",u=(0,o.useRef)(null==e||null==(t=e.event_setting_attributes)?void 0:t.location_type),d=null==(n=l().event_setting_attributes)?void 0:n.location_type,f=(0,eS.m)().spaces,m=(0,ef.qo)({name:"space_id"}),p=(null==f?void 0:f.find(function(e){return e.id===m}))||null,b=["private","secret"].includes(null!=(r=null==p?void 0:p.visibility)?r:"")?eB._d.SECRET:eB._d.OPEN,h=(0,ef.qo)({name:c}),v=(0,o.useMemo)(function(){var t,n={access_type:b,view_type:eB.Bk.GRID,recording_enabled:null==i?void 0:i.live_stream_recording_enabled,auto_post_recording_enabled:!1,room_type:eB.H0.STREAM},r=null==e||null==(t=e.event_setting_attributes)?void 0:t.live_stream_room_setting_attributes;return r?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},n,r):n},[i,e,b]);return(0,o.useEffect)(function(){(0,j.UJ)(d)&&u.current!==d&&(Object.entries(v).forEach(function(e){var t=function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return e5(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e5(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=t[0],r=t[1];s("event_setting_attributes.live_stream_room_setting_attributes.".concat(n),r,{shouldDirty:!0,shouldTouch:!0})}),u.current=d),d===j.Bq.LIVE_ROOM&&h===eB._d.PUBLIC_STREAM&&s(c,eB._d.SECRET,{shouldDirty:!0})},[d,v,s]),{space:p}},e7=function(e){var t=e.event,n=e.setLocationType,o=e9(t).space,i=((0,O.wh)().currentCommunityMember||{}).is_admin;return(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.create.form.basic_info")}),(0,r.jsx)(eI,{event:t,canCreateTopics:!!o&&(0,eO.Y_)(o),requireTopicSelection:null==o?void 0:o.require_topic_selection}),(0,r.jsx)(eR,{event:t}),(0,r.jsx)(eG,{event:t,setLocationType:n}),i&&(0,r.jsx)(e8,{event:t})]})},te=n(5116),tt=function(){return(0,r.jsxs)("div",{className:"create-event-details__cover-image",children:[(0,r.jsx)("label",{children:(0,v.t)("events.create.form.cover_image")}),(0,r.jsx)(eg.D,{name:"cover_image",alt:"",customAspectRatioHelpText:(0,v.t)("image_upload.recommended_size_event_cover"),showAddCoverBtn:!0,customAddCoverBtn:(0,r.jsxs)("div",{className:"create-event-details__cover-image-add",children:[(0,r.jsx)("div",{className:"create-event-details__cover-image-add__icon-wrapper",children:(0,r.jsx)(T.JO,{type:"plus-big",viewBox:"0 0 20 20"})}),(0,r.jsx)("span",{className:"text-dark font-semibold",children:(0,v.t)("events.create.form.cover_image_upload")}),(0,r.jsx)("span",{className:"text-light mt-1 text-sm",children:(0,v.t)("events.create.form.event_cover_image_recommended_size")})]})})]})},tn=function(){var e=(0,o.useRef)(null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.edit_modal.details.title")}),(0,r.jsxs)("div",{className:"my-8",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.details.cover_image")}),(0,r.jsx)(tt,{})]}),(0,r.jsxs)("div",{className:"mb-8 mt-6 md:mt-12",children:[(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.details.description")}),(0,r.jsx)(ep,{name:"body",hideLabel:!0,children:(0,r.jsx)("div",{className:"trix-v2 event-description-wrapper trix-v2--modal-3 mt-2",children:(0,r.jsx)(te.O,{placeholder:(0,v.t)("events.edit_modal.details.description_placeholder"),id:"event-details-body",ref:e,name:"body"})})})]})]})},tr=n(88897),to=n(56070),ti=n(43557),ta=n(18e3),ts=n(91077),tl=n(55963),tc=n(25724),tu=n(54262),td=n(84208);function tf(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var tm=function(e){var t=e.shouldShowConfirmationModal,n=e.toggleConfirmationModal,o=e.handleSubmit,i=e.isLoading;return(0,r.jsx)(td.W,{isOpen:t,onClose:n,onAction:function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,o()];case 1:return e.sent(),n(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){tf(i,r,o,a,s,"next",e)}function s(e){tf(i,r,o,a,s,"throw",e)}a(void 0)})})()},actionText:(0,v.t)("scheduled_emails.delete.email"),title:(0,v.t)("scheduled_emails.delete.modal_title"),size:"sm",actionVariant:"danger",disabled:i,children:(0,r.jsx)("div",{className:"my-4 text-center",children:(0,v.t)("scheduled_emails.delete.modal_description")})})};function tp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tb=function(){var e,t=(e=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return tp(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tp(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],r=t[1];return{isOpen:n,openModal:function(){r(!0)},closeModal:function(){r(!1)}}},th=(0,o.createContext)(null);th.displayName="ScheduledEmailContext";var tv=function(e){var t,n=e.event,o=e.children,i=(0,tu.T)().getScheduledEmailList,a=String((null==n?void 0:n.id)||""),s=null==n||null==(t=n.event_setting_attributes)?void 0:t.starts_at,l=s?new Date(s):void 0,c=new Date,u=(0,M.useQuery)(["scheduled-email-list",a,s],function(){return i({record_id:a,scheduled_email_type:"event"})}),d=u.data,f=u.isLoading,m=u.refetch,p={event:n,scheduledEmailList:(null==d?void 0:d.records)||[],isLoading:f,maxDate:l,minDate:c,refetch:m,hasScheduledEmails:function(){var e;return!!(null==d||null==(e=d.records)?void 0:e.length)}};return(0,r.jsx)(th.Provider,{value:p,children:o})},ty=function(){var e=(0,o.useContext)(th);if(null===e)throw Error("useScheduledEmailContext must be used within a ScheduledEmailProvider");return e};function tg(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function t_(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){tg(i,r,o,a,s,"next",e)}function s(e){tg(i,r,o,a,s,"throw",e)}a(void 0)})}}function tx(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var tj=function(e){var t=e.scheduledEmail,n=e.disabled,o=tb(),i=o.isOpen,a=o.closeModal,s=o.openModal,l=tb(),c=l.isOpen,u=l.closeModal,d=l.openModal,f=ty(),m=f.event,p=f.refetch,b=f.maxDate,h=f.minDate,g=(0,tu.T)(),_=g.destroyScheduledEmail,x=g.isDestroyLoading;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(eq.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,r.jsx)(y.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,ariaLabel:(0,v.t)("events.event_actions"),dataTestId:"action-more",disabled:n}),transitionWrapperClassName:"z-50",size:"small",children:[(0,r.jsx)(eq.Lt.ItemWithLink,{onClick:s,linkType:"button",children:(0,v.t)("edit")}),(0,r.jsx)(eq.Lt.ItemWithLink,{onClick:d,linkType:"button",children:(0,r.jsx)("span",{className:"text-v2-danger",children:(0,v.t)("delete")})})]}),(0,r.jsx)(tc.D,{isDateDisabled:(0,j.VL)(m),isOpen:i,onClose:function(){return t_(function(){return tx(this,function(e){switch(e.label){case 0:return a(),[4,null==p?void 0:p()];case 1:return e.sent(),[2]}})})()},scheduledEmail:t,maxDate:b,minDate:h}),(0,r.jsx)(tm,{shouldShowConfirmationModal:c,toggleConfirmationModal:u,handleSubmit:function(){return t_(function(){return tx(this,function(e){switch(e.label){case 0:return[4,_(t)];case 1:return e.sent(),u(),[4,null==p?void 0:p()];case 2:return e.sent(),[2]}})})()},isLoading:x})]})},tw=function(e){var t=e.scheduledEmail,n=t.scheduled_at,o=t.metadata,i=t.subject,a=o.send_to,s=(0,(0,ef.Gc)().getValues)("event_setting_attributes.send_email_reminder")?"":"text-gray-400";return(0,r.jsxs)("div",{className:(0,d.A)("border-primary flex items-center gap-3 border-b py-4",s),children:[(0,r.jsx)("div",{className:"bg-tertiary flex h-12 w-12 items-center justify-center rounded-lg",children:(0,r.jsx)(T.JO,{type:"16-email",size:16})}),(0,r.jsxs)("div",{className:"grow",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"semibold",color:s,children:i}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(g.Z.LabelSm,{weight:"medium",color:s,children:[(0,v.t)("events.edit_modal.email.to",{send_to:(0,v.t)("scheduled_emails.form.".concat(a))}),(0,v.t)("events.edit_modal.email.separator")]}),(0,r.jsx)(g.Z.LabelSm,{weight:"medium",color:s||"text-light",children:(0,v.t)("events.edit_modal.email.scheduled_at",{scheduled_at:n&&(0,B.w)({dateTime:new Date(n),format:B.f.short_date_at_short_time})})})]})]}),(0,r.jsx)(tj,{scheduledEmail:t})]})},tO=function(){var e=ty(),t=e.isLoading,n=e.scheduledEmailList;return t?(0,r.jsx)(e0.a,{}):n&&0!==n.length?(0,r.jsx)(r.Fragment,{children:n.map(function(e){return(0,r.jsx)(tw,{scheduledEmail:e},e.id)})}):null};function tS(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function tP(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){tS(i,r,o,a,s,"next",e)}function s(e){tS(i,r,o,a,s,"throw",e)}a(void 0)})}}function tC(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var tI="event_setting_attributes.send_email_reminder",tk=function(e){var t,n,i=e.event,a=tb(),s=a.isOpen,l=a.openModal,c=a.closeModal,u=ty(),d=u.refetch,f=u.hasScheduledEmails,m=u.maxDate,p=u.minDate,b=(0,ef.Gc)(),y=b.getValues,_=b.setValue,x=(0,o.useMemo)(function(){return(0,tr.AW)((0,v.t)("events.edit_modal.email.email_body_default_text",{event_name:null==i?void 0:i.name}).replace(/[{}]/g,function(e){return"".concat(e).concat(e)}),[ti.Z,ts.Z,tl.Z,to.ZP,ta.Z])},[null==i?void 0:i.name]),w=(0,U.ZX)(null==i||null==(n=i.event_setting_attributes)||null==(t=n.starts_at)?void 0:t.toString(),-3600),O={record_id:String(null==i?void 0:i.id),scheduled_email_type:"event",scheduled_at:w,subject:(0,v.t)("events.edit_modal.email.default_subject").replace(/[{}]/g,function(e){return"".concat(e).concat(e)}),email_body:{body:x},enabled:(0,j.s9)(i),metadata:{send_to:"going",email_type:"reminder"}},S=y(tI);return(0,r.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.edit_modal.email.long_title")}),(0,r.jsxs)("div",{className:"md:my-3",children:[(0,r.jsx)(ep,{name:"event_setting_attributes.send_in_app_notification_reminder",tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.send_in_app_notification_reminder_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{name:"event_setting_attributes.send_in_app_notification_reminder",variant:"small"})}),(0,r.jsx)(ep,{name:tI,tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.send_scheduled_email_tooltip"),inlineReverse:!0,className:"!pb-0 [&>p]:absolute [&>p]:left-0 [&>p]:top-full [&>p]:!mt-0",rules:{validate:{bounds:function(e){return!e||!!f()||(0,v.t)("events.scheduled_email_error")}}},children:(0,r.jsx)(h.l.ToggleSwitch,{name:tI,variant:"small",onClick:function(){return tP(function(){return tC(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e){return setTimeout(e,0)})];case 1:if(e.sent(),!(S=y(tI))||f())return[2];return l(),[2]}})})()}})})]}),(0,r.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.email.schedule")})}),(0,r.jsx)(tO,{}),(0,r.jsx)(P.z,{type:"button",variant:"secondary",onClick:l,className:"mt-4 min-w-[96px]",disabled:!S||(0,j.VL)(i),children:(0,v.t)("events.edit_modal.email.add_reminder")}),(0,r.jsx)(tc.D,{isDateDisabled:(0,j.VL)(i),isOpen:s,onClose:function(){return tP(function(){var e,t;return tC(this,function(n){switch(n.label){case 0:return c(),[4,d()];case 1:return(null==(t=n.sent().data)||null==(e=t.records)?void 0:e.length)===0&&_(tI,!1,{shouldDirty:!0}),[2]}})})()},scheduledEmail:O,maxDate:m,minDate:p})]})},tN=function(e){var t=e.event;return(0,r.jsx)(tv,{event:t,children:(0,r.jsx)(tk,{event:t})})},tA=n(770),tE=function(){return(0,r.jsxs)(tA.t,{backgroundNone:!0,className:"!p-0 md:!px-4 md:!py-2",children:[(0,r.jsx)(ep,{name:"event_setting_attributes.confirmation_message_title",hideLabel:!0,children:(0,r.jsx)(h.l.Input,{})}),(0,r.jsx)(ep,{name:"event_setting_attributes.confirmation_message_description",hideLabel:!0,children:(0,r.jsx)(h.l.TextArea,{name:"event_setting_attributes.confirmation_message_description"})}),(0,r.jsx)(ep,{name:"event_setting_attributes.confirmation_message_button_title",hideLabel:!0,children:(0,r.jsx)(h.l.Input,{})}),(0,r.jsx)(ep,{name:"event_setting_attributes.confirmation_message_button_link",hideLabel:!0,children:(0,r.jsx)(h.l.Input,{})})]})},tT=function(e){var t=e.event,n=(0,ef.qo)({name:"event_setting_attributes.enable_custom_thank_you_message",defaultValue:(null==t?void 0:t.event_setting_attributes.enable_custom_thank_you_message)||!1}),i=c().setIsEmailNotificationsEnabled,a=(0,(0,ef.Gc)().getValues)("event_setting_attributes.send_email_confirmation");return(0,o.useEffect)(function(){i(a)},[a]),(0,r.jsxs)("div",{className:"mb-6 md:mb-12",children:[(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.edit_modal.notifications.title")}),(0,r.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.notifications.publish")})}),(0,r.jsx)(ep,{name:"event_setting_attributes.send_publish_email",tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.send_publish_email_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.send_publish_email"})}),(0,r.jsx)("div",{className:"mt-6 md:mb-3 md:mt-8",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.edit_modal.notifications.confirmation")})}),(0,r.jsx)(ep,{name:"event_setting_attributes.send_email_confirmation",tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.send_email_confirmation_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.send_email_confirmation"})}),(0,r.jsx)(ep,{name:"event_setting_attributes.send_in_app_notification_confirmation",tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.send_in_app_notification_confirmation_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.send_in_app_notification_confirmation"})}),(0,r.jsx)(ep,{name:"event_setting_attributes.enable_custom_thank_you_message",tooltipText:(0,v.t)("events.edit_modal.event_setting_attributes.enable_custom_thank_you_message_tooltip"),inlineReverse:!0,className:"!pb-0",children:(0,r.jsx)(h.l.ToggleSwitch,{variant:"small",name:"event_setting_attributes.enable_custom_thank_you_message"})}),n&&(0,r.jsx)(tE,{})]})},tM=n(70378),tR=n(44281),tD=function(e){var t=e.event,n=e.onClick,o=(0,tR.V)(t,j.a.PARTICIPANT,3),i=o.records,a=o.totalRecordCount,s=a||(0,v.t)("events.edit_modal.overview.zero");return(0,r.jsxs)("button",{type:"button",className:"border-primary flex h-full w-full cursor-pointer flex-col justify-between rounded-lg border p-4",onClick:n,"aria-label":(0,v.t)("events.edit_modal.overview.rsvps"),children:[(0,r.jsxs)("div",{className:"mb-2 flex w-full items-start justify-between",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,v.t)("events.edit_modal.overview.rsvps")}),(0,r.jsx)(tM.v,{users:i,totalCount:a,size:"md"})]}),(0,r.jsx)(g.Z.TitleMd,{children:s})]})},tL=function(e){var t=e.event,n=e.onClick,o=(0,tR.V)(t,j.a.COHOST,3),i=o.records,a=o.totalRecordCount,s=a||(0,v.t)("events.edit_modal.overview.zero");return(0,r.jsxs)("button",{type:"button",className:"border-primary flex h-full w-full cursor-pointer flex-col justify-between rounded-lg border p-4",onClick:n,"aria-label":(0,v.t)("events.edit_modal.overview.cohosts"),children:[(0,r.jsxs)("div",{className:"mb-2 flex w-full items-start justify-between",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,v.t)("events.edit_modal.overview.cohosts")}),(0,r.jsx)(tM.v,{users:i,totalCount:a,size:"md"})]}),(0,r.jsx)(g.Z.TitleMd,{children:s})]})},tF=n(85122),tU=n(98363),tB=function(e){var t=e.name,n=e.avatarUrl,o=e.email,i=e.rsvpDate,a=(0,tF.ie)(i,{year:"numeric",month:"short",day:"numeric"});return(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{className:"flex items-center pt-6",children:[(0,r.jsx)("div",{className:"mr-4",children:(0,r.jsx)(tU.s,{name:t,src:n,size:"8"})}),(0,r.jsx)(g.Z.LabelSm,{weight:"semibold",color:"text-dark",children:t})]}),(0,r.jsx)("td",{className:"hidden pt-6 md:[display:revert]",children:(0,r.jsx)(g.Z.LabelSm,{color:"text-light",children:o})}),(0,r.jsx)("td",{className:"pt-6",children:(0,r.jsx)(g.Z.LabelSm,{color:"text-light",children:a})})]})},tq=function(){return(0,r.jsx)("div",{className:"flex h-64 w-full flex-col items-center justify-center",children:(0,r.jsx)(g.Z.TitleSm,{weight:"semibold",children:(0,v.t)("events.edit_modal.overview.empty_rsvp")})})},tz=function(e){var t=e.event,n=(0,tR.V)(t,j.a.PARTICIPANT,10),o=n.isLoading,i=n.records;return(0,r.jsxs)("div",{className:"border-primary w-full rounded-lg border p-4",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"medium",color:"text-light",children:(0,v.t)("events.edit_modal.overview.latest_rsvps")}),(null==i?void 0:i.length)>0&&(0,r.jsxs)("table",{className:"mt-6 w-full",children:[(0,r.jsxs)("thead",{className:"text-xxs text-light uppercase",children:[(0,r.jsx)("th",{children:(0,v.t)("events.edit_modal.overview.name")}),(0,r.jsx)("th",{className:"hidden md:[display:revert]",children:(0,v.t)("events.edit_modal.overview.email")}),(0,r.jsx)("th",{children:(0,v.t)("events.edit_modal.overview.rsvp_date")})]}),(0,r.jsx)("tbody",{children:i.map(function(e){return(0,r.jsx)(tB,{name:e.name,avatarUrl:e.avatar_url,email:e.email,rsvpDate:e.rsvp_date},e.id)})})]}),!o&&!(null==i?void 0:i.length)&&(0,r.jsx)(tq,{})]})},tZ=n(52723),tH=function(e){var t,n,r=e.event,o=(0,ef.Gc)(),i=o.formState.dirtyFields,a=(0,o.watch)(),s=a.name,l=a.event_setting_attributes,c=(null==i||null==(t=i.event_setting_attributes)?void 0:t.duration_in_seconds)||(null==i||null==(n=i.event_setting_attributes)?void 0:n.starts_at),u=r||{},d=u.event_setting_attributes,f=u.share_post_enabled,m=(null==l?void 0:l.starts_at)||(null==d?void 0:d.starts_at),p=c?(0,U.ZX)(m,null==l?void 0:l.duration_in_seconds):null==d?void 0:d.ends_at,b=null==d?void 0:d.time_zone_abbreviations,h=null==d?void 0:d.time_zone,v=(0,tZ.N)(m,h);return{name:s,startsAt:m,endsAt:p,timeZoneAbbreviations:b,timeZone:h,dayOfMonth:v.dayOfMonth,shortMonthString:v.shortMonthString,sharePostEnabled:f}},tV=n(20640),tQ=n.n(tV),tW=n(60878),tG=function(e){var t=e.label,n=void 0===t?(0,v.t)("share_link.label"):t,o=e.link,i=void 0===o?window.location.href:o,a=(0,tW.pm)().success;return(0,r.jsxs)("button",{type:"button",className:"flex cursor-pointer items-center",onClick:function(){tQ()(i),a((0,v.t)("share_link.copied"),{duration:"short",shouldUseProgress:!1})},children:[(0,r.jsx)(g.Z.LabelSm,{weight:"medium",children:n}),(0,r.jsx)(T.JO,{type:"16-copy",size:16,className:"ml-1","aria-hidden":!0})]})},t$=function(e){var t=e.event||{},n=t.slug,o=t.space_slug,i=(0,D.LM)({spaceSlug:o,slug:n}),a="".concat(window.location.origin).concat(i);return(0,r.jsx)(tG,{label:(0,v.t)("events.edit_modal.overview.copy_url"),link:a})},tK=function(e){var t=e.event||{},n=t.share_uid,o=t.space_slug,i=(0,D.LM)({spaceSlug:o,slug:n}),a="".concat(window.location.origin).concat(i);return(0,r.jsx)(tG,{label:(0,v.t)("events.edit_modal.overview.copy_public_url"),link:a})},tJ=function(e){var t,n,o,i=e.event,a=null==i||null==(t=i.event_setting_attributes)?void 0:t.live_stream_slug,s=null==i||null==(o=i.event_setting_attributes)||null==(n=o.live_stream_room_setting_attributes)?void 0:n.limit_url_sharing,l=D.dE.room({roomSlug:a}),c=window.location.origin,u=S().hasLimitUrlSharingEnabled;return a?(0,r.jsxs)("div",{className:"flex",children:[u&&s?null:(0,r.jsx)(tG,{label:(0,v.t)("events.edit_modal.overview.copy_live_room_url"),link:c+l}),(0,j.L6)(i)&&(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)(tG,{label:(0,v.t)("events.edit_modal.overview.copy_live_stream_url"),link:c+D.dE.publicRoom({roomSlug:a})})})]}):null},tX=function(e){var t=e.event||{},n=t.slug,o=t.space_slug;return(0,r.jsxs)("button",{type:"button",className:"flex items-center",onClick:function(){window.open((0,D.LM)({spaceSlug:o,slug:n}),"_blank")},children:[(0,r.jsx)(g.Z.LabelSm,{weight:"medium",children:(0,v.t)("events.edit_modal.overview.view_event")}),(0,r.jsx)(T.JO,{type:"16-arrow-top-right",size:16,"aria-hidden":!0})]})},tY=function(e){var t=e.event,n=tH({event:t}),o=n.name,i=n.startsAt,a=n.endsAt,s=n.timeZoneAbbreviations,l=n.timeZone,c=n.dayOfMonth,u=n.shortMonthString,d=n.sharePostEnabled;return(0,f.kK)()?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z.TitleXl,{children:o}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(T.JO,{type:"16-calendar",size:16,className:"mr-3"}),(0,r.jsx)(g.Z.LabelSm,{children:"".concat(u," ").concat(c," \xb7 ").concat((0,tF.Dk)(i,l)," - ").concat((0,tF.Dk)(a,l),"  ").concat(s)})]})}),(0,r.jsxs)("div",{className:"mt-7 flex items-center",children:[(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(tX,{event:t})}),(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(t$,{event:t})}),d&&(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(tK,{event:t})}),(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(tJ,{event:t})})]})]})},t0=function(e){var t=e.event,n=(0,m.eW)().setCurrentSection,o=function(){return n(j.SA.people)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tY,{event:t}),(0,r.jsxs)("div",{className:"my-4 flex flex-col items-stretch gap-4 md:my-6 md:flex-row",children:[(0,r.jsx)("div",{className:"w-full pr-0 md:w-1/2 md:pr-3",children:(0,r.jsx)(tD,{event:t,onClick:o})}),(0,r.jsx)("div",{className:"w-full pl-0 md:w-1/2 md:pl-3",children:(0,r.jsx)(tL,{event:t,onClick:o})})]}),(0,r.jsx)("div",{className:"mt-4 md:my-6",children:(0,r.jsx)(tz,{event:t})})]})},t1=n(40432),t2=n(51630),t3=function(e){var t=e.event,n=(0,tW.pm)(),r=n.success,o=n.error,i=(0,M.useMutation)(function(){return t2.S1.downloadCSV({event:t})},{onSuccess:function(e){return r(null==e?void 0:e.message)},onError:function(){return o((0,v.t)("something_went_wrong"))}}).mutate;return function(e){e.preventDefault(),i()}},t4=function(e){var t=t3({event:e.event});return(0,r.jsxs)(P.z,{onClick:t,variant:"link",className:"!text-dark !flex !items-center !px-0 !text-sm !font-normal",children:[(0,r.jsx)("span",{className:"mr-2",children:(0,v.t)("events.edit_modal.people.download_csv")}),(0,r.jsx)(T.JO,{type:"download",size:20})]})},t6=n(10194),t8=function(){return(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(g.Z.LabelSm,{children:(0,v.t)("events.edit_modal.people.add_attendees_warning_message")})})},t5=function(e){var t=e.event,n=e.onSuccess,r=(0,tW.pm)(),o=r.success,i=r.error,a=(0,M.useQueryClient)();return{removeCohostMutation:(0,M.useMutation)(function(e){return t2.S1.removeAttendeeById({event:t,attendeeId:e})},{onSuccess:function(){o((0,v.t)("events.event_attendee_deleted")),a.invalidateQueries("events-people-cohost"),a.invalidateQueries("events-people-participant"),n&&n()},onError:function(){return i((0,v.t)("events.can_not_delete_event_attendee"))}})}},t9=function(e){var t=e.event,n=e.attendeeId,o=e.onRemove,i=e.accessType,a=e.setSelectedAttendeeId,s=e.setShouldShowAttendeeRemovalConfirmation,l=t5({event:t,onSuccess:function(){return o(n)}}).removeCohostMutation,c="invited"===i||!(0,j.yl)(t),u=function(e){c?l.mutate(e):(a(e),s(!0))},d=c?(0,v.t)("remove_member"):(0,v.t)("manage_attendee");return(0,r.jsx)(eq.Lt,{direction:"bottom-end",className:"flex justify-end",button:(0,r.jsx)(eq.Lt.MenuButton,{className:"invisible w-full group-hover:visible",children:(0,r.jsx)(T.JO,{type:"20-menu-dots-horizontal",size:20,className:"text-dark"})}),children:(0,r.jsx)(eq.Lt.Item,{onClick:function(){return u(n)},children:(0,r.jsx)(eq.Lt.ItemLink,{type:"button",children:d})})})},t7=n(47190),ne=n(65477),nt=n(34519),nn=function(e){var t=e.isOpen,n=e.onClose,o=e.removeAttendeeMutation,i=e.attendeeId,a=e.charge,s=(null==a?void 0:a.amount_to_refund_raw)>0,l=(0,ne.q)(),c=function(e){o(e),n()},u=function(){c(i)};return(0,r.jsxs)(nt.u_,{title:(0,v.t)("events.rsvp.remove_member_modal.title"),isOpen:void 0!==t&&t,onClose:n,children:[(0,r.jsx)(nt.u_.Overlay,{}),(0,r.jsxs)(nt.u_.Content,{children:[(0,r.jsxs)(nt.u_.Header,{children:[(0,r.jsx)(nt.u_.Title,{size:"md",className:"text-center",children:(0,v.t)("events.rsvp.remove_member_modal.title")}),(0,r.jsx)(nt.u_.HeaderActions,{children:(0,r.jsx)(nt.u_.CloseButton,{onClick:n})})]}),(0,r.jsx)(nt.u_.Body,{children:(0,r.jsx)("div",{className:"px-6 pb-4 pt-5 text-center",children:(0,r.jsx)(g.Z.BodyMd,{size:"text-sm",children:(0,v.t)("events.rsvp.remove_member_modal.description")})})}),(0,r.jsxs)(nt.u_.Footer,{className:"space-y-2",children:[(0,r.jsx)(P.z,{variant:"secondary",full:!0,large:!0,onClick:function(){return c(i)},className:"h-10",children:(0,v.t)("events.rsvp.remove_member_modal.remove_button")}),s&&(0,r.jsx)(P.z,{variant:"secondary",full:!0,large:!0,onClick:function(){return l.show({charge:a,onSuccess:n})},className:"h-10",children:(0,v.t)("events.rsvp.remove_member_modal.refund_button")}),s&&(0,r.jsx)(P.z,{variant:"danger",full:!0,large:!0,onClick:function(){return l.show({charge:a,onSuccess:u})},className:"h-10",children:(0,v.t)("events.rsvp.remove_member_modal.remove_and_refund_button")}),!s&&(0,r.jsx)(P.z,{variant:"secondary",full:!0,large:!0,onClick:n,className:"h-10",children:(0,v.t)("events.rsvp.remove_member_modal.decline_button")})]})]})]})},nr=n(66403);function no(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ni(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return no(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return no(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var na=function(e,t,n,r){if(e||r)return t?n?"yes":void 0:n?"yes":"invited"},ns=function(e){var t,n,i=e.records,a=e.event,s=e.onChange,l=t5({event:a,onSuccess:s}).removeCohostMutation,u=ni((0,o.useState)(null),2),d=u[0],f=u[1],m=ni((0,o.useState)(!1),2),p=m[0],b=m[1],h=(0,ef.cl)().dirtyFields,v=(0,ef.Gc)().getValues,y=c().isUpdatingAttendees,_=(null==(t=h.event_setting_attributes)?void 0:t.auto_rsvp_invited_attendees)!==void 0&&(null==(n=h.event_setting_attributes)?void 0:n.auto_rsvp_invited_attendees),x=v("event_setting_attributes.auto_rsvp_invited_attendees"),w=na(_,(0,j.s9)(a),x,y);if(!(null==i?void 0:i.length))return null;var O=i.find(function(e){return e.id===d}),S=null==O?void 0:O.charge;return(0,r.jsxs)("div",{className:"flex w-full flex-col",children:[(null==i?void 0:i.length)>0&&(0,r.jsx)("hr",{}),null==i?void 0:i.map(function(e){var t=e.id,n=e.avatar_url,i=e.name,l=e.email,c=e.rsvp_date,u=e.rsvp_status,d=e.public_uid,m=e.access_type;return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsxs)("div",{className:"hover:bg-secondary group flex h-14 items-center rounded-md px-2",children:[(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(t7.o,{member:{name:i,public_uid:d},children:(0,r.jsx)(tU.s,{src:n,name:i,size:"8"})})}),(0,r.jsx)("div",{className:"w-1/2 shrink-0 md:w-1/3",children:(0,r.jsx)(t7.o,{member:{name:i,public_uid:d},children:(0,r.jsx)(es.Y,{children:(0,r.jsx)(g.Z.LabelSm,{weight:"semibold",children:i})})})}),(0,r.jsx)("div",{className:"hidden w-1/4 shrink-0 md:[display:revert]",children:(0,r.jsx)(es.Y,{children:(0,r.jsx)(g.Z.LabelSm,{children:l})})}),(0,r.jsx)("div",{className:"w-1/2 text-right md:w-1/4",children:(0,r.jsx)(g.Z.LabelSm,{children:(0,tF.ie)(c,{day:"numeric",month:"long",year:"numeric",timeZone:void 0})})}),(0,r.jsxs)("div",{className:"mx-2 flex w-24 shrink-0 justify-end",children:[w&&(0,r.jsx)(nr.j,{rsvpStatus:w}),!w&&(0,r.jsx)(nr.j,{rsvpStatus:u})]}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(t9,{event:a,attendeeId:t,onRemove:s,accessType:m,setSelectedAttendeeId:f,setShouldShowAttendeeRemovalConfirmation:b})})]}),(0,r.jsx)("hr",{})]},t)}),(0,j.yl)(a)&&(0,r.jsx)(nn,{isOpen:p,onClose:function(){return b(!1)},removeAttendeeMutation:l.mutate,attendeeId:d,charge:S})]})},nl=n(98869);function nc(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var nu=function(e){var t=e.event,n=(0,tR.V)(t,j.a.PARTICIPANT),i=n.records,a=n.refetch,s=n.fetchPrevPage,l=n.fetchNextPage,u=n.hasPrevPage,d=n.hasNextPage,f=n.totalRecordCount,m=n.totalConfirmedRecordCount,p=n.addAttendeesAsync,b=n.startRecordNumber,y=n.endRecordNumber,_=(0,ef.Gc)(),x=_.resetField,w=_.watch,O=c().setIsAutoRsvpInvitedAttendees,S=w("event_setting_attributes.auto_rsvp_invited_attendees");return(0,o.useEffect)(function(){O(S||!1)},[S,O]),(0,r.jsxs)("div",{className:"flex h-full flex-col items-stretch pt-4",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"semibold",children:"".concat(m||0," ").concat((0,v.t)("events.edit_modal.people.attendees"))}),(0,r.jsx)(ep,{name:"attendee_invite_attributes.invited_entities_ids",className:"!w-auto",hideLabel:!0,children:(0,r.jsx)(t6.l,{name:"attendee_invite_attributes.invited_entities_ids",variant:"button",buttonLabel:(0,v.t)("events.edit_modal.people.add_attendees"),selectionLabel:(0,v.t)("events.edit_modal.people.attendees_selection_label"),searchPlaceholder:(0,v.t)("events.edit_modal.people.attendees_placeholder"),modalSaveButtonLabel:(0,v.t)("save"),onModalSave:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(!e||"spaces_ids"in e&&!e.spaces_ids.length&&!e.space_groups_ids.length&&!e.member_tags_ids.length&&!e.members_ids.length)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,p({invited_entities_ids:e})];case 2:return t.sent(),x("attendee_invite_attributes.invited_entities_ids"),[3,4];case 3:return console.error(t.sent()),[3,4];case 4:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){nc(i,r,o,a,s,"next",e)}function s(e){nc(i,r,o,a,s,"throw",e)}a(void 0)})})()},renderAfterSelection:(0,r.jsx)(t8,{}),includeAllResultTypes:!0})})]}),(0,r.jsx)("div",{className:"mb-3 mt-2",children:(0,r.jsx)(ep,{name:"event_setting_attributes.auto_rsvp_invited_attendees",tooltipText:(null==t?void 0:t.disable_auto_rsvp_attendees)?(0,v.t)("events.edit_modal.event_setting_attributes.auto_rsvp_invited_attendees_tooltip_disabled"):(0,v.t)("events.edit_modal.event_setting_attributes.auto_rsvp_invited_attendees_tooltip"),inlineReverse:!0,className:"!pb-0",tooltipTextClassName:"text-center",labelClassName:(null==t?void 0:t.disable_auto_rsvp_attendees)?"text-tertiary":"",children:(0,r.jsx)(h.l.ToggleSwitch,{name:"event_setting_attributes.auto_rsvp_invited_attendees",variant:"small",disabled:null==t?void 0:t.disable_auto_rsvp_attendees})})}),(0,r.jsx)("div",{className:"mt-4"}),(null==i?void 0:i.length)>0&&(0,r.jsx)(ns,{event:t,records:i,onChange:a}),f>0&&(0,r.jsx)(nl.t,{startRecordNumber:b,endRecordNumber:y,totalRecordCount:f,fetchPrevPage:s,fetchNextPage:l,hasPrevPage:u,hasNextPage:d})]})},nd=function(e){var t=(0,(0,ef.Gc)().watch)().event_setting_attributes,n=(e||{}).event_setting_attributes;return{locationType:(null==t?void 0:t.location_type)||(null==n?void 0:n.location_type),formEventData:t,eventData:n}},nf=n(1924);function nm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function np(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var nb=function(e){var t,n=e.event,i=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return nm(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nm(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1],l=(0,tR.V)(n,j.a.COHOST),c=l.records,u=l.refetch,d=l.fetchPrevPage,f=l.fetchNextPage,m=l.hasPrevPage,p=l.hasNextPage,b=l.totalRecordCount,h=l.totalConfirmedRecordCount,y=l.addAttendeesAsync,_=l.startRecordNumber,x=l.endRecordNumber,w=(0,ef.Gc)().resetField,O=nd(n).locationType,S=null==c?void 0:c.map(function(e){return e.community_member_id}),P=O===em.Bq.LIVE_STREAM||O===em.Bq.LIVE_ROOM;return(0,r.jsxs)("div",{className:"flex h-full flex-col items-stretch pt-4",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(g.Z.LabelMd,{weight:"semibold",children:"".concat(h||0," ").concat((0,v.t)("events.edit_modal.people.cohosts"))}),(0,r.jsx)(ep,{name:"attendee_invite_attributes.invited_cohost_ids",className:"!w-auto",hideLabel:!0,children:(0,r.jsx)(t6.l,{name:"attendee_invite_attributes.invited_cohost_ids",variant:"button",countLabel:(0,v.t)("events.edit_modal.people.cohosts_added_label"),selectionLabel:(0,v.t)("events.edit_modal.people.cohosts_selection_label"),searchPlaceholder:(0,v.t)("events.edit_modal.people.cohosts_placeholder"),disableSearch:a,excludedMemberIds:S,modalSaveButtonLabel:(0,v.t)("save"),allowCurrentCommunityMember:!0,onModalSave:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(!e)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,y({community_member_ids:e,role:j.a.COHOST})];case 2:return t.sent(),w("attendee_invite_attributes.invited_cohost_ids"),[3,4];case 3:return console.error(t.sent()),[3,4];case 4:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){np(i,r,o,a,s,"next",e)}function s(e){np(i,r,o,a,s,"throw",e)}a(void 0)})})()},renderAfterSelection:P?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t8,{}),(0,r.jsx)(nf.b,{setIsLimitReached:s,initialCohostQuantity:b+eB.ln,shouldDisplayDisabledSearchMessage:a})]}):(0,r.jsx)(t8,{})})})]}),(0,r.jsx)("div",{className:"mt-4"}),(null==c?void 0:c.length)>0&&(0,r.jsx)(ns,{event:n,records:c,onChange:u}),b>0&&(0,r.jsx)(nl.t,{startRecordNumber:_,endRecordNumber:x,totalRecordCount:b,fetchPrevPage:d,fetchNextPage:f,hasPrevPage:m,hasNextPage:p})]})},nh=function(e){var t=e.event,n=e.currentTab;switch(null==n?void 0:n.key){case j.n4.COHOSTS:return(0,r.jsx)(nb,{event:t});case j.n4.ATTENDEES:default:return(0,r.jsx)(nu,{event:t})}},nv=n(78456),ny=function(){var e,t=(0,O.wh)(),n=t.currentCommunityMember,r=t.currentCommunitySettings,o=(0,O.L2)().data,i=(0,nv.vb)(n),a=!!(null==o||null==(e=o.policies)?void 0:e.can_manage_space),s=null==r?void 0:r.allow_moderator_csv_download;return i||a&&s};function ng(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var n_=function(e){var t,n=[{label:(0,v.t)("events.edit_modal.people.attendees"),key:j.n4.ATTENDEES}];e||n.push({label:(0,v.t)("events.edit_modal.people.cohosts"),key:j.n4.COHOSTS});var r=n.find(function(e){return e.label===(0,v.t)("events.edit_modal.people.attendees")}),i=(t=(0,o.useState)(r),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return ng(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ng(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1];return{tabs:n,currentTab:a,onTabClick:function(e){s(n.find(function(t){return t.label===e}))}}},nx=function(e){var t=e.event,n=n_((0,j.dy)(t)),o=n.onTabClick,i=n.currentTab,a=n.tabs,s=ny()&&(null==i?void 0:i.key)===j.n4.ATTENDEES;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z.TitleXl,{children:(0,v.t)("events.create.form.people")}),(null==i?void 0:i.label)&&(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(t1.m,{variant:"underline",className:"sticky",wrapperClassName:"overflow-x-auto overflow-y-hidden",controlled:!0,activeTab:i.label,onClick:o,options:a}),s&&(0,r.jsx)("div",{className:"absolute bottom-2 right-0",children:(0,r.jsx)(t4,{event:t})})]}),(0,r.jsx)(nh,{event:t,currentTab:i})]})},nj=n(92394),nw=function(e){var t,n,i,a,s=e.event,l=e.triggerValidationRef,c=e.setValueRef,u=e.setIsDirty,d=e.setLocationType,f=e.locationType,p=e.isLiveLocation,b=e.setStartsAtDirty,h=e.setPaywallAttributesDirty,v=e.setRepeatsDirty,y=e.setFormScheduleValues,g=(0,m.eW)().currentSection,_=(0,ef.Gc)(),x=_.trigger,w=_.setValue,S=_.formState.dirtyFields,P=(0,ef.qo)({name:"event_setting_attributes.starts_at"}),C=(0,ef.qo)({name:"event_setting_attributes.ends_at"}),I=(0,ef.qo)({name:"recurring_setting_attributes.frequency"});(0,o.useEffect)(function(){var e,t,n,r=function(e){var t;return(null!=(t=Date)&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t)?e.toUTCString():e};y({startsAt:P||(null==s||null==(e=s.event_setting_attributes)?void 0:e.starts_at)||"",endsAt:r(C)||r(null==s||null==(t=s.event_setting_attributes)?void 0:t.ends_at)||"",frequency:I||(null==s||null==(n=s.recurring_setting_attributes)?void 0:n.frequency)||""})},[P,C,I,s,y]),(0,o.useEffect)(function(){l&&x&&(l.current=x)},[l,x]),(0,o.useEffect)(function(){c&&w&&(c.current=w)},[c,w]);var k=Object.values(S),N=!!(null==S||null==(t=S.event_setting_attributes)?void 0:t.starts_at),A=!!(null==S||null==(n=S.paywall_attributes)?void 0:n.price_amount)||!!(null==S||null==(i=S.paywall_attributes)?void 0:i.description),E=!!(null==S||null==(a=S.recurring_setting_attributes)?void 0:a.frequency);(0,o.useEffect)(function(){u(null==k?void 0:k.some(function(e){return!!e}))},[u,k]),(0,o.useEffect)(function(){b(N)},[b,N]),(0,o.useEffect)(function(){h(A)},[h,A]),(0,o.useEffect)(function(){v(E)},[v,E]);var T=(0,eQ.Y)().limitsReachedIsOpen;return(0,r.jsxs)(r.Fragment,{children:[p&&T&&(0,r.jsx)(nj.l,{roomType:function(){switch(f){case em.Bq.LIVE_STREAM:return eB.H0.STREAM;case em.Bq.LIVE_ROOM:return eB.H0.CONFERENCE;default:return eB.H0.STREAM}}()}),(0,r.jsxs)("div",{className:"p-4 md:p-6 lg:py-8",children:[g===j.SA.overview&&(0,r.jsx)(t0,{event:s}),g===j.SA.people&&(0,r.jsx)(O.mE,{spaceId:null==s?void 0:s.space_id,children:(0,r.jsx)(nx,{event:s})}),g===j.SA.basicInfo&&(0,r.jsx)(e7,{event:s,setLocationType:d}),g===j.SA.details&&(0,r.jsx)(tn,{}),g===j.SA.notifications&&(0,r.jsx)(tT,{event:s}),g===j.SA.email&&(0,r.jsx)(tN,{event:s}),g===j.SA.advancedOptions&&(0,r.jsx)(ew,{event:s})]})]})},nO=function(e){var t=e.event,n=e.isCreating,o=e.isDirty,i=e.onSubmit,a=e.locationType,s=e.isStartsAtDirty,l=e.shouldHideAllEventOption,c=e.isRepeatsDirty,u=e.formScheduleValues,d=(0,m.eW)(),f=d.isSaving,p=d.onExit,b=(0,eQ.Y)(),h=b.streamingHoursAvailable,y=b.limitsReachedOnOpen,g=b.recordingHoursReached,_=function(e){e.preventDefault(),y()},x=a===em.Bq.LIVE_STREAM||a===em.Bq.LIVE_ROOM;return(0,r.jsx)(r.Fragment,{children:!n&&(0,r.jsxs)("div",{className:"ml-auto flex space-x-4",children:[x&&!h&&g?(0,r.jsxs)("div",{className:"flex justify-start",children:[(0,r.jsx)("button",{type:"button",className:"mr-1 cursor-pointer underline",onClick:_,children:(0,v.t)("live_streams.form.two_upgrades")}),(0,r.jsx)("p",{children:(0,v.t)("live_streams.form.included")})]}):x&&(!h||g)?(0,r.jsxs)("div",{className:"flex justify-start",children:[(0,r.jsx)("button",{type:"button",className:"mr-1 cursor-pointer underline",onClick:_,children:(0,v.t)("live_streams.form.one_upgrade")}),(0,r.jsx)("p",{children:(0,v.t)("live_streams.form.included")})]}):null,o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.z,{type:"button",onClick:p,variant:"secondary",children:(0,v.t)("cancel")}),(0,r.jsx)(et,{type:"submit",variant:"circle",disabled:f,onEditModeConfirm:i,event:t,isRecurringEvent:(0,j.f0)(t),isStartsAtDirty:s,isRepeatsDirty:c,shouldHideAllEventOption:l,formScheduleValues:u,children:t?(0,v.t)("save_changes"):(0,v.t)("save_draft")})]})]})})},nS=function(){return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-52",children:[(0,r.jsx)("div",{className:"override-svg-width",children:(0,r.jsx)(e0.a,{})}),(0,r.jsx)("div",{className:"mb-4 text-center",children:(0,r.jsx)(g.Z.TitleMd,{children:(0,v.t)("events.create_modal.creating_event")})}),(0,r.jsx)("div",{className:"mb-4 text-center",children:(0,r.jsx)(g.Z.LabelMd,{children:(0,v.t)("events.create_modal.creating_event_message")})})]})},nP={strategy:"fixed",modifiers:[{name:"offset",options:{offset:[0,-1]}}]},nC=function(e){var t,n=e||{},r=n.slug,o=n.space_slug,i=(0,tW.pm)().success,a=(0,D.LM)({spaceSlug:o,slug:r}),s="".concat(window.location.origin).concat(a),l=null==e||null==(t=e.event_setting_attributes)?void 0:t.live_stream_slug,c=D.dE.room({roomSlug:l}),u=window.location.origin;return{onViewEvent:function(){window.open(a,"_blank")},onCopyLink:function(e){tQ()(e),i((0,v.t)("share_link.copied"),{duration:"short",shouldUseProgress:!1})},eventUrl:s,liveRoomUrl:"".concat(u).concat(c),publicLiveRoomUrl:"".concat(u).concat(D.dE.publicRoom({roomSlug:l}))}},nI=function(e){var t,n=e.event,i=nC(n),a=i.onViewEvent,s=i.onCopyLink,l=i.eventUrl,c=i.liveRoomUrl,u=(null==n||null==(t=n.event_setting_attributes)?void 0:t.live_stream_slug)||"",d=window.location.origin+D.dE.publicRoom({roomSlug:u}),f=(0,j.dy)(n)?(0,v.t)("events.edit_modal.overview.copy_live_room_url"):(0,v.t)("events.edit_modal.overview.copy_live_stream_url"),m=(0,j.dy)(n)?c:d,p=[{label:(0,v.t)("events.edit_modal.overview.view_event"),onClick:a,iconName:"16-arrow"},{label:(0,v.t)("events.edit_modal.overview.copy_url"),onClick:function(){return s(l)},iconName:"16-copy"},{label:f,onClick:function(){return s(m)},iconName:"16-copy",disabled:!u}];return(0,r.jsx)(eq.Lt,{size:"medium",direction:"bottom-start",button:(0,r.jsx)(y.h,{name:"16-menu-dots-horizontal",className:"!text-dark",ariaLabel:(0,v.t)("options_dropdown")}),buttonWrapperClassName:"flex items-center ml-4",popperOptions:nP,transitionWrapperClassName:"z-30",dataTestId:"user-profile",children:p.map(function(e){return(0,r.jsx)(o.Fragment,{children:!e.disabled&&(0,r.jsx)(eq.Lt.ItemWithLink,{onClick:e.onClick,children:(0,r.jsxs)("div",{className:"text-dark flex items-center justify-between",children:[e.label,(0,r.jsx)(T.JO,{size:16,type:e.iconName,className:"text-dark"})]})})},e.label)})})},nk=function(e){var t,n,o,i,a,s,l,c,u,d,f=e.validateAndSetCurrentSection,p=e.event,b=e.isEditMode,h=e.title,y=(0,m.eW)(),_=y.sections,x=y.setCurrentSection,w=y.currentSection,O=_.filter(function(e){return e!==j.SA.overview}).map(function(e){return{value:e,label:e}}),S=function(e){f(e,x)},P=(0,j.s9)(p)?(0,v.t)("events.badge_status.published"):(0,v.t)("events.badge_status.draft"),C=(null==p||null==(t=p.event_setting_attributes)?void 0:t.starts_at)||"",I=(0,U.ZX)(C,(null==p||null==(n=p.event_setting_attributes)?void 0:n.duration_in_seconds)||3600),k=w===j.SA.overview,N=(0,tZ.N)(C,null==p||null==(o=p.event_setting_attributes)?void 0:o.time_zone),A=N.dayOfMonth,E=N.shortMonthString,M=null==p||null==(i=p.event_setting_attributes)?void 0:i.time_zone_abbreviations,R="".concat(null!=(l=null==A?void 0:A.toString())?l:""," ").concat(null!=E?E:""," ").concat((0,tF.Dk)(null!=C?C:new Date().toISOString(),null!=(c=null==p||null==(a=p.event_setting_attributes)?void 0:a.time_zone)?c:"")," - ").concat((0,tF.Dk)(null!=(u=I.toISOString())?u:new Date().toISOString(),null!=(d=null==p||null==(s=p.event_setting_attributes)?void 0:s.time_zone)?d:""),",").concat(null!=M?M:"");return k?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-4 mt-5 flex flex-col gap-2 px-5",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[b&&(0,r.jsx)(ea.g,{label:P}),(0,r.jsx)(nI,{event:p})]}),(0,r.jsx)(g.Z.TitleSm,{truncate:!0,weight:"semibold",children:h}),(0,r.jsx)(g.Z.LabelSm,{weight:"font-semibold",children:R})]}),(0,r.jsx)("div",{className:"flex flex-col px-5",children:O.map(function(e){return(0,r.jsxs)("button",{type:"button",className:"border-b-primary text-default flex items-center justify-between border-b py-3 text-sm",onClick:function(){return S(e.value)},children:[e.label,(0,r.jsx)(T.JO,{size:16,type:"16-chevron-right",className:"text-default h-4 w-4"})]},e.label)})})]}):null},nN=n(38603),nA=function(e){var t,n,r=e.event,o=e.spaceId,i=e.locationType,a=(0,O.wh)(),s=a.currentUser,l=a.currentCommunity,c=(0,eS.m)().spaces.find(function(e){return e.id===(o||(null==r?void 0:r.space_id))})||null,u=["private","secret"].includes((null==c?void 0:c.visibility)||""),d=(0,U.TP)(new Date),f=(0,U.ZX)(d.toISOString(),3600);return r?(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},r),n=n={body:r.body_for_editor,attendee_invite_attributes:{invited_entities_ids:null}},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t):{user_id:null==s?void 0:s.id,space_id:null!=o?o:void 0,event_type:j.E_.SINGLE,status:j.Q_.DRAFT,event_setting_attributes:{auto_rsvp_invited_attendees:(null==c?void 0:c.event_auto_rsvp_enabled)||!1,location_type:i,starts_at:d.toUTCString(),ends_at:f.toUTCString(),duration_in_seconds:3600,live_stream_room_setting_attributes:{access_type:u?eB._d.SECRET:eB._d.OPEN,view_type:eB.Bk.GRID,recording_enabled:(null==l?void 0:l.live_stream_recording_enabled)||!1,auto_post_recording_enabled:(null==l?void 0:l.live_stream_recording_enabled)||!1,room_type:eB.H0.STREAM,mute_on_join:!1,hide_participants_list:!1,limit_url_sharing:!1},send_email_confirmation:!0,send_in_app_notification_confirmation:!0,send_email_reminder:!0,send_in_app_notification_reminder:!0,send_publish_email:!0,ticket_type:j.Mj.FREE},recurring_setting_attributes:{range_type:j.pd.ON,occurrences:null,ends_at:f.toUTCString()}}},nE=n(70442),nT=n(57105),nM=n(66205),nR=n(25362),nD=n(57851),nL=n(90431),nF=n(31089),nU=n(37291),nB="events.connection_modal",nq=nT.gk.create(function(e){var t=e.eventId,n=e.spaceName,o=(0,nR.dd)(),i=(0,nU.x)(),a=i.onSendAnnouncement,s=i.isLoading;return(0,r.jsx)(nL.o,{isOpen:o.visible,onClose:o.hide,title:(0,v.t)([nB,"title"]),description:(0,v.t)([nB,"description"],{space_name:n}),isLoading:s,"data-testid":"event-momentum-modal",children:(0,r.jsx)("div",{className:"flex flex-col gap-y-10",children:(0,r.jsx)(nD.X,{children:(0,r.jsx)(nF.K,{iconEl:(0,r.jsx)(T.JO,{type:"20-page-edit-text",size:20}),onClick:function(){a({eventId:t,onSuccess:function(){o.hide()}})},disabled:s,"data-testid":"send-announcement-event-button",children:(0,v.t)([nB,"review_draft"])})})})})}),nz=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,M.useMutation)(function(t){var n,r;return e?t2.S1.update({event:e,formData:(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t),r=r={event_type:e.event_type},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(r)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}),n),forReactQuery:!0}):t2.S1.create({formData:t,forReactQuery:!0})})};function nZ(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function nH(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){nZ(i,r,o,a,s,"next",e)}function s(e){nZ(i,r,o,a,s,"throw",e)}a(void 0)})}}function nV(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function nQ(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function nW(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var nG="force_dirty",n$=function(e){var t=e.onClose,n=e.event,r=e.isDirty,i=e.isEditMode,a=e.setEvent,s=e.shouldClearEventStateOnHide,l=e.onEventChange,u=e.isLiveLocation,d=(0,nE.k6)(),f=(0,O.wh)().currentCommunityMember,m=(0,tW.pm)(),p=m.success,b=m.error,h=(0,nM.q)(),y=(0,nE.TH)().pathname,g=nz(n),_=!n&&g.isLoading,x=c().setIsUpdatingAttendees,w=(0,nv.vb)(f),S=(0,o.useRef)(null),P=(0,o.useRef)(null),C=(0,eQ.Y)(),I=C.purchaseRecordingsAddonWhenLimitReached,k=C.purchaseStreamingAddonWhenLimitReached,N=C.shouldUpgradeAddons,A="/events"===y,E=function(e){void 0!==e&&(!(0,j.s9)(n)||e)&&x(!0)},T=function(e,r){if(p(n?(0,v.t)("events.saved_successfully"):(0,v.t)("events.created_successfully")),h({shouldInvalidateAllEvents:A}),A&&l(n),M(e)){if(t(),a(null),R(e),w)return void nT.gk.show(nq,{eventId:e.id,spaceName:e.space_name})}else L(e,r)},M=function(e){return(null==n?void 0:n.status)===j.Q_.DRAFT&&(null==e?void 0:e.status)===j.Q_.PUBLISHED},R=function(e){d.push(D.xu.show({spaceSlug:e.space_slug,slug:e.slug}))},L=function(e,t){t(nQ(nV({},e),{body:e.body_for_editor})),a(e)},F=function(){b(n?(0,v.t)("events.save_error"):(0,v.t)("events.create_error"))},U=function(e){var t;(null!=(t=Error)&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t)&&console.error(e.message)},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j.HA.CURRENT;S.current&&P.current&&(S.current("recurring_setting_attributes.edit_mode",e,{shouldDirty:!0}),S.current(nG,!0,{shouldDirty:!0}),P.current())};return{handleClose:function(){(!r||confirm((0,v.t)("events.edit_modal.close_warning")))&&(t(),s&&a(null))},onSubmit:function(e,t){var r=t.reset;return nH(function(){var t,o,a,s,l,c,d,f;return nW(this,function(m){switch(m.label){case 0:return m.trys.push([0,2,,3]),l=null==n?void 0:n.event_type,i?delete e[nG]:l=e.recurring_setting_attributes.frequency?j.E_.RECURRING:j.E_.SINGLE,(i?null==e||null==(t=e.paywall_attributes)?void 0:t.price_amount:(0,j.yl)(e))&&(c=e.paywall_attributes.price_amount,d=(0,e1.LG)(c),e.paywall_attributes.price_amount=d),!i&&(null==e||null==(o=e.event_setting_attributes)?void 0:o.ticket_type)==j.Mj.PAID&&[j.Bq.LIVE_ROOM,j.Bq.LIVE_STREAM].includes(null==e||null==(a=e.event_setting_attributes)?void 0:a.location_type)&&(e.event_setting_attributes.live_stream_room_setting_attributes.access_type=eB._d.SECRET),E(null==e||null==(s=e.event_setting_attributes)?void 0:s.auto_rsvp_invited_attendees),[4,nH(function(){return nW(this,function(e){switch(e.label){case 0:if(!(u&&N))return[3,3];return[4,I()];case 1:return e.sent(),[4,k()];case 2:e.sent(),p((0,v.t)("settings.billing.add_ons.changes_succeeded")),e.label=3;case 3:return[2]}})})()];case 1:return m.sent(),f={onSuccess:function(e){return T(e,r)},onError:F},g.mutate(nQ(nV({},e),{event_type:l}),f),[3,3];case 2:return U(m.sent()),[3,3];case 3:return[2]}})})()},onSave:B,onPublish:function(e){S.current&&S.current("status",j.Q_.PUBLISHED,{shouldDirty:!0}),B(e)},isCreating:_,setValueRef:S,triggerFormSubmitRef:P,mutation:g}};function nK(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function nJ(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return nK(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nK(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var nX=function(e){var t,n=e.onClose,r=e.event,i=e.spaceId,a=e.locationType,s=e.shouldClearEventStateOnHide,l=nJ((0,o.useState)(r||null),2),c=l[0],u=l[1],d=!!r&&(0,U.aA)(null==(t=r.event_setting_attributes)?void 0:t.ends_at),f=(0,nN.vk)({params:{past_events:d}}).onEventChange;(0,o.useEffect)(function(){u(r||null)},[r]);var m=!!c,p=m?c.name:(0,v.t)("events.create.title"),b=nA({event:c,spaceId:i,locationType:a}),h=nJ((0,o.useState)(!1),2),y=h[0],g=h[1],_=nJ((0,o.useState)(!1),2),w=_[0],O=_[1],S=nJ((0,o.useState)(!1),2),P=S[0],C=S[1],I=nJ((0,o.useState)(!1),2),k=I[0],N=I[1],A=nJ((0,o.useState)(a),2),E=A[0],T=A[1],M=x(),R=M.triggerValidationRef,D=M.validateAndSetCurrentSection,L=E===em.Bq.LIVE_STREAM||E===em.Bq.LIVE_ROOM,F=(0,j.f0)(c)&&P,B=n$({onClose:n,event:c,isDirty:y,isEditMode:m,setEvent:u,shouldClearEventStateOnHide:void 0!==s&&s,onEventChange:f,isLiveLocation:L}),q=B.handleClose,z=B.onSubmit,Z=B.onSave,H=B.onPublish,V=B.setValueRef,Q=B.triggerFormSubmitRef,W=B.mutation;return{event:c,isEditMode:m,isCreating:B.isCreating,isDirty:y,isStartsAtDirty:w,locationType:E,setLocationType:T,isLiveLocation:L,handleClose:q,onSubmit:z,onSave:Z,onPublish:H,setValueRef:V,triggerFormSubmitRef:Q,triggerValidationRef:R,validateAndSetCurrentSection:D,formDefaultValues:b,title:p,mutation:W,setIsDirty:g,setStartsAtDirty:O,shouldHideAllEventOption:F,setPaywallAttributesDirty:C,isRepeatsDirty:k,setRepeatsDirty:N}};function nY(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var n0=function(e){var t,n=e.isOpen,a=e.onClose,s=e.event,l=e.spaceId,c=e.locationType,u=e.shouldClearEventStateOnHide,v=e.initialSection,y=void 0===v?j.SA.basicInfo:v,g=(t=(0,o.useState)({startsAt:"",endsAt:"",frequency:""}),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return nY(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nY(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),_=g[0],x=g[1],w=nX({spaceId:l,event:s,shouldClearEventStateOnHide:void 0!==u&&u,locationType:c,onClose:a}),O=w.event,S=w.isEditMode,P=w.isCreating,C=w.isDirty,I=w.isStartsAtDirty,k=w.locationType,N=w.setLocationType,A=w.setValueRef,E=w.triggerFormSubmitRef,T=w.formDefaultValues,M=w.title,R=w.handleClose,D=w.onSubmit,L=w.onSave,F=w.onPublish,U=w.validateAndSetCurrentSection,B=w.triggerValidationRef,q=w.setIsDirty,z=w.setStartsAtDirty,Z=w.mutation,H=w.isLiveLocation,V=w.setPaywallAttributesDirty,Q=w.shouldHideAllEventOption,W=w.setRepeatsDirty,G=w.isRepeatsDirty,$=(0,f.kK)();return(0,r.jsxs)(r.Fragment,{children:[!$&&(0,r.jsx)(b.o,{onClick:R,className:"z-[1100]",isVisible:n}),(0,r.jsx)(p.x,{isOpen:n,shouldShowCloseButton:!1,contentPortalId:"events",onClose:i.noop,children:(0,r.jsxs)(m.MW,{formId:"events",sections:Object.values(j.SA),initialSection:$&&S?j.SA.overview:y,title:M,onExit:R,onSave:function(e){return D(e,{})},isSaving:Z.isLoading,children:[(0,r.jsx)(p.x.Header,{className:(0,d.A)("!px-5 !py-3 md:!px-6 md:!py-5",{"!border-0":P}),children:(0,r.jsx)(ed,{isEditMode:S,isCreating:P,event:O,onPublish:F,handleClose:R,validateAndSetCurrentSection:U})}),(0,r.jsxs)(p.x.Body,{children:[$&&(0,r.jsx)(nk,{validateAndSetCurrentSection:U,event:s,isEditMode:S,title:M}),(0,r.jsxs)(h.l,{id:"events",onSubmit:D,passThroughProps:{onCancel:R},defaultValues:T,triggerFormSubmitRef:E,submitDirtyOnly:S,children:[!P&&(0,r.jsx)(nw,{event:O,triggerValidationRef:B,setValueRef:A,setIsDirty:q,setLocationType:N,locationType:k,isLiveLocation:H,setStartsAtDirty:z,setPaywallAttributesDirty:V,setRepeatsDirty:W,setFormScheduleValues:x}),P&&(0,r.jsx)(nS,{}),$&&(0,r.jsx)(er,{event:O,onPublish:F})]})]}),(0,r.jsx)(p.x.Footer,{className:(0,d.A)({"!border-0 !p-0":P||!C}),children:(0,r.jsx)(nO,{event:O,isCreating:P,isDirty:C,onSubmit:L,locationType:k,isStartsAtDirty:I,shouldHideAllEventOption:Q,isRepeatsDirty:G,formScheduleValues:_})})]})})]})};function n1(){return(n1=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var n2=function(e){var t=n1({},function(e){if(null==e)throw TypeError("Cannot destructure "+e);return e}(e));return(0,r.jsx)(u,{children:(0,r.jsx)(n0,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t))})}},39468:function(e,t,n){n.d(t,{I:()=>i});var r=n(85893),o=n(1168),i=function(e){var t=e.label,n=e.value,i=e.placeholder,a=e.error,s=e.disabled,l=e.leftAddon,c=e.rightAddon,u=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["label","value","placeholder","error","disabled","leftAddon","rightAddon"]);return(0,r.jsxs)("div",{children:[t&&(0,r.jsx)("div",{className:"text-sm font-semibold",children:t}),(0,r.jsxs)("div",{className:"mt-2 flex w-full",children:[l&&(0,r.jsx)("div",{className:(0,o.A)({"cursor-not-allowed bg-gray-50":s},"flex h-11 items-center rounded-l-lg border border-gray-300 bg-white px-4 py-3"),children:l}),(0,r.jsx)("input",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:(0,o.A)("placeholder:text-light h-11 grow rounded-lg border border-solid px-4 py-3 outline-none placeholder:opacity-100 focus:border-2 focus:border-gray-500",{"border-red-600 focus:border-red-600":a,"border-primary bg-secondary text-light cursor-not-allowed":s,"text-dark border-gray-400":!s,"rounded-l-none":l,"rounded-r-none":c}),value:n,placeholder:i,disabled:s},u)),c&&(0,r.jsx)("div",{className:(0,o.A)({"border-primary bg-secondary text-light cursor-not-allowed":s},"bg-primary border-primary text-dark ml-[-1px] flex h-11 items-center rounded-r-lg border px-4 py-3"),children:c})]}),a&&(0,r.jsx)("div",{className:"mt-2 text-sm text-red-600",children:a})]})}},57105:function(e,t,n){n.d(t,{dd:()=>a,gk:()=>i,yB:()=>s});var r=n(85893),o=n(25362),i=o.ZP,a=o.dd,s=function(e){var t=e.children;return(0,r.jsx)(i.Provider,{children:t})}},71807:function(e,t,n){n.d(t,{x:()=>l});var r=n(85893),o=n(84142),i=n(73935),a=n(59413),s=n(19347),l=function(e){var t,n,l=e.position,c=e.children,u=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["position","children"]),d=(0,a.x)().shouldShowRailBar,f=document.querySelector("#rail-bar-".concat(void 0===l?"header":l));return f?(0,r.jsx)(r.Fragment,{children:(0,i.createPortal)((0,r.jsx)(o.J,{children:(0,r.jsx)(o.J.Panel,{as:"div",static:void 0===d||d,children:(0,r.jsx)(s.S0,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},u),n=n={children:c},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))})}),f)}):null}},1364:function(e,t,n){n.d(t,{k:()=>g});var r=n(67294),o=n(84326),i=n(78456),a=n(4393),s=n(8683),l=n(90809),c=n(67803),u=n(76972),d=n(69690),f=n(11699);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t,n=e.endDate,o=(t=(0,r.useState)(""),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return m(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1],s=function(e){var t=new Date(e),n=new Date;if(t<=n)return"0s";var r=(0,c.Z)(t,n),o=(0,u.Z)(t,n)%24,i=(0,d.Z)(t,n)%60,a=(0,f.Z)(t,n)%60;return 0===r&&0===o?"".concat(i,"m : ").concat(a,"s"):r>0?"".concat(r,"d : ").concat(o,"h : ").concat(i,"m"):"".concat(o,"h : ").concat(i,"m")};return(0,r.useEffect)(function(){if(!n)return void a("");var e=function(){a(s(n))};e();var t=setInterval(e,1e3);return function(){return clearInterval(t)}},[n]),i},b=n(24869),h=n(41342),v=n(85122),y=n(17617),g=function(){var e,t=(0,h.wh)(),n=t.currentCommunity,c=t.currentCommunityMember,u=t.currentCommunitySettings,d=(0,b.E)().isCommunityOnTrial,f=(0,l.C)().trackEvent,m=(0,y.BT)(),g=(e=window.location.pathname,(0,r.useMemo)(function(){return/^\/settings\/workflows\/(\d+|new|edit|view)(\/.*)?$/.test(e)&&!/^\/settings\/workflows(\?|$)/.test(e)},[e])),_=p({endDate:(null==n?void 0:n.trial_ends_at)||void 0}),x=(0,r.useMemo)(function(){return window.location.pathname.startsWith("/communities/new")},[window.location]),j=(0,r.useMemo)(function(){return/^\/communities\/\d+\/questions\/?$/.test(window.location.pathname)},[window.location]),w=(0,r.useMemo)(function(){return/^\/communities\/\d+\/templates\/?$/.test(window.location.pathname)},[window.location]),O=(0,r.useMemo)(function(){return(null==n?void 0:n.trial_ends_at)?(0,v.ie)(n.trial_ends_at,{day:"2-digit",month:"2-digit"}):""},[n]),S=(0,r.useMemo)(function(){return(null==n?void 0:n.trial_ends_at)?(0,v.ie)(n.trial_ends_at,{month:"long",day:"2-digit"}):""},[n]),P=(0,r.useMemo)(function(){return(null==n?void 0:n.trial_ends_at)?(0,s.TF)(n.trial_ends_at):""},[n]),C=(0,a.eC)(new Date,new Date((null==n?void 0:n.trial_ends_at)||"")),I=(0,r.useMemo)(function(){return C<=1?"1 ".concat(o.Z.t("trial_banner.day")):"".concat(C," ").concat(o.Z.t("trial_banner.days"))},[C]),k=(0,r.useMemo)(function(){return!d&&null!=n&&!!n.subscription&&!!n.subscription.is_cancelled},[n,d]),N=(0,r.useMemo)(function(){return!!(null==n?void 0:n.promotion_enabled)},[n]),A=(0,r.useMemo)(function(){var e=(0,i.vb)(c),t=null==u?void 0:u.hide_trial_banner;return!!(e&&(d||k)&&!x&&!j&&!w&&!t&&!m&&!N&&!g)},[n,c,d,k,m,g]);return{trialEndsInWords:P,trialDaysRemainingInWords:I,trialEndDateFormatted:O,trialEndDateMonthAndDayFormatted:S,daysLeft:C,expiringInTimer:_,isSubscriptionCancelled:k,isCommunityOnTrial:d,shouldShowTrialBanner:A,isTrialBannerExists:!!document.getElementById("trial-banner"),trackTrialBannerClick:function(){f("trial_banner.upgrade_now.clicked",{days_left:C})}}}},9397:function(e,t,n){n.d(t,{i:()=>c});var r=n(85893),o=n(56993),i=n(1168),a=n(85924),s=n(41553),l=n(98363),c=function(e){var t=e.avatarUrl,n=e.name,c=e.progress,u=e.level,d=e.size,f=void 0===d?"large":d,m=(0,a.TC)().isDarkAppearance,p="large"===f?104:64,b=(p-4)/2,h=2*Math.PI*b,v=h-(void 0===c?0:c)/100*h,y=(0,o.O)(u||1);return(0,r.jsxs)("div",{className:"relative flex items-center justify-center rounded-full",style:{height:p,width:p},children:[(0,r.jsxs)("svg",{className:"absolute",width:p,height:p,style:{transform:"rotate(-90deg)"},children:[(0,r.jsx)("circle",{cx:p/2,cy:p/2,r:b,stroke:m?"#42464D":"#F0F3F5",strokeWidth:4,fill:"none"}),(0,r.jsx)("circle",{cx:p/2,cy:p/2,r:b,stroke:y.progress,strokeWidth:4,fill:"none",strokeDasharray:h,strokeDashoffset:v,strokeLinecap:"round"})]}),(0,r.jsx)("div",{className:"bg-secondary absolute z-0 rounded-full",style:{height:p-8,width:p-8},children:(0,r.jsx)(l.s,{isFullRounded:!0,src:t,name:n,size:"large"===f?"24":"14"})}),u&&(0,r.jsx)("div",{className:(0,i.A)("absolute -bottom-1 -right-1 z-10 flex items-center justify-center rounded-full",{"h-8 w-8":"large"===f,"h-6 w-6":"small"===f},y.bg),children:(0,r.jsx)(s.Z.LabelSm,{weight:"bold",children:(0,r.jsx)("span",{className:y.text,children:u})})})]})}},37840:function(e,t,n){n.d(t,{U:()=>l});var r=n(85893),o=n(84326),i=n(56993),a=n(1168),s=n(41553),l=function(e){var t=e.level,n=e.levelName,l=(0,i.O)(t);return(0,r.jsxs)("div",{className:(0,a.A)("mb-2 inline-flex items-center space-x-3 rounded-full px-3 py-1",l.bg,l.text),children:[(0,r.jsxs)(s.Z.LabelSm,{weight:"semibold",color:"text-inherit",children:[(0,r.jsx)("span",{className:"mr-2",children:(0,o.t)("leaderboard.trophy_emoji")}),(0,o.t)("leaderboard.level_number_only",{level:t})]}),(0,r.jsx)("div",{className:(0,a.A)("h-3 w-px rounded-md",l.divider)}),(0,r.jsx)(s.Z.LabelSm,{weight:"semibold",color:"text-inherit",children:n||(0,o.t)("leaderboard.level_n",{level:t})})]})}},56993:function(e,t,n){n.d(t,{O:()=>c});var r=n(85924),o={light:{basic:"bg-[#F8EFDD] text-[#D69B29]",mid:"bg-[#EAEDFD] text-[#506CF0]",pro:"bg-[#F5ECFC] text-[#AC61E7]"},dark:{basic:"bg-[#443E32] text-[#E2AB40]",mid:"bg-[#31374E] text-[#7A91FD]",pro:"bg-[#3E354D] text-[#CF93FF]"}},i={light:{basic:"text-[#D69B29]",mid:"text-[#506CF0]",pro:"text-[#AC61E7]"},dark:{basic:"text-[#E2AB40]",mid:"text-[#7A91FD]",pro:"text-[#CF93FF]"}},a={light:{basic:"bg-[#F4E3C1]",mid:"bg-[#D1D8FB]",pro:"bg-[#E9D6F9]"},dark:{basic:"bg-[#6C624E]",mid:"bg-[#4D577B]",pro:"bg-[#5D4278]"}},s={light:{basic:"#D69B29",mid:"#506CF0",pro:"#AC61E7"},dark:{basic:"#E2AB40",mid:"#7A91FD",pro:"#CF93FF"}},l={light:{basic:"bg-gradient-to-b from-[#F8EFDD] to-transparent",mid:"bg-gradient-to-b from-[#EAEDFD] to-transparent",pro:"bg-gradient-to-b from-[#F5ECFC] to-transparent"},dark:{basic:"bg-gradient-to-b from-[#443E32] to-transparent",mid:"bg-gradient-to-b from-[#31374E] to-transparent",pro:"bg-gradient-to-b from-[#3E354D] to-transparent"}},c=function(e){var t=(0,r.TC)().isDarkAppearance,n=e&&!(e<=3)?e<=6?"mid":"pro":"basic",c=t?"dark":"light";return{bg:o[c][n],text:i[c][n],divider:a[c][n],progress:s[c][n],bgGradient:l[c][n]}}},83730:function(e,t,n){n.d(t,{K:()=>b,Y:()=>h});var r=n(85893),o=n(67294),i=n(96486),a=n(80926),s=n(41342),l=n(78456);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)})}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var p=(0,o.createContext)({streamingHoursAvailable:!1,recordingHoursReached:!1,totalStreamingHours:0,totalRecordingHours:0,limitsReachedIsOpen:!1,limitsReachedOnClose:i.noop,setRecordingEnabled:i.noop,recordingEnabled:!1,limitsReachedOnOpen:i.noop,shouldUpgradeAddons:!1,purchaseRecordingsAddonWhenLimitReached:function(){return Promise.resolve()},purchaseStreamingAddonWhenLimitReached:function(){return Promise.resolve()}});p.displayName="AddonsContext";var b=function(e){var t=e.children,n=(0,s.wh)().currentCommunityMember,c=(0,l.vb)(n),u=(0,a.tm)({enabled:c}),b=u.streamingHoursAvailable,h=u.recordingHoursAvailable,v=u.streamingTotalPlanHours,y=u.recordingTotalPlanHours,g=u.isLoading,_=f((0,o.useState)(!1),2),x=_[0],j=_[1],w=!g&&x&&!h,O=(0,a.$v)(i.noop,{enabled:c}),S=O.purchaseAsync,P=O.currentQuantity,C=O.unitSize,I=(0,a.Yq)(i.noop,{enabled:c}),k=I.purchaseAsync,N=I.currentQuantity,A=I.unitSize,E=v+Number(P||0),T=y+Number(N||0),M=f((0,o.useState)(!1),2),R=M[0],D=M[1];(0,o.useEffect)(function(){D(!g&&(!b||w))},[g,b,w]);var L=!b||w;return(0,r.jsx)(p.Provider,{value:{streamingHoursAvailable:b,recordingHoursReached:w,totalStreamingHours:E,totalRecordingHours:T,limitsReachedIsOpen:R,limitsReachedOnClose:function(){D(!1)},setRecordingEnabled:j,recordingEnabled:x,limitsReachedOnOpen:function(){D(!0)},shouldUpgradeAddons:L,purchaseRecordingsAddonWhenLimitReached:function(){return d(function(){return m(this,function(e){switch(e.label){case 0:if(!x||h||!A)return[2];return[4,k(A)];case 1:return e.sent(),[2]}})})()},purchaseStreamingAddonWhenLimitReached:function(){return d(function(){return m(this,function(e){switch(e.label){case 0:if(b||!C)return[2];return[4,S(C)];case 1:return e.sent(),[2]}})})()}},children:t})},h=function(){var e=(0,o.useContext)(p);if(void 0===e)throw Error("useAddonsContext must be used within a AddonsProvider");return e}},91150:function(e,t,n){n.d(t,{b:()=>u});var r=n(85893),o=n(52293),i=n(84326),a=n(37588),s=n(57363),l=n(43544),c=n(41553),u=function(e){var t=e.name,n=e.roomType,u=void 0===n?a.H0.STREAM:n,d=(0,o.Gc)().control,f=[{value:a.Bk.GRID,label:(0,i.t)("live_streams.form.view_type_grid"),icon:"gallery-view",description:(0,r.jsx)(c.Z.LabelSm,{children:(0,i.t)("live_streams.form.".concat(u,".view_type_description_grid"))})},{value:a.Bk.SPEAKER,label:(0,i.t)("live_streams.form.view_type_speaker"),icon:"speaker-view",description:(0,r.jsx)(c.Z.LabelSm,{children:(0,i.t)("live_streams.form.".concat(u,".view_type_description_speaker"))})}];return(0,r.jsx)(o.Qr,{control:d,name:void 0===t?"":t,render:function(e){var t,n=e.field,o=n.onChange,i=(t=n.value,f.find(function(e){return e.value===t}));return(0,r.jsx)(l.Lt,{direction:"bottom-start",linkType:"button",button:(0,r.jsx)(l.Lt.MenuButton,{className:"form-control relative inline-block w-full text-left",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(s.JO,{type:null==i?void 0:i.icon,className:"ml-1 mr-2 flex"}),(0,r.jsx)(c.Z.LabelMd,{children:null==i?void 0:i.label})]}),(0,r.jsx)("div",{className:"flex content-end",children:(0,r.jsx)(s.JO,{type:"cheveron-down",className:"ml-1 mr-2"})})]})}),buttonClassName:"w-full",className:"relative w-full",size:l.wk.EXTRA_LARGE,onChange:o,options:f,labelWeight:"semibold"})}})}},92394:function(e,t,n){n.d(t,{l:()=>c});var r=n(85893),o=n(84326),i=n(83730),a=n(39905),s=n(34519),l=n(41553),c=function(e){var t=e.roomType,n=(0,i.Y)(),c=n.streamingHoursAvailable,u=n.recordingHoursReached,d=n.totalStreamingHours,f=n.totalRecordingHours,m=n.limitsReachedIsOpen,p=n.limitsReachedOnClose;return(0,r.jsxs)(s.u_,{title:(0,o.t)("live_streams.form.limits_reached"),isOpen:!!m,onClose:p,className:"z-[2100]",children:[(0,r.jsx)(s.u_.Overlay,{}),(0,r.jsxs)(s.u_.Content,{className:"!overflow-visible",children:[(0,r.jsxs)(s.u_.Header,{children:[(0,r.jsx)(s.u_.Title,{className:"text-center",size:"md",children:(0,o.t)("live_streams.form.limits_reached")}),(0,r.jsx)(s.u_.HeaderActions,{children:(0,r.jsx)(s.u_.CloseButton,{onClick:p})})]}),(0,r.jsx)(s.u_.Body,{className:"!overflow-visible text-justify",children:(0,r.jsxs)("ul",{className:"text-default list-outside pl-4 text-sm font-normal",children:[!c&&(0,r.jsx)("li",{className:"text-dark text-xs font-normal",children:(0,r.jsx)(l.Z.BodyXs,{children:(0,o.t)("live_streams.form.".concat(t,".upgrade_streaming_hours_label_v3"),{hours:d})})}),u&&(0,r.jsx)("li",{className:"text-dark mt-2 text-xs font-normal",children:(0,r.jsx)(l.Z.BodyXs,{children:(0,o.t)("live_streams.form.".concat(t,".upgrade_recording_hours_label_v3"),{hours:f})})})]})}),(0,r.jsx)(s.u_.Footer,{children:(0,r.jsx)(a.z,{type:"submit",variant:"circle",full:!0,large:!0,onClick:p,children:(0,o.t)("live_streams.form.close")})})]})]})}},3255:function(e,t,n){n.d(t,{K:()=>s});var r=n(85893),o=n(1168),i=n(80171),a=n(39905),s=function(e){var t=e.variant,n=void 0===t?"icon-only":t,s=e.isActive,l=e.tooltipText,c=e.onClick,u=e.children,d=e.disabled;return(0,r.jsx)(i.T,{placement:"top",content:l,enabled:!!l,className:"inline-block",children:(0,r.jsx)(a.z,{variant:"secondary",small:!0,isFullRounded:!0,className:(0,o.A)("flex h-7 items-center justify-center font-semibold",{"w-7 !p-0":"icon-only"===n,"!px-3":"text-only"===n,"!bg-v2-success/10 !border-v2-success/20 text-v2-success":s,"!border-primary":!s}),onClick:c,disabled:void 0!==d&&d,children:u})})}},81085:function(e,t,n){n.d(t,{U:()=>a});var r=n(85893),o=n(84326),i=n(41553),a=function(e){var t=e.isQueuedForSpotlight;return(0,r.jsx)("div",{className:"mb-1.5",children:(0,r.jsx)(i.Z.LabelXxs,{weight:"semibold",color:"text-very-dark",textTransform:"uppercase",children:t?(0,o.t)("live_streams.room.qa.questions.queued_up"):(0,o.t)("live_streams.room.qa.questions.spotlighted")})})}},8819:function(e,t,n){n.d(t,{f:()=>s});var r=n(88767),o=n(84326),i=n(56608),a=n(60878),s=function(e){var t=e.chatUuid,n=(0,a.pm)(),s=(0,r.useMutation)(function(e){return i.M.spotlightMessage(t,e)},{onSuccess:function(){n.success((0,o.t)("messaging.actions.spotlight_success"))},onError:function(){n.error((0,o.t)("messaging.actions.spotlight_error"))}}),l=s.mutateAsync,c=s.isLoading,u=(0,r.useMutation)(function(e){return i.M.removeSpotlightMessage(t,e)},{onError:function(){n.error((0,o.t)("messaging.actions.remove_spotlight_error"))}});return{spotlightMessage:l,isSpotlightingMessage:c,removeSpotlightMessage:u.mutateAsync,isRemovingSpotlightMessage:u.isLoading}}},34811:function(e,t,n){n.d(t,{CH:()=>i,O_:()=>a,SF:()=>o,dF:()=>s,fm:()=>l,nX:()=>c,w5:()=>r});var r="default",o=8,i=2,a=16,s=6,l=2,c=16},7447:function(e,t,n){n.d(t,{ch:()=>o.ch,vi:()=>o.vi,if:()=>a,O_:()=>s.O_,zl:()=>o.zl,iZ:()=>o.iZ,zD:()=>o.zD,Ft:()=>i,bJ:()=>o.bJ,fm:()=>s.fm,Sl:()=>o.Sl,I7:()=>o.I7,EY:()=>o.EY,O4:()=>o.O4,wV:()=>o.wV,YK:()=>o.YK,y:()=>o.y,bR:()=>o.bR,W4:()=>o.W4,nX:()=>s.nX,Hj:()=>o.Hj,fC:()=>o.fC,Le:()=>o.Le,sO:()=>o.sO,SK:()=>o.SK,TQ:()=>o.TQ,IQ:()=>o.IQ,P$:()=>o.P$,I3:()=>r.I,w5:()=>s.w5,CH:()=>s.CH,oe:()=>o.oe,tS:()=>o.tS,SI:()=>o.SI});var r=n(45024),o=n(93253),i=function(){return(0,r.I)(function(e){return e.settingsActions})},a=function(){var e,t,n=(0,r.I)(o.fC),i=(0,r.I)(o.yU),a=(0,r.I)(o.i$),s=(0,r.I)(o.XT);return e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},n),t=t={isChatSelected:i,isParticipantsSelected:a,isQASelected:s},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e},s=n(34811)},93253:function(e,t,n){n.d(t,{EY:()=>N,Hj:()=>M,I7:()=>l,IQ:()=>d,Le:()=>O,O4:()=>I,P$:()=>E,SI:()=>P,SK:()=>k,Sl:()=>h,TQ:()=>T,W4:()=>C,XT:()=>x,YK:()=>m,bJ:()=>R,bR:()=>w,ch:()=>A,fC:()=>y,i$:()=>_,iZ:()=>c,oe:()=>b,sO:()=>p,tS:()=>s,vi:()=>a,wV:()=>f,y:()=>v,yU:()=>g,zD:()=>j,zl:()=>u});var r=n(57836);function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var a=function(e){return e.settings||{}},s=function(e){var t;return null==(t=e.settings)?void 0:t.audioInputId},l=function(e){var t;return null==(t=e.settings)?void 0:t.audioOutputId},c=function(e){var t;return null==(t=e.settings)?void 0:t.videoInputId},u=function(e){var t;return null==(t=e.settings)?void 0:t.blurEnabled},d=function(e){var t;return null==(t=e.settings)?void 0:t.mirrorEnabled},f=function(e){var t;return null==(t=e.settings)?void 0:t.microphoneEnabled},m=function(e){var t;return null==(t=e.settings)?void 0:t.cameraEnabled},p=function(e){var t;return null==(t=e.settings)?void 0:t.noiseSuppression},b=function(e){var t;return null==(t=e.settings)?void 0:t.gridLayoutPageSize},h=function(e){var t;return null==(t=e.settings)?void 0:t.speakerLayoutPageSize},v=function(e){var t;return null==(t=e.settings)?void 0:t.infinityMirrorAlertDisabled},y=function(e){return e.ui},g=function(e){var t;return(null==(t=e.ui)?void 0:t.currentTab)===r.G.CHAT},_=function(e){var t;return(null==(t=e.ui)?void 0:t.currentTab)===r.G.PARTICIPANTS},x=function(e){var t;return(null==(t=e.ui)?void 0:t.currentTab)===r.G.QA},j=function(e){var t;return(null==(t=e.session)?void 0:t.spectators)||{}},w=function(e){return e.qa.session},O=function(e){var t,n=e.qa.upvotedQuestionIds||[];return(null==(t=e.qa.questions)?void 0:t.map(function(e){return i(o({},e),{upvoted_by_current_community_member:n.includes(e.id)})}))||[]},S=function(e,t){var n=e.qa.upvotedQuestionIds||[],r=e.qa.questions.find(function(e){return e.id===t});return r?i(o({},r),{upvoted_by_current_community_member:n.includes(t)}):null},P=function(e){var t=e.qa.replyingQuestionId;return t?S(e,t):null},C=function(e){return e.qa.replies||[]},I=function(e){return e.qaActions||{}},k=function(e){return e.qa.filterByStatus},N=function(e){return e.qa.sortBy},A=function(e){var t;return(null==(t=e.qa.pendingQuestionIds)?void 0:t.length)||0},E=function(e){return e.spotlightActions||{}},T=function(e){var t;return null==(t=e.spotlight.items)?void 0:t[0]},M=function(e){return e.telemetry.actions||{}},R=function(e){return e.telemetry.data||{}}},6223:function(e,t,n){n.d(t,{R:()=>i,r:()=>c});var r=n(24522),o=n(94571),i={POPULAR:"popular",LATEST:"latest",OLDEST:"oldest"},a=[o.d.APPROVED,o.d.ANSWERED,o.d.UNANSWERED],s=function(e,t){return t===o.d.APPROVED&&a.includes(e.status)||e.status===t},l=function(e,t){switch(t){case"latest":return e.sort(function(e,t){var n=new Date(t.approved_at||t.created_at),r=new Date(e.approved_at||e.created_at);return n.getTime()-r.getTime()});case"oldest":return e.sort(function(e,t){var n=new Date(t.approved_at||t.created_at);return new Date(e.approved_at||e.created_at).getTime()-n.getTime()});case"popular":return e.sort(function(e,t){return t.upvotes_count-e.upvotes_count});default:return e}},c=(0,r.n)(function(e,t){return{qa:{session:null,questions:[],filterByStatus:o.d.APPROVED,sortBy:i.LATEST,replyingQuestionId:null,replies:[],upvotedQuestionIds:[],pendingQuestionIds:[]},qaActions:{setSession:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t().qa.session;e(function(e){r.setInitialFilter&&!i&&(null==n?void 0:n.enabled)&&((null==n?void 0:n.has_pending_questions)?e.qa.filterByStatus=o.d.PENDING:e.qa.filterByStatus=o.d.APPROVED),e.qa.session=n})},setQuestions:function(t){return e(function(e){e.qa.questions=t;var n=t.filter(function(e){return e.upvoted_by_current_community_member}).map(function(e){return e.id}),r=new Set(e.qa.upvotedQuestionIds);n.forEach(function(e){return r.add(e)}),e.qa.upvotedQuestionIds=Array.from(r)})},setFilterToSee:function(e){s(e,t().qa.filterByStatus)||t().qaActions.setFilterByStatus(e.status)},addQuestion:function(n){var r=t().qa,o=r.questions,i=r.filterByStatus,a=r.sortBy;s(n,i)&&!o.some(function(e){return e.id===n.id})&&e(function(e){e.qa.questions.push(n),e.qa.questions=l(e.qa.questions,a)})},updateQuestion:function(n){var r=t().qa,o=r.questions,i=r.filterByStatus,a=r.sortBy,c=o.findIndex(function(e){return e.id===n.id});-1!==c?e(function(e){s(n,i)?e.qa.questions[c]=n:e.qa.questions.splice(c,1),e.qa.questions=l(e.qa.questions,a)}):s(n,i)&&t().qaActions.addQuestion(n)},updateUpvotedQuestionIds:function(n){var r=new Set(t().qa.upvotedQuestionIds);n.upvoted_by_current_community_member?r.add(n.id):r.delete(n.id),e(function(e){e.qa.upvotedQuestionIds=Array.from(r)})},setPendingQuestionIds:function(t){return e(function(e){e.qa.pendingQuestionIds=t})},updatePendingQuestionIds:function(n){var r=new Set(t().qa.pendingQuestionIds);n.status===o.d.PENDING?r.add(n.id):r.delete(n.id),e(function(e){e.qa.pendingQuestionIds=Array.from(r),0===r.size&&e.qa.session&&(e.qa.session.has_pending_questions=!1)})},clearSpotlightedQuestions:function(){e(function(e){e.qa.questions=e.qa.questions.map(function(e){var t,n;return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),n=n={spotlighted:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t})})},deleteQuestion:function(t){return e(function(e){e.qa.questions=e.qa.questions.filter(function(e){return e.id!==t}),e.qa.pendingQuestionIds=e.qa.pendingQuestionIds.filter(function(e){return e!==t})})},setReplyingQuestionId:function(t){return e(function(e){e.qa.replyingQuestionId=t})},setReplies:function(t){return e(function(e){e.qa.replies=t})},addReply:function(n){return e(function(e){var r=t().qa,o=r.replyingQuestionId,i=r.replies;o!==n.question_id||i.some(function(e){return e.id===n.id})||e.qa.replies.push(n)})},updateReply:function(n){var r=t().qa.replies.findIndex(function(e){return e.id===n.id});-1!==r&&e(function(e){e.qa.replies[r]=n})},deleteReply:function(t){return e(function(e){e.qa.replies=e.qa.replies.filter(function(e){return e.id!==t})})},setFilterByStatus:function(t){return e(function(e){e.qa.filterByStatus=t})},setSortBy:function(t){return e(function(e){e.qa.sortBy=t})}}}})},57836:function(e,t,n){n.d(t,{G:()=>o,q:()=>i});var r=n(24522),o=Object.freeze({CHAT:"CHAT",PARTICIPANTS:"PARTICIPANTS",QA:"QA"}),i=(0,r.n)(function(e,t){return{ui:{isSidebarOpen:!1,setIsSidebarOpen:function(t){return e(function(e){e.ui.isSidebarOpen=t})},hideSidebar:function(){return e(function(e){e.ui.isSidebarOpen=!1})},currentTab:o.CHAT,setCurrentTab:function(t){return e(function(e){e.ui.currentTab=t})},displayChat:function(){return e(function(e){e.ui.isSidebarOpen=!0,e.ui.currentTab=o.CHAT,e.ui.hasUnseenChatMessages=!1})},toggleChat:function(){t().ui.isSidebarOpen&&t().ui.currentTab===o.CHAT?t().ui.hideSidebar():t().ui.displayChat()},displayQA:function(){return e(function(e){e.ui.isSidebarOpen=!0,e.ui.currentTab=o.QA,e.ui.hasUnseenQuestions=!1})},toggleQA:function(){t().ui.isSidebarOpen&&t().ui.currentTab===o.QA?t().ui.hideSidebar():t().ui.displayQA()},displayParticipants:function(){return e(function(e){e.ui.isSidebarOpen=!0,e.ui.currentTab=o.PARTICIPANTS,e.ui.hasUnseenChatMessages=!1})},toggleParticipants:function(){t().ui.isSidebarOpen&&t().ui.currentTab===o.PARTICIPANTS?t().ui.hideSidebar():t().ui.displayParticipants()},isCohostsModalOpen:!1,setIsCohostsModalOpen:function(t){return e(function(e){e.ui.isCohostsModalOpen=t})},displayCohostsModal:function(){t().ui.displayParticipants(),t().ui.setIsCohostsModalOpen(!0)},hideCohostsModal:function(){t().ui.setIsCohostsModalOpen(!1)},isMuteParticipantsModalOpen:!1,setIsMuteParticipantsModalOpen:function(t){return e(function(e){e.ui.isMuteParticipantsModalOpen=t})},displayMuteParticipantsModal:function(){t().ui.setIsMuteParticipantsModalOpen(!0)},hideMuteParticipantsModal:function(){t().ui.setIsMuteParticipantsModalOpen(!1)},hasUnseenChatMessages:!1,setHasUnseenChatMessages:function(t){return e(function(e){e.ui.hasUnseenChatMessages=t})},onNewChatMessage:function(){t().ui.isSidebarOpen&&t().ui.currentTab===o.CHAT||t().ui.setHasUnseenChatMessages(!0)},hasUnseenQuestions:!1,setHasUnseenQuestions:function(t){return e(function(e){e.ui.hasUnseenQuestions=t})},onNewQuestion:function(){t().ui.isSidebarOpen&&t().ui.currentTab===o.QA||t().ui.setHasUnseenQuestions(!0)},isRoomInfoOpen:!1,setIsRoomInfoOpen:function(t){return e(function(e){e.ui.isRoomInfoOpen=t})},toggleIsRoomInfoOpen:function(){return e(function(e){e.ui.isRoomInfoOpen=!e.ui.isRoomInfoOpen})},isFullscreen:!1,setIsFullscreen:function(t){return e(function(e){e.ui.isFullscreen=t})},toggleFullscreen:function(){return e(function(e){e.ui.isFullscreen?document.exitFullscreen():document.documentElement.requestFullscreen()})},isPublicStreamNotificationVisible:!1,isPublicStreamNotificationDismissed:!1,setPublicStreamNotificationVisible:function(t){return e(function(e){e.ui.isPublicStreamNotificationVisible=t})},hidePublicStreamNotification:function(){return e(function(e){e.ui.isPublicStreamNotificationVisible=!1,e.ui.isPublicStreamNotificationDismissed=!0})}}}})},45024:function(e,t,n){n.d(t,{I:()=>y});var r=n(64100),o=n(11621),i=n(6223),a=n(24522),s=(0,a.n)(function(e,t){return{session:{spectators:{shouldPoll:!0,setShouldPoll:function(t){return e(function(e){e.session.spectators.shouldPoll=t})},isLoading:!1,isFetching:!1,loadFn:null,setLoadFn:function(t){return e(function(e){e.session.spectators.loadFn=t})},load:function(){var n,r=null!=(n=t().session.spectators.loadFn)?n:function(){return Promise.resolve()};e(function(e){e.session.spectators.isLoading=!0}),r().finally(function(){e(function(e){e.session.spectators.isLoading=!1})})},hasNext:!1,setHasNext:function(t){return e(function(e){e.session.spectators.hasNext=t})},loadMoreFn:null,setLoadMoreFn:function(t){return e(function(e){e.session.spectators.loadMoreFn=t})},loadMore:function(){var n,r=null!=(n=t().session.spectators.loadMoreFn)?n:function(){return Promise.resolve()};e(function(e){e.session.spectators.isFetching=!0}),r().finally(function(){e(function(e){e.session.spectators.isFetching=!1})})},total:0,setTotal:function(t){return e(function(e){e.session.spectators.total=t})},data:[],setData:function(t){return e(function(e){e.session.spectators.data=t})}}}}}),l=n(34811),c=(0,a.n)(function(e){return{settings:{microphoneEnabled:!0,cameraEnabled:!0,audioInputId:l.w5,audioOutputId:null,videoInputId:l.w5,blurEnabled:!1,mirrorEnabled:!0,noiseSuppression:"basic",gridLayoutPageSize:l.SF,speakerLayoutPageSize:l.dF,infinityMirrorAlertDisabled:!1},settingsActions:{toggleMicrophone:function(){return e(function(e){e.settings.microphoneEnabled=!e.settings.microphoneEnabled})},setMicrophoneEnabled:function(t){return e(function(e){e.settings.microphoneEnabled=t})},toggleCamera:function(){return e(function(e){var t;e.settings.cameraEnabled=!(null==(t=e.settings)?void 0:t.cameraEnabled)})},setCameraEnabled:function(t){return e(function(e){e.settings.cameraEnabled=t})},setAudioInputId:function(t){return e(function(e){e.settings.audioInputId=t})},setAudioOutputId:function(t){return e(function(e){e.settings.audioOutputId=t})},setVideoInputId:function(t){return e(function(e){e.settings.videoInputId=t})},toggleBlur:function(){return e(function(e){var t;e.settings.blurEnabled=!(null==(t=e.settings)?void 0:t.blurEnabled)})},toggleMirror:function(){return e(function(e){var t;e.settings.mirrorEnabled=!(null==(t=e.settings)?void 0:t.mirrorEnabled)})},setNoiseSuppression:function(t){return e(function(e){e.settings.noiseSuppression=t})},setBlurEnabled:function(){return e(function(e){e.settings.blurEnabled=!0})},setGridLayoutPageSize:function(t){return e(function(e){var n=Math.min(Math.max(t,l.CH),l.O_);e.settings.gridLayoutPageSize=n})},setSpeakerLayoutPageSize:function(t){return e(function(e){var n=Math.min(Math.max(t,l.fm),l.nX);e.settings.speakerLayoutPageSize=n})},toggleInfinityMirrorAlert:function(){return e(function(e){e.settings.infinityMirrorAlertDisabled=!e.settings.infinityMirrorAlertDisabled})}}}}),u=n(51630);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var f=(0,a.n)(function(e){return{spotlight:{items:[],errorMessage:void 0,isLoading:!1},spotlightActions:{fetchSpotlightItems:function(t){var n,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(function(e){e.spotlight.isLoading=!0}),u.Qk.getSpotlightItems({roomId:t,params:(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},o),r=r={sort:"oldest"},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(r)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}),n)}).then(function(t){e(function(e){e.spotlight.items=t.records,e.spotlight.isLoading=!1})}).catch(function(t){console.error(t),e(function(e){e.spotlight.errorMessage="Failed to fetch spotlight items",e.spotlight.isLoading=!1})})},addSpotlightItem:function(t){e(function(e){var n;e.spotlight.items=((function(e){if(Array.isArray(e))return d(e)})(n=e.spotlight.items)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return d(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}}(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([t])})},deleteSpotlightItem:function(t){e(function(e){e.spotlight.items=e.spotlight.items.filter(function(e){return e.id!==t})})},setSpotlightItems:function(t){e(function(e){e.spotlight.items=t})},clearSpotlightItems:function(t){e(function(e){e.spotlight.items=[]}),u.Qk.clearSpotlightItems({roomId:t})}}}}),m={connectionQualitySeries:[],providerErrors:[]},p=(0,a.n)(function(e){return{telemetry:{data:m,actions:{clearData:function(){e(function(e){e.telemetry.data=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},m)})},addConnectionQualityData:function(t){e(function(e){e.telemetry.data.connectionQualitySeries.push({timestamp:Date.now(),value:t})})},addProviderError:function(t){e(function(e){var n=e.telemetry.data.providerErrors,r=n[n.length-1];(!r||r.message!==t)&&(e.telemetry.data.providerErrors.push({timestamp:Date.now(),message:t}),e.telemetry.data.providerErrors.length>10&&(e.telemetry.data.providerErrors=e.telemetry.data.providerErrors.slice(-10)))})}}}}}),b=n(57836);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function v(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return h(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var y=(0,r.Ue)()((0,o.tJ)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},c.apply(void 0,v(t)),b.q.apply(void 0,v(t)),s.apply(void 0,v(t)),i.r.apply(void 0,v(t)),f.apply(void 0,v(t)),p.apply(void 0,v(t)))},{name:"circle-live-storage",version:3,partialize:function(e){return{settings:e.settings}}}))},1924:function(e,t,n){n.d(t,{b:()=>u});var r=n(85893),o=n(67294),i=n(84326),a=n(80926),s=n(78522),l=n(37588),c=n(41553),u=function(e){var t=e.setIsLimitReached,n=e.initialCohostQuantity,u=e.shouldDisplayDisabledSearchMessage,d=((0,s.B)().selectionState||{}).memberCount+(void 0===n?1:n)||1,f=(0,a.oQ)().config,m=(null==f?void 0:f.live_stream_max_host_capacity)||null,p=d>=Number(m);return(0,o.useEffect)(function(){m&&(d<=Number(m)-l.ln?t(!1):t(!0))},[d,m,t]),(0,r.jsxs)("div",{className:"mb-4 text-center",children:[(0,r.jsx)("div",{children:(0,r.jsx)(c.Z.LabelSm,{weight:p?"medium":"normal",children:(0,i.t)("live_streams.room.cohosts_counter_message",{count:Math.min(d,Number(m||0)),hostCapacity:Number(m||0)})})}),void 0!==u&&u&&(0,r.jsx)("div",{children:(0,r.jsx)(c.Z.LabelSm,{children:(0,i.t)("live_streams.room.cohosts_disable_search_message")})})]})}},80926:function(e,t,n){n.d(t,{$v:()=>y,IO:()=>x,lQ:()=>_,Wk:()=>r.W,tm:()=>c,wK:()=>h,oQ:()=>a,Yq:()=>v});var r=n(59361),o=n(88767),i=n(13532),a=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=(0,o.useQuery)(i.av.liveStreams.configurations(),{enabled:e}),n=t.data,r=t.isLoading,a={};return null==n||n.forEach(function(e){a[e.feature_flag]=e.value}),{isLoading:r,config:a}},s=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=(0,o.useQuery)(i.av.liveStreams.usage(),{enabled:e}),n=t.data,r=t.isLoading,a={};return null==n||n.forEach(function(e){a[e.type]=e.value}),{isLoading:r,usage:a}},l=n(96486),c=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0}).enabled,t=a({enabled:e}),n=t.config,r=t.isLoading,o=s({enabled:e}),i=o.usage,c=o.isLoading,u=v(l.noop,{enabled:e}).currentQuantity,d=Number(y(l.noop,{enabled:e}).currentQuantity||0),f=Number(u||0),m=(null==i?void 0:i.stream_duration)||0,p=Number((null==n?void 0:n.live_stream_monthly_stream_hours)||0),b=(null==i?void 0:i.recordings_duration)||0,h=Number((null==n?void 0:n.live_stream_recording_hours)||0);return{isLoading:r||c,streamingHoursAvailable:m<3600*p+3600*d,recordingHoursAvailable:b<3600*h+3600*f,streamingTotalPlanHours:p+d,recordingTotalPlanHours:h+f}},u=n(84326),d=n(51630),f=n(95533),m=n(24869),p=function(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{enabled:!0}).enabled,a=(0,m.E)().isCommunityOnTrial,s=(0,o.useQuery)(f.a.communityPlanAddons.show({addonId:e}),{enabled:r,staleTime:6e5,retry:function(e,t){return![401,404].includes(null==t?void 0:t.status)}}),l=s.data,c=s.isLoading,p=s.refetch,b=s.isFetching,h=l||{},v=h.id,y=h.max_purchasable_quantity,g=h.name,_=h.quantity,x=h.unit_size,j=!y||"number"==typeof _&&_<y,w=function(e){return!y||"number"==typeof _&&_+e<=y},O=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return a?Promise.resolve().then(function(){return window.location.href=(0,i.xn)()}):v&&_&&w(n)?d.zV.create((e={},t="number"==typeof _?_+n:_,v in e?Object.defineProperty(e,v,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[v]=t,e)):Promise.reject((0,u.t)("addons.community_plan_addon_hook.quantity_not_available_message"))},S=(0,o.useMutation)(function(e){return O(e)},{onSuccess:function(){p(),null==n||n()},onError:function(e){null==t||t(e)}});return{id:v,currentQuantity:_,maxPurchasableQuantity:y,name:g,unitSize:x,canPurchase:j,canPurchaseQuantity:w,purchase:S.mutate,purchaseAsync:S.mutateAsync,refetch:p,isLoading:c,isFetching:b,isPurchasing:S.isLoading}},b=n(60878),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0},t=(0,b.pm)().error;return p("live_stream_spectators",function(){return t((0,u.t)("live_streams.room.attendees_addon_quantity_error"))},l.noop,e)},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.noop,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0},n=(0,b.pm)().error;return p("live_stream_recording_hours",function(){return n((0,u.t)("live_streams.room.recording_hours_addon_error"))},e,t)},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.noop,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0},n=(0,b.pm)().error;return p("live_stream_monthly_stream_hours",function(){return n((0,u.t)("live_streams.room.stream_hours_addon_error"))},e,t)},g=function(){var e=v(),t=e.isLoading,n=e.currentQuantity,r=e.refetch,o=y(),i=o.isLoading,a=o.currentQuantity,s=o.refetch,l=h(),c=l.isLoading,u=l.currentQuantity,d=l.refetch;return{recordingHoursAddonQuantity:n,streamHoursAddonQuantity:a,attendeeSeatsAddonQuantity:u,isLoading:t||i||c,refetch:function(){r(),s(),d()}}},_=function(){var e,t,n,r=a(),o=r.config,i=r.isLoading,l=s(),c=l.usage,u=l.isLoading,d=g(),f=d.refetch,m=d.isLoading,p=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(d,["refetch","isLoading"]);return{monthlyHourLimit:parseInt(null==o?void 0:o.live_stream_monthly_stream_hours)+parseInt((null==p||null==(e=p.streamHoursAddonQuantity)?void 0:e.toString())||"0"),monthlyHourUsage:((null==c?void 0:c.stream_duration)||0)/3600,storageLimit:parseInt(null==o?void 0:o.live_stream_recording_hours)+parseInt((null==p||null==(t=p.recordingHoursAddonQuantity)?void 0:t.toString())||"0"),storageUsage:((null==c?void 0:c.recordings_duration)||0)/3600,hostLimit:null==o?void 0:o.live_stream_max_host_capacity,participantLimit:parseInt(null==o?void 0:o.live_stream_max_spectator_capacity)+parseInt((null==p||null==(n=p.attendeeSeatsAddonQuantity)?void 0:n.toString())||"0"),isLoading:i||u||m,refetchAddons:f}},x=function(){var e=(0,o.useQuery)(i.av.liveStreams.usageLimit()),t=e.data;return{isLoading:e.isLoading,isMonthlyHourLimitReached:null==t?void 0:t.streaming_limit_reached,isStorageLimitReached:null==t?void 0:t.recording_limit_reached}}},59361:function(e,t,n){n.d(t,{W:()=>d});var r=n(88767),o=n(70442),i=n(84326),a=n(51630),s=n(41342),l=n(37588),c=n(13532),u=n(60878),d=function(){var e,t=(0,s.wh)().currentUser,n=(0,u.pm)(),d=n.error,f=n.success,m=(0,o.k6)(),p=(0,r.useQuery)(c.av.liveStreams.liveNow({params:{per_page:1}})),b=p.data,h=p.remove,v=null==b||null==(e=b.records)?void 0:e[0],y=(0,r.useMutation)(function(){return a.Qk.endStream({id:null==v?void 0:v.id})},{onSuccess:function(){f((0,i.t)("live_streams.room.".concat((0,l.vX)(v),".end_success"))),h()},onError:function(){return d((0,i.t)("live_streams.room.".concat((0,l.vX)(v),".end_error")))}});return{room:v,canManage:null==v?void 0:v.can_manage,handleNavigateToRoom:function(){if(v){var e=c.dE.room({roomSlug:v.slug});t||((0,l.L6)(v)?e=c.dE.publicRoom({roomSlug:v.slug}):window.location.href=c.dE.room({roomSlug:v.slug})),m.push(e)}},handleEndStream:function(e){null==e||e.stopPropagation(),y.mutate()}}}},12367:function(e,t,n){n.d(t,{T:()=>j});var r=n(85893),o=n(67294),i=n(46977),a=n(84326),s=n(57105),l=n(98471),c=n(44830),u=n(41553),d=n(1168),f=n(51169),m=n(34519),p=n(75148),b=n(37614),h=n(57363),v=function(e){var t=e.direction,n=e.onClick;return(0,r.jsx)("button",{type:"button",className:"bg-primary focus-visible:!outline-secondary flex h-12 w-12 items-center justify-center rounded-full shadow focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:n,children:(0,r.jsx)(h.JO,{size:20,type:"20-arrow-left",className:"right"==(void 0===t?"right":t)?"rotate-180":""})})};function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var _=function(e){var t=e.attachments,n=void 0===t?[]:t,h=e.startIndex,y=g((0,o.useState)(void 0===h?0:h),2),_=y[0],x=y[1],j=g((0,o.useState)(!1),2),w=j[0],O=j[1],S=(0,s.dd)();(0,o.useEffect)(function(){});var P=_<n.length-1,C=_>0,I=function(){return P&&x(_+1)},k=function(){return C&&x(_-1)},N=n[_],A=N.image_variants||{},E=c.$.isPDF(N.content_type),T=c.$.isImage(N.content_type),M=c.$.isNativelySupportedVideo(N.content_type);return(0,i.y1)("left",k,{enabled:C},[C,_,n]),(0,i.y1)("right",I,{enabled:P},[P,_,n]),(0,o.useEffect)(function(){T&&w&&O(!1)},[N]),(0,r.jsxs)(m.u_,{isOpen:S.visible,onClose:function(){return S.remove()},title:N.filename,children:[(0,r.jsx)(m.u_.Overlay,{}),(0,r.jsxs)(m.u_.Content,{size:"full",children:[(0,r.jsxs)(m.u_.Header,{children:[(0,r.jsx)(u.Z.LabelMd,{weight:"medium",children:N.filename}),(0,r.jsxs)(m.u_.HeaderActions,{className:"items-center",children:[(0,r.jsx)(p.h,{ariaLabel:(0,a.t)("download"),name:"download",className:"ml-2 focus:outline-none",iconClassName:"!text-dark",buttonSize:28,iconSize:16,onClick:function(){window.open(N.url,"_blank")},variant:"primary"}),(0,r.jsx)(m.u_.CloseButton,{onClick:S.remove})]})]}),(0,r.jsxs)(m.u_.Body,{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"w-16",children:C&&(0,r.jsx)(v,{direction:"left",onClick:k})}),(0,r.jsxs)("div",{className:"flex max-h-full flex-1 select-none justify-center",children:[E&&(0,r.jsx)(l.X,{src:N.url}),M&&(0,r.jsx)(b.W,{src:N.url,type:N.content_type,controlsList:"play",autoPlay:!0,poster:A.thumbnail}),T&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{loading:"eager",alt:"",className:(0,d.A)("object-contain",{hidden:!w}),src:A.large||N.url,onLoad:function(){return O(!0)},onError:function(){return O(!0)}}),!w&&(0,r.jsx)(f.a,{center:!0})]})]}),(0,r.jsx)("div",{className:"w-16",children:P&&(0,r.jsx)(v,{direction:"right",onClick:I})})]})]})]})},x=s.gk.create(function(e){var t=e.startIndex,n=e.attachments;return(0,r.jsx)(_,{startIndex:t,attachments:n})}),j=function(){return(0,s.dd)(x)}},9339:function(e,t,n){n.d(t,{h:()=>x});var r=n(85893),o=n(96486),i=n(57105),a=n(84326),s=n(17013),l=n(41084),c=n(39905),u=n(51466),d=n(26950),f=n(41553),m=function(e){var t=e.post,n=e.spaces,o=e.isOpen,i=e.isLoading,m=e.isSubmitting,p=e.onSubmit,b=e.onClose;return i?null:(0,r.jsx)(d.u,{title:(0,a.t)("duplicate_post"),variant:"default",show:o,onClose:b,overflowVisible:!0,children:(0,r.jsxs)(u.l,{defaultValues:{space_id:t.space_id,send_notifications:!1},onSubmit:function(e){return p(e)},children:[(0,r.jsx)(u.l.Item,{name:"space_id",label:(0,a.t)("space"),description:(0,a.t)("duplicate_post_to_space"),rules:{required:(0,a.t)("events.create.form.space_required_error")},hideBorder:!0,fullWidth:!0,children:(0,r.jsx)(s.M,{name:"space_id",variant:"form-input",containerClassname:"mt-2",spaces:n})}),(0,l.Hz)(t)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z.LabelXs,{color:"text-light",children:(0,a.t)("comments_wont_be_duplicated")}),(0,r.jsx)(u.l.Item,{name:"send_notifications",label:(0,a.t)("duplicate_post_send_notifications"),hideDescription:!0,inlineReverse:!0,hideBorder:!0,fullWidth:!0,children:(0,r.jsx)(u.l.ToggleSwitch,{name:"send_notifications",variant:"small"})})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(c.z,{type:"submit",variant:"primary",disabled:m,children:m?(0,a.t)("duplicating"):(0,a.t)("duplicate")})})]})})},p=n(88767),b=n(34962),h=n(60878),v=function(e){var t=e.post,n=e.onSuccess,r=(0,h.pm)(),i=r.success,s=r.error,l=(0,p.useMutation)(function(e){return(0,b.gX)({spaceId:t.space_id,postSlug:t.slug,payload:{post:{space_id:e.space_id,send_notifications:e.send_notifications}}})},{onSuccess:function(e){i((0,a.t)("duplicated_successfully")),(0,o.isFunction)(n)&&n(e)},onError:function(){s((0,a.t)("duplication_failed"))}});return{duplicate:l.mutate,isDuplicating:l.isLoading}},y=n(41342),g=function(e){var t=e.post,n=e.onSuccess,a=(0,i.dd)(),s=(0,y.nT)(),l=s.isLoading,c=s.helpers,u=v({post:t,onSuccess:function(e){(0,o.isFunction)(n)&&n(e),a.remove()}}),d=u.duplicate,f=u.isDuplicating;return(0,r.jsx)(m,{post:t,spaces:c.imageSpacesWithPostCreationAllowed(),isOpen:a.visible,isLoading:l,isSubmitting:f,onSubmit:d,onClose:a.remove})},_=i.gk.create(function(e){return(0,r.jsx)(g,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),x=function(){return(0,i.dd)(_)}},64282:function(e,t,n){n.d(t,{Z:()=>c});var r=n(85893),o=n(72950),i=n(57105),a=n(83730),s=function(e){var t=e.event,n=e.defaultSection,s=e.locationType,l=(0,i.dd)(),c=l.visible,u=l.hide;return(0,r.jsx)(a.K,{children:(0,r.jsx)(o.G,{isOpen:c,onClose:u,event:t,locationType:s,initialSection:n})})},l=i.gk.create(function(e){var t=e.event,n=e.defaultSection,o=e.locationType;return(0,r.jsx)(s,{event:t,defaultSection:n,locationType:o})}),c=function(){return(0,i.dd)(l)}},29662:function(e,t,n){n.d(t,{e:()=>tE});var r,o=n(85893),i=n(96486),a=n(84326),s=n(67294),l=n(39905),c=n(34519);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d="upload_images",f="adjust_images",m="create_post",p="square",b="landscape",h="portrait",v=(u(r={},p,1),u(r,b,16/9),u(r,h,.8),r),y=n(64100);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return g(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var x=function(e){return e.selectedFiles.forEach(function(e){return URL.revokeObjectURL(e.preview)}),{selectedFiles:[]}},j=(0,y.Ue)(function(e){return{currentStep:d,isSubmitting:!1,isFormDirty:!1,isImagesDirty:!1,isScheduledBarPortalRendered:!1,galleryAspectRatio:null,selectedFiles:[],uploadedImages:[],setCurrentStep:function(t){return e({currentStep:t})},setIsSubmitting:function(t){return e({isSubmitting:t})},setIsFormDirty:function(t){return e({isFormDirty:t})},setIsImagesDirty:function(t){return e({isImagesDirty:t})},setIsScheduledBarPortalRendered:function(t){return e({isScheduledBarPortalRendered:t})},updateImage:function(t){e(function(e){var n=e.selectedFiles.findIndex(function(e){return e.preview===t.preview});return e.selectedFiles[n]=t,{selectedFiles:_(e.selectedFiles)}})},addSelectedFiles:function(t){e(function(e){return{selectedFiles:_(e.selectedFiles).concat(_(t))}})},setSelectedFiles:function(t){e({selectedFiles:t})},addUploadedImages:function(t){e(function(e){return{uploadedImages:_(e.uploadedImages).concat(_(t))}})},setUploadedImages:function(t){e({uploadedImages:t})},setGalleryAspectRatio:function(t){t<(v.portrait+v.square)/2?e({galleryAspectRatio:v.portrait}):t>(v.landscape+v.square)/2?e({galleryAspectRatio:v.landscape}):e({galleryAspectRatio:v.square})},resetSelectedFiles:function(){e(x)},reset:function(){e(function(e){var t,n;return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},x(e)),n=n={currentStep:null,uploadedImages:[],galleryAspectRatio:null,isSubmitting:!1,isFormDirty:!1,isImagesDirty:!1,isScheduledBarPortalRendered:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t})}}}),w=n(94184),O=n.n(w),S=n(71068),P=n(41553),C=n(80171),I=n(75148);function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var N=[{format:p,iconType:"16-image-square"},{format:h,iconType:"16-image-portrait"},{format:b,iconType:"16-image-landscape"}],A=function(){var e,t=j(),n=t.galleryAspectRatio,r=t.setGalleryAspectRatio,i=null==(e=Object.entries(v).find(function(e){return(function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return k(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[1]===n}))?void 0:e[0],s="image_space.post_modal.steps.adjust_images.cropping_options";return(0,o.jsx)("div",{className:"text-default flex justify-between",children:N.map(function(e){var t=e.format,n=e.iconType;return(0,o.jsx)(C.T,{content:(0,a.t)("".concat(s,".").concat(t)),children:(0,o.jsx)(I.h,{onClick:function(){r(v[t])},className:O()({"bg-tertiary":i===t}),name:n,iconSize:16,buttonSize:28,iconClassName:O()({"!text-dark":i===t}),ariaLabel:(0,a.t)("".concat(s,".").concat(t))})},t)})})},E=n(45659);function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function R(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var D=function(e){var t,n=e.currentImage,r=(t=(0,s.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return T(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r[0],l=r[1],c=j(),u=c.updateImage,d=c.galleryAspectRatio,f=c.setGalleryAspectRatio;return((0,s.useEffect)(function(){var e=new Image;e.src=n.preview,e.onload=function(){l(e)}},[n.preview]),(0,s.useEffect)(function(){!d&&a&&f(a.width/a.height)},[d,a]),a&&d)?(0,o.jsx)("div",{className:"relative flex aspect-video max-w-full grow cursor-pointer",children:(0,o.jsx)(E.Z,{image:n.preview,crop:n.crop,aspect:d,zoom:n.zoom,onCropChange:function(e){e!==n.crop&&u(R(M({},(0,i.cloneDeep)(n)),{crop:e}))},onZoomChange:function(e){e!==n.zoom&&u(R(M({},(0,i.cloneDeep)(n)),{zoom:e}))},onCropComplete:function(e,t){u(R(M({},(0,i.cloneDeep)(n)),{croppedAreaPixels:t}))}})}):null},L=n(94556),F=n(57363),U=n(44081),B=n(89213),q=n(49705),z=n(17617),Z=function(e){var t=e.onClick,n=e.index,r=e.currentImageIndex,i=!!(0,U.dw)().activeItem,s=(0,z.en)();return(0,o.jsx)(I.h,{onClick:t,className:O()("bg-tertiary border-secondary outline-tertiary absolute -right-0.5 -top-0.5 z-10 hidden h-4 w-4 rounded-full border !p-0 outline outline-2",{"group-hover:!flex":!i},{"!flex":!s&&!i&&n===r}),buttonSize:16,iconClassName:"!text-dark",name:"16-close",ariaLabel:(0,a.t)("delete_image")})},H=function(e){var t,n=e.direction,r=e.scrollableContainerRef;null==r||null==(t=r.current)||t.scroll({left:(null==r?void 0:r.current.scrollLeft)+("left"===n?-200:200),behavior:"smooth"})},V=function(e){var t=e.direction,n=e.scrollableContainerRef,r="left"===t,i="right"===t;return(0,o.jsxs)("div",{className:O()("absolute z-30 flex h-full items-center",{"-left-px":r,"-right-px":i}),children:[i&&(0,o.jsx)("div",{className:"from-primary h-full w-8 bg-gradient-to-l to-transparent"}),(0,o.jsx)("button",{type:"button",onClick:function(){return H({direction:t,scrollableContainerRef:n})},className:"bg-primary group flex h-full cursor-pointer items-center px-2 py-1",children:(0,o.jsx)(F.JO,{size:16,className:O()({"-rotate-90":i,"rotate-90":r},"text-light group-hover:text-darkest"),type:"caret-down-bold"})}),r&&(0,o.jsx)("div",{className:"from-primary h-full w-8 bg-gradient-to-r to-transparent"})]})},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.noop,t=j().addSelectedFiles;return{handleFileSelection:function(n){t(n=n.map(function(e){return{file:e,preview:URL.createObjectURL(e),crop:{x:0,y:0},zoom:1}})),e()}}},W=n(7391),G=n(60878),$=function(e){var t=e.handleFileSelection,n=e.selectedFiles,r=e.uploadedFilesCount,o=(0,G.pm)(),i="image_space.post_modal.steps.upload_images.errors",s=10-r,l=function(e){e.reduce(function(e,t){var n=t.errors[0].code;return e.includes(n)||e.push(n),e},[]).forEach(function(e){var t={shouldShowCloseButton:!0,shouldUseProgress:!1};switch(e){case"file-invalid-type":return o.error((0,a.t)("".concat(i,".file_invalid_type")),t);case"file-too-large":return o.error((0,a.t)("".concat(i,".file_too_large")),t);case"too-many-files":return o.error((0,a.t)("".concat(i,".too_many_files"),{max_images:10}),t);default:return o.error((0,a.t)("".concat(i,".something_went_wrong")),t)}})},c=(0,W.uI)({onDrop:function(e,r){r.length>0?l(r):parseInt(n.length)+parseInt(e.length)>s?l([{errors:[{code:"too-many-files"}]}]):t(e)},noClick:!0,accept:{"image/*":[".jpg",".jpeg",".png"]},maxFiles:s,maxSize:2e7,multiple:!0}),u=c.getRootProps,d=c.getInputProps,f=c.isDragAccept,m=c.isDragReject;return{getRootProps:u,getInputProps:d,isDragActive:f||m,open:c.open}},K=function(){var e=j(),t=e.setSelectedFiles,n=e.selectedFiles;return{removeImage:function(e){t(n.filter(function(t){return t!==e}))}}},J=function(e){var t=e.fileStates,n=e.index;return(0,o.jsx)("div",{className:"shrink-0 p-1",children:(0,o.jsxs)("div",{className:"bg-tertiary flex h-12 w-12 items-center justify-center rounded-md",children:["completed"===t[n].status&&(0,o.jsx)(F.JO,{type:"20-checkmark-circle-fill",size:20,className:"text-default"}),"uploading"===t[n].status&&(0,o.jsx)(S.D,{percentage:t[n].progress,size:18,strokeWidth:1.5}),"error"===t[n].status&&(0,o.jsx)(P.Z.LabelXs,{color:"text-default",children:(0,a.t)("image_space.post_modal.steps.adjust_images.file_error")})]})})},X=function(e){var t=e.image,n=e.index,r=e.setCurrentImageIndex,i=e.currentImageIndex;return(0,o.jsx)("button",{type:"button",onClick:function(){return r(n)},className:O()("shrink-0 cursor-pointer touch-none select-none rounded-lg border-2 border-transparent p-0.5",{"border-secondary":n===i}),children:(0,o.jsx)("img",{loading:"eager",src:t.preview,className:"h-12 w-12 rounded-md object-cover",alt:t.file.name})},t.preview)},Y=function(e){var t=e.isOverlay,n=(0,U.dI)().item;return(0,o.jsx)("div",{className:O()("rounded-lg border-2 border-transparent p-0.5 opacity-50",{"!opacity-100":void 0!==t&&t}),children:(0,o.jsx)("img",{loading:"eager",src:n.preview,className:"h-12 w-12 rounded-md object-cover",alt:n.file.name})})};function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function en(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ee(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var eo=function(e){var t=e.selectedFiles,n=e.setCurrentImageIndex,r=e.currentImageIndex,i=e.status,a=e.fileStates,l=e.editingImageSignedId,u=e.onDeleteAllImages,d=(0,s.useRef)(null),f=er((0,L.A)(),2),m=f[0],p=f[1],b=er((0,L.A)(),2),h=b[0],v=b[1],y=(0,c.UV)().contentPortalElement,g=j(),_=g.uploadedImages,x=g.setSelectedFiles,w=$({handleFileSelection:Q(function(){setTimeout(function(){return H({direction:"right",scrollableContainerRef:d})},200)}).handleFileSelection,selectedFiles:t,uploadedFilesCount:_.length}),O=w.getInputProps,S=w.open,P=K().removeImage,C=t.map(function(e){return en(et({},e),{id:e.preview})}),I=C[r],k=!l&&t.length+_.length<10;return(0,o.jsxs)("div",{className:"relative mt-5 flex",children:[!p&&(0,o.jsx)(V,{direction:"left",scrollableContainerRef:d}),(0,o.jsxs)(U.cm,{shouldUseKeyboardSensor:!1,distance:10,items:C,onSort:function(e){var t=e.indexOf(I);t!==r&&n(t),x(e.map(function(e){return en(et({},e),{id:void 0})}))},restrictToParentElement:!0,children:[(0,o.jsx)(U.Fo,{children:(0,o.jsxs)("div",{className:"scrollbar-hide m-auto !flex items-center overflow-x-scroll px-1 pt-1",ref:d,"data-testid":"thumbnails-list",children:[(0,o.jsx)("div",{className:"h-px w-px",ref:m}),t.map(function(e,s){return"uploading"===i||"completed"===i?(0,o.jsx)(J,{fileStates:a,index:s},e.preview):(0,o.jsxs)(q.c,{tabIndex:-1,item:C[s],disabled:1===_.length,placeholder:Y,className:"group relative !w-auto shrink-0",dataTestId:"thumbnail-item",children:[(0,o.jsx)(Z,{onClick:function(){P(e),1===t.length&&u()},index:s,currentImageIndex:r}),(0,o.jsx)(X,{image:e,index:s,setCurrentImageIndex:n,currentImageIndex:r})]},e.preview)}),k&&(0,o.jsxs)("button",{type:"button",className:"hover:bg-secondary text-default ml-1 flex h-12 w-12 shrink-0 cursor-pointer items-center justify-center rounded-md border border-dashed",onClick:function(){return"uploading"!==i&&S()},children:[(0,o.jsx)("input",en(et({},O()),{"data-testid":"upload_more_images"})),(0,o.jsx)(F.JO,{type:"20-add-lg",size:20})]}),(0,o.jsx)("div",{className:"h-px w-px",ref:h})]})}),(0,o.jsx)(B.y,{portalTo:y,children:(0,o.jsx)(Y,{isOverlay:!0})})]}),!v&&(0,o.jsx)(V,{direction:"right",scrollableContainerRef:d})]})},ei=n(45555);function ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function es(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function el(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var ec=function(e){var t=e.currentImage,n=j().updateImage;return(0,o.jsxs)("div",{className:"text-light flex items-center justify-between",children:[(0,o.jsx)(I.h,{name:"16-zoom-out",onClick:function(){var e=el(es({},(0,i.cloneDeep)(t)),{zoom:t.zoom-.1});e.zoom>=1&&n(e)},className:"mr-3",iconSize:16,buttonSize:28,ariaLabel:(0,a.t)("zoom_out")}),(0,o.jsx)("div",{className:"flex h-4 w-32 items-center",children:(0,o.jsxs)(ei.i.Root,{value:[Math.round(10*t.zoom)/10],max:5,min:1,step:.1,onValueChange:function(e){var r=(function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,1)||function(e,t){if(e){if("string"==typeof e)return ea(e,1);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ea(e,t)}}(e,1)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];r!==t.zoom&&n(el(es({},(0,i.cloneDeep)(t)),{zoom:r}))},children:[(0,o.jsx)(ei.i.Track,{children:(0,o.jsx)(ei.i.Range,{className:"!bg-badge"})}),(0,o.jsx)(ei.i.Thumb,{className:"before:!bg-badge"})]})}),(0,o.jsx)(I.h,{onClick:function(){var e=el(es({},(0,i.cloneDeep)(t)),{zoom:t.zoom+.1});e.zoom<=5&&n(e)},className:"ml-3",name:"16-zoom-in",iconSize:16,buttonSize:28,ariaLabel:(0,a.t)("zoom_in")})]})};function eu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ed=function(e){var t,n=e.status,r=e.overallProgress,i=e.fileStates,l=e.editingImageSignedId,c=e.onDeleteAllImages,u=(t=(0,s.useState)(0),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return eu(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eu(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1],m=j(),p=m.selectedFiles,b=m.uploadedImages,h=p[d],v=(0,s.useRef)(p.length),y=v.current,g=p.length;return(g>0&&d>g-1?f(p.length-1):g>y&&f(y),v.current=g,h)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:O()("border-primary flex grow flex-col overflow-hidden rounded-md border",{"bg-tertiary":"uploading"===n}),children:["idle"===n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(D,{currentImage:h}),(0,o.jsxs)("div",{className:O()("border-primary flex border-t px-4 py-3",{"justify-between":0===d,"justify-end":d>0}),children:[0===b.length&&0===d&&(0,o.jsx)(A,{}),(0,o.jsx)(ec,{currentImage:h})]})]}),("uploading"===n||"completed"===n)&&(0,o.jsxs)("div",{className:"mb-12 mt-1 flex aspect-video flex-col items-center justify-center gap-4",children:[(0,o.jsx)(S.D,{percentage:r,size:22,strokeWidth:1.75}),(0,o.jsx)(P.Z.LabelMd,{color:"text-default",children:(0,a.t)("image_space.post_modal.steps.adjust_images.uploading")})]}),"error"===n&&(0,o.jsx)("div",{className:"mb-12 mt-1 flex aspect-video flex-col items-center justify-center gap-4",children:(0,o.jsx)(P.Z.LabelMd,{color:"text-default",children:(0,a.t)("image_space.post_modal.steps.adjust_images.files_error")})})]}),(0,o.jsx)(eo,{currentImageIndex:d,selectedFiles:p,setCurrentImageIndex:f,fileStates:i,status:n,editingImageSignedId:l,onDeleteAllImages:c})]}):null},ef=n(94849),em=n(13532);function ep(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function eh(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function ev(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||eg(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ey(e){return function(e){if(Array.isArray(e))return ep(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||eg(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eg(e,t){if(e){if("string"==typeof e)return ep(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ep(e,t)}}var e_=function(){var e=ev((0,s.useState)([]),2),t=e[0],n=e[1],r=ev((0,s.useState)(0),2),o=r[0],i=r[1];return(0,s.useEffect)(function(){var e=t.reduce(function(e,t){return e+t.progress},0);i(t.length?e/t.length:0)},[t]),{status:t.some(function(e){return"error"===e.status})?"error":t.every(function(e){return"idle"===e.status})?"idle":t.every(function(e){return"completed"===e.status})?"completed":"uploading",fileStates:t,overallProgress:o,reset:function(){n([]),i(0)},uploadFiles:function(e){n(e.map(function(){return{progress:0,status:"idle"}})),e.forEach(function(e,t){new ef.TX(e,(0,em.hq)(),{directUploadWillStoreFileWithXHR:function(e){e.upload.addEventListener("loadstart",function(){n(function(e){var n=ey(e);return n[t]=eh(eb({},n[t]),{status:"uploading"}),n})}),e.upload.addEventListener("progress",function(e){n(function(n){var r=ey(n);return r[t]=eh(eb({},r[t]),{progress:e.loaded/e.total*100}),r})})}}).create(function(e,r){if(e)throw n(function(e){var n=ey(e);return n[t]=eh(eb({},n[t]),{status:"error"}),n}),Error("Direct upload failed: ".concat(null==e?void 0:e.message));n(function(e){var n=ey(e);return n[t]=eh(eb({},n[t]),{status:"completed",progress:100,response:eb({blob_url:(0,em.Gd)({signed_id:r.signed_id,filename:encodeURIComponent(r.filename)})},r)}),n})})})}}};function ex(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var ej=function(e,t){var n,r,o,i;return e.width/e.height>t?(o=Math.round(e.height*t),i=e.height,n=Math.round((e.width-o)/2),r=0):(o=e.width,i=Math.round(e.width/t),n=0,r=Math.round((e.height-i)/2)),{x:n,y:r,width:o,height:i}},ew=function(){var e=j(),t=e.selectedFiles,n=e.setSelectedFiles,r=e.galleryAspectRatio,o=e.setUploadedImages,i=e.addUploadedImages,a=e.uploadedImages,s=e.setIsImagesDirty,l=e_(),c=l.status,u=l.overallProgress,d=l.reset,f=l.fileStates,m=l.uploadFiles;return{uploadImages:function(){if(!r)throw Error("Gallery aspect ratio not set");Promise.all(t.map(function(e){return new Promise(function(t,n){var o=new Image,i=document.createElement("canvas"),a=i.getContext("2d");if(e.croppedAreaPixels){var s=e.croppedAreaPixels;parseFloat((s.width/s.height).toFixed(2))!==parseFloat(r.toFixed(2))&&(e.croppedAreaPixels=void 0)}o.src=URL.createObjectURL(e.file),o.onload=function(){var n=e.croppedAreaPixels||ej(o,r);i.width=n.width,i.height=n.height,null==a||a.drawImage(o,n.x,n.y,n.width,n.height,0,0,n.width,n.height),i.toBlob(function(r){r&&t({croppedImage:new File([r],e.file.name,{type:"image/jpeg",lastModified:new Date().getTime()}),croppedArea:n})},"image/jpeg")},o.onerror=function(e){n(e)}})})).then(function(e){n(t.map(function(t,n){var r,o;return r=ex({},t),o=o={croppedAreaPixels:e[n].croppedArea},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}),r})),m(e.map(function(e){return e.croppedImage}))}).catch(function(e){throw Error("Error processing images: ".concat(e))})},overallProgress:u,resetUploads:d,status:c,fileStates:f,updateStoredImages:function(e){if(e){var n=t[0],r={signed_id:f[0].response.signed_id,url:f[0].response.blob_url,original_url:f[0].response.blob_url,filename:f[0].response.filename,width:n.croppedAreaPixels.width,height:n.croppedAreaPixels.height};o(a.map(function(t){return t.signed_id===e?ex({},t,r):t}))}else i(f.map(function(e,n){return{signed_id:e.response.signed_id,url:e.response.blob_url,original_url:e.response.blob_url,filename:e.response.filename,width:t[n].croppedAreaPixels.width,height:t[n].croppedAreaPixels.height}}));s(!0)}}},eO=function(e){var t=e.onClose,n=e.onCompleted,r=void 0===n?i.noop:n,u=e.isOnTop,f=void 0!==u&&u,p=e.editingImageSignedId,b=j(),h=b.setCurrentStep,v=b.resetSelectedFiles,y=ew(),g=y.uploadImages,_=y.overallProgress,x=y.resetUploads,w=y.status,O=y.fileStates,S=y.updateStoredImages,P=function(){v(),f?t():h(d)};return(0,s.useEffect)(function(){"completed"===w?(S(p),x(),v(),h(m),r(),f&&t()):"error"===w&&x()},[f,w]),(0,o.jsxs)(c.u_,{isOpen:!0,onClose:function(){v(),t()},contentPortalId:"adjust-images-modal-portal",children:[(0,o.jsx)(c.u_.Overlay,{}),(0,o.jsxs)(c.u_.Content,{size:"xl",children:[(0,o.jsxs)(c.u_.Header,{children:[(0,o.jsx)(c.u_.Title,{size:"sm",children:(0,a.t)("image_space.post_modal.steps.adjust_images.title")}),(0,o.jsxs)(c.u_.HeaderActions,{className:"!gap-3",children:[(0,o.jsx)(l.z,{type:"button",variant:"secondary",onClick:P,children:(0,a.t)("cancel")}),(0,o.jsx)(l.z,{type:"submit",variant:"circle",disabled:"uploading"===w,onClick:function(){return g()},children:f?(0,a.t)("save"):(0,a.t)("next")})]})]}),(0,o.jsx)(c.u_.Body,{className:"flex flex-col pb-5 pt-4",children:(0,o.jsx)(ed,{status:w,fileStates:O,overallProgress:_,editingImageSignedId:p,onDeleteAllImages:P})})]})]})},eS=n(88767),eP=n(70442),eC=n(27053),eI=n(76810),ek=n(34962);function eN(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function eA(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var eE=function(e){var t=e.payload,n=e.space,r=e.uploadedImages;return{post:eA(eN({},(0,i.omit)(t,["gallery"])),{space_id:null==n?void 0:n.id,gallery_attributes:eA(eN({},t.gallery),{images_attributes:r.map(function(e){return{id:e.id,image:e.signed_id,width:e.width,height:e.height}})})})}},eT=function(e){var t=e.space,n=e.post,r=e.onSuccess,o=(0,G.pm)(),i=j(),s=i.setIsSubmitting,l=i.uploadedImages,c=!!n.slug,u=(0,eS.useMutation)(function(e){return n.slug?(0,ek._u)({spaceId:t.id,postSlug:n.slug,payload:e}):(0,ek.x6)({spaceId:t.id,payload:e})},{onSuccess:function(e){s(!1),r(e),o.success((0,a.t)(c?"quick_post.toasts.changes_saved":"quick_post.toasts.".concat(e.status,"_saved")))},onError:function(e){s(!1),o.error(e.errorDetails,{shouldShowCloseButton:!0,shouldUseProgress:!1})}}).mutate;return{onSubmit:function(e){s(!0),u(eE({payload:e,space:t,uploadedImages:l}))}}},eM=n(41084),eR=n(1892),eD=n(41342),eL=n(51466),eF=n(52293),eU=n(19614),eB=n(30009),eq=n(77646),ez=n(60589),eZ=n(5765);function eH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eV=function(e){var t,n=e.post,r=(t=(0,s.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return eH(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eH(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=r[0],c=r[1],u=(0,z.j)(),d=(0,eF.Gc)(),f=d.watch,m=d.setValue,p=j(),b=p.isSubmitting,h=p.uploadedImages,v=p.isScheduledBarPortalRendered,y=(0,eD.L2)().data,g=f(),_=g.published_at,x=g.status,w=g.topics,O=(null==y?void 0:y.require_topic_selection)&&0>=Number(null==w?void 0:w.length),S=h.length>0&&!b&&!O,P=!!(null==n?void 0:n.id),I=(0,eM.Hz)(n),k="quick_post.scheduled_post_ui.".concat(b?"submitting_button":"submit_button"),N=[{icon:"16-download",label:(0,a.t)("".concat(k,".save_draft")),value:"draft"},{icon:"16-calendar",label:(0,a.t)("".concat(k,".schedule_post")),value:"scheduled"},{icon:"16-publish",label:(0,a.t)("".concat(k,".publish")),value:"published"}],A=(0,i.find)(N,{value:x||"published"}),E=function(e){"scheduled"===e.value?c(!0):(m("status",e.value),c(!1),T(null))},T=function(e){m("published_at",e)},M=function(){E(N[0])},R=y&&(0,ez.k8)(y)&&!I;return(0,o.jsxs)(o.Fragment,{children:[v&&(0,o.jsx)(eq.e,{publishedAt:_,revertToDraftState:M,status:x,updatePublishedAt:T,variant:u?"2-lines":"default"}),(0,o.jsx)(eU.M,{datePickerVisible:l,onCancel:function(e){e&&e.preventDefault(),c(!1),"scheduled"===x&&M()},value:_,onSave:function(e){T(e),m("status","scheduled"),c(!1)},placement:"bottom-end",saveButtonVariant:"circle",children:R?(0,o.jsx)(C.T,{disabled:!O,content:(0,a.t)("quick_post_v2.error_messages.no_topics"),trigger:"mouseenter click focus focusin",placement:"bottom",children:(0,o.jsx)(eZ.F,{type:"submit",disabled:!S,selectedAction:A,setSelectedAction:E,options:N,variant:"circle"})}):(0,o.jsx)(C.T,{disabled:!O,content:(0,a.t)("quick_post_v2.error_messages.no_topics"),trigger:"mouseenter click focus focusin",placement:"bottom",children:(0,o.jsx)(eB.a,{isEdit:P,isDisabled:!S})})})]})},eQ=n(8413),eW=n(51169);function eG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function e$(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var eK=function(e){var t=e.isDragActive,n=e.getRootProps,r=e.getInputProps,i=e.open,s=e.className,l="image_space.post_modal.steps.upload_images";return(0,o.jsx)("div",e$(eG({},n()),{className:"group h-full w-full",children:(0,o.jsxs)("button",{type:"button",className:O()("flex h-full w-full flex-col items-center justify-center px-4 text-center",s),onClick:i,children:[(0,o.jsx)("input",e$(eG({},r()),{"data-testid":"upload_multi_image"})),(0,o.jsx)(F.JO,{size:24,type:"24-circle-arrow-up",className:O()("text-default !h-6 !w-6",{"group-hover:text-messaging-info-blue":!t})}),(0,o.jsx)("div",{className:"mb-1 mt-3",children:(0,o.jsxs)(P.Z.LabelMd,{weight:"semibold",color:O()("text-dark",{"group-hover:text-messaging-info-blue":!t}),children:[(0,a.t)("".concat(l,".drag_and_drop_up_to_n_images"),{max_images:10}),t&&" "+(0,a.t)("".concat(l,".here"))]})}),!t&&(0,o.jsx)(P.Z.LabelSm,{color:"text-default group-hover:text-messaging-info-blue",children:(0,a.t)("".concat(l,".recommendation"))})]})}))};function eJ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eX=function(){var e,t,n,r=(e=(0,s.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return eJ(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eJ(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],a=r[1],l=j(),c=l.selectedFiles,u=l.uploadedImages,d=$({handleFileSelection:Q(function(){return a(!0)}).handleFileSelection,selectedFiles:c,uploadedFilesCount:u.length}),f=d.isDragActive,m=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(d,["isDragActive"]);return(0,o.jsxs)("div",{className:O()("flex h-full w-full flex-col items-center justify-center rounded-md px-4 text-center",{"!bg-light-blue":f}),children:[(0,o.jsx)(eK,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({isDragActive:f},m),n=n={className:"pb-0"},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)),i&&(0,o.jsx)(eO,{onClose:function(){return a(!1)},isOnTop:!0})]})},eY=n(43544),e0=n(19499),e1=function(){var e=j(),t=e.setUploadedImages,n=e.uploadedImages,r=e.setIsImagesDirty;return{removeImage:function(e){t(n.filter(function(t){return t!==e})),r(!0)}}};function e2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function e3(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function e4(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){e3(i,r,o,a,s,"next",e)}function s(e){e3(i,r,o,a,s,"throw",e)}a(void 0)})}}function e6(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var e8=function(e){var t=e.url,n=e.fileName,r=e.contentType;return e4(function(){return e6(this,function(e){switch(e.label){case 0:return[4,fetch(t)];case 1:return[4,e.sent().blob()];case 2:return[2,new File([e.sent()],n,{type:r,lastModified:new Date().getTime()})]}})})()},e5=function(e){var t,n=e.currentImage,r=(t=(0,s.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return e2(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e2(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],l=r[1],c=e1().removeImage,u=Q(function(){return l(!0)}).handleFileSelection,d="image_space.post_modal.steps.create_post.image_options",f=[{value:(0,a.t)("".concat(d,".crop_image")),label:(0,a.t)("".concat(d,".crop_image")),icon:"16-crop",onClick:function(){return e4(function(){return e6(this,function(e){switch(e.label){case 0:return[4,e8({url:n.original_url,fileName:n.filename,contentType:"image/jpeg"})];case 1:return u([e.sent()]),[2]}})})()}},{value:(0,a.t)("".concat(d,".remove")),label:(0,a.t)("".concat(d,".remove")),icon:"16-trash-bin",onClick:function(){c(n)}}];return(0,o.jsxs)(o.Fragment,{children:[i&&(0,o.jsx)(eO,{onClose:function(){return l(!1)},isOnTop:!0,editingImageSignedId:n.signed_id}),(0,o.jsx)(eY.Lt,{direction:"bottom-end",className:"absolute right-4 top-4",button:(0,o.jsx)(I.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark",className:"bg-primary border-primary rounded-full border",ariaLabel:(0,a.t)("".concat(d,".label"))}),children:(0,o.jsx)(e0.A,{options:f,linkType:"button"})})]})};function e9(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function e7(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return e9(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e9(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var te=function(e){var t,n=e.currentImageIndex,r=(0,s.useRef)(null),i=(0,s.useRef)(null),a=e7((0,s.useState)(!0),2),l=a[0],c=a[1],u=e7((0,s.useState)(),2),d=u[0],f=u[1],m=j(),p=m.uploadedImages,b=m.galleryAspectRatio,h=m.setGalleryAspectRatio,v=p[n];return((0,s.useEffect)(function(){!b&&v&&h(v.width/v.height)},[b,v,h]),(0,s.useEffect)(function(){if(!l&&i.current){var e=i.current.getBoundingClientRect();f(e.width/e.height)}},[l,i]),v)?(b&&d&&(t=b>d?"w-full my-auto":b<d?"h-full":"h-full w-full"),(0,o.jsxs)("div",{className:"flex justify-center overflow-auto md:grow",ref:i,children:[l&&(0,o.jsx)(eW.a,{}),(0,o.jsxs)("div",{className:O()("relative",t),children:[(0,o.jsx)(e5,{currentImage:v}),(0,o.jsx)("img",{loading:"eager",ref:r,src:v.url,alt:v.filename,onLoad:function(){return c(!1)},className:O()("rounded-md",{hidden:l},t)})]})]})):(0,o.jsx)(eX,{})};function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tn=function(e){var t,n=e.image,r=e.index,i=e.currentImageIndex,a=e.onClick,l=(t=(0,s.useState)(!0),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tt(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tt(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],u=l[1];return(0,o.jsx)("button",{type:"button",onClick:function(){return a(r)},className:O()("cursor-pointer touch-none select-none rounded-lg border-2 border-transparent p-0.5",{"border-secondary":r===i&&!c,"bg-tertiary mx-1 h-12 w-12 animate-pulse":c}),children:(0,o.jsx)("img",{loading:"eager",src:n.url,className:O()("h-12 w-12 rounded-md object-cover",{hidden:c}),onLoad:function(){return u(!1)},alt:n.filename})})},tr=function(e){var t=e.isOverlay,n=(0,U.dI)().item;return(0,o.jsx)("div",{className:O()("rounded-lg border-2 border-transparent p-0.5 opacity-50",{"!opacity-100":void 0!==t&&t}),children:(0,o.jsx)("img",{loading:"eager",src:n.url,className:"h-12 w-12 rounded-md object-cover",alt:n.filename})})};function to(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function ta(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function ts(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return to(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return to(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var tl=function(e){var t=e.setCurrentImageIndex,n=e.currentImageIndex,r=ts((0,s.useState)(!1),2),i=r[0],a=r[1],l=(0,s.useRef)(null),u=ts((0,L.A)(),2),d=u[0],f=u[1],m=ts((0,L.A)(),2),p=m[0],b=m[1],h=(0,c.UV)().contentPortalElement,v=j(),y=v.uploadedImages,g=v.setUploadedImages,_=v.selectedFiles,x=v.resetSelectedFiles,w=v.setIsImagesDirty,O=$({handleFileSelection:Q(function(){return a(!0)}).handleFileSelection,selectedFiles:_,uploadedFilesCount:y.length}),S=O.getInputProps,P=O.open,C=e1().removeImage,I=y.map(function(e){return ta(ti({},e),{id:e.signed_id,originalId:e.id})}),k=I[n];return(0,o.jsxs)("div",{className:"relative mt-5 flex",children:[!f&&(0,o.jsx)(V,{direction:"left",scrollableContainerRef:l}),(0,o.jsxs)(U.cm,{shouldUseKeyboardSensor:!1,distance:10,items:I,onSort:function(e){var r=e.indexOf(k);r!==n&&t(r),g(e.map(function(e){return ta(ti({},e),{id:e.originalId})})),w(!0)},restrictToParentElement:!0,children:[(0,o.jsx)(U.Fo,{children:(0,o.jsxs)("div",{className:"scrollbar-hide m-auto !flex items-center overflow-x-scroll px-1 pt-1",ref:l,children:[(0,o.jsx)("div",{className:"h-px w-px",ref:d}),y.map(function(e,r){return(0,o.jsxs)(q.c,{tabIndex:-1,item:I[r],disabled:1===y.length,placeholder:tr,className:"group relative !w-auto shrink-0",dataTestId:"thumbnail-item",children:[(0,o.jsx)(Z,{onClick:function(){return C(e)},index:r,currentImageIndex:n}),(0,o.jsx)(tn,{image:e,index:r,currentImageIndex:n,onClick:t})]},e.signed_id)}),y.length<10&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{type:"button",className:"hover:bg-secondary text-default ml-1 flex h-12 w-12 shrink-0 cursor-pointer items-center justify-center rounded-md border border-dashed",onClick:function(){x(),P()},children:[(0,o.jsx)("input",ti({},S())),(0,o.jsx)(F.JO,{type:"20-add-lg",size:20})]}),i&&(0,o.jsx)(eO,{onClose:function(){return a(!1)},onCompleted:function(){return setTimeout(function(){return H({direction:"right",scrollableContainerRef:l})},200)},isOnTop:!0})]}),(0,o.jsx)("div",{className:"h-px w-px",ref:p})]})}),(0,o.jsx)(B.y,{portalTo:h,children:(0,o.jsx)(tr,{isOverlay:!0})})]}),!b&&(0,o.jsx)(V,{direction:"right",scrollableContainerRef:l})]})};function tc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tu=function(){var e,t=(e=(0,s.useState)(0),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return tc(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tc(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],r=t[1],i=!(0,z.j)(),a=j(),l=a.uploadedImages,c=a.setIsScheduledBarPortalRendered,u=(0,s.useRef)(l.length),d=u.current,f=l.length;return f>0&&n>f-1?r(l.length-1):f>d&&r(d),u.current=f,(0,s.useEffect)(function(){i&&c(!0)},[i,c]),(0,o.jsxs)("div",{className:"flex max-h-full w-full flex-col justify-center overflow-auto lg:h-full lg:w-3/4",children:[i&&(0,o.jsx)("div",{id:eQ.U}),(0,o.jsxs)("div",{className:"flex max-h-full min-h-[20rem] w-full flex-col overflow-auto p-6",children:[(0,o.jsx)(te,{currentImageIndex:n}),l.length>0&&(0,o.jsx)(tl,{currentImageIndex:n,setCurrentImageIndex:r})]})]})},td=n(45308),tf=n(59892),tm=n(76234),tp=n(45111),tb=function(e){var t=e.editor,n=e.portalId;return t?(0,o.jsx)(tm.Z,{container:function(){return document.getElementById(n)},children:(0,o.jsx)("div",{className:"flex items-center md:pt-2",children:(0,o.jsx)(tp.c,{popoverPanelClassName:"md:!w-[21rem]",onEmojiSelect:function(e){return t.chain().focus().insertContent(e.emoji).run()},targetWrapperClassName:"!flex",target:(0,o.jsx)(I.h,{iconSize:20,buttonSize:28,iconClassName:"!text-dark !w-6 !h-6",name:"20-emoji",ariaLabel:(0,a.t)("emoji_picker")})})})}):null},th=["blockquote","poll","embeds","slash_commands","file","image","horizontal_rule","code_block","headings","cta"],tv=function(e){var t,n=e.space,r=e.post,i=j().setIsFormDirty,l=(0,eF.Gc)().formState.isDirty;return(0,s.useEffect)(function(){i(l)},[l,i]),(0,o.jsxs)("div",{className:"border-b-primary border-y p-6 pb-4 lg:border-t-0",children:[(0,o.jsx)(P.Z.LabelMd,{weight:"semibold",children:(0,a.t)("image_space.post_modal.steps.create_post.caption_label")}),(0,o.jsx)(tf.$,{placeholder:(0,a.t)("image_space.post_modal.steps.create_post.caption_placeholder"),name:"tiptap_body.body",sgidToObjectMap:(null==r||null==(t=r.tiptap_body)?void 0:t.sgids_to_object_map)||{},spaceId:null==n?void 0:n.id,editorClassName:"min-w-full h-40 overflow-y-scroll mt-3",disabledExtensions:th,shouldShowTextModifiersMenu:!1,toolbars:[{portalId:"create-image-post-toolbar",component:tb}]}),(0,o.jsx)("div",{id:"create-image-post-toolbar"})]})},ty=function(e){var t=e.space,n=!!t&&(0,ez.k8)(t);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eL.l.Item,{variant:"extra-bottom-margin",className:"!pt-3",hideBorder:!0,name:"slug",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,hideDescription:!0,tooltipText:(0,a.t)("post.slug_description"),children:(0,o.jsx)(eL.l.Input,{name:"slug",autoComplete:"off"})}),n&&(0,o.jsx)(eL.l.Item,{variant:"extra-bottom-margin",className:"!pt-4",hideBorder:!0,name:"user_id",translationRoot:"post",fullWidth:!0,hideDescription:!0,tooltipText:(0,a.t)("post.user_id_description"),children:(0,o.jsx)(eL.l.CommunityMemberSelect,{name:"user_id",direction:"up",valueField:"user_id"})})]})},tg=function(e){var t=e.space,n=(0,eC.m)().post,r={hide_meta_info:!0,is_comments_disabled:!0,is_comments_closed:!(0,(0,eF.Gc)().watch)("is_comments_disabled"),is_liking_disabled:!0,is_truncation_disabled:!0,pin_to_top:!!n.id&&(0,eM.Hz)(n),hide_from_featured_areas:!(null==t?void 0:t.hide_from_featured_areas),"gallery.downloadable_images":!0},i=Object.keys(r).filter(function(e){return r[e]});return(0,o.jsx)(o.Fragment,{children:i.map(function(e){return(0,o.jsx)(eL.l.Item,{id:"post_".concat(e),name:e,label:(0,a.t)("post.".concat(e)),labelClassName:"!font-normal !p-0",className:"mb-3 !p-0",hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,o.jsx)(eL.l.ToggleSwitch,{name:e,variant:"small"})},e)})})};function t_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tx=function(e){var t,n=e.space,r=(t=(0,s.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return t_(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t_(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],l=r[1];return(0,o.jsxs)("div",{className:"border-primary border-b",children:[(0,o.jsxs)("button",{type:"button",className:"flex w-full items-center justify-between px-6 py-5",onClick:function(){return l(!i)},"aria-expanded":i,children:[(0,o.jsx)(P.Z.LabelMd,{weight:"semibold",children:(0,a.t)("image_space.post_modal.steps.create_post.more_options_label")}),(0,o.jsx)(F.JO,{type:i?"cheveron-up":"cheveron-down",size:20})]}),i&&(0,o.jsxs)("div",{className:"mb-5 px-6",children:[(0,o.jsx)(tg,{space:n}),(0,o.jsx)(ty,{space:n})]})]})},tj=function(e){var t=e.post,n=e.space,r=n&&(0,ez.Y_)(n),i=j().setIsScheduledBarPortalRendered,l=(0,z.j)();return(0,s.useEffect)(function(){l&&i(!0)},[l,i]),(0,o.jsxs)("div",{className:"border-primary w-full lg:h-full lg:w-1/4 lg:overflow-scroll lg:border-l",children:[l&&(0,o.jsx)("div",{id:eQ.U}),(0,o.jsx)(tv,{space:n,post:t}),(n.topics_count>0||r)&&(0,o.jsx)("div",{className:"border-primary border-b px-6 pb-2",children:(0,o.jsx)(eL.l.Item,{name:"topics",hideDescription:!0,hideBorder:!0,label:(0,a.t)("image_space.post_modal.steps.create_post.topics_label"),labelClassName:"!mb-3",children:(0,o.jsx)(td.w,{containerClassName:"!p-0 -mx-1",name:"topics",spaceId:n.id,creatable:r})})}),(0,ez.Y_)(n)&&(0,o.jsx)(tx,{space:n})]})};function tw(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var tO=function(e){var t=e.onClose,n=e.onPostChange,r=e.shouldSkipRedirectAfterSubmit,s=(0,eI.T)().invalidatePostsApiQueries,u=(0,eC.m)().post,d=(0,eD.L2)().data,f=(0,eP.k6)(),m=(0,eS.useQueryClient)(),p=eT({space:d,post:u,onSuccess:function(e){var o;return(o=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(o){switch(o.label){case 0:return n(u),[4,m.invalidateQueries(eR.j)];case 1:return o.sent(),[4,s()];case 2:return o.sent(),t(!0),r||f.push((0,eM.RG)({post:e})),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var i=o.apply(e,t);function a(e){tw(i,n,r,a,s,"next",e)}function s(e){tw(i,n,r,a,s,"throw",e)}a(void 0)})})()}}).onSubmit;return(0,o.jsx)(c.u_,{isOpen:!0,onClose:t,contentPortalId:"create-post-modal-portal",children:(0,o.jsxs)(eL.l,{onSubmit:p,defaultValues:(0,i.pick)(u,["tiptap_body","hide_meta_info","is_comments_disabled","is_comments_closed","is_liking_disabled","is_truncation_disabled","pin_to_top","pinned_at","hide_from_featured_areas","gallery.downloadable_images","slug","user_id","status","published_at","topics"]),formClassName:"fixed inset-0 z-[1060]",children:[(0,o.jsx)(c.u_.Overlay,{}),(0,o.jsxs)(c.u_.Content,{size:"full",className:"sm:!max-h-[836px] sm:!max-w-[1312px]",children:[(0,o.jsxs)(c.u_.Header,{className:"z-10 md:!py-4",children:[(0,o.jsx)(P.Z.TitleSm,{weight:"font-semibold",children:(0,a.t)("".concat("image_space.post_modal.steps.create_post",".").concat(u.id?"edit":"create","_title"))}),(0,o.jsxs)(c.u_.HeaderActions,{className:"!gap-3",children:[(0,o.jsx)(l.z,{type:"button",variant:"secondary",onClick:function(){return t(!1)},children:(0,a.t)("cancel")}),(0,o.jsx)(eV,{post:u})]})]}),(0,o.jsxs)(c.u_.Body,{className:"md:border-primary flex flex-wrap content-start !p-0 md:border-t",children:[(0,o.jsx)(tu,{}),(0,o.jsx)(tj,{post:u,space:d})]})]})]})})},tS=function(e){var t,n,r=e.onClose,i=e.onSelection,a=j(),s=a.selectedFiles,l=a.uploadedImages,u=$({handleFileSelection:Q(i).handleFileSelection,selectedFiles:s,uploadedFilesCount:l.length}),d=u.isDragActive,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(u,["isDragActive"]);return(0,o.jsxs)(c.u_,{isOpen:!0,onClose:r,contentPortalId:"upload-images-modal-portal",children:[(0,o.jsx)(c.u_.Overlay,{}),(0,o.jsxs)(c.u_.Content,{size:"xl",className:O()("aspect-square",{"!bg-light-blue":d}),children:[(0,o.jsxs)(c.u_.Header,{children:[(0,o.jsx)(c.u_.Title,{size:"sm",children:" "}),(0,o.jsx)(c.u_.HeaderActions,{children:(0,o.jsx)(c.u_.CloseButton,{onClick:r,className:O()({"!bg-light-blue":d})})})]}),(0,o.jsx)(c.u_.Body,{className:"flex cursor-pointer flex-col items-center justify-center !p-0",children:(0,o.jsx)(eK,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({isDragActive:d},f),n=n={className:"pb-14"},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))})]})]})},tP=function(e){var t=j(),n=t.setCurrentStep,r=t.setUploadedImages;(0,s.useEffect)(function(){n((null==e?void 0:e.gallery)?m:d),(null==e?void 0:e.gallery)&&r(e.gallery.images)},[null==e?void 0:e.gallery,n,r])},tC=function(e){var t=(0,eR.t)({spaceId:null==e?void 0:e.space_id,postSlug:null==e?void 0:e.slug,disabled:e&&"gallery"in e}),n=t.post;return t.isLoading?null:n||e||{id:null,gallery:null}},tI=n(57105),tk=n(88241),tN=function(e){var t=e.spaceId,n=e.onClose,r=e.currentPost,s=e.onPostChange,l=void 0===s?i.noop:s,c=e.shouldSkipRedirectAfterSubmit,u=(0,tI.dd)(),m=j(),p=m.currentStep,b=m.setCurrentStep,h=m.reset,v=m.isFormDirty,y=m.isImagesDirty,g=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||!(v||y)||confirm((0,a.t)("quick_post_v2.accidental_leave_confirmation")))&&(h(),n())},_=tC(r);return(tP(_),u&&u.visible&&_)?(0,o.jsx)(eD.mE,{spaceId:t,children:(0,o.jsx)(tk._x,{perPagePostIds:[[_.id]],children:(0,o.jsxs)(eD.DW,{post:_,children:[p===d&&(0,o.jsx)(tS,{onClose:g,onSelection:function(){return b(f)}}),p===f&&(0,o.jsx)(eO,{onClose:g}),p!==d&&p!==f&&(0,o.jsx)(tO,{onClose:g,onPostChange:l,shouldSkipRedirectAfterSubmit:void 0!==c&&c})]})})}):null},tA=tI.gk.create(function(e){return(0,o.jsx)(tN,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),tE=function(){return(0,tI.dd)(tA)}},5603:function(e,t,n){n.d(t,{M:()=>l});var r=n(85893),o=n(96486),i=n(84326),a=n(1168),s=n(57363),l=function(e){var t=e.onChange,n=e.searchValue,l=e.onKeyPress,c=e.onClickCancel,u=void 0===c?o.noop:c,d=e.placeholder,f=void 0===d?(0,i.t)("messaging.actions.search_name"):d,m=e.className,p=e.showCancelButton,b=e.shouldAutoFocus;return(0,r.jsx)("div",{className:(0,a.A)("bg-primary isolate z-10 mx-2 flex w-full items-center justify-between gap-4"),children:(0,r.jsxs)("div",{className:(0,a.A)("bg-secondary-dark active:border-very-dark focus-within:bg-primary focus-within:border-very-dark active:bg-primary hover:border-dark hover:focus-within:border-very-dark border-hover group flex h-8 w-full flex-1 items-center gap-2 overflow-hidden rounded-lg border p-3 marker:mr-0 hover:bg-transparent md:p-1",void 0===m?"":m),children:[(0,r.jsx)(s.JO,{type:"16-search-v3",className:"text-light group-focus-within:text-dark group-active:text-dark ml-2",size:16,useWithFillCurrentColor:!0}),(0,r.jsx)("input",{className:"text-darkest placeholder:text-light text-xs-plus w-full rounded bg-transparent font-medium outline-none placeholder:opacity-100 sm:rounded-none",placeholder:f,"data-name":"v2-search","data-testid":"v2-search","aria-autocomplete":"list",value:n,onChange:function(e){return t(e.target.value)},onKeyPress:l,autoFocus:void 0!==b&&b}),(n||void 0!==p&&p)&&(0,r.jsx)(s.JO,{type:"20-close",className:"text-dark mr-2 !h-5 !w-5 cursor-pointer",size:20,useWithFillCurrentColor:!0,onClick:u})]})})}},29090:function(e,t,n){n.d(t,{V:()=>o,f:()=>i});var r=n(84326),o=function(e){return"post"===e?(0,r.t)("flagged_contents.moderation_info.post"):(0,r.t)("flagged_contents.moderation_info.comment")},i=function(e){return!!e.unresolved_flagged_reports_count}},24831:function(e,t,n){n.d(t,{F:()=>N,t:()=>A});var r=n(57105),o=n(85893),i=n(84326),a=n(41331),s=n(18285),l=n(34519),c=n(15863),u=n(88767),d=n(7992),f=n(51805),m=n(88241),p=n(60878),b=n(93199),h=n(13532);function v(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var y="settings.moderation.review_flagged_content_modal",g=function(e,t){var n=(0,p.pm)(),r=n.success,o=n.error,a=function(e,t){var n;return(n=function(){var n,r;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(o){switch(o.label){case 0:return n="post"===t?{post_id:e}:{comment_id:e},[4,(0,b.UT)(h.av.flaggedContent.index({params:n}))];case 1:if((r=o.sent())&&Array.isArray(r.records)&&r.records.length>0)return[2,r.records[0]];return[2,r]}})},function(){var e=this,t=arguments;return new Promise(function(r,o){var i=n.apply(e,t);function a(e){v(i,r,o,a,s,"next",e)}function s(e){v(i,r,o,a,s,"throw",e)}a(void 0)})})()},s=(0,u.useQueryClient)(),l=(0,u.useQuery)(["flagged-content",e,t],function(){return a(e,t)},{enabled:!!e}),c=l.data,g=l.isLoading,_=null==c?void 0:c.id,x=function(){if("post"===t){var n,r,o;(0,m.o1)({postId:e,queryClient:s}).forEach(function(e){s.invalidateQueries(e)})}else"comment"===t&&(s.refetchQueries((0,d.k)({postId:null==c||null==(n=c.flagged_contentable)?void 0:n.post_id,parentCommentId:null==c||null==(r=c.flagged_contentable)?void 0:r.parent_comment_id})),s.refetchQueries((0,f.z)({postId:null==c||null==(o=c.flagged_contentable)?void 0:o.post_id,id:e})))},j=(0,u.useMutation)({mutationFn:function(){var e;return e=String(_),(0,b.gN)(h.av.flaggedContent.approve({id:e}))},onSuccess:function(){x(),r((0,i.t)([y,"success_approving"]))},onError:function(){return o((0,i.t)([y,"error_approving"]))}}),w=j.mutate,O=j.isLoading,S=(0,u.useMutation)({mutationFn:function(e){var t,n,r=e.reason;return t=String(_),n=r,(0,b.gN)(h.av.flaggedContent.reject({id:t}),{action_reason_body:n})},onSuccess:function(){x(),r((0,i.t)([y,"success_rejecting"]))},onError:function(){return o((0,i.t)([y,"error_rejecting"]))}});return{approveFlaggedContent:w,isApproving:O,rejectFlaggedContent:S.mutate,isRejecting:S.isLoading,isLoading:g,flaggedContent:c}};function _(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function x(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){_(i,r,o,a,s,"next",e)}function s(e){_(i,r,o,a,s,"throw",e)}a(void 0)})}}function j(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var w=function(e){var t,n=e.flaggedContentId,u=e.flaggedContentType,d=(0,r.dd)(),f=g(n,u),m=f.approveFlaggedContent,p=f.rejectFlaggedContent,b=f.flaggedContent,h=f.isApproving,v=f.isRejecting,y=null!=b?b:{},_=y.flagged_contentable,w=y.reports,O=void 0===w?[]:w,S=y.status,P=null==_||null==(t=_.type)?void 0:t.toLowerCase(),C=null==O?void 0:O.length;return void 0===S||"post"!==P&&"comment"!==P?null:(0,o.jsxs)(l.u_,{isOpen:d.visible,onClose:d.hide,contentPortalId:"review-modal-content",children:[(0,o.jsx)(l.u_.Overlay,{}),(0,o.jsxs)(l.u_.Content,{size:"lg",children:[(0,o.jsxs)(l.u_.Header,{children:[(0,o.jsx)(l.u_.Title,{size:"sm",children:(0,i.t)("flagged_contents.moderation_info.reports_title",{count:C})}),(0,o.jsx)(l.u_.HeaderActions,{className:"absolute right-0 top-0 mr-6 mt-6",children:(0,o.jsx)(l.u_.CloseButton,{onClick:d.hide})})]}),(0,o.jsxs)(l.u_.Body,{className:"flex flex-col !p-0",children:[(0,o.jsx)(s.z,{content:b}),(0,o.jsx)(a.Q,{reports:O})]}),(0,o.jsx)(l.u_.Footer,{className:"!p-0",children:(0,o.jsx)(c.r,{i18nRoot:"settings.moderation.review_flagged_content_modal",status:S,isApproving:h,isRejecting:v,onApprove:function(){return x(function(){return j(this,function(e){switch(e.label){case 0:return m(),[4,d.hide()];case 1:return e.sent(),[2]}})})()},onReject:function(e){return x(function(){return j(this,function(t){switch(t.label){case 0:return p({reason:e}),[4,d.hide()];case 1:return t.sent(),[2]}})})()},contentType:P})})]})]})},O=r.gk.create(function(e){return(0,o.jsx)(w,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),S=n(795),P=n(57363),C=n(92768),I=n(41553),k=n(29090),N=Object.assign({},{Regular:function(e){var t=e.record,n=e.contentType,r=A();if(!(0,k.f)(t))return null;var a=(0,k.V)(n);return(0,o.jsx)(C.a,{className:"!py-2",iconEl:(0,o.jsx)(P.JO,{className:"text-v2-warning",type:"20-info",size:20}),children:(0,o.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,o.jsxs)(I.Z.LabelSm,{children:[(0,i.t)("flagged_contents.moderation_info.flagged_report_content",{content:a}),(0,o.jsx)(S.w,{content:(0,i.t)("flagged_contents.moderation_info.flagged_report_count",{count:t.unresolved_flagged_reports_count}),as:"span"})]}),(0,o.jsx)("button",{type:"button",onClick:function(){return r.show({flaggedContentId:String(t.id),flaggedContentType:n})},className:"hover:bg-v2-warning-100 dark:hover:bg-primary rounded-full border border-black bg-transparent px-4 py-1 transition dark:border-white",children:(0,o.jsx)(I.Z.LabelSm,{weight:"semibold",children:(0,i.t)("flagged_contents.moderation_info.review_button")})})]})})},Short:function(e){var t=e.record,n=e.contentType,r=A();if(!(0,k.f)(t))return null;var a=(0,k.V)(n),s=(0,i.t)("flagged_contents.moderation_info.short_content",{content:a});return(0,o.jsx)("button",{type:"button",onClick:function(){return r.show({flaggedContentId:String(t.id),flaggedContentType:n})},className:"dark:bg-primary cursor-pointer rounded-lg bg-amber-50",children:(0,o.jsx)(C.a,{className:"!py-2",iconEl:(0,o.jsx)(P.JO,{className:"text-v2-warning",type:"20-info",size:20}),children:(0,o.jsx)(I.Z.LabelSm,{children:s})})})}}),A=function(){return(0,r.dd)(O)}},79650:function(e,t,n){n.d(t,{a:()=>I,O:()=>S});var r=n(85893),o=n(73935),i=n(84326),a=n(67294),s=n(45697),l=n.n(s);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var u=function(e){var t,n=e.trialDays,o=e.hasSubscriptionPrices,s=e.label,l=void 0===s?(0,i.t)("checkbox"):s,u=(t=(0,a.useState)(n>0),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return c(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1];return o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"form-group full-width",children:[(0,r.jsxs)("div",{className:"form-meta",children:[(0,r.jsx)("label",{children:i.Z.t("settings.paywalls.form.free_trial.section_subtitle")}),(0,r.jsx)("div",{className:"field-description",children:i.Z.t("settings.paywalls.form.free_trial.section_description")})]}),(0,r.jsx)("div",{className:"form-input",children:(0,r.jsx)("div",{className:"form-meta-button",children:(0,r.jsxs)("div",{className:"simple-toggle",children:[(0,r.jsx)("input",{type:"checkbox",value:"true",id:"checkbox-enable-trial",name:"enable-trial",defaultChecked:d,onChange:function(e){f(e.target.checked)}}),(0,r.jsx)("label",{htmlFor:"checkbox-enable-trial",children:(0,r.jsx)("span",{className:"sr-only",children:l})})]})})})]}),d&&(0,r.jsxs)("div",{className:"input-container",children:[(0,r.jsx)("label",{children:i.Z.t("settings.paywalls.form.free_trial.input_label")}),(0,r.jsxs)("div",{className:"form-input-group",children:[(0,r.jsx)("input",{type:"number",step:"1",min:"1",name:"paywall[trial_days]",id:"paywall_trial_days",placeholder:i.Z.t("settings.paywalls.form.free_trial.placeholder"),defaultValue:n||1,className:"form-control form-input-group--prefix"}),(0,r.jsx)("div",{className:"form-input-group--suffix",children:i.Z.t("settings.paywalls.form.free_trial.days_label")})]})]})]}):(0,r.jsx)("p",{children:i.Z.t("settings.paywalls.form.free_trial.need_subscription_price")})};u.propTypes={trialDays:l().number,hasSubscriptionPrices:l().bool};var d=["monthly","annual","quarter","biannual","biweekly","weekly","daily","onetime"],f=function(e,t,n){var r,o=(r=n/100,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2*(r%1!=0)}).format(r)+" USD");return e?(o+=" / ",o+=(0,i.t)("settings.paywall_prices.interval_labels.".concat(e),{count:t})):o},m=function(e){var t=e.priceType,n=e.interval,o=e.intervalCount,a=e.intervalLabel,s=e.amount,l=e.preferred,c=e.allowPreferredAction,u=e.onRemove,d=e.onSetPreferred;return(0,r.jsxs)("div",{className:"price-list__element",children:[(0,r.jsxs)("div",{className:"price-list__element__info",children:[(0,r.jsx)("div",{className:"price-list__element__info--type",children:"subscription"===t?"".concat(a," ").concat((0,i.t)("settings.paywall_prices.subscription_item_text")):a}),(0,r.jsx)("div",{className:"price-list__element__info--amount",children:f(n,o,s)})]}),(0,r.jsxs)("div",{className:"price-list__element__actions",children:[!l&&c&&(0,r.jsx)("button",{type:"button",className:"price-list__element__actions__action btn-link label-negative focus-visible:!outline-secondary focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:d,children:(0,i.t)("settings.paywall_prices.buttons.make_preferred")}),l&&(0,r.jsx)("button",{type:"button",className:"price-list__element__actions__action label-positive focus-visible:!outline-secondary focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:d,children:(0,i.t)("settings.paywall_prices.form.preferred_label")}),(0,r.jsx)("button",{type:"button",className:"price-list__element__actions__danger btn-link focus-visible:!outline-secondary focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:u,children:(0,i.t)("settings.paywall_prices.buttons.remove")})]})]})},p={daily:{interval:"daily",interval_count:1,interval_label:"daily"},weekly:{interval:"weekly",interval_count:1,interval_label:"weekly"},biweekly:{interval:"weekly",interval_count:2,interval_label:"biweekly"},monthly:{interval:"monthly",interval_count:1,interval_label:"monthly"},quarter:{interval:"monthly",interval_count:3,interval_label:"quarter"},biannual:{interval:"monthly",interval_count:6,interval_label:"biannual"},annual:{interval:"yearly",interval_count:1,interval_label:"annual"},onetime:{interval:void 0,interval_count:void 0,interval_label:"onetime"}},b=function(e,t,n,r){var o=n.find(function(n){return n.amount===Math.round(100*e)&&n.interval===p[t].interval&&n.interval_count===p[t].interval_count});return e.length<1||n.length>r-1||!!o},h=n(96486);function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function g(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||j(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||j(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}}var w="monthly",O=function(e,t){var n=_((0,a.useState)(e||[]),2),r=n[0],o=n[1],i=_((0,a.useState)(w),2),s=i[0],l=i[1],c=_((0,a.useState)(""),2),u=c[0],d=c[1],f=_((0,a.useState)([]),2),m=f[0],b=f[1],v=_((0,a.useState)(!1),2),j=v[0],O=v[1];(0,a.useEffect)(function(){var t,n,o,i,a;t=r.filter(function(e){return!!e.tempId}).map(function(e){return(0,h.omit)(e,["tempId","interval_label"])}),n=e.filter(function(e){return!r.some(function(t){return t.id===e.id})}).map(function(e){return g(y({},e),{_destroy:"1"})}),o=e.find(function(e){return e.preferred}),i=r.find(function(e){return e.preferred}),a=[],(null==o?void 0:o.id)&&(null==o?void 0:o.id)!==(null==i?void 0:i.id)&&r.find(function(e){return e.id===(null==o?void 0:o.id)})&&a.push({id:o.id,preferred:!1}),void 0!==(null==i?void 0:i.id)&&(null==o?void 0:o.id)!==(null==i?void 0:i.id)&&a.push({id:i.id,preferred:!0}),b(x(t).concat(x(n),x(a)).map(function(e){return JSON.stringify(e)})),O(r.some(function(e){return e.interval}))},[r]);var S=function(){l(w),d("")};return{currentPaywallPrices:r,intervalOption:s,onIntervalOptionChange:function(e){l(e.target.value)},amount:u,onAmountChange:function(e){var t=e.target.value;if(!t)return void d("");d(t<1?1:t)},onAdd:function(e){if(e.preventDefault(),s&&u&&!(r.length>t)){var n=p[s],i=n.interval?"subscription":"onetime",a=Math.round(100*u);o(x(r).concat([{tempId:"temp-id-".concat(Math.floor(1e6*Math.random())),amount:a,interval:n.interval,interval_count:n.interval_count,interval_label:I18n.t("settings.paywall_prices.form.interval_select_options.".concat(n.interval_label,"_label")),price_type:i,preferred:!1}])),S()}},onRemove:function(e){if(!(e<0)&&!(e>=r.length)){var t=x(r);t.splice(e,1),o(t)}},onSetPreferred:function(e){if(!(e<0)&&!(e>=r.length)){var t=x(r),n=t.findIndex(function(e){return e.preferred});n!==e&&void 0!==n&&(t[n]=g(y({},t[n]),{preferred:!1})),t[e]=g(y({},t[e]),{preferred:!0}),o(t)}},changes:m,hasSubscriptionPrices:j}},S=function(e){var t=e.name,n=e.paywall_prices,a=e.prices_max_count,s=e.trial_days,l=O(n,a),c=l.currentPaywallPrices,f=l.intervalOption,p=l.onIntervalOptionChange,h=l.amount,v=l.onAmountChange,y=l.onAdd,g=l.onRemove,_=l.onSetPreferred,x=l.changes,j=l.hasSubscriptionPrices,w=document.getElementById("paywall-free-trial-container");return(0,r.jsxs)("div",{className:"paywall-prices-container",children:[(0,r.jsxs)("div",{className:"add-new-price","data-testid":"add-new-price",children:[(0,r.jsx)("select",{className:"add-new-price__element",value:f,onChange:p,children:d.map(function(e){return(0,r.jsx)("option",{value:e,children:(0,i.t)("settings.paywall_prices.form.interval_select_options.".concat(e,"_label"))},e)})}),(0,r.jsx)("span",{className:"amount-icon",children:"$"}),(0,r.jsx)("input",{type:"number",step:".01",min:"1",placeholder:(0,i.t)("settings.paywall_prices.amount"),className:"form-control add-new-price__element--short rounded-none rounded-r-md",value:h,onChange:v}),(0,r.jsx)("button",{type:"submit",disabled:b(h,f,c,a),className:"add-new-price__element--button btn btn-circle",onClick:y,children:(0,i.t)("settings.paywall_prices.buttons.add")})]}),(0,r.jsx)("div",{className:"price-list",children:c.map(function(e,t){var n=e.id,o=e.tempId,i=e.price_type,a=e.interval,s=e.interval_count,l=e.interval_label,u=e.amount,d=e.preferred;return(0,r.jsx)(m,{priceType:i,interval:a,intervalLabel:l,intervalCount:s,amount:u,preferred:d,allowPreferredAction:c.length>1,onRemove:function(){return g(t)},onSetPreferred:function(){return _(t)}},n||o)})}),x.map(function(e){return(0,r.jsx)("input",{name:"".concat(t,"[]"),type:"hidden",value:e},e)}),(0,o.createPortal)((0,r.jsx)(u,{trialDays:s,hasSubscriptionPrices:j}),w)]})},P=n(98684),C=n(51466),I=(0,a.forwardRef)(function(e,t){var n,o,i=e.currency,a=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["currency"]),s=i.code.toUpperCase(),l=i.direction===P.RV.rtl?(0,r.jsx)("div",{className:"px-4 py-2",children:s}):null,c=i.direction===P.RV.ltr?(0,r.jsx)(r.Fragment,{children:s}):null;return(0,r.jsx)(C.l.Input,(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},a),o=o={ref:t,inputMode:"numeric",prefixWrapperClassName:"bg-primary! border-primary! rounded-l-lg! relative! -mr-px! inline-flex! items-center! space-x-2! border! sm:text-sm!",prefix:l,suffix:c},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}),n))});I.displayName="PaywallCurrencyAmountFormInput"},98384:function(e,t,n){n.d(t,{e:()=>m});var r=n(85893),o=n(67294),i=n(88767),a=n(84326),s=n(81881),l=n(46122),c=n(46681),u=n(99666);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var m=function(e){var t=e.post,n=f((0,o.useState)(null),2),d=n[0],m=n[1],p=f((0,o.useState)(!1),2),b=p[0],h=p[1],v=(0,i.useMutation)(function(e){var t=e.postId,n=e.value;return s.R.createPostFeedback({postId:t,helpful:n})}).mutate;return(0,r.jsxs)("div",{className:"mx-auto w-full pt-4",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(c.Di,{weight:"semibold",children:(0,a.t)("support_widget.was_this_article_helpful")})}),(0,r.jsx)("div",{className:"mb-6 flex justify-center gap-4",children:(0,r.jsx)(u.O,{value:d,handleFeedback:function(e){b||(m(e),v({postId:t.id,value:e}),h(!0))},isFeedbackGiven:b})}),(0,r.jsx)("div",{children:(d||!1===d)&&(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(l.p,{children:(0,a.t)("support_widget.thank_you_for_article_feedback")})})})]})}},52521:function(e,t,n){n.d(t,{d:()=>s});var r=n(67294),o=n(96486),i=n(70442),a=n(89864),s=function(){var e=(0,i.k6)();if(!e)throw Error("useNavigateToPost must be used within a Router component");return{navigateToPost:(0,r.useCallback)(function(t){var n=t.newPost,r=t.prevLocation,i=t.params,s=t.hasNextPage,l=t.shouldFocusOnCommentsSection,c=t.isWithinProfileContext,u=t.profileContextMember,d=(0,o.pickBy)({prevLocation:r,params:i,hasNextPage:s,shouldFocusOnCommentsSection:void 0!==l&&l,isWithinProfileContext:c,profileContextMember:u},function(e){return void 0!==e});e.push({pathname:a.x.show({slug:n.slug,spaceSlug:n.space_slug}),state:d})},[e])}}},30581:function(e,t,n){n.d(t,{Y:()=>eb});var r=n(85893),o=n(67294),i=n(11899),a=n(94184),s=n.n(a),l=n(17e3),c=n(41342),u=function(){var e=(0,c.Zh)().record,t=(0,o.useRef)(null),n=(0,o.useRef)(null),a=(0,c.wh)().currentCommunityMember;return((0,o.useEffect)(function(){if(t.current&&(null==e?void 0:e.is_comments_enabled)){var n=new i.do(function(){var e=document.documentElement.scrollHeight;window.parent.postMessage(["setHeight",e],"*")});return n.observe(t.current),function(){return n.disconnect()}}},[null==e?void 0:e.is_comments_enabled]),null==e?void 0:e.is_comments_enabled)?(0,r.jsx)("div",{ref:t,className:s()("post bg-primary border-primary border md:mb-6 md:rounded-lg",{"pb-1 pt-2.5":!!a}),children:(0,r.jsx)(l.o,{commentsFormRef:n,autofocusReplyForm:!1})}):null},d=n(40382),f=n(41084),m=n(27053),p=n(91704),b=n(72851),h=n(23627),v=function(){var e=(0,c.Zh)(),t=e.record,n=e.helpers,o=t.body_trix_content,i=t.tiptap_body,a=!!(null==n?void 0:n.isTiptapPost),s=!!(null==n?void 0:n.isTrixPost),l=(0,m.m)().isPostBodyEmpty;return(0,r.jsxs)(r.Fragment,{children:[!l&&(0,r.jsx)(b.X,{seeMoreClassName:"text-default hover:text-dark",children:(0,r.jsxs)("div",{className:"profile-posts__post__body",children:[s&&o&&(0,r.jsx)(p.P,{content:o}),a&&i&&(0,r.jsx)(h.R,{readOnly:!0,value:i.body,sgidToObjectMap:i.sgids_to_object_map,inlineAttachments:i.inline_attachments})]})}),(0,f.Fr)(t)&&(0,r.jsx)(d.l,{className:"!py-2"})]})},y=n(96486),g=n(84326),_=n(96533),x=n(54348),j=n(57363),w=n(63676),O=n(80171),S=n(76896),P=function(e){var t=e.shouldOpenInNewTab,n=(0,c.wh)().isViewOnlyMasquerading,o=(0,_.r)().hide,i=(0,c.Zh)(),a=i.record,l=i.onLikeToggle,u=a.comments_count,d=a.is_comments_enabled,f=a.is_liked_by_current_user,m=a.is_liking_enabled,p=a.user_likes_count,b=a.post_details_loaded,h=(0,c.EU)();return d||m?(0,r.jsxs)("div",{className:s()("profile-posts__post__actions flex items-center",{"justify-between":m,"justify-end":!m}),children:[m&&(0,r.jsx)(O.T,{interactive:!1,content:f?(0,g.t)("profile_tabs.post.unlike_description"):(0,g.t)("profile_tabs.post.like_description"),placement:"bottom",disabled:!h||!b,children:(0,r.jsx)("button",{type:"button",onClick:n?y.noop:l,className:s()("profile-posts__post__like focus-visible:outline-secondary hover:bg-tertiary active:text-default flex space-x-1 rounded-md p-1 text-sm focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"text-default focus:text-default":!f,"liked text-brand focus:text-brand":f,disabled:!h||!b}),children:b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.JO,{type:"like"}),(0,r.jsx)("span",{className:"profile-posts__post__like-count",children:(0,w.HA)(p)})]}):(0,r.jsx)(S.gi,{variant:"row",lg:!0,short:!0})})}),d&&(0,r.jsx)(O.T,{interactive:!1,content:(0,g.t)("profile_tabs.post.comment_description"),placement:"bottom",disabled:!b,children:(0,r.jsxs)(x.s,{post:a,allComments:!0,className:"profile-posts__post__comments-count text-default focus-visible:outline-secondary focus-visible:text-dark hover:text-dark inline-block rounded-md p-1 text-sm focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:o,target:t&&"_blank",children:[b&&(0,g.t)("post.comments",{count:u,formatted_count:(0,w.HA)(u)}),!b&&(0,r.jsx)(S.gi,{variant:"row",lg:!0,long:!0})]})})]}):null},C=n(13532),I=n(48250),k=n(82859),N=n(8683),A=function(e){var t=e.shouldOpenInNewTab,n=void 0!==t&&t,o=(0,_.r)().hide,i=(0,c.Zh)().record,a=function(e){return!(0,k.n2)(e)&&o()},s=i.name,l=i.created_at,u=i.space_name,d=i.space_slug;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.H,{onClick:a,post:i,className:"!rounded-lg",wrapperClassName:"!p-0"}),(0,r.jsxs)("div",{className:"profile-posts__post__meta w-full space-x-2",children:[(0,r.jsxs)("span",{className:"profile-posts__post__author text-default text-sm",children:[(0,g.t)("profile_tabs.post.posted_in")," ",(0,r.jsx)("a",{className:"focus-visible:outline-secondary focus-visible:text-dark text-dark hover:text-darkest font-medium focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:C.RZ.show({spaceSlug:d}),children:u})]}),(0,r.jsx)("span",{className:"bg-badge inline-block h-1 w-1 rounded-full align-middle"}),(0,r.jsx)(O.T,{interactive:!1,content:(0,f.s4)(l),children:(0,r.jsx)(x.s,{onClick:a,post:i,target:n?"_blank":"_self",className:"text-dark focus-visible:outline-secondary focus-visible:text-dark group inline-flex focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,r.jsx)("span",{className:"profile-posts__post__time text-default group-hover:text-dark text-sm",children:(0,N.TF)(l,{format:N.lc.short})})})})]}),!!s&&(0,r.jsx)(x.s,{onClick:a,post:i,target:n?"_blank":"_self",className:"text-dark focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,r.jsx)("div",{className:"profile-posts__post__title text-darkest break-all text-xl font-semibold leading-7",children:s})})]})},E=function(e){var t=e.onPostChange,n=e.shouldOpenInNewTab,o=(0,c.Zh)().record;if(!o||!o.id)return null;var i=o.updated_at;return(0,r.jsxs)("div",{className:"profile-posts__post bg-primary flex flex-col space-y-3 p-5 md:px-6",children:[(0,r.jsx)(A,{}),(0,r.jsx)(v,{}),(0,r.jsx)(P,{onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},o,e))},shouldOpenInNewTab:n})]},i)};function T(e){var t=e.post,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["post"]);return(0,r.jsx)(E,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({post:t},n))}var M=n(60622),R=function(e){var t=e.post,n=e.comments_count,o=e.className,i=e.showCount,a=e.onCommentsClick,l=e.iconClassName;return(0,r.jsx)("div",{className:s()("col-span-1",o),children:(0,r.jsx)(O.T,{placement:"bottom",content:(0,g.t)("post.comment_description"),interactive:!1,children:(0,r.jsxs)(x.s,{post:t,allComments:!0,ariaLabel:(0,g.t)("post.comment_description"),shouldOpenPostModal:!0,className:s()("action-item action-comment text-default focus-visible:outline-secondary group flex items-center justify-center rounded-md text-center transition-colors focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"hover:text-dark p-1":!(0,f.Fr)(t)}),onClick:a,children:[(0,r.jsx)("span",{className:"action__icon inline-flex align-text-top",children:(0,r.jsx)(j.JO,{"aria-hidden":!0,type:"24-comment",className:s()("group-hover:text-dark mr-1",void 0===l?"text-default":l),useWithFillCurrentColor:!0})}),(void 0===i||i)&&(0,r.jsx)("span",{className:"count text-default group-hover:text-dark text-base font-medium tracking-tight",children:(0,w.dm)(n)})]})})})},D=function(e){var t=e.name,n=e.onLikeToggle,o=e.is_liked_by_current_user,i=e.user_likes_count,a=e.isOrCanBeCommunityMember,l=e.className,u=e.iconClassName,d=e.likedSpanClassName,m=e.showCount,p=(0,c.wh)().isViewOnlyMasquerading,b=(0,c.Zh)().record;return(0,r.jsx)("div",{className:s()("col-span-1",l),children:(0,r.jsx)(O.T,{placement:"bottom",content:(0,g.t)(o?"post.unlike_description":"post.like_description",{name:null!=t?t:""}),interactive:!1,children:(0,r.jsxs)("button",{type:"button",onClick:n,"aria-label":(0,g.t)("like_post_aria_label",{name:null!=t?t:""}),className:s()("action-item action-link action-like post__actions--like text-default focus-visible:outline-secondary group flex items-center justify-center rounded-md text-center transition-colors focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{liked:o,disabled:!a||p,"hover:text-dark":!o,"hover:text-dark min-w-[2.5rem] p-1":!(0,f.Fr)(b)}),children:[(0,r.jsx)("span",{className:s()("action__icon inline-flex align-text-top",o&&d),children:(0,r.jsx)(j.JO,{className:s()("mr-1",void 0===u?"":u),type:o?"24-heart-red-fill":"24-heart-outline"})}),(void 0===m||m)&&(0,r.jsx)("span",{className:s()("count text-base font-medium tracking-tight",{"!text-v2-danger":o}),children:(0,w.dm)(i)})]})})})},L=function(e){var t=e.type,n=void 0===t?"list":t,o=e.wrapperClassName,i=e.commentButtonClassName,a=e.commentIconClassName,l=e.likeButtonClassName,u=e.likeIconClassName,d=e.likedSpanClassName,f=e.showCommentsCount,p=e.showLikesCount,b=e.onCommentsClick,h=void 0===b?y.noop:b,v=(0,m.m)(),g=v.post,_=v.showEngagementActions,x=v.onLikeToggle,j=g.user_likes_count,w=g.is_liking_enabled,O=g.is_comments_enabled,P=g.is_liked_by_current_user,C=g.comments_count,I=g.post_details_loaded,k=g.display_title,N=(0,c.EU)();return _&&(w||O)?I?(0,r.jsxs)("div",{className:s()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),{"grid grid-cols-2 items-center text-sm md:w-40":"list"===n},{"absolute bottom-4 left-4 flex items-center gap-2":"card"===n},{"flex items-center gap-2 text-sm":"image-card"===n},o),children:[(0,r.jsx)(M.T,{children:w&&(0,r.jsx)(D,{name:k,onLikeToggle:function(e){null==x||x(e)},isOrCanBeCommunityMember:N,user_likes_count:j,is_liked_by_current_user:P,className:l,iconClassName:u,likedSpanClassName:d,showCount:void 0===p||p})}),O&&(0,r.jsx)(R,{comments_count:C,post:g,className:i,iconClassName:a,showCount:void 0===f||f,onCommentsClick:h})]}):(0,r.jsxs)("div",{className:s()("post--".concat(n,"__actions post--").concat(n,"__actions-visible"),{"flex items-center":"list"===n},{"absolute bottom-4 left-4 flex items-center gap-2":"card"===n},o),children:[(0,r.jsx)("div",{className:s()("action-item action-link action-like post__actions--like p-1",l),children:(0,r.jsx)("span",{className:"action__icon",children:(0,r.jsx)(S.gi,{variant:"row",lg:!0,short:!0})})}),(0,r.jsx)("div",{className:s()("action-item action-comment p-1",i),children:(0,r.jsx)("span",{className:"action__icon",children:(0,r.jsx)(S.gi,{variant:"row",lg:!0,short:!0})})})]}):null},F=n(54252),U=n(17617),B=n(85924),q=n(59834),z=n(98363),Z=n(41553);function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){H(e,t,n[t])})}return e}var Q=function(e){var t,n,o,i=e.post,a=e.onPostChange,l=e.onPostDestroy,u=(0,q.O)({public_uid:null!=(o=i.community_member.public_uid)?o:"",params:{show_back_link:!0}}),d=(0,B.TC)().isDarkAppearance,m=(0,U.en)(),p=(0,F.F)(),b=(0,c.L2)().data,h=d?"bg-[#2B2E33CC] backdrop-blur-[1px]":"bg-[#FFFFFFCC] backdrop-blur-[1px]";return(0,r.jsxs)("div",{className:s()("mt-2 flex w-full flex-row-reverse items-center justify-between gap-2",{"absolute bottom-2 mt-0 hidden px-2 focus:flex focus-visible:flex group-hover:flex peer-hover:flex peer-focus-visible:flex":m}),children:[(0,r.jsx)("div",{className:"flex shrink-0 items-center justify-end gap-2",children:(0,r.jsx)(L,V({type:"image-card",wrapperClassName:"!mr-0",commentButtonClassName:s()("rounded-md p-1",H({},h,m)),commentIconClassName:"text-selector-active md:!mr-0",likeButtonClassName:s()("rounded-md p-1",H({},h,m)),likeIconClassName:"text-selector-active md:!mr-0",likedSpanClassName:"text-brand",showLikesCount:!m,showCommentsCount:!m},m&&{onCommentsClick:function(e){e.preventDefault(),p.show({post:i,spaceId:null==b?void 0:b.id,onPostChange:a,onPostDestroy:l,autofocusReplyForm:!0})}}))}),!(0,f.A8)(i)&&(0,r.jsxs)("a",(t=V({},u),n=n={className:s()("flex items-center justify-start gap-2 overflow-hidden rounded-md py-1 pl-1 pr-2",H({},h,m)),children:[(0,r.jsx)(z.s,{src:i.community_member.avatar_url||"",name:i.community_member.name||"",size:"5"}),(0,r.jsx)(Z.Z.LabelSm,{weight:"medium",truncate:!0,children:i.community_member.name})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))]})},W=function(e){var t=e.post,n=e.children,o=e.onPostChange,i=e.onPostDestroy,a=(0,F.F)(),s=(0,c.L2)().data;return(0,r.jsx)("button",{type:"button",className:"focus-visible:outline-secondary peer w-full focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2","aria-label":(0,g.t)("image_space.grid_view.open_full_post"),onClick:function(){return a.show({post:t,spaceId:null==s?void 0:s.id,onPostChange:o,onPostDestroy:i})},children:n})},G=function(e){var t=e.post,n=e.children;return(0,r.jsx)(x.s,{post:t,className:"focus-visible:outline-secondary peer inline-block focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:n})},$=function(e){var t=e.post,n=e.isSquareGrid,o=e.onPostChange,i=e.onPostDestroy,a=(0,U.WJ)()?W:G;return(0,r.jsxs)("div",{className:"group relative",children:[(0,r.jsxs)("div",{className:"absolute right-2 top-2 flex",children:[t.gallery.images.length>1&&(0,r.jsx)(j.JO,{type:"16-multiple-images",size:16}),t.pinned_at_top_of_space&&(0,r.jsx)(j.JO,{type:"16-pin-sm-white",size:16})]}),(0,r.jsx)(a,{post:t,onPostChange:o,onPostDestroy:i,children:(0,r.jsx)("img",{loading:"lazy",src:t.gallery.images[0].url,alt:t.truncated_content,className:s()("pointer-events-none inline-block w-full rounded-md md:rounded-none",{"aspect-square object-cover":void 0===n||n})})}),(0,r.jsx)(Q,{post:t,onPostChange:o,onPostDestroy:i})]})},K=function(e){var t=e.post,n=e.onPostChange,o=e.onPostDestroy;return(0,r.jsx)($,{post:t,onPostChange:n,onPostDestroy:o,isSquareGrid:!1})},J=n(60589),X=n(42194),Y=n(24831),ee=n(29090),et=n(34860),en=n(24330),er=n(51169),eo=function(e){var t=e.post,n=t.last_replied_or_posted,o=t.post_details_loaded,i=(null==n?void 0:n.type)==="replied";if(!o)return(0,r.jsx)(S.gi,{variant:"row",lg:!0,almostFull:!0});if(!n)return null;var a=(0,g.t)(n.type);return(0,r.jsxs)(x.s,{post:t,className:"!text-default focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:[i&&(0,r.jsx)(j.JO,{type:"arrow-solid-bottom-right",useWithFillCurrentColor:!0,className:"mr-1 !w-3.5",size:14}),(0,r.jsxs)(O.T,{interactive:!1,content:(0,f.s4)(n.created_at),className:"inline-flex items-center gap-1",children:[(0,r.jsx)("span",{className:"meta-person-action text-sm",children:"".concat(n.user_name," ").concat(a," ")}),(0,r.jsx)("span",{className:"ago post--card__timestamp text-sm",children:(0,N.TF)(n.created_at)})]})]})},ei=function(){return(0,r.jsx)(L,{type:"card"})};function ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var es=function(e){var t,n,o=e.onPostChange,i=e.onPostDestroy,a=e.refetchPosts,l=(0,c.Zh)(),u=l.record,d=l.isUpdatingCardViewThumbnail,f=(0,B.TC)().isDarkAppearance;if(!u)return null;var m=u.flagged_for_approval_at,p=u.community_member,b=u.hide_meta_info,h=u.display_title,v=u.is_liking_enabled,_=u.is_comments_enabled,j=u.cardview_image_url,w=(0,c.L2)().data,O=s()("post--card post--parent border-primary bg-primary border relative overflow-hidden rounded-2xl",{"flagged-for-approval":m,"has-engagement pb-10":v||_}),S=(0,q.O)({public_uid:p.public_uid,params:{show_back_link:!0}});return(0,r.jsxs)("div",{className:O,children:[(0,r.jsxs)("div",{className:"post--card__post text-dark",children:[(0,r.jsx)(x.s,{post:u,className:"post--card__cover text-dark bg-primary focus-visible:outline-secondary focus-visible:text-dark relative block aspect-[2] rounded-t-lg bg-cover bg-center bg-no-repeat focus-visible:rounded-t-lg focus-visible:outline focus-visible:outline-2",style:function(){if(j)return{backgroundImage:"url(".concat(j,")")};var e=f?(0,et.aP)("dark-mode-cover-thumbnail-2x.png"):(0,et.aP)("light-mode-cover-thumbnail-2x.png");return{backgroundImage:"url(".concat(e,")")}}(),shouldOpenPostModal:!0,children:d&&(0,r.jsx)("div",{className:"bg-primary absolute inset-0 flex items-center justify-center rounded-t-lg",children:(0,r.jsx)(er.a,{})})}),!b&&(0,r.jsx)("div",{className:"post--card__user has-cover -mt-5 px-5",children:(0,r.jsx)("div",{className:"post__avatar",children:(0,r.jsx)("a",(t=ea({className:"user__avatar focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},S),n=n={children:(0,r.jsx)(z.s,{src:p.avatar_url,name:p.name,size:"10"})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))})}),(0,r.jsx)("div",{className:s()("post--card__body p-5",{"post-meta--hidden":b}),children:(0,r.jsxs)("div",{className:"post--card__content",children:[(0,r.jsx)("div",{className:"post--card__header",children:(0,r.jsxs)("h2",{className:"space-x-2 text-base font-semibold",children:[(0,r.jsx)(x.s,{post:u,className:"!text-darkest overflow-anywhere focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:(0,y.truncate)(h,{length:60})}),!!m&&(0,r.jsx)(en.g,{className:"post--card__headline-tag !bg-author-in-review border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]})}),!b&&(0,r.jsx)("div",{className:"post--card__meta",children:(0,r.jsx)(eo,{post:u})})]})})]}),(0,r.jsx)(ei,{}),(0,r.jsxs)("div",{className:"absolute inset-x-4 top-4 z-[5] flex items-center justify-between",children:[(0,r.jsx)("div",{className:"grow",children:(0,J.Y_)(w)&&(0,ee.f)(u)&&(0,r.jsx)(Y.F.Short,{record:u,contentType:"post"})}),(0,r.jsx)("div",{className:"ml-2 shrink-0",children:(0,r.jsx)(X.p,{onPostDestroy:i,refetchPosts:a,onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(ea({},u,e),t)}})})]})]})},el=function(e){return(0,r.jsx)(es,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))},ec=function(e){var t=e.post,n=t.last_replied_or_posted;return t.post_details_loaded?n?(0,r.jsxs)(x.s,{post:t,className:"!text-default focus-visible:outline-secondary inline-flex items-center gap-1 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:["replied"===n.type&&(0,r.jsx)(j.JO,{useWithFillCurrentColor:!0,type:"arrow-solid-bottom-right",className:"text-default !w-3.5",size:14}),(0,r.jsxs)(O.T,{interactive:!1,content:(0,f.s4)(n.created_at),className:"inline-flex items-center gap-1",children:[(0,r.jsx)("span",{className:"meta-person-action text-xs",children:"".concat(n.user_name," ").concat(n.type," ")}),(0,r.jsx)("span",{className:"ago post--list__timestamp text-xs",children:(0,N.TF)(n.created_at)})]})]}):null:(0,r.jsx)(S.gi,{variant:"row",lg:!0,half:!0})};function eu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function ed(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var ef=function(e){var t=e.onPostChange,n=e.onPostDestroy,o=e.refetchPosts,i=e.hideTitle,a=void 0!==i&&i,l=(0,c.L2)().data,u=(0,c.Zh)().record,d=(0,U.kK)(),f=u.flagged_for_approval_at,m=u.community_member,p=u.hide_meta_info,b=u.display_title,h=s()("post--list post--parent border-t border-primary px-5 py-3 md:py-4 bg-primary border-b-none last:border-b md:border-x first:md:rounded-t-2xl last:md:rounded-b-2xl",{"flagged-for-approval":f}),v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(eu({},u,e),n)},_=(0,J.Y_)(l)&&(0,ee.f)(u),j=(0,q.O)({public_uid:m.public_uid,params:{show_back_link:!0}});return d?(0,r.jsxs)("div",{className:h,children:[(0,r.jsx)("div",{className:"post--list__post text-dark flex gap-3",children:(0,r.jsxs)("div",{className:"post--list__body flex w-full flex-col gap-2",children:[(0,r.jsx)("div",{className:"post--list__content w-full gap-2 !pr-0 md:gap-0",children:!a&&(0,r.jsxs)("div",{className:s()("post--list__header flex w-full items-start justify-between",{"post-meta--hidden":p}),children:[(0,r.jsxs)("h2",{className:"mr-4 space-x-2 text-base font-medium leading-5",children:[(0,r.jsx)(x.s,{post:u,className:"!text-dark overflow-anywhere focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:(0,y.truncate)(b,{length:110})}),!!f&&(0,r.jsx)(en.g,{className:"post--list__headline-tag !bg-author-in-review w-full max-w-fit border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]}),(0,r.jsx)(X.p,{onPostDestroy:n,refetchPosts:o,onChange:v})]})}),!p&&(0,r.jsxs)("div",{className:"flex items-start justify-start space-x-2",children:[(0,r.jsx)("div",{className:"post--list__user",children:(0,r.jsx)("a",ed(eu({},j),{className:"focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,r.jsx)(z.s,{src:m.avatar_url,name:m.name,size:"6"})}))}),(0,r.jsxs)("div",{className:"post--list__meta flex w-full items-center justify-between",children:[(0,r.jsx)(ec,{post:u}),(0,r.jsx)("div",{className:"post--list__actions-wrapper gap-2 self-start md:gap-0",children:(0,r.jsx)(L,{})})]})]})]})}),_&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(Y.F.Regular,{record:u,contentType:"post"})})]}):(0,r.jsxs)("div",{className:h,children:[(0,r.jsxs)("div",{className:"post--list__post text-dark flex gap-3",children:[!p&&(0,r.jsx)("div",{className:"post--list__user",children:(0,r.jsx)("a",ed(eu({},j),{className:"focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,r.jsx)(z.s,{src:m.avatar_url,name:m.name,size:"10"})}))}),(0,r.jsxs)("div",{className:"post--list__body flex w-full items-center justify-between",children:[(0,r.jsxs)("div",{className:s()("post--list__content flex flex-col",{"justify-center":p,"justify-start gap-1":!p}),children:[!a&&(0,r.jsx)("div",{className:s()("post--list__header",{"post-meta--hidden":p}),children:(0,r.jsxs)("h2",{className:"mr-4 flex space-x-2 text-base font-medium leading-5",children:[(0,r.jsx)(x.s,{post:u,className:"!text-dark overflow-anywhere focus-visible:outline-secondary focus-visible:text-dark line-clamp-1 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:b}),!!f&&(0,r.jsx)(en.g,{className:"post--list__headline-tag !bg-author-in-review w-full max-w-fit shrink-0 border-0 align-text-top uppercase text-white",label:(0,g.t)("in_review")})]})}),!p&&(0,r.jsx)("div",{className:"post--list__meta inline-flex",children:(0,r.jsx)(ec,{post:u})})]}),(0,r.jsxs)("div",{className:"post--list__actions-wrapper flex shrink-0 items-baseline gap-1",children:[(0,r.jsx)(L,{likeButtonClassName:"!inline-flex",commentButtonClassName:"!inline-flex"}),(0,r.jsx)(X.p,{onPostDestroy:n,refetchPosts:o,onChange:v})]})]})]}),_&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(Y.F.Regular,{record:u,contentType:"post"})})]})},em=function(e){return(0,r.jsx)(ef,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))},ep=n(24921),eb=function(e){var t=e.space,n=void 0===t?{}:t,o=e.post,i=e.isFirst,a=e.forcePostView,s=e.forceSimplifiedView,l=e.forceIframeView,d=e.usedIn,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["space","post","isFirst","forcePostView","forceSimplifiedView","forceIframeView","usedIn"]),m=!!o.pinned_at_top_of_space,p=(0,J.AU)(n),b=(0,J.G6)(n),h=ep.D;return(0,J.fq)(n)?h=ep.D:(0,J.wk)(n)?h=K:(0,J.HO)(n)?h=$:void 0!==s&&s?h=T:void 0!==l&&l?h=u:void 0!==a&&a||m&&void 0!==i&&i?h=ep.D:p?h=el:b&&(h=em),(0,r.jsx)(c.DW,{post:o,usedIn:d,children:(0,r.jsx)(h,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({post:o},f))})}},73384:function(e,t,n){n.d(t,{Fk:()=>a,_t:()=>s});var r=n(85893),o=n(67294),i=(0,o.createContext)({params:{},hasNextPage:!1});i.displayName="PostNavigationContext";var a=function(e){var t=e.children,n=e.params,o=e.hasNextPage;return(0,r.jsx)(i.Provider,{value:{params:void 0===n?{}:n,hasNextPage:void 0!==o&&o},children:t})},s=function(){var e=(0,o.useContext)(i);if(!e)throw Error("usePostNavigationContext must be used within a PostNavigationProvider");return e}},17e3:function(e,t,n){n.d(t,{o:()=>tJ});var r=n(85893),o=n(67294),i=n(84326),a=n(58533),s=n(1168),l=n(20624),c=n(96486),u=n(60589),d=n(24831),f=n(29090),m=n(41342),p=n(63549),b=n(52293),h=n(83095),v=n(59892),y=n(52988),g=n(39905),_=n(46977),x=n(67379),j=n(4614),w=function(e,t,n,r){(0,o.useEffect)(function(){if(e&&e.id!==(null==t?void 0:t.id)&&"CommunityMember"===e.type){var o,i;r((o={},i=e.rich_text_field_sgid,i in o?Object.defineProperty(o,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[i]=e,o)),(0,c.defer)(function(){var t,r;null==n||null==(r=n.current)||null==(t=r.chain)||t.call(r).focus("start").insertContent([(0,j.F_)({sgid:e.rich_text_field_sgid}),(0,j.$U)({text:" "})]).run()})}},[e,t,n])},O=function(e,t,n){(0,o.useEffect)(function(){(0,c.defer)(function(){if(t&&!e){var r,o,i;null==n||null==(i=n.current)||null==(o=i.commands)||null==(r=o.focus)||r.call(o,"end")}})},[t,e,n])},S=n(41769);function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var I=function(e){var t=C((0,o.useState)(!1),2),n=t[0],r=t[1],i=C((0,o.useState)(0),2),a=i[0],s=i[1],l=(0,o.useRef)(null),u=(0,o.useRef)(null),d=(0,b.Gc)(),f=d.watch,m=d.reset,p=d.formState,h=p.isSubmitting,v=p.isSubmitSuccessful,y=f("tiptap_body"),g=!(0,S.NU)(y),_=g||h,x=(0,o.useCallback)(function(t){e&&(t||!g?r(!0):r(!1))},[e,g]),j=(0,o.useCallback)(function(){e&&r(!0)},[e]);return(0,o.useEffect)(function(){!g&&e&&r(!0)},[g,e]),(0,o.useEffect)(function(){v&&(e&&r(!1),(0,c.defer)(function(){m(),s(function(e){return e+1})}))},[v,m,e]),{isEditorExpanded:n,setIsEditorExpanded:r,editorKey:a,commentBoxRef:l,toolbarRef:u,formContext:d,isSubmitting:h,isEditorEmpty:g,isSubmitDisabled:_,handleFocusChange:x,handleEditorFocus:j}},k=function(e,t,n){(0,o.useEffect)(function(){if(e){var r=function(){setTimeout(function(){var e,r=document.activeElement,o=null==(e=t.current)?void 0:e.contains(r),i=document.querySelector(".post__reply:not(.reply-to-parent)"),a=null==i?void 0:i.contains(r);o||a?n(!0):n(!1)},0)};return document.addEventListener("focusin",r),document.addEventListener("focusout",r),function(){document.removeEventListener("focusin",r),document.removeEventListener("focusout",r)}}},[e,t,n])},N=function(e){var t=e.editorRef,n=e.autoFocus,r=e.parentCommentId,i=e.communityMemberForReply,a=e.currentCommunityMember,s=e.addToLocalSgidToObjectMap,l=e.usedIn,c=e.toolbarPortalId,u="minimal-post-modal"===l,d=u&&!r,f=I(u),m=f.isEditorExpanded,p=f.editorKey,b=f.commentBoxRef,h=f.toolbarRef,v=f.formContext,y=f.isSubmitting,g=f.isSubmitDisabled,j=f.handleFocusChange,S=f.handleEditorFocus,P=d?m&&!g:!g;return O(d,n,t),(0,o.useEffect)(function(){h.current=document.getElementById(c)},[c,h]),k(u,h,j),w(i,a,t,s),(0,_.y1)("meta+enter, ctrl+enter",function(){(0,x.C)(v)&&v.triggerFormSubmit()},{enableOnContentEditable:!0,enabled:P},[v,P]),{isEditorExpanded:m,commentBoxRef:b,handleEditorFocus:S,editorKey:p,isSubmitDisabled:g,isSubmitting:y,isUsedInMinimalPostModal:u,isPostCommentFormInMinimalPostModal:d}};function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return A(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var T=function(e){var t=e.autoFocus,n=e.className,o=e.communityMemberForReply,a=e.editorRef,l=e.isEdit,c=void 0!==l&&l,u=e.parentCommentId,d=e.placeholder,f=void 0===d?(0,i.t)("comments.form.fields.body_placeholder"):d,p=e.postId,_=e.spaceId,x=e.usedIn,j=e.persistCacheKey,w=(0,m.wh)().currentCommunityMember,O=(0,b.Gc)(),S=O.formState.isDirty,P=O.setValue,C=O.watch;(0,h.K)({cacheKey:j,fields:["tiptap_body"],enabled:!c&&!!j&&S});var I="tiptap_body.sgids_to_object_map",k=C(I)||{},A=function(e){P(I,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},k,e))},T="tiptap_body.inline_attachments",M=C(T)||[],R=["post",p,c?"edit":"create",u,"comment-form-toolbar",x].filter(Boolean).join("-"),D=N({editorRef:a,autoFocus:void 0!==t&&t,usedIn:x,parentCommentId:u,communityMemberForReply:o,currentCommunityMember:w,addToLocalSgidToObjectMap:A,toolbarPortalId:R}),L=D.isEditorExpanded,F=D.commentBoxRef,U=D.handleEditorFocus,B=D.editorKey,q=D.isSubmitDisabled,z=D.isSubmitting,Z=D.isUsedInMinimalPostModal,H=D.isPostCommentFormInMinimalPostModal;return(0,r.jsxs)("div",{ref:F,className:(0,s.A)("border-primary focus-within:border-light active:border-light rounded-lg border transition-all duration-300 ease-in-out",{"pointer-events-none opacity-50":z,"px-4 py-3":!H,"max-h-[40px] px-4 py-1.5":H&&!L,"max-h-[440px] px-4 py-3":H&&L}),children:[(0,r.jsx)("div",{className:(0,s.A)("transition-all duration-300 ease-in-out",{"max-h-[40px] overflow-hidden":Z&&!L,"max-h-[400px]":Z&&L}),children:(0,r.jsx)(v.$,{editorRef:a,placeholder:f,name:"tiptap_body.body",toolbars:[{portalId:R,component:y.o}],className:(0,s.A)("max-h-[400px] overflow-y-auto",n),editorClassName:"min-h-[30px]",spaceId:_,sgidToObjectMap:k,inlineAttachments:M,onLocalSgidToObjectMapChange:A,onLocalAttachmentsChange:function(e){P(T,Array.from(new Set(E(M).concat(E(e)))))},disabledExtensions:["poll","ai_copilot","cta"],onFocusChange:function(e){e&&U()},isVoiceMessageAllowed:!0,allowBubbleMenuOverflow:!1})}),(0,r.jsxs)("div",{className:(0,s.A)("flex items-end justify-between transition-all duration-300 ease-in-out",{"invisible max-h-0 overflow-hidden opacity-0":H&&!L,"visible max-h-[32px] opacity-100":H&&L,"h-0":H&&!L,"h-[32px]":H&&L}),children:[(0,r.jsx)("div",{id:R,className:"transition-opacity duration-300 ease-in-out"}),(0,r.jsx)(g.z,{variant:"primary",type:"submit",disabled:q,className:"!px-4 transition-opacity duration-300 ease-in-out",children:c?z?(0,i.t)("comments.create.actions.saving"):(0,i.t)("comments.create.actions.save"):z?(0,i.t)("comments.create.actions.submitting"):(0,i.t)("comments.create.actions.submit")})]})]},B)},M=n(5179),R=n(98363),D=n(51466),L=n(88767),F=n(93199),U=n(13532),B=n(60878),q=function(e){var t=e.postId,n=e.parentCommentId,r=e.onCreate,o=(0,B.pm)().error;return{createComment:(0,L.useMutation)(function(e){return(0,F.Cu)(U.av.comments.create({postId:t}),{comment:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({parent_comment_id:n},e)})},{onSuccess:r,onError:function(){return o((0,i.t)("comments.create.alerts.failure"))}}).mutateAsync}},z=function(e){var t=e.spaceId,n=e.postId,o=e.parentCommentId,a=e.communityMemberForReply,l=e.autoFocus,c=e.onCreate,u=e.bodyInputRef,d=e.className,f=e.persistCacheKey,p=(0,M.g)(!!o),b=(0,m.wh)().currentCommunityMember,v=(0,m.Zh)(),y=v.usedIn,g=v.isUsedInMinimalTipTapViewModal,_=(0,(0,h.d)({cacheKey:f}).getPersistedFormFieldValues)(),x=a?(0,i.t)("comments.form.fields.body_reply_placeholder",{name:a.name}):(0,i.t)("comments.form.fields.body_placeholder"),j=q({postId:n,parentCommentId:o,onCreate:c}).createComment;return(0,r.jsxs)("div",{className:(0,s.A)("post__reply flex items-start gap-3 py-2.5 md:py-5",{"md:px-6":"minimal-post-modal"!==y,"reply-to-parent -ml-8 py-2.5 md:ml-0":o&&"full-post-modal"!==y,"reply-to-parent -ml-8 md:ml-[-3.125rem]":o&&"full-post-modal"===y,"reply-to-post bg-primary sticky bottom-0":!o,"md:rounded-b-2xl":!g,"px-5":!o&&!g}),ref:p,children:["full-post-modal"!==y&&(0,r.jsx)(R.s,{src:null==b?void 0:b.avatar_url,name:(null==b?void 0:b.name)||"",size:"10"}),(0,r.jsx)(D.l,{className:"relative w-full",defaultValues:{tiptap_body:null==_?void 0:_.tiptap_body},onSubmit:function(e){return j(e)},children:(0,r.jsx)(T,{autoFocus:void 0!==l&&l,className:d,communityMemberForReply:a,editorRef:u,isEdit:!1,parentCommentId:o,placeholder:x,postId:n,spaceId:t,usedIn:y,persistCacheKey:f})})]})},Z=n(72727),H=n(67919),V=n(70442),Q=function(){var e=(0,V.TH)().hash.split(H.q)[1];return{commentId:e&&parseInt(e,10)||null}};function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var G=function(e){var t,n=e.enabled,r=void 0===n||n,i=(0,Z.L)().isElectron,a=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return W(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],l=a[1],c=Q().commentId;(0,o.useEffect)(function(){if(r&&c&&!s&&!i){var e=setTimeout(function(){l(!0);var e=document.querySelector("".concat(H.q).concat(c));e&&e.scrollIntoView()},500);return function(){return clearTimeout(e)}}},[r,c,s,i])},$=n(45578),K=n.n($),J=n(7992),X=function(e){var t=e.postId,n=e.parentCommentId,r=e.usedIn,o=e.preloaded,i=void 0!==o&&o,a=e.preloadedComments,s=void 0===a?[]:a,l=e.preloadedCommentsTotalCount,u=void 0===l?0:l,d=e.onCommentsUpdate;return(0,L.useInfiniteQuery)((0,J.k)({postId:t,parentCommentId:n,usedIn:r}),function(e){var r=e.pageParam,o={per_page:15,page:void 0===r?1:r},i=n?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({parent_comment_id:n},o):o;return(0,F.UT)(U.av.comments.index({postId:t,params:i}))},{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},onSuccess:function(e){var t=e.pages;d(K()((0,c.flatMap)(t,function(e){return e.records}),"id"))},initialData:function(){if(i)return{pages:[{records:s,page:0,has_next_page:u>s.length}],pageParams:[]}},cacheTime:0,staleTime:1/0,notifyOnChangeProps:"tracked"})},Y=n(43063),ee=n.n(Y);function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function en(e,t){if(e){if("string"==typeof e)return et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return et(e,t)}}var er=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.initialComments,r=(e=(0,o.useState)(void 0===n?[]:n),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||en(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],a=r[1];return{comments:i,setComments:a,addCommentToList:function(e){return a(function(t){return((function(e){if(Array.isArray(e))return et(e)})(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||en(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e])})},updateCommentInList:function(e){return a(function(t){return t.map(function(t){return t.id===e.id?e:t})})},removeCommentFromList:function(e){var t=e.id;return a(function(e){return ee()(e,["id",t])})}}},eo=n(31841),ei=function(e){var t=e.postId,n=e.parentCommentId,r=n?"post-".concat(t,"-comment-").concat(n,"-reply-form-values"):"post-".concat(t,"-comment-form-values"),o=(0,eo._)(r).resetValue;return{persistCacheKey:r,resetPersistedFormValues:o}},ea=function(){var e=(0,V.TH)(),t=e.state;return{shouldFocusOnCommentsSection:null==t?void 0:t.shouldFocusOnCommentsSection,location:e,setShouldFocusOnCommentsSection:function(t){e.state.shouldFocusOnCommentsSection=t}}};function es(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function el(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return es(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return es(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ec=function(e){var t=e.postId,n=e.parentCommentId,r=e.preloaded,i=void 0!==r&&r,a=e.preloadedComments,s=void 0===a?[]:a,l=e.preloadedCommentsTotalCount,c=e.postCommentsClosed,u=e.postLikingDisabled,d=e.usedIn,f=e.isUsedInMinimalTipTapViewModal,p=e.onCommentCreate,b=e.onCommentDelete,h=e.resetCommunityMemberForReply,v=e.space,y=e.showReplyForm,g=e.commentsSectionRef,_=(0,m.N3)(),x=(0,m.Zh)(),j=x.usedIn,w=void 0===j?void 0===d?"post":d:j,O=x.isUsedInMinimalTipTapViewModal,S=er({initialComments:s||[]}),P=S.comments,C=S.setComments,I=S.addCommentToList,k=S.updateCommentInList,N=S.removeCommentFromList,A=el((0,o.useState)(c),2),E=A[0],T=A[1],M=el((0,o.useState)(u),2),R=M[0],D=M[1],L=el((0,o.useState)(0),2),F=L[0],U=L[1],B=ea(),q=B.shouldFocusOnCommentsSection,z=B.setShouldFocusOnCommentsSection,Z=ei({postId:t,parentCommentId:n}),H=Z.persistCacheKey,V=Z.resetPersistedFormValues,Q=X({postId:t,parentCommentId:n,usedIn:w,preloaded:i,preloadedComments:s,preloadedCommentsTotalCount:void 0===l?0:l,onCommentsUpdate:C}),W=Q.isLoading,$=Q.isFetchingNextPage,K=Q.hasNextPage,J=Q.fetchNextPage,Y=Q.remove,ee=c!==E||u!==R;(0,o.useEffect)(function(){!i&&ee&&(T(c),D(u),C([]),Y())},[i,ee,c,u,Y,C]);var et=W&&0===P.length,en=W||$;(0,o.useEffect)(function(){if(!en&&q){var e;null==g||null==(e=g.current)||e.scrollIntoView({behavior:"smooth"}),z(!1)}},[en,q,z,null==g?void 0:g.current]);var eo=_&&v&&void 0!==y&&y&&(!en||P.length>0);return G({enabled:!W}),{comments:P,isFetchingNextPage:$,hasNextPage:K,fetchNextPage:J,addCommentToList:I,updateCommentInList:k,removeCommentFromList:N,handleCommentCreate:function(e){null==h||h(),I(e),null==p||p(e);var t=document.getElementById("comment_wrapper_".concat(e.id));t&&t.scrollIntoView({behavior:"smooth",block:"center"}),V(),U(function(e){return e+1})},handleCommentDelete:function(e){N(e),null==b||b(e)},formKey:F,persistCacheKey:H,isFirstLoading:et,isAnyLoading:en,shouldShowForm:eo,usedIn:w,isUsedInMinimalTipTapViewModal:void 0===O?void 0!==f&&f:O}},eu=function(e){var t=e.space,n=e.post,o=e.parentCommentId,a=e.preloadedComments,c=e.preloadedCommentsTotalCount,u=e.showReplyForm,d=e.autofocusReplyForm,f=e.communityMemberForReply,m=e.onCommentReplyClick,p=e.onCommentCreate,b=e.onCommentDelete,h=e.resetCommunityMemberForReply,v=e.formRef,y=ec({postId:n.id,parentCommentId:o,preloaded:!0,preloadedComments:void 0===a?[]:a,preloadedCommentsTotalCount:void 0===c?0:c,postCommentsClosed:n.is_comments_closed,postLikingDisabled:n.is_liking_disabled,space:t,showReplyForm:void 0!==u&&u,onCommentCreate:p,onCommentDelete:b,resetCommunityMemberForReply:h}),g=y.comments,_=y.hasNextPage,x=y.fetchNextPage,j=y.updateCommentInList,w=y.handleCommentCreate,O=y.handleCommentDelete,S=y.formKey,P=y.persistCacheKey,C=y.isAnyLoading,I=y.shouldShowForm,k=y.isUsedInMinimalTipTapViewModal;return(0,r.jsxs)("div",{className:(0,s.A)({"my-3":!I}),children:[g.map(function(e){return(0,r.jsx)(tC,{space:t,post:n,comment:e,autofocusReplyForm:!0,onReplyClick:m,onUpdate:j,onDelete:O,onReplyCreate:p,onReplyDelete:b},e.id)}),C&&(0,r.jsx)(l.m,{}),!C&&_&&(0,r.jsx)("div",{className:"load-more mb-4 mt-2 pl-5 text-left text-sm font-medium md:pl-6",children:(0,r.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),x()},className:"focus-visible:outline-secondary load-more__replies text-link focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,i.t)("comments.list.show_more_replies")})}),C&&k&&(0,r.jsx)("div",{className:"bg-primary absolute bottom-0 left-0 w-full !px-5 !py-4 md:!px-8",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"bg-tertiary h-10 w-10 animate-pulse rounded-full"}),(0,r.jsx)("div",{className:"border-primary h-10 w-full rounded-lg border p-px"})]})}),I&&(0,r.jsx)(z,{spaceId:t.id,postId:n.id,parentCommentId:o,communityMemberForReply:f,autoFocus:void 0!==d&&d,className:(0,s.A)(k&&"!max-h-[360px]"),onCreate:w,bodyInputRef:v,persistCacheKey:P},S)]})},ed=n(20640),ef=n.n(ed),em=n(15731),ep=n(56345),eb=n(75148),eh=n(43544);function ev(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function ey(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var eg=function(e){var t=e.comment,n=e.canReport,o=e.canReview,a=e.canEdit,l=e.canDestroy,c=e.canBookmark,u=e.isReply,d=e.onReportClick,f=e.onEditClick,m=e.onDeleteClick,p=e.onUpdate,b=(0,em.I)(),h=[],v=(0,B.pm)().success;n&&h.push({key:"report",label:(0,i.t)("comments.action_menu.report.label"),href:"#",onClick:function(){d()}}),o&&h.push(ev({key:"review",label:(0,i.t)("comments.action_menu.review.label"),to:U.sC.index()},b?{target:"_blank",rel:"noreferrer"}:{})),a&&h.push({key:"edit",label:(0,i.t)("comments.action_menu.edit.label"),onClick:function(){f()}});var y=t.show_url;return(y&&h.push({key:"Copy link",label:(0,i.t)("comments.action_menu.copy_url.label"),href:"#",onClick:function(){ef()(y),v((0,i.t)("comments.action_menu.copy_url.url_copied"))}}),l&&h.push({key:"delete",label:(0,i.t)("comments.action_menu.delete.label"),hasDanger:!0,onClick:function(){m()}}),0!==h.length||c)?(0,r.jsx)("div",{className:(0,s.A)("post__actions--comment ml-2 md:ml-4",{"post__actions--reply":u}),"data-testid":"post-comment-actions",children:(0,r.jsxs)(eh.Lt,{menuButtonEl:"div",button:(0,r.jsx)(eb.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,dataTestId:"action-more",ariaLabel:(0,i.t)("comments.actions")}),children:[(0,r.jsx)(ep.e,{variant:"dropdown",bookmarkType:"comment",record:t,onSuccess:function(e){p(ey(ev({},t),{bookmark_id:e}))}}),h.map(function(e){var t=e.key,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["key"]);return(0,r.jsx)(eh.Lt.ItemWithLink,ey(ev({},n),{children:e.label}),t)})]})}):null},e_=n(93440),ex=n(91704),ej=n(72851),ew=function(e){var t=e.comment,n=t.body_trix_content,o=t.editor,i=t.tiptap_body,a=t.updated_at;return(0,r.jsx)("div",{className:"post__body text-base","data-testid":"comment-body",children:(0,r.jsx)("div",{className:"post__inside text-dark","data-testid":"comment-body-inside",children:(0,r.jsx)(ej.X,{lines:8,children:"tiptap"===o?(0,r.jsx)(e_.G,{tiptapBody:i}):(0,r.jsx)(ex.P,{content:n})})},a)})},eO=n(87279),eS=function(e){var t=e.comment,n=e.space,o=e.updateComment;return(0,r.jsx)("div",{className:"text-dark mb-1 whitespace-pre-line text-sm font-normal",children:(0,r.jsx)(eO.l,{onSubmit:o,defaultValues:{tiptap_body:t.tiptap_body},children:(0,r.jsx)(T,{isEdit:!0,postId:t.post_id,spaceId:n.id,autoFocus:!0})})})},eP=n(57105),eC=n(34519),eI=function(e){var t=e.comment,n=e.space,o=e.updateComment,a=(0,eP.dd)();return(0,_.y1)("esc",function(){return a.remove()},{enableOnContentEditable:!0},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eC.u_.Overlay,{}),(0,r.jsxs)(eC.u_.Content,{size:"lg",className:"!overflow-visible",children:[(0,r.jsxs)(eC.u_.Header,{children:[(0,r.jsx)(eC.u_.Title,{size:"sm",children:(0,i.t)("comments.edit.form.title")}),(0,r.jsx)(eC.u_.HeaderActions,{children:(0,r.jsx)(eC.u_.CloseButton,{onClick:a.remove})})]}),(0,r.jsx)(eC.u_.Body,{className:"!overflow-y-visible pb-6",children:(0,r.jsx)(eS,{comment:t,space:n,updateComment:o})})]})]})},ek=n(45697),eN=n.n(ek),eA=n(12635),eE=n(5116),eT=function(e){var t=e.spaceId,n=e.spaceIsPrivate,o=e.onClose,a=(0,b.Gc)(),s=a.watch,l=a.formState,c=l.isDirty,u=l.isSubmitting,d=l.isSubmitSuccessful,f=s().body,m=u||d,p=!!f&&!m;(0,eA.M)({enabled:p});var h=function(){(!c||confirm((0,i.t)("prevent_accidental_leave_message")))&&o()};return(0,r.jsxs)(eC.u_.Content,{size:"lg",wrapperClassName:"!h-full",className:"!transform-none !overflow-visible",children:[(0,r.jsxs)(eC.u_.Header,{children:[(0,r.jsx)(eC.u_.Title,{children:(0,i.t)("comments.edit.form.title")}),(0,r.jsx)(eC.u_.HeaderActions,{children:(0,r.jsx)(eC.u_.CloseButton,{onClick:h})})]}),(0,r.jsx)(eC.u_.Body,{className:"comment__edit-modal-content-body trix-v2 max-h-[calc(100dvh-82px-65px)] !overflow-visible md:max-h-none",children:(0,r.jsx)(eE.O,{id:"comment-edit-body",name:"body",placeholder:(0,i.t)("comments.form.fields.body_placeholder"),className:"h-full",editorContainerClassName:"flex flex-col h-full",textboxClassName:"overflow-auto rounded-md py-4 sm:max-h-[40vh]",space_id:t,is_private_space:n})}),(0,r.jsxs)(eC.u_.Footer,{className:"bottom-0 flex justify-end space-x-4",children:[(0,r.jsx)(g.z,{type:"button",variant:"secondary",onClick:h,children:(0,i.t)("cancel")}),(0,r.jsx)(g.z,{type:"submit",variant:"primary",disabled:!p,children:m?(0,i.t)("saving_changes"):(0,i.t)("save_changes")})]})]})};eT.propTypes={spaceId:eN().number.isRequired,spaceIsPrivate:eN().bool.isRequired,onClose:eN().func.isRequired};var eM=function(e){var t=e.comment,n=e.onUpdate,r=t.id,o=t.post_id,a=t.body_for_editor,s=(0,B.pm)(),l=s.success,c=s.error;return{defaultValues:{body:a},updateComment:(0,L.useMutation)(function(e){return(0,F.gN)(U.av.comments.update({postId:o,id:r}),{comment:e})},{onSuccess:function(e){n(e),l((0,i.t)("comments.edit.alerts.success"))},onError:function(){return c((0,i.t)("comments.edit.alerts.failure"))}}).mutateAsync}},eR=function(e){var t=e.space,n=e.comment,o=e.onUpdate,a=t.id,s=t.is_private,l=(0,eP.dd)(),u="tiptap"===n.editor,d=eM({comment:n,onUpdate:function(e){o(e),l.hide()}}),f=d.defaultValues,m=d.updateComment;return(0,r.jsx)(eC.u_,{title:(0,i.t)("comments.edit.form.title"),isOpen:l.visible,onClose:c.noop,children:u?(0,r.jsx)(eI,{comment:n,space:t,updateComment:m}):(0,r.jsxs)(D.l,{defaultValues:f,onSubmit:m,className:"h-full",formClassName:"h-full",children:[(0,r.jsx)(eC.u_.Overlay,{}),(0,r.jsx)(eT,{spaceId:a,spaceIsPrivate:s,onClose:l.hide})]})})},eD=eP.gk.create(function(e){var t=e.space,n=e.comment,o=e.onUpdate;return(0,r.jsx)(eR,{space:t,comment:n,onUpdate:o})}),eL=function(e){var t,n,o=e.label,i=e.onClick,a=e.disabled,l=void 0!==a&&a,c=e.isLiked,u=void 0!==c&&c,d=e.className,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["label","onClick","disabled","isLiked","className"]);return(0,r.jsx)("button",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({type:"button",className:(0,s.A)("focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",d),onClick:function(e){e.preventDefault(),l||i()},"aria-disabled":l},f),n=n={children:(0,r.jsx)("span",{"aria-checked":u,className:(0,s.A)("hover:text-dark text-sm",{"text-brand font-semibold":u,"text-default font-medium":!u}),children:o})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))};eL.propTypes={label:eN().string.isRequired,onClick:eN().func.isRequired,disabled:eN().bool,isLiked:eN().bool,className:eN().string};var eF=n(63676),eU=function(e){var t=e.likesCount,n=e.onClick;return(0,r.jsx)("button",{type:"submit",className:"text-default hover:text-dark group ml-auto mr-0 text-sm font-medium","data-testid":"like-count",onClick:n,children:(0,r.jsx)("span",{className:"group-focus-visible:outline-secondary group-focus-visible:rounded-sm group-focus-visible:outline group-focus-visible:outline-2 group-focus-visible:outline-offset-2",children:(0,i.t)("comments.likes",{count:t,formatted_count:(0,eF.HA)(t)})})})},eB=function(e){var t=e.canLike,n=e.canReply,o=e.canSeeLikes,a=e.isLiked,l=e.isLikeDisabled,c=e.likesCount,u=e.onLikeClick,d=e.onLikesCountClick,f=e.onReplyClick,p=(0,m.wh)().currentUser,b=o&&c>0&&(p||t&&n);return(0,r.jsxs)("div",{className:"post__actions post__actions-visible mt-1 flex pl-[3.25rem]",children:[t&&(0,r.jsx)(eL,{className:(0,s.A)("post__actions--like mr-2",{liked:a}),label:(0,i.t)("comments.engagement_actions.".concat(a?"liked":"like")),onClick:u,disabled:l,isLiked:a}),n&&(0,r.jsx)(eL,{className:"post__actions--reply",label:(0,i.t)("comments.engagement_actions.reply"),onClick:f}),b&&(0,r.jsx)(eU,{likesCount:c,onClick:d})]})};eB.propTypes={canLike:eN().bool.isRequired,canReply:eN().bool.isRequired,canSeeLikes:eN().bool.isRequired,isLiked:eN().bool.isRequired,isLikeDisabled:eN().bool.isRequired,likesCount:eN().number.isRequired,onLikeClick:eN().func.isRequired,onLikesCountClick:eN().func.isRequired,onReplyClick:eN().func.isRequired};var eq=n(51169),ez=n(41553),eZ=n(59834),eH=function(e){var t,n,o,i,a=e.communityMember,s=e.hideModal,l=(0,eZ.O)({public_uid:null!=(o=a.public_uid)?o:""}),c=l.onClick,u=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(l,["onClick"]);return(0,r.jsxs)("button",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({type:"button",className:"flex w-full items-center gap-3 text-left",onClick:function(e){s(),null==c||c(e)}},u),n=n={children:[(0,r.jsx)("div",{className:"mt-0",children:(0,r.jsx)(R.s,{name:null!=(i=a.name)?i:"",src:a.avatar_url,size:"10"})}),(0,r.jsx)(ez.Z.LabelSm,{weight:"medium",children:a.name})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},eV=n(85564),eQ=n.n(eV),eW=n(10928),eG=n.n(eW),e$=n(83780),eK=function(e){var t=e.id,n=e.isQueryEnabled,r=e.placeholderLikesCount,o=(0,e$.m)(U.av.comments.userLikes({id:t,params:{per_page:15}}),{enabled:n}),i=o.data,a=o.isLoading,s=o.hasNextPage,l=o.fetchNextPage,c=o.mapPages;return{likedByMembers:K()(eQ()(c(function(e){return e.records})),"id"),totalLikesCount:i?eG()(i.pages).count:r,isLoading:a,hasNextPage:s,fetchNextPage:l}},eJ=function(e){var t=e.commentId,n=e.placeholderLikesCount,o=(0,eP.dd)(),s=eK({id:t,isQueryEnabled:o.visible,placeholderLikesCount:n}),c=s.likedByMembers,u=s.totalLikesCount,d=s.isLoading,f=s.hasNextPage,m=s.fetchNextPage,p=(0,i.t)("comments.likes",{count:u,formatted_count:(0,eF.HA)(u)});return(0,r.jsxs)(eC.u_,{title:p,isOpen:o.visible,onClose:o.hide,children:[(0,r.jsx)(eC.u_.Overlay,{}),(0,r.jsxs)(eC.u_.Content,{children:[(0,r.jsxs)(eC.u_.Header,{children:[(0,r.jsx)(eC.u_.Title,{size:"sm",children:(0,r.jsx)(ez.Z.LabelLg,{weight:"semibold",children:p})}),(0,r.jsx)(eC.u_.HeaderActions,{children:(0,r.jsx)(eC.u_.CloseButton,{onClick:o.hide})})]}),(0,r.jsx)(eC.u_.Body,{className:"pb-6 pt-4",children:d?(0,r.jsx)(l.m,{}):(0,r.jsx)("div",{id:"comment-likes-modal-".concat(t),className:"max-h-[calc(100dvh-62px-44px-24px)] overflow-auto sm:max-h-80",children:(0,r.jsx)(a.Z,{scrollThreshold:.75,next:m,hasMore:null!=f&&f,loader:(0,r.jsx)(eq.a,{}),scrollableTarget:"comment-likes-modal-".concat(t),dataLength:c.length,className:"flex flex-col space-y-4",children:c.map(function(e){return(0,r.jsx)(eH,{communityMember:e,hideModal:o.hide},e.id)})})})})]})]})};eJ.displayName="LikesModalComponent";var eX=eP.gk.create(function(e){var t=e.commentId,n=e.placeholderLikesCount;return(0,r.jsx)(eJ,{commentId:t,placeholderLikesCount:n})});eX.displayName="LikesModal";var eY=n(74322),e0=n(45317),e1=n(42613),e2=n(96533),e3=n(9397),e4=n(61853),e6=n(57363),e8=function(e){var t=e.agentProfileInfo,n=e.publicUid,o=e.avatarURL,a=e.name,s=void 0===a?"":a,l=e.closeCard,c=(0,e2.r)(),u=(0,e4.Dk)().setCurrentBotProfile,d=(0,V.k6)();return(0,r.jsxs)(e0.VY,{className:"border-primary bg-primary z-[1059] w-full max-w-[320px] rounded-xl border p-6 shadow-xl",sideOffset:5,side:"right",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"text-dark mr-4 min-w-0 flex-1",children:[(0,r.jsx)(ez.Z.LabelMd,{weight:"semibold",children:(0,r.jsx)("span",{className:"text-dark",children:s})}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{className:"text-light break-words",children:(0,r.jsx)(ez.Z.LabelSm,{weight:"regular",children:(0,r.jsx)("span",{className:"text-light",children:null==t?void 0:t.bio})})})]}),(0,r.jsx)("div",{className:"shrink-0",children:(0,r.jsx)(e3.i,{avatarUrl:o,name:s,size:"small"})})]}),(0,r.jsx)("div",{className:"mt-4 space-y-2"}),(0,r.jsxs)("div",{className:"mt-4 flex w-full space-x-2",children:[n&&(0,r.jsxs)(g.z,{className:"!border-primary flex items-center justify-center space-x-2 !px-3 !py-1.5 !font-medium",full:!0,variant:"secondary",onClick:function(){c.show({memberPublicId:n}),l()},children:[(0,r.jsx)(e6.JO,{type:"16-user",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0}),(0,r.jsx)("span",{children:(0,i.t)("view_profile")})]}),(null==t?void 0:t.can_interact)&&(0,r.jsxs)(g.z,{onClick:function(e){var n;e.preventDefault(),e.stopPropagation(),u(null!=(n=null==t?void 0:t.profile)?n:null),d.push({pathname:(0,U.W9)()})},variant:"circle",full:!0,children:[(0,r.jsx)(e6.JO,{type:"plus",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0,className:"mr-1"}),(0,r.jsx)("span",{children:(0,i.t)("community_inbox.new_conversation")})]})]})]})};function e5(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var e9=function(e){var t,n=e.children,i=e.communityMemberId,a=e.publicUid,s=e.avatarURL,l=e.name,c=e.disabled,u=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return e5(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e5(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1],m=(0,e1.z)({agentId:Number(i)}).getAgentProfileInfoQuery.data;return(0,r.jsxs)(e0.fC,{openDelay:300,closeDelay:100,open:d,onOpenChange:f,children:[(0,r.jsx)(e0.xz,{asChild:!0,children:(0,r.jsx)("div",{children:n})}),(0,r.jsx)(e0.h_,{children:!(void 0!==c&&c)&&(0,r.jsx)(e8,{agentProfileInfo:null!=m?m:null,publicUid:a,avatarURL:s,name:void 0===l?"":l,closeCard:function(){return f(!1)}})})]})},e7=n(60983),te=function(e){var t,n,o,i,a,s,l,c=e.comment,u=c.community_member,d=c.author_type,f=(0,eZ.O)({public_uid:null!=(o=u.public_uid)?o:"",params:{show_back_link:!0}}),m=(0,eY.W)({id:u.id,params:{show_back_link:!0}});return(0,r.jsx)("div",{className:"post__user flex items-start",children:(0,r.jsx)("div",{className:"post__avatar mr-3",children:(0,r.jsx)("a",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:"user__avatar focus-visible:outline-secondary focus-visible:text-dark block h-10 w-10 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},"CommunityAiAgent"===d?m:f),n=n={children:"CommunityAiAgent"===d?(0,r.jsx)(e9,{communityMemberId:u.id,name:u.name,publicUid:u.public_uid,avatarURL:u.avatar_url,children:(0,r.jsx)(R.s,{src:null!=(i=u.avatar_url)?i:"",name:null!=(a=u.name)?a:"",size:"10"})}):(0,r.jsx)(e7.C,{communityMemberId:u.id,name:u.name,publicUid:u.public_uid,headline:u.headline,avatarURL:u.avatar_url,children:(0,r.jsx)(R.s,{src:null!=(s=u.avatar_url)?s:"",name:null!=(l=u.name)?l:"",size:"10"})})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))})})},tt=n(78456),tn=n(8683),tr=n(41084),to=n(17617),ti=n(80171),ta=n(34842),ts=n(24330),tl=n(23386),tc=function(e){var t,n,o=e.comment,a=e.commentLinkProps,l=o.community_member,u=o.created_at,d=(0,to.kK)(),f="full-post-modal"===(0,m.Zh)().usedIn,p=d||f?(0,c.truncate)(l.headline,{length:60}):l.headline;return p||d||f?(0,r.jsx)("div",{className:"post__meta inline-flex",children:(0,r.jsx)(ti.T,{content:l.headline,shouldUseSpanWrapper:!1,interactive:!1,disabled:!p,children:(0,r.jsx)("button",{type:"button",className:"author__credentials text-default focus-visible:outline-secondary focus-visible:text-dark mt-1 w-full text-left text-xs leading-4 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,r.jsxs)("span",{children:[p&&(0,r.jsx)("span",{className:(0,s.A)("overflow-anywhere mr-2",{"md:line-clamp-1":!f}),children:p}),(d||f)&&!!p&&(0,r.jsx)("span",{className:"bg-badge mr-2 inline-block h-[0.15rem] w-[0.15rem] rounded-full align-middle"}),(d||f)&&(0,r.jsx)("a",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:(0,s.A)("text-default hover:text-dark text-xs leading-5","focus-visible:outline-secondary focus-visible:text-dark mr-2 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2")},a),n=n={children:(0,r.jsx)(ti.T,{content:(0,tr.s4)(u),className:"inline-flex",interactive:!1,children:(0,tn.TF)(u,{format:tn.lc.short})})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)),(d||f)&&o.flagged_for_approval_at&&(0,r.jsx)(ts.g,{className:"authour__in-review !bg-author-in-review border-0 uppercase text-white",label:(0,i.t)("comments.in_review")})]})})})}):null};function tu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function td(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var tf=function(e){var t,n=e.post,o=e.comment,a=o.id,l=o.community_member,c=o.member_tags,u=o.flagged_for_approval_at,d=o.created_at,f=o.parent_comment_id,p=o.author_type,b=(0,m.wh)().currentCommunityMember,h="full-post-modal"===(0,m.Zh)().usedIn,v=!!l.admin,y=null==c?void 0:c.filter(function(e){var t;return(null==e?void 0:e.is_public)&&(null==e||null==(t=e.display_locations)?void 0:t.post_bio)}),g=(0,em.I)(),_=(0,tt.vb)(b),x=(null==y?void 0:y.length)>0||v,j=(0,to.kK)(),w=j?_:x,O=(0,eZ.O)({public_uid:null!=(t=l.public_uid)?t:"",params:{show_back_link:!0}}),S=(0,eY.W)({id:l.id,params:{show_back_link:!0}}),P=tu({href:(0,U.LM)({spaceSlug:n.space_slug,slug:n.slug,hash:"".concat(H.q).concat(a)})},g?{target:"_blank",rel:"noreferrer"}:{});return(0,r.jsxs)("div",{className:"post__bio mb-1.5 w-full",children:[(0,r.jsxs)("div",{className:(0,s.A)("author text-darkest flex flex-wrap items-center gap-x-2",{"no-headline":!l.headline}),children:[(0,r.jsx)("div",{className:"author__name flex",children:(0,r.jsx)("a",td(tu({className:"text-dark hover:text-darkest focus-visible:outline-secondary focus-visible:text-dark overflow-anywhere text-sm font-semibold focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"},"CommunityAiAgent"===p?S:O),{children:l.name}))}),"CommunityAiAgent"===p&&(0,r.jsx)(ta.c,{}),x&&w&&(0,r.jsx)("div",{className:"author__tags member-tags",children:(0,r.jsx)(tl.m,{memberTags:y,isAdmin:v,limit:j||h||f?1:2,showMoreLabelVariant:"numbers"})}),!j&&!h&&(0,r.jsx)("div",{className:"author__time flex",children:(0,r.jsx)("a",td(tu({className:(0,s.A)("text-default hover:text-dark text-xs","focus-visible:outline-secondary focus-visible:text-dark focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2")},P),{children:(0,r.jsx)(ti.T,{content:(0,tr.s4)(d),className:"inline-flex",interactive:!1,children:(0,tn.TF)(d,{format:tn.lc.short})})}))}),!j&&!h&&u&&(0,r.jsx)(ts.g,{className:"authour__in-review !bg-author-in-review border-0 uppercase text-white",label:(0,i.t)("comments.in_review")})]}),(0,r.jsx)(tc,{comment:o,commentLinkProps:P})]})},tm=["harassment","spam","incorrect_location","against_guidelines","other"],tp=function(e){var t=e.show,n=e.onClose,o=e.onReportSubmit,a=tm.map(function(e){return{value:e,label:(0,i.t)("flagged_contents.report_reasons.".concat(e))}});return(0,r.jsxs)(eC.u_,{isOpen:t,onClose:n,title:(0,i.t)("comments.report.form.title"),children:[(0,r.jsx)(eC.u_.Overlay,{}),(0,r.jsxs)(eC.u_.Content,{children:[(0,r.jsxs)(eC.u_.Header,{children:[(0,r.jsx)(eC.u_.Title,{size:"sm",children:(0,i.t)("comments.report.form.title")}),(0,r.jsx)(eC.u_.HeaderActions,{children:(0,r.jsx)(eC.u_.CloseButton,{onClick:n})})]}),(0,r.jsx)(eC.u_.Body,{children:(0,r.jsxs)(D.l,{onSubmit:function(e){return o(e)},children:[(0,r.jsx)(D.l.Item,{name:"reported_reason_type",label:(0,i.t)("flagged_contents.form.reported_reason_type"),description:(0,i.t)("flagged_contents.form.reported_reason_type_description"),className:"!pt-0",hideBorder:!0,children:(0,r.jsx)(D.l.SelectNative,{name:"reported_reason_type",options:a})}),(0,r.jsx)(D.l.Item,{name:"reported_reason_body",label:(0,i.t)("flagged_contents.form.reported_reason_body"),description:(0,i.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,r.jsx)(D.l.TextArea,{name:"reported_reason_body"})}),(0,r.jsx)("div",{className:"flex justify-end py-4",children:(0,r.jsx)(g.z,{type:"submit",variant:"primary",children:(0,i.t)("report")})})]})})]})]})};function tb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var th=function(e){var t,n=e.comment,r=e.onDelete,a=n.id,s=n.post_id,l=(0,B.pm)(),c=l.success,u=l.error,d=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tb(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tb(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=d[0],m=d[1],p=function(){return m(!1)},b=(0,L.useMutation)(function(){return(0,F.pC)(U.av.comments.destroy({postId:s,id:a}))},{onSuccess:function(){c((0,i.t)("comments.delete.alerts.success"),{duration:"short",shouldUseProgress:!1}),p(),r({id:a})},onError:function(){u((0,i.t)("comments.delete.alerts.failure")),p()}});return{isDeleteConfirmModalOpen:f,openDeleteConfirmModal:function(){return m(!0)},closeDeleteConfirmModal:p,deleteComment:b.mutate,isDeletingComment:b.isLoading}},tv=n(51630);function ty(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tg(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ty(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ty(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var t_="Comment",tx=function(e){var t=e.comment,n=t.id,r=t.is_liking_enabled,a=t.is_liked,s=t.likes_count,l=(0,m.xJ)(),c=(0,m.EU)(),u=(0,em.I)(),d=tg((0,o.useState)(a),2),f=d[0],p=d[1],b=tg((0,o.useState)(s),2),h=b[0],v=b[1],y=(0,L.useMutation)(function(){return tv.Qd.create({userLikeableId:n,userLikableType:t_,forReactQuery:!0})}),g=y.mutate,_=y.isLoading,x=(0,L.useMutation)(function(){return tv.Qd.destroy({userLikeableId:n,userLikableType:t_,forReactQuery:!0})}),j=x.mutate,w=x.isLoading;return{toggleLike:function(){if(!l){var e=(0,U.j)({params:{notice:(0,i.t)("comments.log_in_to_like_comments"),post_login_redirect:window.location.href}});u?window.open(e,"_blank","noreferrer"):window.location.href=e;return}_||w||(f?(p(!1),v(function(e){return e-1}),j()):(p(!0),v(function(e){return e+1}),g()))},isLiked:f,likesCount:h,canLike:r&&c,canSeeLikes:r,isLoading:_||w}};function tj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tw(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tj(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var tO=function(e){var t=e.comment,n=e.showReplyForm,r=e.replyFormRef,a=t.is_replying_enabled,s=(0,m.xJ)(),l=(0,m.EU)(),c=(0,em.I)(),u=tw((0,o.useState)(n),2),d=u[0],f=u[1],p=tw((0,o.useState)(null),2),b=p[0],h=p[1];return{openReplyForm:function(e){var t,n,o=e.communityMember;if(!s){var a=(0,U.j)({params:{notice:(0,i.t)("comments.log_in_to_add_a_comment"),post_login_redirect:window.location.href}});c?window.open(a,"_blank","noreferrer"):window.location.href=a;return}h(o),f(!0),r.current&&(null==(n=r.current.commands)||null==(t=n.focus)||t.call(n,"end"))},shouldShowReplyForm:d,communityMemberForReply:b,canReply:a&&l,resetCommunityMemberForReply:function(){return h(null)}}};function tS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tP=function(e){var t,n=e.comment.id,r=(0,B.pm)(),a=r.success,s=r.error,l=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tS(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tS(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],u=l[1],d=function(){return u(!1)},f=(0,L.useMutation)(function(e){var t,r;return(0,F.Cu)(U.av.flaggedContent.create(),{flagged_content:(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),r=r={flagged_contentable_id:n,flagged_contentable_type:"Comment"},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}),t)})},{onSuccess:function(){a((0,i.t)("comments.report.alerts.success"),{duration:"short",shouldUseProgress:!1}),d()},onError:function(){s((0,i.t)("comments.report.alerts.failure"))}}).mutate;return{isReportModalOpen:c,openReportModal:function(){return u(!0)},closeReportModal:d,submitReport:f}},tC=function(e){var t=e.space,n=e.post,a=e.comment,l=e.showReplyForm,b=e.autofocusReplyForm,h=e.onReplyClick,v=e.onUpdate,y=void 0===v?c.noop:v,g=e.onDelete,_=void 0===g?c.noop:g,x=e.onReplyCreate,j=void 0===x?c.noop:x,w=e.onReplyDelete,O=void 0===w?c.noop:w,S=(0,m.wh)().isViewOnlyMasquerading,P=(0,m.Zh)().isUsedInMinimalTipTapViewModal,C=a.id,I=a.parent_comment_id,k=a.community_member,N=a.replies,A=a.replies_count,E=a.flagged_for_approval_at,T=a.policies,M=!!E,R=!!I,D=T.can_report&&!M,L=T.can_manage&&M,F=T.can_edit,U=T.can_destroy,B=T.can_bookmark,q=(0,o.useRef)(null),z=tO({comment:a,showReplyForm:void 0!==l&&l,replyFormRef:q}),Z=z.openReplyForm,H=z.shouldShowReplyForm,V=z.communityMemberForReply,Q=z.canReply,W=z.resetCommunityMemberForReply,G=tx({comment:a}),$=G.toggleLike,K=G.isLiked,J=G.likesCount,X=G.canLike,Y=G.canSeeLikes,ee=G.isLoading,et=(0,eP.dd)(eX),en=(0,eP.dd)(eD),er=tP({comment:a}),eo=er.isReportModalOpen,ei=er.openReportModal,ea=er.closeReportModal,es=er.submitReport,el=th({comment:a,onDelete:_}),ec=el.isDeleteConfirmModalOpen,ed=el.openDeleteConfirmModal,ef=el.closeDeleteConfirmModal,em=el.deleteComment,ep=el.isDeletingComment,eb=h||Z;return(0,r.jsxs)("div",{className:(0,s.A)("post--comment text-dark md:px-0",{"px-5":!R&&!P,"pl-5":R&&!P}),id:"comment_wrapper_".concat(C),children:[(0,r.jsxs)("div",{className:(0,s.A)("post__content py-2.5",{"md:px-6":!P}),children:[(0,r.jsxs)("div",{className:"flex w-full justify-between",children:[(0,r.jsxs)("div",{className:"flex w-full pt-1",children:[(0,r.jsx)(te,{comment:a}),(0,r.jsxs)("div",{className:"flex w-full flex-col",children:[(0,r.jsx)(tf,{post:n,comment:a}),(0,r.jsx)(ew,{comment:a})]})]}),(0,r.jsx)(eg,{comment:a,canReport:D,canReview:L,canEdit:F,canDestroy:U,canBookmark:B,isReply:R,onReportClick:S?c.noop:ei,onEditClick:S?c.noop:function(){return en.show({space:t,comment:a,onUpdate:y})},onDeleteClick:S?c.noop:ed,onUpdate:y})]}),(0,u.Y_)(t)&&(0,f.f)(a)&&(0,r.jsx)("div",{className:"my-2 pl-[3.25rem]",children:(0,r.jsx)(d.F.Regular,{record:a,contentType:"comment"})}),(0,r.jsx)(eB,{canReply:Q,canLike:X,canSeeLikes:Y,isLiked:K,likesCount:J,isLikeDisabled:ee,onReplyClick:S?c.noop:function(){return eb({communityMember:k})},onLikeClick:S?c.noop:$,onLikesCountClick:S?c.noop:function(){return et.show({commentId:C,placeholderLikesCount:J})}}),D&&(0,r.jsx)(tp,{show:eo,onClose:ea,onReportSubmit:es}),U&&(0,r.jsx)(p.c,{isOpen:ec,onClose:ef,onConfirm:em,confirmText:ep?(0,i.t)("deleting"):(0,i.t)("delete"),confirmVariant:"danger",title:(0,i.t)("comments.delete.confirm.title"),disabled:ep,children:(0,i.t)("comments.delete.confirm.description")})]}),!R&&(0,r.jsx)("div",{className:(0,s.A)("post__replies md:ml-[3.125rem]",{"ml-8":!P,"ml-12":P}),children:(0,r.jsx)(eu,{space:t,post:n,parentCommentId:C,preloadedComments:N||[],preloadedCommentsTotalCount:A,showReplyForm:H,autofocusReplyForm:void 0!==b&&b,communityMemberForReply:V,resetCommunityMemberForReply:W,onCommentReplyClick:Z,onCommentCreate:j,onCommentDelete:O,formRef:q})})]})};function tI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tk=function(e){var t,n=e.space,c=e.post,u=e.preloaded,d=e.preloadedComments,f=e.preloadedCommentsTotalCount,m=e.showReplyForm,p=e.autofocusReplyForm,b=e.onCommentCreate,h=e.onCommentDelete,v=e.formRef,y=e.scrollableTarget,g=e.commentsSectionRef,_=ec({parentCommentId:null,postId:c.id,preloaded:void 0!==u&&u,preloadedComments:void 0===d?[]:d,preloadedCommentsTotalCount:void 0===f?0:f,postCommentsClosed:c.is_comments_closed,postLikingDisabled:c.is_liking_disabled,space:n,showReplyForm:void 0!==m&&m,onCommentCreate:b,onCommentDelete:h,commentsSectionRef:g}),x=_.comments,j=_.hasNextPage,w=_.fetchNextPage,O=_.updateCommentInList,S=_.handleCommentCreate,P=_.handleCommentDelete,C=_.formKey,I=_.persistCacheKey,k=_.isFirstLoading,N=_.isAnyLoading,A=_.isUsedInMinimalTipTapViewModal,E=_.shouldShowForm,T=(t=(0,o.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tI(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tI(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),M=T[0],R=T[1];return(0,o.useEffect)(function(){var e=null==y?void 0:y.current;e&&R(e)},[null==y?void 0:y.current]),(0,r.jsxs)("div",{className:(0,s.A)({"my-3":!E}),children:[(0,r.jsx)(a.Z,{style:{overflow:"initial"},scrollThreshold:.8,next:w,hasMore:null!=j&&j,loader:(0,r.jsx)(l.m,{}),dataLength:(null==x?void 0:x.length)||0,scrollableTarget:null!=M?M:"panel",children:x.map(function(e){return(0,r.jsx)(tC,{space:n,post:c,comment:e,autofocusReplyForm:!0,onUpdate:O,onDelete:P,onReplyCreate:b,onReplyDelete:h},e.id)})},M?"elementTarget":"idTarget"),j&&!N&&(0,r.jsx)("div",{className:"load-more py-5 text-center",children:(0,r.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),w()},className:"focus-visible:outline-secondary load-more__comments border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest inline-block rounded-md border px-6 py-2 text-sm font-semibold leading-normal transition-colors duration-150 focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",children:(0,i.t)("comments.list.show_more_comments")})}),k&&(0,r.jsx)(l.m,{className:(0,s.A)({"mb-16":A})}),N&&A&&(0,r.jsx)("div",{className:"bg-primary absolute bottom-0 left-0 w-full !px-5 !py-4 md:!px-8",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("div",{className:"bg-tertiary h-10 w-10 animate-pulse rounded-full"}),(0,r.jsx)("div",{className:"border-primary h-10 w-full rounded-lg border p-px"})]})}),E&&(0,r.jsx)(z,{spaceId:n.id,postId:c.id,autoFocus:void 0!==p&&p,className:(0,s.A)(A&&"!max-h-[360px]"),onCreate:S,bodyInputRef:v,persistCacheKey:I},C)]})},tN=n(51805),tA=function(e){var t,n=e.space,a=e.post,s=e.id,c=e.showReplyForm,u=e.autofocusReplyForm,d=e.onCommentDelete,f=e.onReplyCreate,m=e.onReplyDelete,p=(0,tN.E)({postId:a.id,id:s,postCommentsClosed:null!=(t=a.is_comments_closed)&&t,postLikingDisabled:a.is_liking_disabled}),b=p.comment,h=p.isLoading,v=p.updateQueryData;return((0,o.useEffect)(function(){if(!h){var e,t;null==(e=(t=window).initialiseTippy)||e.call(t)}},[h]),G({enabled:!h}),h)?(0,r.jsx)(l.m,{}):b?(0,r.jsx)(tC,{space:n,post:a,comment:b,showReplyForm:void 0!==c&&c,autofocusReplyForm:void 0!==u&&u,onUpdate:v,onDelete:d,onReplyCreate:f,onReplyDelete:m}):(0,r.jsx)("div",{className:"post__comment-not-found border-primary text-dark dark:text-lightest bg-v2-warning-100 rounded-b-lg border-t p-2.5 py-4 text-base md:p-5",children:(0,i.t)("comments.hierarchy.not_found")})},tE=n(27053),tT=n(74527),tM=function(e){var t=e.post,n=["post-conversation-summary",t.id],r=(0,L.useQueryClient)(),o=(0,L.useQuery)(n,function(){return(0,F.UT)(U.av.posts.conversationSummary({postId:String(t.id)}))},{enabled:!1,staleTime:6e5,retry:function(e,t){return(null==t?void 0:t.status)!==404}});return{conversationSummary:o.data,isLoadingConversationSummary:o.isLoading,refetchConversationSummary:o.refetch,clearConversationSummary:function(){r.resetQueries({queryKey:n,exact:!0})}}};function tR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tD="post.conversation_summary",tL=function(e){var t,n=e.post,a=e.className,l=tM({post:n}),c=l.conversationSummary,u=l.refetchConversationSummary,d=l.clearConversationSummary,f=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return tR(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tR(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=f[0],p=f[1],b=(0,o.useCallback)(function(){p(!1)},[]),h=!m&&!c,v=!m&&!!c;return n.conversation_summary_overview?(0,r.jsx)("div",{className:(0,s.A)("flex py-5 md:px-6",a),children:(0,r.jsxs)(tT.w,{isCollapsed:h,onCollapseClick:function(){p(!1),d()},onExpandClick:function(){p(!0),u()},className:"pb-4",children:[(0,r.jsxs)(tT.w.Content,{closeButtonPosition:"sidebar",children:[(0,r.jsx)(tT.w.Header,{animate:m,isHidden:v,children:(0,i.t)([tD,h?"title":"loading"])}),h&&(0,r.jsx)(tT.w.BodyText,{children:n.conversation_summary_overview}),(null==c?void 0:c.content)&&(0,r.jsx)(tT.w.BodyText,{animation:"fade-in",onAnimationComplete:b,children:c.content})]}),n.comments_count&&v&&(0,r.jsx)(tT.w.Footer,{children:(0,r.jsx)(tT.w.FooterNote,{children:(0,i.t)([tD,"comments_summarized"],{count:n.comments_count,formatted_count:(0,eF.HA)(n.comments_count)})})})]})}):null},tF=function(e){var t=e.className;return(0,r.jsx)("div",{className:t,children:(0,r.jsxs)("div",{className:"bg-tertiary flex items-center justify-center gap-2 rounded-md p-3 text-center",children:[(0,r.jsx)(e6.JO,{size:16,type:"lock-v2",className:"text-dark"}),(0,r.jsx)(ez.Z.LabelSm,{children:(0,i.t)("post.comments_section.comments_closed")})]})})},tU=n(94184),tB=n.n(tU),tq=n(29378);function tz(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function tZ(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var tH=function(e){var t=e.isIframeEmbed,n=e.containerClassNames,o=e.currentCommunity,a=t?{target:"_blank",rel:"noreferrer"}:{},s=!!(null==o?void 0:o.private_sign_up_url),l=(0,tq.fs)(o)||s,c=s?o.private_sign_up_url:(0,tq.pn)(o);return(0,r.jsxs)("div",{className:n,children:[(0,r.jsx)("div",{className:"mb-3 text-center",children:(0,r.jsx)(ez.Z.LabelLg,{weight:"semibold",children:(0,i.t)("login_to_comment")})}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,r.jsx)("a",tZ(tz({className:"focus-visible:outline-secondary border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest rounded-md border px-[18px] py-[6px] text-sm font-semibold transition-colors duration-150 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:(0,U.j)({params:{post_login_redirect:window.location.href}})},a),{children:(0,i.t)("log_in")})),l&&(0,r.jsx)("a",tZ(tz({className:"signup-link btn btn-primary focus-visible:!outline-secondary !bg-brand !text-brand-button !h-auto !rounded-md !px-[18px] !py-[6px] !text-sm !font-bold !leading-5 !transition-colors !duration-150 hover:!opacity-90 focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",href:c},a),{children:s?o.private_sign_up_label:(0,i.t)("sign_up")}))]})]})},tV=n(66007),tQ=function(e){var t=e.lockedPostCtaContent,n=e.containerClassNames;return(0,r.jsxs)("div",{className:n,children:[(0,r.jsx)("div",{children:(0,r.jsx)(ez.Z.TitleSm,{weight:"semibold",children:t.heading})}),(0,r.jsx)("div",{className:"mt-4",children:t.body&&(0,r.jsx)(ez.Z.BodyMd,{children:(0,r.jsx)(tV.Z,{html:t.body})})}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(g.z,{onClick:function(){return window.location.href=t.buttonLink},children:t.buttonLabel})}),(0,r.jsxs)("div",{className:"already-member mt-4",children:[(0,r.jsx)(ez.Z.LabelSm,{children:(0,i.t)("already_a_member")}),(0,r.jsx)("a",{className:"signup-link text-link ml-1 text-sm font-medium",href:(0,U.j)({params:{post_login_redirect:window.location.href}}),children:(0,i.t)("log_in")})]})]})},tW=function(e){var t=e.post,n=e.space,o=(0,m.wh)(),a=o.currentCommunity,s=o.currentUser,l=(0,tE.m)(),c=l.isSharedPostWithTeaserLayout,d=l.showGatedCommentSectionAtBottom,f=l.showGatedCommentSectionAtTop,p=l.isSharedPostViewWithMinimalLayout,b=(0,em.I)(),h={heading:a.locked_post_cta_heading||(0,i.t)("login_to_comment"),body:a.locked_post_cta_body,buttonLabel:a.locked_post_cta_button_text||(0,i.t)("log_in"),buttonLink:a.locked_post_cta_button_url||(0,U.j)({params:{post_login_redirect:window.location.href}})},v=!!s,y=!v&&c,g=(0,tq.v)(a),_=tB()("gated-post gated-post--custom-cta py-10 px-7 text-center",{"border-t border-primary":p,post__logged_out_comments:!g,"post__bottom_border border-b border-primary":f&&!p,"post__top_border border-t border-primary":d&&!p,"gated-post--standard-layout":!t.minimal_layout,"gated-post--no-gradient":!y,"gated-post--gradient":y});return(g||(0,u.WB)(n))&&a.custom_cta_for_share_links?(0,r.jsx)(tQ,{containerClassNames:_,lockedPostCtaContent:h}):t.is_comments_enabled&&!v?(0,r.jsx)(tH,{containerClassNames:_,isIframeEmbed:b,currentCommunity:a}):null},tG=function(e){var t=e.post||{},n=t.slug,o=t.space_slug;return(0,r.jsx)("div",{className:"border-primary flex items-center justify-center gap-4 border-t p-12",children:(0,r.jsx)("a",{className:"btn btn-secondary",href:(0,U.LM)({spaceSlug:o,slug:n}),children:(0,i.t)("leave_a_comment")})})};function t$(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tK(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return t$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t$(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var tJ=function(e){var t=e.autofocusReplyForm,n=e.commentsFormRef,a=e.className,l=e.scrollableTarget,c=(0,tE.m)(),u=c.post,d=c.showGatedCommentSectionAtBottom,f=c.showGatedCommentSectionAtTop,p=c.shouldShowLeaveCommentButton,b=c.shouldHideCommentsListForSpace,h=c.refetchPostDetails,v=c.updatePostDetailsQueryCache,y=Q().commentId,g=tK((0,o.useState)(y),2),_=g[0],x=g[1],j=tK((0,o.useState)(y&&u.comments_count>4),2),w=j[0],O=j[1],S=(0,m.L2)().data,P=(0,m.Zh)().isUsedInMinimalTipTapViewModal,C=u.is_comments_closed,I=function(){h&&h()},k=function(){v&&v({comments_count:u.comments_count+1})},N=function(){O(!1),x(null),window.location.hash="#all_comments"},A=b({space:S});(0,o.useEffect)(function(){x(y)},[y]);var E=(0,o.useRef)(null),T=!(p||(0,tr.HZ)(u));return(0,r.jsxs)(r.Fragment,{children:[!A&&(0,r.jsx)(tL,{post:u}),(0,r.jsxs)("div",{ref:E,className:(0,s.A)("post__comments trix-v2",{"transition-[margin] duration-150 ease-in-out":P&&!C},void 0===a?"":a),"data-controller":"comments",id:"all_comments","data-post-id":u.id,children:[C&&(0,r.jsx)(tF,{className:"m-4"}),p&&(0,r.jsx)(tG,{post:u}),T&&f&&(0,r.jsx)(tW,{post:u,space:S}),!A&&w&&_&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"show-all-comments__wrapper px-2.5 py-4 md:p-6",children:(0,r.jsxs)("a",{className:"show-all-comments__link focus-visible:outline-secondary border-hover bg-primary text-dark hover:text-darkest focus-visible:text-darkest inline-flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-semibold leading-normal transition-colors duration-150 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",href:"#all_comments",onClick:function(e){e.preventDefault(),N()},children:[(0,r.jsx)(e6.JO,{type:"arrow-solid-top-left"}),(0,i.t)("post.comments_section.show_all_count_comments",{count:u.comments_count,formatted_count:(0,eF.HA)(u.comments_count)})]})}),(0,r.jsx)(tA,{space:S,post:u,id:_,showReplyForm:!C,autofocusReplyForm:t,onCommentDelete:function(){I(),N()},onReplyCreate:k,onReplyDelete:I})]}),!A&&!w&&(0,r.jsx)(tk,{space:S,post:u,showReplyForm:!C,autofocusReplyForm:t,formRef:n,onCommentCreate:k,onCommentDelete:I,scrollableTarget:l,commentsSectionRef:E}),T&&d&&(0,r.jsx)(tW,{post:u,space:S})]})]})}},34822:function(e,t,n){n.d(t,{S:()=>U});var r=n(85893),o=n(94184),i=n.n(o),a=n(27053),s=n(60622),l=n(70442),c=n(84326),u=n(41342),d=n(31510),f=n(57363),m=n(52521),p=n(73384),b=n(86721),h=n(63676),v=n(76896),y=function(e){var t=e.count,n=e.toggleComment,o=e.hasPostDetailsLoaded,s=e.shouldForceSamePageInteractions,u=void 0!==s&&s,f=(0,a.m)().post,y=(0,b.Z)().usedIn,g=(0,l.TH)(),_=(0,m.d)().navigateToPost,x=(0,p._t)(),j=x.params,w=x.hasNextPage,O=!(0,d.U)()||"profile-modal"===y;return o?(0,r.jsx)("button",{type:"button",className:i()("hover:!text-dark focus-visible:outline-secondary text-default p-0 text-sm font-medium transition-colors duration-150 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"),"data-testid":"post-comment-count",onClick:function(){O&&!u?_({newPost:f,prevLocation:g,params:j,hasNextPage:w,shouldFocusOnCommentsSection:!0}):n()},children:(0,c.t)("post.comments",{count:t,formatted_count:(0,h.HA)(t)})}):(0,r.jsx)(v.gi,{variant:"row",lg:!0,long:!0})},g=n(67142),_=n(41084),x=function(e){var t=e.likesCount;return e.isLoading?(0,r.jsx)(v.gi,{variant:"row",lg:!0,extraLong:!0}):0===t?null:(0,r.jsx)("span",{className:"overflow-anywhere text-default group-hover:text-dark text-sm font-medium",children:(0,c.t)("likes_count",{localeCount:(0,h.HA)(t),count:t})})},j=n(67294),w=n(96486),O=n(58533),S=n(57105),P=n(20624),C=n(13532),I=n(83780),k=n(34519),N=n(80301),A=function(e){var t,n=e.post,o=(0,S.dd)(),i=(0,I.m)(C.av.posts.userLikesList({postId:String(n.id),params:{per_page:15}}),{enabled:!!(null==n?void 0:n.id)},["post-likes-modal",null==n?void 0:n.id]),a=i.data,s=i.isLoading,l=i.fetchNextPage,u=i.hasNextPage,d=i.mapPages,f=(0,j.useMemo)(function(){return(0,w.flatten)(d(function(e){return e.records}))},[d]),m=null==a||null==(t=a.pages[0])?void 0:t.count;return(0,r.jsxs)(k.u_,{title:(0,c.t)("like_modal_title"),isOpen:o.visible,onClose:o.hide,children:[(0,r.jsx)(k.u_.Overlay,{}),(0,r.jsxs)(k.u_.Content,{children:[(0,r.jsxs)(k.u_.Header,{children:[(0,r.jsx)(k.u_.Title,{size:"sm",children:m?(0,r.jsxs)(r.Fragment,{children:[(0,h.HA)(m)," ",1===m?(0,c.t)("like"):(0,c.t)("likes")]}):(0,c.t)("likes")}),(0,r.jsx)(k.u_.HeaderActions,{children:(0,r.jsx)(k.u_.CloseButton,{onClick:o.hide})})]}),(0,r.jsx)(k.u_.Body,{className:"pb-6 pt-4",children:s?(0,r.jsx)(P.m,{}):(0,r.jsx)("div",{id:"post-likes-modal-".concat(n.id),className:"max-h-[calc(100dvh-62px-44px-24px)] overflow-auto sm:max-h-80",children:(0,r.jsx)(O.Z,{scrollThreshold:.75,next:l,hasMore:u||!1,loader:(0,r.jsx)(P.m,{}),scrollableTarget:"post-likes-modal-".concat(n.id),dataLength:f.length,className:"flex flex-col space-y-4",children:f.map(function(e){return(0,r.jsx)(N.N,{member:e,hideModal:o.hide},e.id)})})})})]})]})},E=S.gk.create(function(e){var t=e.post;return(0,r.jsx)(A,{post:t})}),T=function(e){var t=e.shouldDisplayVerticalDivider,n=(0,a.m)(),o=n.post,s=n.isPostBodyEmpty,l=(0,u.Zh)().usedIn,c=o.user_likes_count,d=o.is_liking_enabled,f=o.sample_user_likes_community_members,m=void 0===f?[]:f,p=o.post_details_loaded,b=(0,S.dd)(E);return p?d&&c&&m.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{type:"button",onClick:function(){return b.show({post:o})},className:"post__engagement focus-visible:outline-secondary group focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2","data-testid":"post-liked-by",children:(0,r.jsx)("div",{className:"engagement__likes flex items-center",children:(0,r.jsxs)("div",{className:"engagement__members border-tertiary flex items-center space-x-2",children:[(0,r.jsx)(g.pB,{users:m.slice(0,3).map(function(e){return{src:e.avatar_url,name:e.name}}),isFullRounded:!0,size:"5"}),(0,r.jsx)(x,{likesCount:c,isLoading:!p})]})})}),(void 0===t||t)&&(0,r.jsx)("div",{className:"bg-badge h-0.5 w-0.5 rounded-full"})]}):null:(0,r.jsx)("div",{className:i()("post__engagement",{"!pt-5":(0,_.Fr)(o)&&s,"mx-2":"minimal-post-modal"!==l}),children:(0,r.jsx)(v.gi,{variant:"members-avatar-row-v3"})})},M=function(e){var t,n=e.shouldOpenCommentPage,o=e.showCommentAndFocusCommentForm,s=e.toggleComment,b=e.shouldForceSamePageInteractions,h=(0,u.EU)(),v=(0,l.TH)(),g=(0,m.d)().navigateToPost,_=(0,p._t)(),x=_.params,j=_.hasNextPage,w=(0,a.m)().post,O=w.is_comments_closed,S=w.is_comments_enabled,P=w.comments_count,C=w.post_details_loaded,I=!(0,d.U)();return S&&!n?(0,r.jsxs)(r.Fragment,{children:[!O&&h&&(0,r.jsx)("button",{type:"button",onClick:function(){I?g({newPost:w,prevLocation:v,params:x,hasNextPage:j}):o()},"aria-label":(0,c.t)("cap_comment_aria_label",{title:null!=(t=null==w?void 0:w.name)?t:(0,c.t)("this_post")}),className:i()("action-comment text-default hover:!text-dark focus-visible:outline-secondary flex items-center px-1 py-0.5 text-sm font-medium transition-colors duration-150 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"),children:(0,r.jsx)("span",{className:"action__icon",children:(0,r.jsx)(f.JO,{type:"24-comment",size:24})})}),(0,r.jsxs)("div",{className:"engagement__comments ml-auto mr-0 flex items-center gap-2","data-testid":"engagement-comments",children:[(0,r.jsx)(T,{}),(0,r.jsx)(y,{count:void 0===P?0:P,toggleComment:s,hasPostDetailsLoaded:C,shouldForceSamePageInteractions:void 0!==b&&b})]})]}):(0,r.jsx)("div",{className:"engagement__comments ml-auto mr-0 flex items-center gap-2",children:(0,r.jsx)(T,{shouldDisplayVerticalDivider:!1})})},R=n(54348),D=function(e){var t=e.shouldOpenCommentPage,n=e.toggleComment,o=e.shouldForceSamePageInteractions,i=(0,a.m)().post,s=i.is_comments_enabled,l=i.comments_count,u=i.post_details_loaded;return s&&t?(0,r.jsxs)(R.s,{post:i,allComments:!0,className:"flex w-full !items-center !justify-between",shouldOpenPostModal:!1,children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"action__icon",children:(0,r.jsx)(f.JO,{type:"message",className:"!text-dark",useWithFillCurrentColor:!0})}),(0,r.jsx)("span",{className:"count !text-dark",children:(0,c.t)("cap_comment")})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(y,{count:void 0===l?0:l,toggleComment:n,hasPostDetailsLoaded:u,shouldForceSamePageInteractions:void 0!==o&&o})})]}):null};function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var F=function(){var e,t,n=(e=(0,j.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return L(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],s=n[1],l=(0,u.EU)(),d=(0,a.m)(),m=d.post,p=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(d,["post"]),b=m.is_liking_enabled,h=m.is_liked_by_current_user,v=m.post_details_loaded;return b&&l?(0,r.jsx)("button",{type:"button","aria-label":(0,c.t)("like_post_aria_label",{name:null!=(t=null==m?void 0:m.name)?t:""}),onClick:function(e){var t;s(!0),setTimeout(function(){s(!1)},200),null==(t=p.onLikeToggle)||t.call(p,e)},className:i()("action-link post__actions--like hover:!text-dark focus-visible:outline-secondary flex items-center px-1 py-0.5 text-sm transition-all duration-200 ease-in-out focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"liked text-brand font-semibold":h,"text-default font-medium":!h,"cursor-not-allowed":!v},o?"scale-110":"scale-100"),children:(0,r.jsx)(f.JO,{type:h?"24-heart-red-fill":"24-heart-outline",size:24})}):null},U=function(e){var t=e.toggleComment,n=e.showCommentAndFocusCommentForm,o=e.shouldOpenCommentPage,l=void 0!==o&&o,c=e.shouldForceSamePageInteractions,u=e.className;return(0,a.m)().showEngagementActions?(0,r.jsxs)("div",{className:i()("post__actions post__actions-visible border-primary flex items-center gap-1 border-t px-3 py-2.5 md:px-4",void 0===u?"":u),"data-testid":"post-engagement-actions",children:[(0,r.jsx)(s.T,{children:(0,r.jsx)(F,{})}),(0,r.jsx)(M,{shouldOpenCommentPage:l,showCommentAndFocusCommentForm:n,toggleComment:t,shouldForceSamePageInteractions:void 0!==c&&c}),(0,r.jsx)(D,{shouldOpenCommentPage:l,toggleComment:t})]}):null}},80301:function(e,t,n){n.d(t,{N:()=>l});var r=n(85893),o=n(60983),i=n(59834),a=n(98363),s=n(41553),l=function(e){var t=e.member,n=e.hideModal,l=t.name,c=t.avatar_url,u=t.public_uid,d=t.headline,f=(0,i.O)({public_uid:u}),m=f.onClick,p=f["aria-label"],b=f.href,h=f.rel,v=f.target;return(0,r.jsxs)("a",{className:"flex items-center gap-3",onClick:function(e){n(),m&&m(e)},"aria-label":p,href:b,rel:h,target:v,children:[(0,r.jsx)("div",{className:"mt-0",children:(0,r.jsx)(o.C,{communityMemberId:t.id,name:l,publicUid:u,headline:d,avatarURL:c,children:(0,r.jsx)(a.s,{name:l,src:c,size:"10"})})}),(0,r.jsx)(s.Z.LabelSm,{weight:"medium",children:l})]})}},27265:function(e,t,n){n.d(t,{c:()=>u});var r=n(85893),o=n(94184),i=n.n(o),a=n(84326),s=n(17617),l=n(57363),c=n(41553),u=function(e){var t=e.post,n=e.mobileWrapperClassName,o=(0,s.kK)();return t.pinned_at_top_of_space?o?(0,r.jsxs)("div",{className:i()("mx-5 mt-5 flex items-center gap-2",void 0===n?"":n),children:[(0,r.jsx)(l.JO,{size:20,type:"20-pinned-post",className:"text-dark"}),(0,r.jsx)(c.Z.LabelXxs,{children:(0,a.t)("post.pinned_post")})]}):(0,r.jsx)("div",{className:"post__pin post__pin--pinned inline-flex p-1",children:(0,r.jsx)(l.JO,{type:"20-pin-post",className:"text-default !h-5 !w-5",size:20,useWithStrokeCurrentColor:!0})}):null}},13737:function(e,t,n){n.d(t,{Z:()=>v});var r=n(85893),o=n(88767),i=n(70442),a=n(84326),s=n(17013),l=n(41342),c=n(93199),u=n(41084),d=n(13532),f=n(39905),m=n(51466),p=n(34519),b=n(60878),h=n(41553),v=function(e){var t=e.spaceId,n=e.postId,v=e.postSlug,y=e.postTitle,g=e.hasNoteAboutExceptions,_=e.isOpen,x=e.onClose,j=e.onDuplicateSuccess,w=(0,i.k6)(),O=(0,b.pm)(),S=O.success,P=O.error,C=(0,l.nT)(),I=C.isLoading,k=(0,C.helpers.basicSpacesWithPostCreationAllowed)(),N=(0,o.useMutation)(function(e){return(0,c.aU)(d.av.posts.duplicate({spaceId:t,postSlug:v}),{post:{post_id:n,space_id:e.space_id,send_notifications:e.send_notifications}})},{onSuccess:function(e){S((0,a.t)("duplicated_successfully")),x(),w.push((0,u.RG)({post:e,editMode:!0})),j&&j(e)},onError:function(){P((0,a.t)("duplication_failed"))}}),A=N.mutate,E=N.isLoading;return I?null:(0,r.jsxs)(p.u_,{isOpen:void 0!==_&&_,onClose:x,children:[(0,r.jsx)(p.u_.Overlay,{}),(0,r.jsxs)(p.u_.Content,{className:"!overflow-visible",children:[(0,r.jsxs)(p.u_.Header,{children:[(0,r.jsx)(p.u_.Title,{children:(0,a.t)("duplicate_post_title",{post_title:y||(0,a.t)("duplicate_post_title_untitled")})}),(0,r.jsx)(p.u_.CloseButton,{onClick:x})]}),(0,r.jsx)(p.u_.Body,{className:"!overflow-visible",children:(0,r.jsxs)(m.l,{onSubmit:function(e){return A(e)},defaultValues:{space_id:t,send_notifications:!1},id:"duplicate-post-form",children:[(0,r.jsx)(m.l.Item,{name:"space_id",hideBorder:!0,fullWidth:!0,label:(0,a.t)("space"),description:(0,a.t)("duplicate_post_to_space"),rules:{required:(0,a.t)("events.create.form.space_required_error")},children:(0,r.jsx)(s.M,{spaces:k,name:"space_id",variant:"form-input",defaultValue:t,containerClassname:"mt-2"})}),(void 0===g||g)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z.LabelXs,{color:"text-light",children:(0,a.t)("comments_wont_be_duplicated")}),(0,r.jsx)(m.l.Item,{name:"send_notifications",hideBorder:!0,fullWidth:!0,label:(0,a.t)("duplicate_post_send_notifications"),hideDescription:!0,inlineReverse:!0,children:(0,r.jsx)(m.l.ToggleSwitch,{variant:"small",name:"send_notifications"})})]})]})}),(0,r.jsx)(p.u_.Footer,{children:(0,r.jsx)(f.z,{type:"submit",variant:"primary",disabled:E,form:"duplicate-post-form",children:E?(0,a.t)("duplicating"):(0,a.t)("duplicate")})})]})]})}},72826:function(e,t,n){n.d(t,{u:()=>l});var r=n(85893),o=n(1892),i=n(69788),a=n(41342),s=n(51169),l=function(e){var t=e.show,n=e.closeModal,l=e.post,c=e.shouldSkipRedirectAfterSubmit,u=e.onChange,d=e.onSubmitSuccess;if(!t)return null;var f=(0,o.t)({spaceId:l.space_id,postSlug:l.slug,context:"edit-post-modal"}),m=f.isLoading,p=f.post,b=f.remove;return m?(0,r.jsx)(s.a,{variant:"fullscreen"}):(0,r.jsx)(a.DW,{post:p,onPostChange:u,children:(0,r.jsx)(i.Y,{show:t,closeModal:function(){n&&n(),b()},shouldSkipRedirectAfterSubmit:void 0!==c&&c,onSubmitSuccess:d})})}},24012:function(e,t,n){n.d(t,{m:()=>k});var r=n(85893),o=n(88767),i=n(84326),a=n(51714),s=n(37291),l=n(78456),c=n(14735),u=n(86785),d=n(59709),f=n(34754),m=n(98324),p=n(42953),b=n(64282),h=n(27053),v=n(41342),y=n(17617),g=n(24804),_=n(56345),x=n(57363),j=n(63549),w=n(75148),O=n(34519),S=n(24330),P=n(43544),C=n(60878);function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var k=function(e){var t,n=e.onChange,k=e.onPostDestroy,N=(0,h.m)(),A=N.post,E=N.canUpdatePost,T=N.canDuplicatePost,M=N.canDestroyPost,R=N.canManagePost,D=N.refetchPostDetails,L=(0,b.Z)(),F=(0,C.pm)(),U=F.success,B=F.error,q=(0,v.L2)().refetch,z=(0,y.kK)(),Z=(t=(0,g.k)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return I(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),H=Z[0],V=Z[1],Q=(0,f.B)({event:A}),W=Q.onDeleteClickHandler,G=Q.isConfirmationModalOpen,$=Q.toggleConfirmationModal,K=Q.isRecurringModalOpen,J=Q.toggleRecurringModal,X=(0,v.wh)(),Y=X.isViewOnlyMasquerading,ee=X.currentCommunityMember,et=(0,l.vb)(ee)&&"draft"!==A.status,en=(0,s.x)(),er=en.onSendAnnouncement,eo=en.isLoading,ei=(0,O.UV)().contentPortalElement,ea=(0,o.useMutation)(function(e){return a.S.destroy({event:A,params:{delete_mode:e}})},{onSuccess:function(){k(A.id),U((0,p.Km)(A),{duration:"short",shouldUseProgress:!1}),null==q||q()},onError:function(){return B((0,i.t)("event_dropdown_actions.delete_failed"))}});return E||T||M?Y?(0,r.jsx)(x.JO,{type:"menu-dots","aria-label":(0,i.t)("events.event_actions"),className:"cursor-not-allowed"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(P.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,r.jsx)(w.h,{name:"20-menu-dots-horizontal",iconClassName:"!text-default group-hover:!text-dark !w-5 !h-5",className:"group",variant:"secondary",iconSize:20,buttonSize:28,ariaLabel:(0,i.t)("events.event_actions"),dataTestId:"action-more"}),className:"z-10",transitionWrapperClassName:"z-50",size:"large",appendTo:null!=ei?ei:document.body,children:[(0,r.jsx)(_.e,{variant:"dropdown",bookmarkType:"event",record:A,onSuccess:D}),z&&(0,r.jsx)(m.i,{onChange:function(){return n()},button:(0,r.jsx)(P.Lt.ItemLink,{children:(0,i.t)("events.event_actions_dropdown.share_event")})}),E&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){return L.show({event:A})},forceClose:!0,children:(0,i.t)("edit_event")}),T&&(0,r.jsx)(P.Lt.ItemLink,{onClick:V,children:(0,i.t)("duplicate_event")}),M&&(0,r.jsx)(P.Lt.ItemLink,{onClick:W,forceClose:!0,children:(0,r.jsx)("span",{className:"text-v2-danger",children:(0,i.t)("delete_event")})}),et&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Lt.Separator,{}),(0,r.jsx)(P.Lt.ItemLink,{"data-testid":"send-announcement-event-action",disabled:eo,onClick:function(){return er({eventId:A.id})},children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,i.t)("share_via_broadcast"),(0,r.jsx)(S.g,{label:(0,i.t)("new"),square:!0})]})})]}),R&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Lt.Separator,{}),(0,r.jsx)(d.E,{event:A,canEdit:E})]})]}),(0,r.jsx)(j.c,{isOpen:G,title:(0,i.t)("delete_event_confirmation"),onClose:$,onCancel:$,onConfirm:function(){return ea.mutate("")},confirmVariant:"danger",disabled:ea.isLoading,confirmText:ea.isLoading?(0,i.t)("deleting"):(0,i.t)("confirm"),children:(0,i.t)("delete_event_descriptor")}),(0,r.jsx)(u.D,{event:A,show:H,onClose:V}),!(0,p.yl)(A)&&(0,r.jsx)(c.t,{show:K,isDeleting:ea.isLoading,onConfirm:function(e){return ea.mutate(e)},onCloseModal:J})]}):null}},42194:function(e,t,n){n.d(t,{p:()=>el});var r=n(85893),o=n(27053),i=n(41342),a=n(24012),s=n(94184),l=n.n(s),c=n(96486),u=n(88767),d=n(84326),f=n(29662),m=n(74520),p=n(24330),b=n(41084),h=n(51630),v=n(9339),y=n(40274),g=n(29378),_=n(78456),x=n(13532),j=n(56345),w=n(63549),O=n(75148),S=n(60878),P=n(43544),C=n(34519),I=n(84969),k=n(93199),N=n(79840),A=function(e){var t=e.post,n=e.handleClose,i=void 0===n?c.noop:n,a=(0,S.pm)(),s=a.success,l=a.error,f=!!t.post_follower_id,m=(0,o.m)().onPostFollow,p=(0,u.useMutation)(f?function(){return(0,k.pC)(x.av.postFollowers.destroy({postId:t.id,postFollowerId:t.post_follower_id}))}:function(){return(0,k.Cu)(x.av.postFollowers.create({postId:t.id}))},{onSuccess:function(e){var t;m({post_follower_id:f?null:null==e||null==(t=e.post_follower)?void 0:t.id}),i(),s(I18n.t(f?"post_unfollow.success":"post_follow.success"))},onError:function(){return l(I18n.t(f?"post_unfollow.error":"post_follow.error"))}});return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){p.mutate()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("follow_post"),field:"follow_post",value:f,variant:"small"})})};function E(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var T=function(e){var t=e.post,n=e.onChange,o=e.refetchPosts,i=e.handleClose,a=void 0===i?c.noop:i,s=(0,S.pm)(),l=s.success,f=s.error,m=t.pinned_at_top_of_space,p=(0,u.useMutation)(function(){return h.Fv.pin({post:t,formData:{is_pinned:!m,pin_to_top:!0}})},{onSuccess:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(n(e,{refetch:!1}),!(0,c.isFunction)(o))return[3,2];return[4,o()];case 1:t.sent(),t.label=2;case 2:return l(I18n.t(m?"post_unpinned":"post_pinned")),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){E(i,r,o,a,s,"next",e)}function s(e){E(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){f(I18n.t(m?"post_unpinned_error":"post_pinned_error"))},onSettled:a});return(0,r.jsx)(P.Lt.ItemLink,{onClick:p.mutate,children:(0,r.jsx)(N.sI,{label:(0,d.t)("pin_to_top"),field:"pin_to_top",value:m,variant:"small"})})},M=n(23583);function R(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var D=function(e){var t=e.post,n=e.handleClose,o=e.onChange,i=!!(null==t?void 0:t.pinned_at),a=(0,u.useQueryClient)(),s=(0,S.pm)(),l=s.success,c=s.error,f=(0,M.P)().refetch,m=(0,u.useMutation)(function(){var e,n;return h.Fv.pin({post:t,formData:(e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t),n=n={is_pinned:!i,pin_to_top:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}),e)})},{onSuccess:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return null==o||o(e,{refetch:!1}),[4,f()];case 1:return t.sent(),[4,a.invalidateQueries("posts")];case 2:return t.sent(),l((0,d.t)(i?"post_unpinned_from_sidebar":"post_pinned_to_sidebar")),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){R(i,r,o,a,s,"next",e)}function s(e){R(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){c((0,d.t)(i?"post_unpinned_error":"post_pinned_error"))},onSettled:n});return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){return m.mutate()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("pin_post"),field:"pin_post",value:i,variant:"small"})})},L=function(e){var t=e.post,n=e.handleClose,o=e.onChange,i=!!(null==t?void 0:t.is_comments_disabled),a=i?"post.enable_comments":"post.disable_comments",s=(0,S.pm)(),l=s.success,c=s.error,f=(0,u.useMutation)(function(){return(0,k.gN)(x.av.posts.update({spaceId:null==t?void 0:t.space_id,postSlug:null==t?void 0:t.slug}),{post:{space_id:null==t?void 0:t.space_id,is_comments_disabled:!i}})},{onSuccess:function(e){null==o||o(e,{refetch:!1}),l((0,d.t)("".concat(a,".alerts.success")))},onError:function(){c((0,d.t)("".concat(a,".alerts.failure")))},onSettled:n}).mutate;return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){return f()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("post.action_menu.disable_comments"),field:"disable_comments",value:i,variant:"small"})})},F=function(e){var t=e.post,n=e.handleClose,o=e.onChange,i=!!(null==t?void 0:t.is_comments_closed),a=i?"post.open_comments":"post.close_comments",s=(0,S.pm)(),l=s.success,c=s.error,f=(0,u.useMutation)(function(){return(0,k.gN)(x.av.posts.update({spaceId:null==t?void 0:t.space_id,postSlug:null==t?void 0:t.slug}),{post:{space_id:null==t?void 0:t.space_id,is_comments_closed:!i}})},{onSuccess:function(e){null==o||o(e,{refetch:!1}),l((0,d.t)("".concat(a,".alerts.success")))},onError:function(){c((0,d.t)("".concat(a,".alerts.failure")))},onSettled:n}).mutate;return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){return f()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("post.action_menu.close_comments"),field:"close_comments",value:i,variant:"small"})})};function U(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var B=function(e){var t=e.post,n=e.handleClose,o=void 0===n?c.noop:n,i=e.onChange,a=e.refetchPosts,s=t.hide_from_featured_areas,l=(0,S.pm)(),f=l.success,m=l.error,p=(0,u.useMutation)(function(){return s?h.Fv.showInFeaturedAreas({post:t}):h.Fv.hideFromFeaturedAreas({post:t})},{onSuccess:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(i(e,{refetch:!1}),!(0,c.isFunction)(a))return[3,2];return[4,a()];case 1:t.sent(),t.label=2;case 2:return f(I18n.t(s?"post.marked_unhidden":"post.marked_hidden")),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){U(i,r,o,a,s,"next",e)}function s(e){U(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){m(I18n.t("something_went_wrong"))}});return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){o(),p.mutate()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("post.hide_from_featured_areas"),field:"hide_from_featured_areas",value:s,variant:"small"})})},q=function(e){var t=e.post,n=e.onChange,o=t.is_liking_disabled,i=o?"post.enable_liking":"post.disable_liking",a=(0,S.pm)(),s=a.success,l=a.error,c=(0,u.useMutation)(function(){return(0,k.gN)(x.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:{space_id:t.space_id,is_liking_disabled:!o}})},{onSuccess:function(e){n(e,{refetch:!1}),s((0,d.t)("".concat(i,".alerts.success")))},onError:function(){l((0,d.t)("".concat(i,".alerts.failure")))}}).mutate;return(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){return c()},children:(0,r.jsx)(N.sI,{label:(0,d.t)("post.action_menu.disable_liking"),field:"disable_liking",value:o,variant:"small"})})},z=n(13737),Z=n(72826),H=n(39905),V=n(51466),Q=["harassment","spam","incorrect_location","against_guidelines","other"],W=function(e){var t=e.onClose,n=e.show,o=e.post,i=(0,S.pm)(),a=(0,u.useMutation)(function(e){return(0,k.t5)(x.av.flaggedContent.create(),{method:"POST",forReactQuery:!0,body:JSON.stringify({flagged_content:e})})},{onSuccess:function(){i.success((0,d.t)("report_post_success")),t()},onError:function(){i.error((0,d.t)("something_went_wrong"))}}),s=Q.map(function(e){return{value:e,label:(0,d.t)("flagged_contents.report_reasons.".concat(e))}});return(0,r.jsxs)(C.u_,{isOpen:n,onClose:t,title:(0,d.t)("flagged_contents.form.report_post"),children:[(0,r.jsx)(C.u_.Overlay,{}),(0,r.jsx)(C.u_.Content,{children:(0,r.jsxs)(V.l,{defaultValues:{flagged_contentable_id:o.id,flagged_contentable_type:"Post"},onSubmit:function(e){return a.mutate(e)},children:[(0,r.jsxs)(C.u_.Header,{children:[(0,r.jsx)(C.u_.Title,{size:"sm",children:(0,d.t)("flagged_contents.form.report_post")}),(0,r.jsx)(C.u_.HeaderActions,{children:(0,r.jsx)(C.u_.CloseButton,{onClick:t})})]}),(0,r.jsxs)(C.u_.Body,{children:[(0,r.jsx)(V.l.Item,{name:"reported_reason_type",label:(0,d.t)("flagged_contents.form.reported_reason_type"),description:(0,d.t)("flagged_contents.form.reported_reason_type_description"),hideBorder:!0,children:(0,r.jsx)(V.l.SelectNative,{name:"reported_reason_type",options:s})}),(0,r.jsx)(V.l.Item,{name:"reported_reason_body",label:(0,d.t)("flagged_contents.form.reported_reason_body"),description:(0,d.t)("flagged_contents.form.reported_reason_body_description"),hideBorder:!0,fullWidth:!0,children:(0,r.jsx)(V.l.TextArea,{name:"reported_reason_body"})})]}),(0,r.jsxs)(C.u_.Footer,{className:"flex justify-end",children:[(0,r.jsx)(H.z,{type:"button",variant:"secondary",onClick:t,className:"mr-2",disabled:a.isLoading,children:(0,d.t)("cancel")}),(0,r.jsx)(H.z,{type:"submit",variant:"circle",disabled:a.isLoading,"data-testid":"report_post_submit",children:(0,d.t)("report")})]})]})})]})},G=n(52293),$=n(87279),K=n(61641),J=function(e){var t=e.post,n=e.onSuccess,r=e.onError,o=(0,S.pm)(),i=o.success,a=o.error;return(0,u.useMutation)({mutationFn:function(e){return(0,k.gN)(x.av.posts.update({spaceId:t.space_id,postSlug:t.slug}),{post:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({space_id:t.space_id},e)})},onSuccess:function(e){(0,c.isFunction)(n)&&n(e),i((0,d.t)("changes_saved"))},onError:function(){(0,c.isFunction)(r)&&r(),a((0,d.t)("failed_to_save_changes"))}})},X=function(e){var t,n,o=e.post,a=e.isOpen,s=e.onClose,l=e.onChange,c=(0,i.Zh)().setIsUpdatingCardViewThumbnail,u=J({post:o,onSuccess:function(e){l(e,{refetch:!1}),null==c||c(!1)},onError:function(){null==c||c(!1)}}),f=(0,G.cI)({defaultValues:{cardview_thumbnail:o.cardview_thumbnail}});return(0,r.jsx)($.l,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},f),n=n={onSubmit:function(e){u.mutate(e)},className:"hidden",children:function(e){var t=e.triggerFormSubmit;return(0,r.jsx)(K.a,{isOpen:a,name:"cardview_thumbnail",onClose:function(){s()},aspectRatio:2,title:(0,d.t)("upload_a_cardview_thumbnail"),renderer:function(){return(0,r.jsx)(r.Fragment,{})},onImageAttachSuccess:t,onProcessing:function(e){return e&&(null==c?void 0:c(e))}})}},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},Y=n(70442),ee=n(60589),et=n(17617),en=n(24804);function er(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function eo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return er(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return er(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ei=function(e){var t=e.onPostDestroy,n=(0,i.L2)(),r=n.data,a=n.refetch,s=(0,o.m)(),l=s.post,c=s.showShareOnWebOptions,f=(0,i.Zh)().usedIn,m=(0,Y.k6)(),p=eo((0,en.k)(!1),2),v=p[0],y=p[1],g=eo((0,en.k)(!1),2),_=g[0],x=g[1],j=eo((0,en.k)(!1),2),w=j[0],O=j[1],P=eo((0,en.k)(!1),2),C=P[0],I=P[1],k=eo((0,en.k)(!1),2),N=k[0],A=k[1],E=(0,b.hm)(l),T=(0,et.kK)(),M=(0,S.pm)(),R=M.success,D=M.error,L=E&&!(null==r?void 0:r.hide_right_sidebar)&&!(0,ee.AU)(r),F=(0,ee.AU)(r)||(0,ee.G6)(r),U=!!(0,Y.$B)("/c/:spaceSlug/:postSlug"),B=l.pinned_at_top_of_space,q=!U&&!B&&F,z=T||"full-post-modal"===f,Z=z?c(r):q&&c(r),H=(0,ee.AU)(r)&&!B&&(0,ee.Y_)(r);return{shouldShowPinToSidebar:L,isPostCardOrListView:F,isPostDetailsPage:U,isCurrentPostPinnedAtTopOfSpace:B,isEligibleForSharing:q,isRenderedOnSmallScreensOrFullPostModal:z,shouldShowShareOnWebOptions:Z,shouldShowSetThumbnailOptionForPosts:H,shouldShowEditPostModal:v,toggleEditPostModal:y,shouldShowDuplicatePostModal:_,toggleDuplicatePostModal:x,shouldShowReportPostModal:w,toggleReportPostModal:O,shouldShowConfirmationModal:C,toggleConfirmationModal:I,deleteMutation:(0,u.useMutation)(function(){return h.Fv.destroy({post:l})},{onSuccess:function(){t(l.id),R((0,d.t)("post_dropdown_actions.delete_successful")),a()},onError:function(){return D((0,d.t)("post_dropdown_actions.delete_failed"))}}),redirectToPost:function(e){return m.push((0,b.RG)({post:e}))},shouldShowSetThumbnailModal:N,toggleSetThumbnailModal:A}},ea=function(e){var t=e.refetchPosts,n=e.currentCommunity,a=e.onPostDestroy,s=e.onChange,k=(0,o.m)(),N=k.post,E=k.showModerationInActionsDropdown,M=k.canManagePost,R=k.canUpdatePost,U=k.canDestroyPost,H=k.canDuplicatePost,V=k.canReportPost,Q=k.refetchPostDetails,G=k.isTiptapPost,$=(0,i.Zh)(),K=$.usedIn,J=$.isUsedInMinimalTipTapViewModal,Y=(0,i.wh)(),ee=Y.currentCommunitySettings,et=Y.isViewOnlyMasquerading,en=Y.currentCommunityMember,er=(0,y.L)().show,eo=(0,f.e)(),ea=(0,v.h)(),es=(0,b.Fr)(N),el=(0,b.hm)(N),ec=(0,C.UV)(),eu=ec.contentPortalElement,ed=ec.onClose,ef=(0,i.L2)().data,em=(0,_.vb)(en),ep=(null==ee?void 0:ee.kb_post_action_enabled)&&em,eb=(0,m.$)(),eh=eb.onShareViaBroadcast,ev=eb.isLoading,ey=(0,S.pm)(),eg=ey.success,e_=ey.error,ex=(0,u.useMutation)(function(){return h.Fv.updateKnowledgeBasePost({post:N})},{onSuccess:function(){eg((0,d.t)("post_dropdown_actions.update_knowledge_base_post_successful"))},onError:function(){return e_((0,d.t)("post_dropdown_actions.update_knowledge_base_post_failed"))}}),ej=ei({onPostDestroy:a}),ew=ej.shouldShowPinToSidebar,eO=ej.shouldShowShareOnWebOptions,eS=ej.shouldShowSetThumbnailOptionForPosts,eP=ej.shouldShowEditPostModal,eC=ej.toggleEditPostModal,eI=ej.shouldShowDuplicatePostModal,ek=ej.toggleDuplicatePostModal,eN=ej.shouldShowReportPostModal,eA=ej.toggleReportPostModal,eE=ej.shouldShowConfirmationModal,eT=ej.toggleConfirmationModal,eM=ej.deleteMutation,eR=ej.redirectToPost,eD=ej.shouldShowSetThumbnailModal,eL=ej.toggleSetThumbnailModal;return et?(0,r.jsx)(O.h,{name:"16-menu-dots-horizontal",iconClassName:"!text-dark cursor-not-allowed",ariaLabel:(0,d.t)("post_actions"),dataTestId:"action-more",disabled:!0}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(P.Lt,{direction:"bottom-end",menuButtonEl:"div",button:(0,r.jsx)(O.h,{name:"20-dot-menu",iconClassName:"!text-default group-hover:!text-dark",className:"group",variant:"secondary",iconSize:20,buttonSize:J?32:28,ariaLabel:(0,d.t)("post_actions"),dataTestId:"action-more"}),className:l()("z-10",{"inline-flex h-8 w-8":J}),transitionWrapperClassName:"z-50",size:"large",buttonLabel:(0,d.t)("post_actions"),appendTo:null!=eu?eu:document.body,children:[(0,r.jsx)(j.e,{variant:"dropdown",bookmarkType:"post",record:N,onSuccess:Q}),eO&&(0,r.jsx)(I.P,{onChange:s,button:(0,r.jsx)(P.Lt.ItemLink,{children:(0,d.t)("post.share.share_post_actions_label")}),shouldRenderCustomMenuButton:!0}),R&&el&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){et?(0,c.noop)():er({post:N,onPostChange:s,shouldSkipRedirectAfterSubmit:J})},children:(0,d.t)("edit_post")}),R&&es&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){eo.show({spaceId:null==ef?void 0:ef.id,onClose:function(){return eo.remove()},onPostChange:s,currentPost:N,shouldSkipRedirectAfterSubmit:"full-post-modal"===K})},children:(0,d.t)("edit_post")}),el&&H&&(0,r.jsx)(P.Lt.ItemLink,{onClick:ek,children:(0,d.t)("duplicate_post")}),es&&H&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){"full-post-modal"===K&&ed(),ea.show({post:N,onSuccess:eR})},children:(0,d.t)("duplicate_post")}),eS&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){eL()},children:(0,d.t)("set_thumbnail")}),V&&(0,r.jsx)(P.Lt.ItemLink,{onClick:et?c.noop:eA,children:(0,d.t)("report_post")}),E&&(0,r.jsx)(P.Lt.ItemWithLink,{to:x.sC.index(),children:(0,d.t)("flagged_contents.review")}),U&&(0,r.jsx)(P.Lt.ItemLink,{onClick:et?c.noop:eT,children:(0,r.jsx)("span",{className:"text-v2-danger",children:(0,d.t)("delete_post")})}),ep&&(0,r.jsx)(P.Lt.ItemLink,{onClick:function(){ex.mutate()},children:(0,d.t)("post_dropdown_actions.update_knowledge_base_post_dropdown_label")}),em&&el&&G&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.Lt.Separator,{}),(0,r.jsx)(P.Lt.ItemLink,{"data-testid":"send-announcement-post-action",disabled:ev,onClick:function(){return eh({postId:N.id})},children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,d.t)("post_dropdown_actions.share_via_broadcast"),(0,r.jsx)(p.g,{label:(0,d.t)("new"),square:!0})]})})]}),(R||H||V||E||U)&&(0,r.jsx)(P.Lt.Separator,{}),(0,r.jsx)(A,{post:N}),M&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(T,{post:N,onChange:s,refetchPosts:t}),ew&&(0,r.jsx)(D,{post:N,onChange:s}),(0,r.jsx)(q,{post:N,onChange:s}),(0,r.jsx)(L,{post:N,onChange:s}),N.is_comments_enabled&&(0,r.jsx)(F,{post:N,onChange:s}),!!n&&(0,g.Nf)(n)&&(0,r.jsx)(B,{post:N,onChange:s,refetchPosts:t})]})]}),(0,r.jsx)(X,{post:N,onChange:s,onClose:eL,isOpen:eD}),(0,r.jsx)(Z.u,{show:eP,closeModal:eC,post:N,onChange:s}),(0,r.jsx)(z.Z,{spaceId:N.space_id,postId:N.id,postSlug:N.slug,postTitle:N.name,isOpen:eI,onClose:ek}),(0,r.jsx)(W,{post:N,show:eN,onClose:eA}),(0,r.jsx)(w.c,{isOpen:eE,title:(0,d.t)("delete_post_confirmation"),onClose:eT,onCancel:eT,onConfirm:eM.mutate,confirmVariant:"danger",disabled:eM.isLoading,confirmText:eM.isLoading?(0,d.t)("deleting"):(0,d.t)("confirm"),children:(0,d.t)("delete_post_descriptor")})]})},es=function(e){var t=e.onChange,n=e.onPostDestroy,i=e.refetchPosts,s=e.currentCommunity,l=(0,o.m)(),c=l.isBasicPost,u=l.isEventPost,d=l.isImagePost;return(0,r.jsxs)(r.Fragment,{children:[(c||d)&&(0,r.jsx)(ea,{onChange:t,onPostDestroy:n,refetchPosts:i,currentCommunity:s}),u&&(0,r.jsx)(a.m,{onChange:t,onPostDestroy:n})]})},el=function(e){var t=e.onChange,n=e.onPostDestroy,a=e.refetchPosts,s=(0,o.m)(),l=s.showPostActions,c=s.canUpdatePost,u=s.canDestroyPost,d=s.isEventPost,f=(0,i.wh)().currentCommunity;return l&&(!d||c||u)?(0,r.jsx)(es,{onChange:t,onPostDestroy:n,refetchPosts:a,currentCommunity:f}):null}},62068:function(e,t,n){n.d(t,{y:()=>_});var r=n(85893),o=n(94184),i=n.n(o),a=n(66007),s=n(70442),l=n(84326),c=n(41084),u=n(13532),d=n(27053),f=n(41342),m=n(85924),p=n(91704),b=n(72851),h=n(23627),v=n(98384),y=n(52521),g=n(73384),_=function(e){var t=e.enableTruncation,n=e.noPadding,o=(0,d.m)(),_=o.post,x=o.isSharedPostWithTeaserLayout,j=o.isSharedPostViewWithMinimalLayout,w=o.isTiptapPost,O=o.isTrixPost,S=o.isBasicPost,P=o.isPostBodyEmpty,C=(0,s.TH)(),I=(0,y.d)().navigateToPost,k=(0,g._t)(),N=k.params,A=k.hasNextPage,E=(0,m.wC)().minimal_layout,T=(0,f.Zh)(),M=T.usedIn,R=T.isUsedInMinimalTipTapViewModal,D=["help","help-en"].includes(_.community_slug)&&S,L=!(void 0!==t&&t),F=j&&x,U=!R&&(0,c.HZ)(_)&&!L,B=_.body_trix_content,q=_.tiptap_body,z=_.internal_custom_html,Z=_.pinned_at_top_of_space,H=_.updated_at;if(P)return null;var V=8;return Z?V=2:F&&(V=4),(0,r.jsx)("div",{className:i()("post__body",{"!p-0":void 0!==n&&n,"px-5 pb-5 md:px-6":(0,c.Fr)(_)&&!R,"mt-5":"minimal-post-modal"===M}),"data-testid":"post-body",children:(0,r.jsxs)("div",{className:"post__inside trix-v2 w-full","data-testid":"post-body-inside",children:[(0,r.jsxs)(b.X,{lines:V,disabled:L,hideToggle:x||U,children:[O&&B&&(0,r.jsx)(p.P,{content:B,contentParentPath:u.xu.show({slug:_.slug,spaceSlug:_.space_slug})}),w&&q&&(0,r.jsx)(h.R,{readOnly:!0,disableMentionClicks:E,value:q.body,sgidToObjectMap:q.sgids_to_object_map,inlineAttachments:q.inline_attachments}),z&&(0,r.jsx)(a.Z,{html:z},"internal_custom_html"),D&&(0,r.jsx)(v.e,{post:_})]}),U&&(0,r.jsx)("button",{type:"button",className:"text-default hover:text-dark mt-2 text-base",onClick:function(){I({newPost:_,params:N,hasNextPage:A,prevLocation:C})},children:(0,l.t)("see_more")})]})},H)}},48250:function(e,t,n){n.d(t,{H:()=>u});var r=n(85893),o=n(94184),i=n.n(o),a=n(84326),s=n(41877),l=n(41084),c=n(54348),u=function(e){var t,n,o,u,d,f,m=e.post,p=e.className,b=e.wrapperClassName,h=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["post","className","wrapperClassName"]),v=(0,l.HZ)(m);return(null!=(u=null==(o=m.cover_image_variants)?void 0:o.large)?u:m.cover_image_url)?(0,r.jsx)("div",{className:i()("px-5 pt-5 md:p-0",void 0===b?"":b),children:(0,r.jsx)(c.s,(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({shouldOpenPostModal:!0,post:m,className:"post__cover focus-visible:outline-secondary focus-visible:text-dark block focus-visible:rounded-lg focus-visible:outline focus-visible:outline-2 focus-visible:md:rounded-b-none"},h),n=n={children:m.cover_image_variants&&(0,r.jsx)(s.Q,{src:null!=(d=m.cover_image_url)?d:"",srcVariants:m.cover_image_variants,alt:(0,a.t)("post.cover_image_alt"),className:i()("w-full object-cover",void 0===p?"":p,{"md:rounded-b-none":!v,"rounded-lg":v,"rounded-2xl":!v})},null!=(f=m.cover_image_url)?f:"")},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}):null}},61410:function(e,t,n){n.d(t,{m:()=>S});var r=n(85893),o=n(94184),i=n.n(o),a=n(70442),s=n(84326),l=n(60589),c=n(24831),u=n(29090),d=n(41342),f=n(41084),m=n(17617),p=n(24330),b=n(27053),h=n(86307),v=n(56345),y=n(27265),g=n(42194),_=n(84969),x=n(59331),j=function(e){var t=e.post,n=e.onChange,o=e.onPostDestroy,a=e.refetchPosts,s=e.hideShareLink,l=e.hidePinnedToTopIcon,c=e.hideBookmarkButton,u=e.hideSummarizeButton,p=(0,b.m)(),j=p.refetchPostDetails,w=p.isSharedPostView,O=(0,m.kK)(),S=(0,f.Fr)(t),P=(0,f.hm)(t),C=(0,d.Zh)().isUsedInMinimalTipTapViewModal,I=(0,h.Z)({post:t}).toggleSummary,k=!c&&!w&&!O,N=!s&&!O,A=!l&&!w&&!O,E=!C;return k||E||N||A?(0,r.jsxs)("div",{className:"post__actions-container text-dark flex items-center gap-0.5","data-testid":"post-header-actions",children:[t.has_summary&&!u&&(0,r.jsx)(x.k,{onClick:I}),k&&(0,r.jsx)(v.e,{bookmarkType:S||P?"post":"event",record:t,onSuccess:j,className:i()("!text-default",{"group-hover:!text-dark":!t.bookmark_id})}),N&&(0,r.jsx)(_.P,{onChange:n}),E&&(0,r.jsx)(g.p,{onChange:n,onPostDestroy:o,refetchPosts:a}),A&&(0,r.jsx)(y.c,{post:t})]}):null},w=n(97281),O=n(72034),S=function(e){var t,n,o=e.hideAuthorHeadline,b=void 0!==o&&o,h=e.hideBookmarkButton,v=e.hideSummarizeButton,y=e.hidePinnedToTopIcon,g=e.hideShareLink,_=e.isRenderedOutsideTheSpace,x=void 0!==_&&_,S=e.metaInfoWrapperClassName,P=e.onChange,C=e.onPostDestroy,I=e.post,k=e.refetchPosts,N=e.tagsLimit,A=e.tagsShowMoreLabelVariant,E=(0,d.L2)().data,T=(0,d.Zh)(),M=T.usedIn,R=T.isUsedInMinimalTipTapViewModal,D=null==I?void 0:I.cover_image_url,L=(0,m.kK)(),F=null==(t=(0,a.$B)("/home"))?void 0:t.isExact,U=null==(n=(0,a.$B)("/feed"))?void 0:n.isExact,B=x||F||U||L||"minimal-post-modal"===M;return(0,r.jsxs)(r.Fragment,{children:[(0,l.Y_)(E)&&(0,u.f)(I)&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(c.F.Regular,{record:I,contentType:"post"})}),(0,r.jsxs)("div",{className:i()("flex items-start justify-between gap-3",{"mb-5":R&&(0,f.Fr)(I)}),children:[(0,r.jsxs)("div",{className:"flex grow flex-col items-start justify-between space-y-4 md:space-y-5",children:[(null==I?void 0:I.flagged_for_approval_at)&&(0,r.jsx)(p.g,{className:"!bg-author-in-review post__headline-tag align mt-1 border-0 align-middle uppercase text-white",label:(0,s.t)("in_review")}),B?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.c,{isRenderedOutsideTheSpace:x,doesPostHaveCoverImage:D,space:E,tagsLimit:N,tagsShowMoreLabelVariant:A,wrapperClassName:i()("mt-1",S),hideAuthorHeadline:b}),(0,r.jsx)(O.p,{})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O.p,{}),(0,r.jsx)(w.c,{isRenderedOutsideTheSpace:x,doesPostHaveCoverImage:D,space:E,tagsLimit:N,tagsShowMoreLabelVariant:A,wrapperClassName:i()("mt-1",S),hideAuthorHeadline:b})]})]}),(0,r.jsx)(j,{post:I,onChange:P,refetchPosts:k,onPostDestroy:C,hideShareLink:void 0!==g&&g,hidePinnedToTopIcon:void 0!==y&&y,hideBookmarkButton:void 0!==h&&h,hideSummarizeButton:void 0!==v&&v})]})]})}},97281:function(e,t,n){n.d(t,{c:()=>k});var r=n(85893),o=n(67294),i=n(84326),a=n(27053),s=n(41342),l=n(17617),c=n(94184),u=n.n(c),d=n(54348),f=n(82859),m=n(8683),p=n(41084),b=n(80171),h=n(23386),v=n(96486),y=(0,o.forwardRef)(function(e,t){var n=e.headline,o=e.post,i=o.community_member,a=o.created_at,c=(0,l.kK)(),f=(0,s.Zh)().usedIn,p=c||"full-post-modal"===f,h=p?(0,v.truncate)(n,{length:60}):n;return n||p?(0,r.jsx)("div",{className:"post__meta inline-flex flex-wrap items-center gap-x-2",children:(0,r.jsx)(b.T,{content:n,shouldUseSpanWrapper:!1,interactive:!1,disabled:!n,children:(0,r.jsx)("button",{type:"button",className:u()("author__credentials text-default focus-visible:outline-secondary focus-visible:text-dark mt-1 text-left text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"is-admin":!!i.is_admin}),children:(0,r.jsxs)("span",{className:"space-x-2",children:[n&&(0,r.jsx)("span",{className:u()("overflow-anywhere",{"md:line-clamp-1":"full-post-modal"!==f}),children:h}),p&&!!n&&(0,r.jsx)("span",{className:"bg-badge inline-block h-[0.15rem] w-[0.15rem] rounded-full align-middle"}),p&&(0,r.jsx)("span",{className:"author__time",children:(0,r.jsx)(d.s,{post:o,className:"ago text-default hover:text-dark focus-visible:outline-secondary focus-visible:text-dark text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",forwardedRef:t,children:(0,m.TF)(a,{format:m.lc.short})})})]})})})}):null});y.displayName="AuthorHeadline";var g=n(59834),_=n(85924),x=function(e){var t,n,o,i=e.children,a=e.post,s=e.className,l=void 0===s?"":s,c=a.community_member,d=(0,_.wC)().minimal_layout,f=(0,g.O)({public_uid:null!=(o=c.public_uid)?o:"",params:{show_back_link:!0},name:c.name});return d?(0,r.jsx)("div",{className:l,children:i}):(0,r.jsx)("a",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},f),n=n={className:u()("focus-visible:outline-secondary hover:text-dark inline-block focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",l),"data-testid":"post-avatar",children:i},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},j=n(60983),w=n(31960),O=n(98363),S=function(e){var t,n,o=e.post,i=o.community_member,a=(0,w.E)().member;return(0,r.jsx)("div",{className:"post__avatar",children:(0,r.jsx)(j.C,{communityMemberId:i.id,publicUid:i.public_uid,avatarURL:i.avatar_url,name:null!=(t=i.name)?t:"",headline:i.headline,disabled:!!a,children:(0,r.jsx)(x,{post:o,className:"mr-3",children:(0,r.jsx)(O.s,{src:i.avatar_url,name:null!=(n=i.name)?n:"",size:"10"})})})})},P=(0,o.forwardRef)(function(e,t){var n,o,i=e.doesPostHaveCoverImage,a=e.className,s=e.children,c=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["doesPostHaveCoverImage","className","children"]),d=(0,l.kK)();return(0,r.jsx)("div",(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:u()("post__user flex items-stretch",{"md:!mb-2 md:!mt-1":d&&void 0!==i&&i},a),ref:t},c),o=o={children:s},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}),n))});P.displayName="PostViewListItemWrapper";var C=function(e){var t=e.communityMember,n=e.containerRef,o=e.doesPostHaveCoverImage,a=e.hasTags,s=e.headline,l=e.hideAuthorHeadline,c=void 0!==l&&l,v=e.isAdmin,g=e.isSmScreen,_=e.pageLinkRef,j=e.post,w=e.posterJoinedDate,O=e.shouldDisplayMemberTags,C=e.tagsShowMoreLabelVariant,I=e.visibleMemberTags,k=e.wrapperClassName,N=!!s;return(0,r.jsxs)(P,{doesPostHaveCoverImage:void 0!==o&&o,ref:n,className:k,"data-testid":"post-meta-info-regular",children:[(0,r.jsx)(S,{post:j}),(0,r.jsxs)("button",{type:"button",className:"post__bio focus-visible:outline-secondary flex flex-col justify-between self-center text-left focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:function(e){var t,n;if(t=e.target,(null!=(n=HTMLAnchorElement)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!n[Symbol.hasInstance](t):!(t instanceof n))&&_.current)if((0,f.n2)(e)){var r=_.current.href;window.open(r,"_blank","noreferrer"),e.preventDefault()}else _.current.click()},children:[(0,r.jsxs)("div",{className:u()("author flex flex-wrap items-baseline gap-x-2 gap-y-px",{"no-headline":!(null==t?void 0:t.headline)&&j.name,"has-tags":void 0!==a&&a}),children:[(0,r.jsx)("div",{className:"author__name inline-flex",children:(0,r.jsx)(x,{post:j,className:"!text-dark overflow-anywhere text-sm font-semibold leading-5",children:null==t?void 0:t.name})}),void 0!==O&&O&&(0,r.jsx)("div",{className:"author__tags member-tags self-center",children:(0,r.jsx)(h.m,{memberTags:I,isAdmin:void 0!==v&&v,limit:void 0!==g&&g||(0,p.Fr)(j)?1:2,showMoreLabelVariant:C})}),(0,r.jsx)("div",{className:"author__time inline-flex",children:(0,r.jsx)(d.s,{post:j,className:"ago text-default hover:text-dark focus-visible:outline-secondary focus-visible:text-dark flex items-baseline text-xs focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",forwardedRef:_,children:(0,r.jsx)(b.T,{interactive:!1,content:(0,p.s4)(j.created_at),children:(0,m.TF)(j.created_at,{format:m.lc.short})})})})]}),!c&&(0,r.jsx)(y,{headline:s,post:j}),!(N&&!c)&&!!w&&(0,r.jsx)("div",{className:"text-light flex text-xs",children:(0,i.t)("post.member_since",{date:w})})]})]})},I=function(e){var t=e.communityMember,n=e.containerRef,o=e.doesPostHaveCoverImage,i=e.hasTags,a=e.headline,s=e.hideAuthorHeadline,l=e.isAdmin,c=e.pageLinkRef,d=e.post,f=e.shouldDisplayMemberTags,m=e.tagsLimit,p=e.tagsShowMoreLabelVariant,b=e.visibleMemberTags,v=e.wrapperClassName;return(0,r.jsxs)(P,{doesPostHaveCoverImage:void 0!==o&&o,ref:n,className:v,"data-testid":"post-meta-info-small",children:[(0,r.jsx)(S,{post:d}),(0,r.jsxs)("button",{type:"button",className:"post__bio focus-visible:outline-secondary flex flex-col justify-between gap-1 self-center text-left focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:function(e){var t,n;t=e.target,(null!=(n=HTMLAnchorElement)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?n[Symbol.hasInstance](t):t instanceof n)||!c.current||c.current.click()},children:[(0,r.jsxs)("div",{className:u()("author flex flex-wrap items-center gap-x-2 gap-y-1",{"no-headline":!(null==t?void 0:t.headline)&&d.name,"has-tags":void 0!==i&&i}),children:[(0,r.jsx)("div",{className:"author__name inline-flex",children:(0,r.jsx)(x,{post:d,className:"!text-dark text-sm font-semibold leading-5",children:null==t?void 0:t.name})}),void 0!==f&&f&&(0,r.jsx)("div",{className:"author__tags member-tags !m-0",children:(0,r.jsx)(h.m,{memberTags:b,isAdmin:void 0!==l&&l,limit:m,showMoreLabelVariant:p})})]}),!(void 0!==s&&s)&&(0,r.jsx)(y,{headline:a,post:d,ref:c})]})]})},k=function(e){var t=e.doesPostHaveCoverImage,n=void 0!==t&&t,c=e.hideAuthorHeadline,u=void 0!==c&&c,d=e.isRenderedOutsideTheSpace,f=e.space,m=e.tagsLimit,p=e.tagsShowMoreLabelVariant,b=void 0===p?"numbers":p,h=e.wrapperClassName,v=(0,a.m)(),y=v.post,g=v.isSharedPostView,_=v.posterJoinedDate,x=(0,s.Zh)().usedIn,j=!!(null==y?void 0:y.hide_meta_info),w=null==y?void 0:y.community_member,O=(null==y?void 0:y.member_tags)||[],S=null==w?void 0:w.id,P=null==O?void 0:O.filter(function(e){var t;return!!((null==e?void 0:e.is_public)&&(null==e||null==(t=e.display_locations)?void 0:t.post_bio))}),k=(0,o.useMemo)(function(){return!!(S&&(null==P?void 0:P.length)>0)},[S,P]),N=(0,l.kK)(),A=(0,o.useRef)(null),E=(0,o.useRef)(null);if(j||!f)return null;var T=void 0!==d&&d?"".concat((0,i.t)("post.posted_in")," ").concat(f.name):null==w?void 0:w.headline,M=!!(null==w?void 0:w.admin),R=!g&&(k||M);return N||"full-post-modal"===x?(0,r.jsx)(I,{communityMember:w,containerRef:A,doesPostHaveCoverImage:n,hasTags:k,headline:T,hideAuthorHeadline:u,isAdmin:M,pageLinkRef:E,post:y,shouldDisplayMemberTags:R,tagsLimit:m,tagsShowMoreLabelVariant:b,visibleMemberTags:P,wrapperClassName:h}):(0,r.jsx)(C,{communityMember:w,containerRef:A,doesPostHaveCoverImage:n,hasTags:k,headline:T,hideAuthorHeadline:u,isAdmin:M,isSmScreen:N,pageLinkRef:E,post:y,posterJoinedDate:_,shouldDisplayMemberTags:R,tagsShowMoreLabelVariant:b,visibleMemberTags:P,wrapperClassName:h})}},72034:function(e,t,n){n.d(t,{p:()=>v});var r=n(85893),o=n(94184),i=n.n(o),a=n(84326),s=n(4393),l=n(8683),c=n(1168),u=n(25152),d=function(e){var t=e.startsAt,n=e.endsAt,o=e.status,i=(void 0===o?null:o)===u.Q_.DRAFT,d=(0,s.aA)(n),f=(0,s.aA)(t),m=null;return m=!f||d||i?i?(0,a.t)("events.details.draft"):d?(0,a.t)("events.details.finished",{time_string:(0,l.TF)(n)}):(0,a.t)("events.details.starts",{time_string:(0,l.TF)(t)}):(0,a.t)("events.details.in_progress"),(0,r.jsx)("div",{className:(0,c.A)("event-counter-badge",{"event-counter-badge--finished":d,"event-counter-badge--draft":i}),children:"".concat(m)})},f=n(54348),m=n(27053),p=n(41342),b=n(17617),h=n(41553),v=function(){var e=(0,m.m)(),t=e.post,n=e.canManagePost,o=(0,p.Zh)().usedIn,a=(0,b.kK)();if(!t.name||"minimal-post-modal"===o&&!a)return null;if("minimal-post-modal"===o&&a)return(0,r.jsx)("div",{className:"overflow-anywhere",children:(0,r.jsx)(h.Z.TitleMd,{children:t.name})});var s=(t||{}).event_setting_attributes||{},l=s.starts_at,c=s.ends_at,u=i()("post__header",{"post-meta--hidden":t.hide_meta_info});return(0,r.jsxs)("div",{className:u,"data-testid":"post-header",children:[l&&c&&(0,r.jsx)(d,{startsAt:l,endsAt:c,status:null==t?void 0:t.status}),(0,r.jsx)("h1",{className:i()("post__title text-2xl font-bold leading-7",{"with-admin-actions":n}),"data-testid":"post-title",children:(0,r.jsx)(f.s,{post:t,className:"!text-darkest overflow-anywhere focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",shouldOpenPostModal:!0,children:t.name})})]})}},84969:function(e,t,n){n.d(t,{P:()=>w});var r=n(85893),o=n(94184),i=n.n(o),a=n(84326),s=n(39468),l=n(41342),c=n(57363),u=n(39905),d=n(79840),f=n(41553),m=n(43544),p=n(67294),b=n(20640),h=n.n(b),v=n(13532),y=n(60878);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var _=function(e){var t,n=e.post,r=e.getSharePostLink,o=e.sharePostData,i=(0,y.pm)().success,s=(0,l.wh)().currentCommunity,c=(0,l.L2)().data,u=(t=(0,p.useState)({post:{show_post_teaser:!!(null==n?void 0:n.show_post_teaser),share_to_web:!!(null==n?void 0:n.share_post_enabled),share_post_enabled:!!(null==n?void 0:n.share_post_enabled),minimal_layout:!!(null==n?void 0:n.minimal_layout)}}),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return g(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1],m=(0,v.LM)({spaceSlug:null==n?void 0:n.space_slug,slug:null==n?void 0:n.slug});return(0,p.useEffect)(function(){n.share_post_enabled&&!o&&r({postId:null==n?void 0:n.id,body:d})},[null==n?void 0:n.share_post_enabled,o,d,r,null==n?void 0:n.id]),{onClickCopyLink:function(e){h()(e||window.location.origin+m),i((0,a.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},onChange:function(e){f(function(t){var o={post:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t.post,e)};return r({postId:null==n?void 0:n.id,body:o}),o})},formData:d,currentCommunity:s,currentSpace:c}},x=function(e){var t=e.getSharePostLink,n=e.post,o=e.sharePostData,p=_({post:n,getSharePostLink:t,sharePostData:o}),b=p.onClickCopyLink,h=p.onChange,v=p.formData,y=p.currentCommunity,g=p.currentSpace,x=(0,l.wh)().isViewOnlyMasquerading;return y.is_private||(null==g?void 0:g.is_private)?(0,r.jsxs)("div",{children:[(0,r.jsx)(m.Lt.ItemLink,{disabled:x,onClick:function(){h({share_to_web:!v.post.share_to_web})},children:(0,r.jsx)(d.sI,{label:(0,a.t)("post.share.share_to_web"),tooltipText:(0,a.t)("post.share.share_to_web_on_description"),field:"share_to_web",value:v.post.share_to_web,variant:"small",disabled:x,className:i()({"cursor-not-allowed":x})})}),v.post.share_to_web&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex flex-row items-center",children:(0,r.jsx)("div",{className:"mb-4 mt-1 flex-1 px-5",children:(0,r.jsx)(s.I,{disabled:!0,value:null==o?void 0:o.share_post_link,rightAddon:(0,r.jsx)("button",{type:"submit",onClick:function(){return b(null==o?void 0:o.share_post_link)},children:(0,r.jsx)(c.JO,{type:"20-copy"})})})})}),(0,r.jsx)(m.Lt.ItemLink,{onClick:function(){h({show_post_teaser:!v.post.show_post_teaser})},children:(0,r.jsx)(d.sI,{label:(0,a.t)("post.share.show_teaser"),tooltipText:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:(0,a.t)("post.share.show_teaser_description_title")}),(0,r.jsx)("a",{href:"/settings#field-custom_cta_for_share_links",children:(0,a.t)("post.share.show_teaser_description_link")})]}),field:"show_post_teaser",value:v.post.show_post_teaser,variant:"small"})}),!(null==y?void 0:y.is_private)&&(0,r.jsx)(m.Lt.ItemLink,{onClick:function(){return h({minimal_layout:!v.post.minimal_layout})},children:(0,r.jsx)(d.sI,{label:(0,a.t)("post.share.minimal_layout"),tooltipText:(0,a.t)("post.share.minimal_layout_description"),field:"minimal_layout",value:v.post.minimal_layout,variant:"small"})})]})]}):(0,r.jsxs)("div",{className:"flex flex-row items-center px-4 py-2",children:[(0,r.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,r.jsx)(f.Z.LabelMd,{weight:"bold",children:(0,a.t)("post.share.share_to_web")}),(0,r.jsx)(f.Z.LabelSm,{children:(0,a.t)("post.share.post_is_public")})]}),(0,r.jsx)("div",{children:(0,r.jsx)(u.z,{variant:"secondary",onClick:function(){return b()},children:(0,a.t)("copy_link")})})]})},j=n(27053),w=function(e){var t=e.onChange,n=e.button,o=e.shouldRenderCustomMenuButton,s=e.menuButtonEl,u=e.appendTo,d=(0,j.m)({onChangeSharePost:t}),p=d.showShareOnWebOptions,b=d.post,h=d.getSharePostLink,v=d.sharePostData,y=(0,l.L2)().data,g=null!=n?n:(0,r.jsx)(c.JO,{type:"20-arrow-box-up",size:20});return p(y)?(0,r.jsx)(m.Lt,{size:"extra-large",direction:"bottom-end",menuButtonEl:void 0===s?"button":s,className:"w-full",appendTo:u,buttonClassName:i()("w-full focus-visible:outline-secondary focus-visible:rounded-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-1",{"p-1 hover:bg-tertiary rounded group flex items-center":!o}),button:o?g:(0,r.jsx)(f.Z.LabelSm,{weight:"medium",color:"text-default group-hover:text-dark",children:(0,a.t)("post.share.title")}),children:(0,r.jsx)(x,{post:b,getSharePostLink:h,sharePostData:v})}):null}},16882:function(e,t,n){n.d(t,{Y:()=>f});var r=n(85893),o=n(67294),i=n(84326),a=n(1168),s=n(86307),l=n(74527),c=n(41553);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var d="post.summary",f=function(e){var t,n=e.post,f=e.className,m=e.shouldScrollIntoView,p=void 0!==m&&m,b=(0,s.Z)({post:n}),h=b.summary,v=b.isLoadingSummary,y=b.clearSummary,g=(0,o.useRef)(null),_=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return u(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),x=_[0],j=_[1],w=!!h||v,O=!x&&!!h;(0,o.useEffect)(function(){v&&j(!0)},[v]),(0,o.useEffect)(function(){p&&g.current&&w&&g.current.scrollIntoView({behavior:"smooth"})},[w,p]);var S=(0,o.useCallback)(function(){j(!1)},[]);return n.has_summary?(0,r.jsx)("div",{className:(0,a.A)("bg-ai-summary flex px-5 transition-all duration-500 ease-in-out md:px-6",{"h-0 py-0 opacity-0 md:py-0":!w,"h-auto py-4 opacity-100":w},f),ref:g,children:w&&(0,r.jsx)(l.w,{onCollapseClick:function(){j(!1),y()},children:(0,r.jsxs)(l.w.Content,{className:"gap-4",children:[(0,r.jsx)(l.w.Header,{animate:x,isHidden:O,children:(0,i.t)([d,"loading"])}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(c.Z.LabelSm,{color:"text-default",leading:"leading-tight",children:(0,i.t)([d,"title"])}),(0,r.jsx)(c.Z.TitleMd,{children:n.name})]}),(null==h?void 0:h.content)&&(0,r.jsx)(l.w.BodyText,{animation:"fade-in",onAnimationComplete:S,children:h.content})]})})}):null}},54348:function(e,t,n){n.d(t,{s:()=>h});var r=n(85893),o=n(70442),i=n(52928),a=n(67919),s=n(31960),l=n(31510),c=n(41084),u=n(13532),d=n(15731),f=n(34519),m=n(73384);function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function b(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var h=function(e){var t=e.post,n=e.ariaLabel,h=e.allComments,v=e.forwardedRef,y=e.onClick,g=e.children,_=e.shouldOpenPostModal,x=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["post","ariaLabel","allComments","forwardedRef","onClick","children","shouldOpenPostModal"]),j=(0,s.E)().member,w=(0,o.UO)().postSlug,O=(0,d.I)(),S=(0,f.UV)(),P=S.isInsideModal,C=S.onClose,I=(0,o.TH)(),k=(0,m._t)(),N=k.params,A=k.hasNextPage,E=!(0,l.U)(),T=(0,u.LM)({spaceSlug:t.space_slug,slug:t.slug,hash:void 0!==h&&h?a.Q:""});return O?(0,r.jsx)("a",b(p({href:T,target:"_blank",rel:"noreferrer","aria-label":n},x,v&&{ref:v}),{children:g})):(0,c.Sb)(t,{postSlugInUrl:w})?(0,r.jsx)("a",b(p({href:T,"aria-label":n},x,v&&{ref:v}),{children:g})):void 0!==_&&_&&E?(0,r.jsx)(i.rU,b(p({to:{pathname:u.xu.show({slug:t.slug,spaceSlug:t.space_slug}),state:{prevLocation:I,params:N,hasNextPage:A,isWithinProfileContext:!!j,profileContextMember:j}},"aria-label":n},x,v&&{ref:v}),{children:g})):(0,r.jsx)(i.rU,b(p({to:T,"aria-label":n},x,v&&{ref:v}),{onClick:P?C:y,children:g}))}},59331:function(e,t,n){n.d(t,{k:()=>l});var r=n(85893),o=n(84326),i=n(85924),a=n(80171),s=n(75148),l=function(e){var t=e.onClick,n=e.buttonSize,l=(0,i.TC)().isDarkAppearance;return(0,r.jsx)(a.T,{content:(0,o.t)("post.summarize"),interactive:!1,children:(0,r.jsx)(s.h,{name:l?"20-stardust":"20-stardust-gradient",iconSize:20,className:"group",iconClassName:"group-hover:animate-spin-pause-reverse",onClick:t,buttonSize:void 0===n?28:n,ariaLabel:(0,o.t)("post.summarize")})})}},24921:function(e,t,n){n.d(t,{D:()=>er});var r=n(85893),o=n(67294),i=n(94184),a=n.n(i),s=n(70442),l=n(40382),c=n(17e3),u=n(34822),d=n(27265),f=n(27053),m=n(41342),p=n(41084),b=n(17617),h=n(92640),v=n(66007),y=n(84326),g=n(85924),_=n(23627),x=n(73384),j=n(52521),w=["image","file","embed","poll","video"],O=function(e){return"paragraph"===e.type&&(!e.content||0===e.content.length)||void 0!==e.text&&""===e.text.trim()&&" "!==e.text},S=function(e){return e.filter(function(e){return!O(e)}).map(function(e){if(e.content){var t,n;return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),n=n={content:S(e.content)},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}return e})},P=function(e){return!(e&&e.content&&Array.isArray(e.content))||0===e.content.length},C=function(e){return"string"==typeof e.type&&w.includes(e.type)},I=n(96486);function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function N(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var A=function(e){if(!e)return{truncatedContent:[],mediaContent:null,hasTruncatedContent:!1,hasMediaAttachmentsBeforeTruncation:!1};var t={charCount:0,mediaCount:0,truncatedContent:[],mediaContent:null,hasTruncatedContent:!1,textLengthCache:new Map,hasMediaAttachmentsBeforeTruncation:!1};return D(e,t),{truncatedContent:S(t.truncatedContent),mediaContent:t.mediaContent,hasTruncatedContent:t.hasTruncatedContent,hasMediaAttachmentsBeforeTruncation:t.hasMediaAttachmentsBeforeTruncation}},E=function(e,t){return!t.mediaContent&&(t.mediaContent=e,!0)},T=function(e,t){C(e)?L(e,t):e.content&&Array.isArray(e.content)?M(e,t):F(e,t)},M=function(e,t){var n=N(k({},e),{content:[]});if(t.truncatedContent.push(n),e.content){var r=!0,o=!1,i=void 0;try{for(var a,s=e.content[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;if(t.hasTruncatedContent)break;var c=B(l,t),u=250-t.charCount;c<=u?(T(l,N(k({},t),{truncatedContent:n.content})),t.charCount+=c):(U(l,u,N(k({},t),{truncatedContent:n.content})),t.hasTruncatedContent=!0),R(t)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}},R=function(e){(e.charCount>250||e.mediaCount>3)&&(e.hasTruncatedContent=!0)},D=function(e,t){return(0,I.some)(e,function(e){if(O(e))return!1;var n,r=t.hasTruncatedContent&&C(e),o=t.hasTruncatedContent&&Array.isArray(e.content);return!!(r&&E(e,t))||(t.hasTruncatedContent||(T(e,t),R(t)),o&&D(null!=(n=e.content)?n:[],t))})},L=function(e,t){t.hasMediaAttachmentsBeforeTruncation=!0,t.mediaCount<3?(t.mediaCount+=1,t.truncatedContent.push(k({},e))):(E(e,t),t.hasTruncatedContent=!0)},F=function(e,t){var n=B(e,t),r=250-t.charCount;n<=r?(t.charCount+=n,t.truncatedContent.push(k({},e))):(U(e,r,t),t.hasTruncatedContent=!0)},U=function(e,t,n){var r=k({},e);"string"==typeof e.text?(r.text=e.text.slice(0,t),r.text&&(t<e.text.length&&(r.text+="..."),n.truncatedContent.push(r),n.charCount+=r.text.length)):e.content&&Array.isArray(e.content)&&(r.content=[],n.truncatedContent.push(r),D(e.content,N(k({},n),{truncatedContent:r.content})))},B=function(e,t){if(t.textLengthCache.has(e)){var n;return null!=(n=t.textLengthCache.get(e))?n:0}var r=0;return"string"==typeof e.text?r=e.text.length:e.content&&Array.isArray(e.content)&&(r=e.content.reduce(function(e,n){return e+B(n,t)},0)),t.textLengthCache.set(e,r),r},q=function(e){var t,n,r=e.params,i=void 0===r?{}:r,a=e.hasNextPage,l=void 0!==a&&a,c=(0,f.m)().post,u=(0,j.d)().navigateToPost,d=(0,s.TH)(),m=(0,o.useMemo)(function(){var e,t;return A(null==c||null==(t=c.tiptap_body)||null==(e=t.body)?void 0:e.content)},[null==c||null==(n=c.tiptap_body)||null==(t=n.body)?void 0:t.content]),p=m.truncatedContent,b=m.mediaContent,h=m.hasTruncatedContent,v=m.hasMediaAttachmentsBeforeTruncation,y=(0,o.useMemo)(function(){return{type:"doc",content:p}},[p]),g=(0,o.useMemo)(function(){return b?{type:"doc",content:[b]}:null},[b]),_=(0,o.useMemo)(function(){return P(g)},[g]),x=(0,o.useMemo)(function(){return P(y)},[y]),w=h&&p&&!x,O=p&&!x,S=!v&&!!b&&!_;return{truncatedContent:y,mediaContent:g,redirectToPostModal:(0,o.useCallback)(function(){u({newPost:c,prevLocation:d,params:i,hasNextPage:l})},[c,d,i,l,u]),tiptapBody:null==c?void 0:c.tiptap_body,shouldShowSeeMoreButton:w,shouldRenderTruncatedContent:O,shouldRenderMediaContent:S}},z=function(){var e=(0,g.wC)().minimal_layout,t=(0,f.m)().post,n=(0,x._t)(),o=n.params,i=n.hasNextPage,a=t.internal_custom_html,s=q({params:o,hasNextPage:i}),l=s.mediaContent,c=s.truncatedContent,u=s.shouldRenderTruncatedContent,d=s.shouldRenderMediaContent,m=s.tiptapBody,p=s.redirectToPostModal,b=s.shouldShowSeeMoreButton;return(0,r.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[u&&(0,r.jsx)(_.R,{readOnly:!0,disableMentionClicks:e,value:c,shouldRefetch:!0,sgidToObjectMap:m.sgids_to_object_map,inlineAttachments:m.inline_attachments}),a&&(0,r.jsx)(v.Z,{html:a},"internal_custom_html"),b&&(0,r.jsx)("button",{type:"button",className:"text-light hover:text-dark focus-visible:text-dark inline-flex text-base","data-testid":"see-more-post",onClick:p,children:(0,y.t)("see_more")}),d&&(0,r.jsx)(_.R,{readOnly:!0,disableMentionClicks:e,sgidToObjectMap:m.sgids_to_object_map,inlineAttachments:m.inline_attachments,value:l,shouldRefetch:!0,className:"w-full"})]})},Z=n(13532),H=n(72851),V=n(91704),Q=n(98384),W=function(){var e=(0,f.m)(),t=e.post,n=e.isTrixPost,o=t.body_trix_content,i=t.internal_custom_html,a=t.pinned_at_top_of_space,l=(0,j.d)().navigateToPost,c=(0,s.TH)(),u=(0,x._t)(),d=u.params,m=u.hasNextPage,b=4;a&&(b=2);var h=["help","help-en"].includes(t.community_slug)&&(0,p.hm)(t);return(0,r.jsxs)("div",{className:"flex w-full flex-col items-start justify-start gap-2",children:[(0,r.jsxs)(H.X,{lines:b,hideToggle:!0,children:[n&&o&&(0,r.jsx)(V.P,{content:o,contentParentPath:Z.xu.show({slug:t.slug,spaceSlug:t.space_slug})}),i&&(0,r.jsx)(v.Z,{html:i},"internal_custom_html"),h&&(0,r.jsx)(Q.e,{post:t})]}),(0,r.jsx)("button",{type:"button",className:"text-default hover:text-dark text-base",onClick:function(){l({newPost:t,params:d,hasNextPage:m,prevLocation:c})},children:(0,y.t)("see_more")})]})},G=function(e){var t=e.noPadding,n=(0,f.m)(),o=n.post,i=n.isTiptapPost,s=n.isPostBodyEmpty,l=o.updated_at;return s?null:(0,r.jsx)("div",{className:a()("post__body",{"!p-0":void 0!==t&&t,"px-5 pb-5 md:px-6":(0,p.Fr)(o)}),"data-testid":"post-body",children:(0,r.jsx)("div",{className:"post__inside trix-v2 w-full","data-testid":"post-body-inside",children:i?(0,r.jsx)(z,{}):(0,r.jsx)(W,{})})},l)},$=n(62068),K=function(e){var t,n,o=e.children,i=(0,f.m)(),l=i.isImagePost,c=i.isPostBodyEmpty,u=i.isPostMetaHidden,d=i.isSharedPostWithTeaserLayout,p=(0,m.Zh)().usedIn,b=null==(t=(0,s.$B)("/home"))?void 0:t.isExact,h=null==(n=(0,s.$B)("/feed"))?void 0:n.isExact,v="full-post-modal"===p,y=c&&!b&&!h&&!u&&!l;return(0,r.jsx)("div",{className:a()("post__content text-dark",{"p-5 md:px-6":!l&&u,"px-5 pb-5 pt-4 md:px-6 md:py-5":!l&&!u,"pt-5":l&&!v&&u,"pt-4 md:pt-5":l&&!v&&!u,"py-5":l&&v,"!pb-0":l&&v&&!c,"pb-5":y,relative:d}),"data-testid":"post-content-wrapper",children:o})},J=n(48250),X=n(61410),Y=n(16882);function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ee(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var en=function(e){var t,n=e.autofocusReplyForm,i=e.className,v=e.defaultShowComment,y=e.hideAuthorHeadline,g=e.hideBookmarkButton,_=e.hidePinnedToTopIcon,x=void 0!==_&&_,j=e.hideShareLink,w=e.isRenderedOutsideTheSpace,O=e.metaInfoWrapperClassName,S=e.onPostChange,P=e.onPostDestroy,C=e.pageSupportsContentTruncation,I=e.refetchPosts,k=e.shouldOpenCommentPage,N=e.tagsLimit,A=e.tagsShowMoreLabelVariant,E=e.shouldForceSamePageInteractions,T=void 0!==E&&E,M=e.scrollableTarget,R=(0,o.useRef)(null),D=(0,m.Zh)(),L=D.record,F=D.usedIn,U=(0,f.m)(),B=U.isPostBodyEmpty,q=U.showPostActions,z=et((0,o.useState)(void 0!==v&&v),2),Z=z[0],H=z[1],V=et((0,o.useState)(void 0!==n&&n),2),Q=V[0],W=V[1],ee=(0,b.kK)(),en=L.name,er=L.is_truncation_disabled,eo=L.is_comments_enabled,ei=L.flagged_for_approval_at,ea=L.hide_meta_info,es=L.pinned_at_top_of_space,el=L.post_details_loaded,ec=null==(t=(0,s.$B)("/c/:spaceSlug/:postSlug"))?void 0:t.isExact,eu=(0,p.hm)(L)&&!ec&&!er&&!T,ed=(0,m.wh)().currentUser,ef=(0,f.m)(),em=ef.isSharedPostView,ep=ef.isSharedPostWithTeaserLayout,eb=(void 0===C||C)&&!er||ep,eh=(0,p.Fr)(L)||(0,p.hm)(L),ev="full-post-modal"===F,ey=!q&&"full-post-modal"===F&&ea;if(!L||!L.id)return null;var eg=(0,o.useCallback)(function(){return(0,h.p)(R.current)&&R.current.focus()},[R]);(0,o.useEffect)(function(){Q&&eg()},[eg]);var e_=a()("post post--parent bg-primary border-primary rounded-none border first:mt-5 first:md:mt-0 md:rounded-2xl",{"post--shared":em,"post--shared__truncated":ep&&!ed,"is-truncation-disabled":!eb,"flagged-for-approval":ei,"post-name--empty":!en,"post-meta--hidden":ea,"is-pinned":es,"!shadow-none !rounded-none !border-0":ev,"!mb-5 md:!mb-6":!ev},i),ex=(0,o.useCallback)(function(){if(H(!0),W(!0),R.current)if((0,h.p)(R.current))(0,h.p)(R.current)&&R.current.focus();else{var e,t;null==(t=R.current.commands)||null==(e=t.focus)||e.call(t,"end")}},[]);return(0,r.jsxs)("div",{className:e_,"data-testid":"post-container",children:[!x&&ee&&eh&&(0,r.jsx)(d.c,{post:L}),(0,r.jsx)(J.H,{post:L}),!eb&&(0,r.jsx)("div",{className:a()("overflow-hidden bg-transparent md:rounded-t-2xl",{"rounded-t-none md:rounded-t-none":ev||!!L.cover_image_url}),children:(0,r.jsx)(Y.Y,{post:L})}),(0,r.jsx)("div",{className:"post__post",children:(0,r.jsxs)(K,{children:[(0,r.jsx)("div",{className:a()({"mb-5":!B,"px-5 md:px-6":(0,p.Fr)(L),hidden:ey}),children:(0,r.jsx)(X.m,{post:L,isRenderedOutsideTheSpace:void 0!==w&&w,onChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};S(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},L,e),t)},refetchPosts:I,onPostDestroy:P,hideShareLink:void 0!==j&&j,hidePinnedToTopIcon:x,hideBookmarkButton:void 0!==g&&g,hideSummarizeButton:eb,tagsLimit:ee?1:void 0===N?3:N,tagsShowMoreLabelVariant:void 0===A?"numbers":A,metaInfoWrapperClassName:O,hideAuthorHeadline:void 0!==y&&y})}),(0,p.Fr)(L)&&"full-post-modal"!==F&&(0,r.jsx)(l.l,{onPostChange:S,onPostDestroy:P}),eu?(0,r.jsx)(G,{}):(0,r.jsx)($.y,{enableTruncation:eb}),ep&&(0,r.jsx)("div",{className:"to-primary absolute bottom-0 left-0 z-10 h-1/2 w-full bg-gradient-to-b from-transparent"})]})}),(0,r.jsx)("div",{className:"mt-auto",children:(0,r.jsx)(u.S,{toggleComment:function(){W(!1),H(function(e){return!e})},showCommentAndFocusCommentForm:ex,shouldOpenCommentPage:void 0!==k&&k,shouldForceSamePageInteractions:T})}),el&&eo&&Z&&(0,r.jsx)(c.o,{commentsFormRef:R,autofocusReplyForm:Q,scrollableTarget:M})]})},er=function(e){return(0,r.jsx)(en,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}},27053:function(e,t,n){n.d(t,{m:()=>b});var r=n(88767),o=n(70442),i=n(93199),a=n(41342),s=n(29378),l=n(78456),c=n(85122),u=n(41084),d=n(60589),f=n(15731);function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var p=function(e,t,n,r,o){var i=u.Sb(e,{postSlugInUrl:r}),a=!!(i&&e.minimal_layout),s=!!(i&&e.show_post_teaser),l=!t&&u.GT(e,{currentUser:n,postSlugInUrl:r}),c=!!(!n&&e.is_comments_enabled&&!e.is_comments_closed||s),d=c&&e.comments_count>5,f=c&&e.comments_count<=5,m=!!(e.flagged_for_approval_at&&o),p=!!(!a&&(e.is_liking_enabled||e.is_comments_enabled));return{isSharedPostView:i,isSharedPostViewWithMinimalLayout:a,isSharedPostWithTeaserLayout:s,showSpaceName:a,showGatedCommentSection:c,showGatedCommentSectionAtBottom:f,showGatedCommentSectionAtTop:d,showModerationInActionsDropdown:m,showPostActions:l,showEngagementActions:p}},b=function(){var e,t,n,b=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onChangeSharePost,h=(0,o.UO)().postSlug,v=(0,f.I)(),y=(0,a.Zh)(),g=y.record,_=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(y,["record"]),x=(null==g||null==(n=g.community_member)?void 0:n.created_at)?(0,c.ie)(g.community_member.created_at,{month:"long",year:"numeric",day:"numeric"}):"",j=(0,a.wh)(),w=j.currentUser,O=j.currentCommunity,S=j.currentCommunityMember,P={canManagePost:u.ou(g),canUpdatePost:u.sN(g),canDuplicatePost:u.Vr(g),canDestroyPost:u.$2(g),canReportPost:u.KX(g)},C=p(g,v,w,h,P.canManagePost),I=u.hm(g),k=u.HZ(g),N=u.Fr(g),A=u.s8(g),E=u.Iz(g),T=u.Vt(g),M=u.A8(g),R=!!(C.isSharedPostViewWithMinimalLayout&&S),D=(0,r.useMutation)(function(e){var t=e.postId,n=e.body;return(0,i.aU)("/posts/".concat(t,"/share"),n)},{onSuccess:function(e){b&&b(m({},g,e),{refetch:!1})}}),L=D.mutate,F=D.data,U=D.isLoading;return e=m({post:g},_,P,C),t=t={getSharePostLink:L,isBasicPost:I,isEventPost:k,isImagePost:N,isLoadingSharePostData:U,isPostBodyEmpty:T,isPostMetaHidden:M,isTiptapPost:A,isTrixPost:E,posterJoinedDate:x,sharePostData:F,shouldHideCommentsListForSpace:function(e){var t=e.space,n=(0,s.aF)(O)||S,r=(0,d.fL)(t)||(0,d.J$)(t)||(0,l.vb)(S);return!(n&&r)||C.isSharedPostViewWithMinimalLayout||C.isSharedPostWithTeaserLayout},shouldShowLeaveCommentButton:R,showShareOnWebOptions:function(e){return!C.isSharedPostView&&!v&&u.Pu(g,O,e)}},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}},23782:function(e,t,n){n.d(t,{s:()=>a});var r=n(85893),o=n(28321),i=n(28601),a=function(e){var t=e.profileFields,n=t.visible,a=t.not_visible;return(0,r.jsxs)(i.$,{dataTestId:"profile-fields-section",children:[(0,r.jsx)(o.s,{fields:n}),(0,r.jsx)(o.s,{fields:a,isHidden:!0})]})}},6193:function(e,t,n){n.d(t,{C:()=>s});var r=n(85893),o=n(94184),i=n.n(o),a=n(57363),s=function(e){var t=e.iconType,n=e.iconProps,o=e.info,s=e.dataTestId,l=e.className,c=e.iconClassName;return o?(0,r.jsxs)("div",{className:i()("profile-drawer__about__block whitespace-pre-line [word-break:break-word]",void 0===l?"":l),"data-testid":s,children:[t?(0,r.jsx)(a.JO,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({useWithFillCurrentColor:!0,className:i()("text-dark",void 0===c?"":c),type:t},void 0===n?{}:n)):null," ",(0,r.jsx)("p",{children:o})]}):null}},24650:function(e,t,n){n.d(t,{o:()=>a});var r=n(85893),o=n(59459),i=n(6193),a=function(e){var t=e.link,n=e.iconType;return t?(0,r.jsx)(i.C,{iconType:n,info:(0,r.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:(0,o.B)(t)})}):null}},28601:function(e,t,n){n.d(t,{$:()=>a});var r=n(85893),o=n(45697),i=n.n(o),a=function(e){var t=e.title,n=e.children,o=e.dataTestId;return(0,r.jsxs)("div",{className:"profile-drawer__about__section","data-testid":o,children:[t&&(0,r.jsx)("div",{className:"profile-drawer__about__heading",children:t}),n]})};a.propTypes={title:i().string,children:i().oneOfType([i().arrayOf(i().node),i().node]),dataTestId:i().string}},74776:function(e,t,n){n.d(t,{Z:()=>o});var r=n(85893);function o(e){var t=e.title,n=e.subtitle;return(0,r.jsxs)("div",{className:"profile-drawer__empty",children:[(0,r.jsx)("div",{className:"profile-drawer__empty__title",children:t}),(0,r.jsx)("div",{className:"profile-drawer__empty__subtitle",children:n})]})}},60983:function(e,t,n){n.d(t,{C:()=>C});var r=n(85893),o=n(67294),i=n(45317),a=n(94184),s=n.n(a),l=n(84326),c=n(96533),u=n(9397),d=n(37840),f=n(96486),m=n(88767),p=n(70442),b=n(3697),h=n(41342),v=n(13532),y=n(90926),g=n(57363),_=n(39905),x=function(e){var t=e.communityMemberId,n=e.closeCard,o=(0,p.k6)(),i=(0,h.wh)().isViewOnlyMasquerading,a=(0,y.pB)().findOrCreateChatRoom,s=(0,m.useMutation)(function(){return a({kind:b.g8,community_member_ids:[t]})},{onSuccess:function(e){o.push((0,v.co)({url:(0,v.so)({uuid:e})}))}}),c=s.mutate,u=s.isLoading;return(0,r.jsxs)(_.z,{onClick:function(){i?(0,f.noop)():c(),n()},className:"!border-primary flex items-center space-x-2 !px-3 !py-1.5 !font-medium",variant:"secondary",children:[(0,r.jsx)(g.JO,{type:u?"loader":"16-chat",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0}),(0,r.jsx)("span",{children:(0,l.t)("message")})]})},j=n(54503),w=n(86976),O=n(41553),S=function(e){var t=e.communityMemberId,n=e.publicUid,o=e.messagingEnabled,a=e.avatarURL,f=e.name,m=void 0===f?"":f,p=e.headline,b=void 0===p?"":p,v=e.side,y=e.sideOffset,S=e.closeCard,P=(0,c.r)(),C=(0,w.c8)().data,I=(0,h.wh)().currentCommunityMember,k=(null==I?void 0:I.id)!==t&&(null==I?void 0:I.messaging_enabled)&&o,N=(0,j.Y)({member_ids:[t]}),A=N.isLoading,E=N.data,T=null==E?void 0:E.find(function(e){return Number(e.community_member_id)===Number(t)}),M=!!(null==C?void 0:C.enabled);return(0,r.jsxs)(i.VY,{className:"border-primary bg-primary z-[1061] w-full max-w-[320px] rounded-xl border p-6 shadow-xl",sideOffset:y,side:v,children:[(0,r.jsxs)("div",{className:s()("flex justify-between",b?"items-start":"items-center"),children:[(0,r.jsxs)("div",{className:"text-dark mr-4 truncate",children:[(0,r.jsx)(O.Z.LabelLg,{weight:"semibold",children:(0,r.jsx)("span",{className:"text-dark",children:m})}),(0,r.jsx)("br",{}),b&&(0,r.jsx)("div",{className:"text-light truncate",children:(0,r.jsx)(O.Z.LabelSm,{weight:"regular",children:(0,r.jsx)("span",{className:"text-light",children:b})})}),M&&(0,r.jsx)("div",{className:"mt-2",children:A?(0,r.jsx)("div",{className:"bg-tertiary mb-2 h-7 w-32 animate-pulse rounded-full text-center text-transparent md:text-left"}):(null==T?void 0:T.current_level)&&(0,r.jsx)(d.U,{level:null==T?void 0:T.current_level,levelName:null==T?void 0:T.current_level_name})})]}),(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(u.i,{avatarUrl:a,name:m,size:"small",progress:null==T?void 0:T.level_progress,level:null==T?void 0:T.current_level})})]}),(0,r.jsx)("div",{className:"mt-4 space-y-2"}),(0,r.jsxs)("div",{className:"mt-4 flex w-full space-x-2",children:[n&&(0,r.jsxs)(_.z,{className:"!border-primary flex items-center justify-center space-x-2 !px-3 !py-1.5 !font-medium",full:!k,variant:"secondary",onClick:function(){P.show({memberPublicId:n}),S()},children:[(0,r.jsx)(g.JO,{type:"16-user",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0}),(0,r.jsx)("span",{children:(0,l.t)("view_profile")})]}),k&&(0,r.jsx)(x,{closeCard:S,communityMemberId:t})]})]})};function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e){var t,n=e.children,a=e.communityMemberId,s=e.publicUid,l=e.messagingEnabled,c=e.avatarURL,u=e.name,d=e.headline,f=e.disabled,m=e.side,p=e.sideOffset,b=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return P(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),h=b[0],v=b[1];return(0,r.jsxs)(i.fC,{openDelay:300,closeDelay:100,open:h,onOpenChange:v,children:[(0,r.jsx)(i.xz,{asChild:!0,children:(0,r.jsx)("span",{children:n})}),(0,r.jsx)(i.h_,{children:!(void 0!==f&&f)&&(0,r.jsx)(S,{communityMemberId:a,publicUid:s,avatarURL:c,name:void 0===u?"":u,headline:void 0===d?"":d,messagingEnabled:l,closeCard:function(){return v(!1)},side:void 0===m?"right":m,sideOffset:void 0===p?5:p})})]})}},54503:function(e,t,n){n.d(t,{Y:()=>a});var r=n(88767),o=n(93199),i=n(13532),a=function(e){var t=e.member_ids,n=e.enabled;return(0,r.useQuery)(["gamificationMember",t],function(){return(0,o.UT)(i.av.gamification.members({params:{member_ids:t}}))},{cacheTime:6e4,enabled:void 0===n||n})}},87685:function(e,t,n){n.d(t,{N:()=>eP});var r=n(85893),o=n(94184),i=n.n(o),a=n(96486),s=n(84326),l=n(95146),c=n(11944),u=n(35756),d=n(56918),f=n(85122),m=n(8683),p=n(81261),b=n(32589),h=n(13847),v=n(17617),y=n(35565),g=n(46272),_=n(4320),x=n(23386),j=n(41553),w=n(23782),O=n(6193),S=n(24650),P=n(28601),C=function(e){var t,n=e.member,o=Object.prototype.hasOwnProperty.call(n,"email"),i=(0,_.a)(),a=(0,_.R)(),l=(0,h.rV)(),c=(0,b.V)(),u=(0,v.kK)(),C=null==(t=n.member_tags)?void 0:t.filter(function(e){var t;return(null==e?void 0:e.is_public)&&(null==e||null==(t=e.display_locations)?void 0:t.profile_page)}),I=(null==C?void 0:C.length)>0;return(0,r.jsxs)("div",{className:"profile-drawer__about",children:[!i&&n.bio&&(0,r.jsx)(P.$,{dataTestId:"biography-section",title:(0,s.t)("profile_drawer.biography"),children:(0,r.jsx)(O.C,{info:n.bio,dataTestId:"profile-member-bio"})}),(0,r.jsxs)(P.$,{dataTestId:"profile-info-section",children:[!c&&o&&(0,r.jsx)(O.C,{iconType:"at-symbol",info:n.email,dataTestId:"profile-member-email"}),!i&&(0,r.jsx)(O.C,{iconType:"map-pin",iconProps:{viewBox:"0 0 14 18"},info:n.location,dataTestId:"profile-member-location"}),(0,r.jsx)(O.C,{iconType:"calendar",info:(0,s.t)("profile_drawer.member_since",{member_since:(0,f.ie)(n.created_at,{month:"long",year:"numeric",day:"numeric"})}),dataTestId:"profile-member-since"}),!!n.last_seen_at&&(0,r.jsx)(O.C,{iconType:"16-clock",info:(0,s.t)("profile_drawer.last_seen",{last_seen:(0,m.TF)(n.last_seen_at)}),iconProps:{viewBox:"0 0 18 18",className:"text-dark ml-0.5 mt-0.5"}})]}),l&&(0,r.jsx)(P.$,{dataTestId:"activity-score-section",children:(0,r.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,r.jsx)(j.Z.LabelSm,{weight:"semibold",children:(0,s.t)("activity_score.activity_score_title")}),(0,r.jsx)(y.XR,{ids:[n.id],children:(0,r.jsx)(d.z,{memberId:n.id})})]})}),I&&!u&&(0,r.jsx)(P.$,{title:(0,s.t)("profile_drawer.tags"),children:(0,r.jsx)("div",{className:"profile-drawer__about__tags",children:(0,r.jsx)(x.m,{limit:1/0,memberTags:C})})}),a&&(0,r.jsx)(P.$,{title:(0,s.t)("profile_fields.upgrade_flow.title"),children:(0,r.jsx)(g.I,{})}),i&&(0,r.jsx)(w.s,{profileFields:n.profile_fields}),!i&&(0,p.sR)(n)&&(0,r.jsxs)(P.$,{title:(0,s.t)("profile_drawer.social"),children:[(0,r.jsx)(S.o,{iconType:"globe",link:n.website_url}),(0,r.jsx)(S.o,{iconType:"facebook",link:n.facebook_url}),(0,r.jsx)(S.o,{iconType:"twitter",link:n.twitter_url}),(0,r.jsx)(S.o,{iconType:"linkedin",link:n.linkedin_url}),(0,r.jsx)(S.o,{iconType:"instagram",link:n.instagram_url})]})]})},I=function(){return(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(j.Z.LabelSm,{children:(0,s.t)("something_went_wrong")})})},k=function(e){return(0,r.jsx)(u.S,{renderFunc:I,children:(0,r.jsx)(C,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))})},N=n(58533),A=n(20624),E=n(77201),T=n(74776),M=n(52928),R=n(93440),D=n(82859),L=n(41084),F=n(13532),U=n(80171),B=n(91704);function q(e){var t=e.comment,n=e.onClose,o=e.shouldOpenInNewTab,i="tiptap"===t.editor;return(0,r.jsx)(M.rU,{to:(0,F.LM)({slug:t.post_slug,spaceSlug:t.space_slug})+"#comment_wrapper_".concat(t.id),onClick:function(e){return!(0,D.n2)(e)&&n()},className:"profile-comments__item bg-primary focus-visible:outline-secondary hover:outline-secondary flex items-start p-5 transition-colors duration-150 md:px-6",target:o&&"_blank",children:(0,r.jsxs)("div",{className:"profile-comments__content text-darkest flex w-full flex-col space-y-3 text-base",children:[(0,r.jsx)("div",{className:"profile-comments__meta text-default flex flex-row space-x-3 text-sm font-normal",children:(0,r.jsxs)("div",{className:"space-x-2",children:[(0,r.jsxs)("span",{className:"profile-comments__post-name text-default break-all",children:[(0,s.t)("profile_drawer.comments.commented_on")," ",(0,r.jsx)("span",{className:"text-dark font-medium",children:t.post_name||t.post_truncated_content})]}),(0,r.jsx)("span",{className:"bg-badge inline-block h-1 w-1 rounded-full align-middle"}),(0,r.jsx)(U.T,{interactive:!1,content:(0,L.s4)(t.created_at),className:"inline-flex",children:(0,r.jsx)("span",{children:(0,m.TF)(t.created_at,{format:m.lc.short})})})]})}),i?(0,r.jsx)(R.G,{tiptapBody:t.tiptap_body},t.updated_at):(0,r.jsx)(B.P,{content:t.body_trix_content})]})})}var z=function(e){var t=e.memberPublicId,n=e.member,o=e.onClose,i=e.shouldOpenInNewTab,a=e.scrollableTarget,l=(0,E.F)({memberPublicId:t}),c=l.fetchNextPage,u=l.comments,d=l.hasNextPage;return l.isLoading?(0,r.jsx)(A.m,{}):u.length<1?(0,r.jsx)(T.Z,{title:s.Z.t("profile_drawer.comments.empty_state.title"),subtitle:s.Z.t("profile_drawer.comments.empty_state.subtitle")}):(0,r.jsx)("div",{className:"profile-comments bg-tertiary h-full overflow-auto",id:"profile-comments-scrollable-target",children:(0,r.jsx)(N.Z,{scrollThreshold:.5,next:c,hasMore:!!d,loader:(0,r.jsx)(A.m,{}),dataLength:u.length,scrollableTarget:(void 0===a?"panel":a)||"profile-comments-scrollable-target",className:"flex flex-col space-y-2",children:u.map(function(e){return(0,r.jsx)(q,{onClose:o,comment:e,member:n,shouldOpenInNewTab:i},e.id)})})})},Z=n(30581),H=n(41342),V=n(88241),Q=n(62025),W=function(e){var t=e.memberPublicId,n=e.shouldOpenInNewTab,o=e.scrollableTarget,i=(0,Q.t)({memberPublicId:t}),a=i.fetchNextPage,l=i.posts,c=i.data,u=i.hasNextPage,d=i.isLoading,f=i.onPostChange;if(d)return(0,r.jsx)(A.m,{});if(l.length<1)return(0,r.jsx)(T.Z,{title:(0,s.t)("profile_drawer.posts.empty_state.title"),subtitle:(0,s.t)("profile_drawer.posts.empty_state.subtitle")});var m=null==c?void 0:c.pages.map(function(e){return e.records.map(function(e){return e.id})});return(0,r.jsx)(V._x,{perPagePostIds:m,children:(0,r.jsx)("div",{className:"profile-posts bg-tertiary h-full overflow-auto",id:"profile-posts-scrollable-target",children:(0,r.jsx)(N.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:a,hasMore:!!u,loader:(0,r.jsx)(A.m,{}),dataLength:l.length,scrollableTarget:(void 0===o?"panel":o)||"profile-posts-scrollable-target",className:"space-y-2",children:l.map(function(e){return(0,r.jsx)(H.mE,{spaceId:e.space_id,children:(0,r.jsx)(Z.Y,{forceSimplifiedView:!0,onPostChange:f,post:e,shouldOpenInNewTab:n},e.id)},e.id)})})})})},G=n(67142),$=n(24310),K=n(60622),J=function(e){var t=e.member,n=t.is_deleted?(0,s.t)("deactivated"):t.admin?(0,s.t)("admin"):t.moderator?(0,s.t)("moderator"):null;return n?(0,r.jsx)("div",{className:i()("text-badge m-0 inline-block select-none overflow-hidden rounded-2xl bg-clip-padding px-2 py-[2px] text-[9px] font-bold uppercase",{"bg-[#ef4444] text-white":t.is_deleted,"bg-brand text-brand-button":!t.is_deleted}),children:n}):null},X=n(20640),Y=n.n(X),ee=n(39905),et=n(60878),en=n(57363),er=function(e){var t=e.member.public_uid,n=e.large,o=(0,et.pm)().success,a=(0,F.zd)({public_uid:t});return(0,r.jsx)(U.T,{placement:"bottom",content:(0,s.t)("post.share.copy_link_to_profile"),interactive:!1,children:(0,r.jsx)("div",{children:(0,r.jsx)(ee.z,{type:"button",variant:"secondary","aria-label":(0,s.t)("post.share.copy_link_to_profile"),onClick:function(){Y()(window.location.origin+a),o((0,s.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},"data-testid":"copy-link-profile",large:n,className:i()({"!px-2.5":n}),children:(0,r.jsx)(en.JO,{type:"link",size:16,useWithFillCurrentColor:!0})})})})},eo=function(e){var t=e.toggleDrawer,n=e.isFullPageProfile,o=e.memberId;return(0,r.jsx)(U.T,{placement:"bottom",content:(0,s.t)("post.share.edit_profile"),interactive:!1,children:(0,r.jsx)(ee.z,{variant:"secondary",onClick:function(){n?window.location.href=F.bf.edit({memberId:String(o)}):t()},"aria-label":(0,s.t)("post.share.edit_profile"),children:(0,r.jsx)(en.JO,{type:"pencil",useWithFillCurrentColor:!0,size:16,"aria-hidden":!0})})})},ei=n(70442),ea=n(3697),es=n(90926),el=n(98363),ec=n(25820);function eu(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var ed=function(e){var t=e.member,n=e.onSendMessageClick,o=e.isFullPageProfile,a=void 0!==o&&o,l=e.shouldHideMessageButton,c=e.shouldAutoNavigate,u=void 0===c||c,d=(0,es.pB)().findOrCreateChatRoom,f=(0,ei.k6)(),m=(0,ec.w)({memberPublicId:t.public_id,member:t,isFullPageProfile:a,shouldHideMessageButton:void 0!==l&&l}),b=m.shouldShowEditProfileButton,h=m.onClickOpenEditProfileDrawer,v=m.handleCopyProfileLink,y=m.shouldShowMemberChatIcon,g=function(e){var t;return(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,d({kind:ea.g8,community_member_ids:[e]})];case 1:return t=r.sent(),u&&f.push((0,F.co)({url:(0,F.so)({uuid:t})})),n(t),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){eu(i,r,o,a,s,"next",e)}function s(e){eu(i,r,o,a,s,"throw",e)}a(void 0)})})()};return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-6",children:[(0,r.jsx)(el.s,{name:null==t?void 0:t.name,size:"16",src:null==t?void 0:t.avatar_url}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j.Z.TitleSm,{weight:"font-bold",textAlign:"text-center",children:null==t?void 0:t.name}),(0,r.jsx)(j.Z.BodySm,{textAlign:"text-center",children:null==t?void 0:t.headline})]}),(0,p.cT)(t)&&(0,r.jsx)(x.m,{limit:1/0,memberTags:t.member_tags}),y&&(0,r.jsx)(ee.z,{full:!0,variant:"circle",onClick:function(){return g(t.id)},children:(0,s.t)("message")}),a&&(0,r.jsxs)("div",{className:i()("grid gap-2",{"grid-cols-2":b}),children:[(0,r.jsx)(ee.z,{full:!0,variant:"secondary-light",onClick:v,children:(0,s.t)("profile_drawer.dropdown.copy_profile_link")}),b&&(0,r.jsx)(ee.z,{full:!0,variant:"secondary-light",onClick:h,children:(0,s.t)("profile_drawer.dropdown.edit_member_profile")})]})]})},ef=n(44102),em=function(e){var t=e.member,n=e.large;return(0,r.jsx)(U.T,{placement:"bottom",content:(0,s.t)("post.share.view_as",{member_first_name:t.first_name}),interactive:!1,children:(0,r.jsx)(ee.z,{variant:"secondary",onClick:function(){return(0,ef.g)({entityId:t.id,entityType:"CommunityMember"}).then(function(e){return window.open(e.masquerade_url,"_self")}).catch(function(e){return console.error(e)})},"aria-label":(0,s.t)("post.share.view_as",{member_first_name:t.first_name}),large:n,"data-testid":"view-as-masquerade",className:i()({"!px-2.5":n}),children:(0,r.jsx)(en.JO,{type:"16-eye-open",size:16,useWithStrokeCurrentColor:!0,"aria-hidden":!0})})})},ep=function(e){var t=e.member,n=e.onSendMessageClick,o=e.isFullPageProfile,i=e.shouldHideMessageButton,a=e.shouldOpenInNewTab,s=(0,v.kK)(),l=(0,ec.w)({memberPublicId:t.public_id,member:t,isFullPageProfile:o,shouldHideMessageButton:i}),c=l.shouldShowEditProfileButton,u=l.onClickOpenEditProfileDrawer,d=l.shouldShowMemberChatIcon,f=l.canEditProfile,m=l.canViewOnlyMasquerade;return s?(0,r.jsx)(ed,{member:t,shouldAutoNavigate:!a,onSendMessageClick:n,shouldHideMessageButton:i,isFullPageProfile:o}):(0,r.jsxs)("div",{className:"profile-drawer__header",children:[(0,r.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,r.jsx)(G.sJ,{size:"24",src:t.avatar_url,name:t.name,isFullRounded:!0}),(0,r.jsx)("div",{className:"absolute -bottom-2 flex items-center gap-1",children:(0,r.jsx)(J,{member:t})})]}),(0,r.jsxs)("div",{className:"profile-drawer__header__info",children:[(0,r.jsx)("div",{children:(0,r.jsx)("h3",{className:"profile-drawer__header__name",children:t.name})}),(0,r.jsx)(K.T,{children:(0,r.jsxs)("div",{className:"profile-drawer__header__actions",children:[d&&(0,r.jsx)($.k,{communityMemberId:t.id,onClick:n,shouldAutoNavigate:!a,variant:m?"icon":"button"}),o?f&&(0,r.jsx)(eo,{toggleDrawer:u,memberId:t.public_id}):(0,r.jsx)(er,{member:t}),m&&(0,r.jsx)(em,{member:t}),c&&(0,r.jsx)(eo,{toggleDrawer:u,memberId:t.public_id})]})})]})]})},eb=n(45697),eh=n.n(eb),ev=n(88159),ey=n(85924),eg=n(51433),e_=n(78456),ex=n(80219),ej=function(e){var t=e.onClose,n=e.space,o=n.emoji,i=n.custom_emoji_url,a=n.custom_emoji_dark_url,l=n.hide_members_count,c=n.name,u=n.slug,d=n.member_count,f=n.is_private,m=n.show_lock_icon_for_non_members,p=n.is_space_member,b=e.shouldOpenInNewTab,h=(0,ey.TC)().currentAppearance,v=(0,H.wh)().currentCommunityMember,y=(0,e_.vb)(v),g=(0,eg.$)({shouldShowLockIconForNonMembers:m&&!p,isPrivate:f,isAdmin:y});return(0,r.jsxs)(M.rU,{to:(0,F._v)({spaceSlug:u}),onClick:function(e){return!(0,D.n2)(e)&&t()},className:"profile-spaces__item",target:b&&"_blank",children:[(0,r.jsx)(ex.S,{wrapperClassName:"profile-spaces__emoji self-start",className:"gated-or-not with-emoji",emoji:o,customEmojiUrl:i,customEmojiDarkUrl:a,appearance:h,shouldUseLockIcon:g,lockIcon:(0,r.jsx)("span",{className:"gated-or-not",children:(0,r.jsx)(en.JO,{type:"lock",useWithFillCurrentColor:!0,className:"text-dark"})})}),(0,r.jsxs)("div",{className:"profile-spaces__details",children:[(0,r.jsx)("p",{className:"profile-spaces__title",children:c}),!l&&(0,r.jsx)("p",{className:"profile-spaces__members",children:(0,s.t)("profiles.members",{count:d})})]})]})};ej.propTypes={space:eh().shape({emoji:eh().string,custom_emoji_url:eh().string,custom_emoji_dark_url:eh().string,name:eh().string.isRequired,slug:eh().string.isRequired,member_count:eh().number.isRequired,is_private:eh().bool.isRequired})};var ew=function(e){var t=e.memberPublicId,n=e.onClose,o=e.shouldOpenInNewTab,i=e.scrollableTarget,a=(0,ev.u)({memberPublicId:t}),s=a.spaces,l=a.isLoading,c=a.fetchNextPage,u=a.hasNextPage;return l?(0,r.jsx)(A.m,{}):s.length<1?(0,r.jsx)(T.Z,{title:I18n.t("profile_drawer.spaces.empty_state.title"),subtitle:I18n.t("profile_drawer.spaces.empty_state.subtitle")}):(0,r.jsx)("div",{className:"h-full overflow-auto",id:"profile-spaces-scrollable-target",children:(0,r.jsx)(N.Z,{scrollThreshold:.5,next:c,hasMore:u,loader:(0,r.jsx)(A.m,{}),dataLength:s.length,className:"profile-spaces",scrollableTarget:(void 0===i?"panel":i)||"profile-spaces-scrollable-target",children:s.map(function(e){return(0,r.jsx)(ej,{onClose:n,space:e,shouldOpenInNewTab:o},e.id)})})})};ew.propTypes={memberPublicId:eh().string.isRequired,onClose:eh().func.isRequired,shouldOpenInNewTab:eh().bool,scrollableTarget:eh().string};var eO={ABOUT:(0,s.t)("profile_tabs.about"),POSTS:(0,s.t)("profile_tabs.posts"),COMMENTS:(0,s.t)("profile_tabs.comments"),SPACES:(0,s.t)("profile_tabs.spaces")},eS=Object.values(eO).map(function(e){return{label:e}}),eP=function(e){var t=e.member,n=e.onClose,o=void 0===n?a.noop:n,s=e.onOpenMessaging,u=e.memberPublicId,d=e.isFullPageProfile,f=e.shouldOpenInNewTab,m=void 0!==f&&f,p=e.shouldHideMessageButton,b=e.shouldHideBadge,h=e.isRenderedOnRailBar,v=void 0!==h&&h,y=e.shouldFixTabsOnTop,g=t.comments_count,_=t.posts_count,x=t.spaces_count,j=void 0!==b&&b?eS:[{label:eO.ABOUT},{label:eO.POSTS,badge:{value:_}},{label:eO.COMMENTS,badge:{value:g}},{label:eO.SPACES,badge:{value:x}}],w=d?"panel":null;return(0,r.jsx)("div",{className:i()({"profile-full-page":d,"profile-drawer trix-v2":!d,"flex h-full":t.is_deleted}),children:t.is_deleted?(0,r.jsx)(l.d8,{}):(0,r.jsxs)(c.O.Group,{className:i()("flex flex-col !overflow-hidden",{"!h-[calc(100vh-50px)] md:!h-[calc(100vh-60px)]":!d&&!v,"!h-[calc(100dvh-24px)] md:!h-[calc(100vh-2.5rem-64px)]":v&&!d}),children:[(0,r.jsxs)("div",{className:i()({"sticky top-0 z-30":void 0!==y&&y}),children:[(0,r.jsx)(ep,{member:t,onSendMessageClick:d?a.noop:function(e){s?s(e):o()},isFullPageProfile:d,shouldHideMessageButton:void 0!==p&&p,shouldOpenInNewTab:m}),(0,r.jsx)("div",{className:"border-primary bg-primary border-b px-6",children:(0,r.jsx)(c.O.List,{children:Object.values(j).map(function(e){return(0,r.jsxs)(c.O,{className:"text-sm",children:[e.label,(0,r.jsx)(c.O.Counter,{children:e.badge&&e.badge.value>0&&e.badge.value})]},e.label)})})})]}),(0,r.jsxs)(c.O.Panels,{className:i()({"h-full grow":!d}),children:[(0,r.jsx)(c.O.Panel,{children:(0,r.jsx)(k,{member:t})}),(0,r.jsx)(c.O.Panel,{children:(0,r.jsx)(W,{memberPublicId:u,onClose:d?a.noop:o,shouldOpenInNewTab:m,scrollableTarget:w})}),(0,r.jsx)(c.O.Panel,{children:(0,r.jsx)(z,{memberPublicId:u,member:t,onClose:d?a.noop:o,shouldOpenInNewTab:m,scrollableTarget:w})}),(0,r.jsx)(c.O.Panel,{children:(0,r.jsx)(ew,{memberPublicId:u,onClose:d?a.noop:o,shouldOpenInNewTab:m,scrollableTarget:w})})]})]})})};eP.displayName="Profile"},25820:function(e,t,n){n.d(t,{w:()=>d});var r=n(20640),o=n.n(r),i=n(84326),a=n(41342),s=n(13532),l=n(14598),c=n(32701),u=n(60878),d=function(e){var t=e.member,n=e.memberPublicId,r=e.isFullPageProfile,d=e.shouldHideMessageButton,f=(0,u.pm)().success,m=(0,s.zd)({public_uid:n}),p=(0,l.H)(),b=p.showOwnProfileEdit,h=p.showMemberProfileEdit,v=(0,a.wh)().currentCommunityMember,y=(null==v?void 0:v.id)==(null==t?void 0:t.id),g=null==v?void 0:v.is_admin,_=!(void 0!==r&&r)&&!(null==t?void 0:t.is_deleted)&&(y||g),x=(0,c.L7)();return{shouldShowEditProfileButton:_,onClickOpenEditProfileDrawer:function(){g?h({member:t}):y&&b()},handleCopyProfileLink:function(){o()(window.location.origin+m),f((0,i.t)("post.share.link_copied"),{duration:"short",shouldUseProgress:!1})},shouldShowMemberChatIcon:!(void 0!==d&&d)&&!(null==t?void 0:t.is_deleted)&&!y&&(null==v?void 0:v.messaging_enabled)&&(t.messaging_enabled||g&&!t.admin)&&x,canEditProfile:!(null==t?void 0:t.is_deleted)&&g,canViewOnlyMasquerade:g&&(null==v?void 0:v.id)!==t.id}}},72634:function(e,t,n){n.d(t,{T:()=>c});var r=n(88767),o=n(84326),i=n(60878),a=n(42480),s=n(93228);function l(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var c=function(e){var t=e.memberPublicUid,n=e.memberName,c=(0,i.pm)(),u=(0,r.useQueryClient)(),d=(0,a.K)({onSuccess:function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,(0,s._)(u,null!=t?t:"")];case 1:return e.sent(),c.success((0,o.t)("profile_drawer.connect_banner.messages.connection_accepted",{memberName:n})),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){c.error((0,o.t)("profile_drawer.connect_banner.messages.connection_accept_error"))}});return{acceptConnectionForUser:d.mutate,isAccepting:d.isLoading}}},92957:function(e,t,n){n.d(t,{E:()=>c});var r=n(88767),o=n(84326),i=n(60878),a=n(67146),s=n(93228);function l(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var c=function(e){var t=e.memberPublicUid,n=(0,i.pm)(),c=(0,r.useQueryClient)(),u=(0,a.k)({onSuccess:function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,(0,s._)(c,null!=t?t:"")];case 1:return e.sent(),n.success((0,o.t)("profile_drawer.connect_banner.messages.connection_ignored")),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){n.error((0,o.t)("profile_drawer.connect_banner.messages.connection_ignore_error"))}});return{ignoreConnectionForUser:u.mutate,isIgnoring:u.isLoading}}},93228:function(e,t,n){n.d(t,{_:()=>a});var r=n(81261),o=n(8054);function i(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var a=function(e,t){var n;return(n=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:return[4,Promise.all([e.invalidateQueries([o.Wx,t,{page_name:r.$q.PROFILE_VIEW}]),e.invalidateQueries("community-members"),e.invalidateQueries("audience")])];case 1:return n.sent(),[2]}})},function(){var e=this,t=arguments;return new Promise(function(r,o){var a=n.apply(e,t);function s(e){i(a,r,o,s,l,"next",e)}function l(e){i(a,r,o,s,l,"throw",e)}s(void 0)})})()}},78188:function(e,t,n){n.d(t,{t:()=>o});var r=n(85893),o=function(){return(0,r.jsxs)("div",{className:"border-primary rounded-xl border px-5 pt-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"bg-tertiary h-10 w-10 animate-pulse rounded-full"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"bg-tertiary h-5 w-36 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-3 w-20 animate-pulse rounded-md duration-300"})]})]}),(0,r.jsxs)("div",{className:"mb-5 mt-10 space-y-3",children:[(0,r.jsx)("div",{className:"bg-tertiary h-3 w-full animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-3 w-full animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-3 w-64 animate-pulse rounded-md duration-300"})]}),(0,r.jsxs)("div",{className:"border-primary -mx-5 flex h-12 items-center justify-between space-x-2 border-t px-5",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"bg-tertiary h-6 w-6 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-6 w-6 animate-pulse rounded-md duration-300"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"bg-tertiary h-6 w-12 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-6 w-16 animate-pulse rounded-md duration-300"})]})]})]})}},82942:function(e,t,n){n.d(t,{J:()=>a});var r=n(85893),o=n(94184),i=n.n(o),a=function(e){var t=e.isFullPageView;return(0,r.jsx)("div",{className:i()("border-primary col-span-full w-full overflow-auto border-r p-4 md:col-span-4",{"!md:w-1/3":t}),children:(0,r.jsxs)("div",{className:"flex flex-col items-center py-9",children:[(0,r.jsx)("div",{className:"bg-tertiary h-24 w-24 animate-pulse rounded-full duration-300"}),(0,r.jsxs)("div",{className:"mt-7 flex flex-col items-center space-y-1.5",children:[(0,r.jsx)("div",{className:"bg-tertiary h-4 w-32 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-4 w-48 animate-pulse rounded-md duration-300"})]}),(0,r.jsxs)("div",{className:"mt-4 flex flex-col items-center space-y-2",children:[(0,r.jsx)("div",{className:"bg-tertiary h-6 w-56 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-5 w-32 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-5 w-24 animate-pulse rounded-md duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-5 w-44 animate-pulse rounded-md duration-300"})]}),(0,r.jsxs)("div",{className:"mt-8 flex items-center justify-between space-x-3",children:[(0,r.jsx)("div",{className:"bg-tertiary h-[34px] w-24 animate-pulse rounded-full duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-[34px] w-[34px] animate-pulse rounded-full duration-300"})]})]})})}},39265:function(e,t,n){n.d(t,{y:()=>o});var r=n(85893),o=function(){return(0,r.jsxs)("div",{className:"mb-6 flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"bg-tertiary w-18 h-[38px] animate-pulse rounded-full duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary w-18 h-[38px] animate-pulse rounded-full duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-[38px] w-[106px] animate-pulse rounded-full duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-[38px] w-[84px] animate-pulse rounded-full duration-300"}),(0,r.jsx)("div",{className:"bg-tertiary h-[38px] w-[90px] animate-pulse rounded-full duration-300"})]})}},50175:function(e,t,n){n.d(t,{o:()=>tt});var r=n(85893),o=n(67294),i=n(94184),a=n.n(i),s=n(96486),l=n(84326),c=n(19323),u=n(37840),d=n(23782),f=n(6193),m=n(24650),p=n(28601),b=n(54503),h=n(56918),v=n(81261),y=n(32589),g=n(13847),_=n(17617),x=n(35565),j=n(46272),w=n(4320),O=n(23386),S=n(41553),P=function(e){var t,n=e.member,o=(0,b.Y)({enabled:!!(null==n?void 0:n.id),member_ids:[null==n?void 0:n.id]}).data,i=null==o?void 0:o[0],a=!(0,s.isEmpty)(n.email),c=(0,w.a)(),P=(0,w.R)(),C=(0,g.rV)(),I=(0,y.V)(),k=(0,_.kK)(),N=null==(t=n.member_tags)?void 0:t.filter(function(e){var t;return(null==e?void 0:e.is_public)&&(null==e||null==(t=e.display_locations)?void 0:t.profile_page)}),A=(null==N?void 0:N.length)>0,E=a&&!I;return(0,r.jsxs)("div",{className:"text-dark px-0 py-4 text-sm",children:[i&&(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)(u.U,{level:i.current_level,levelName:i.current_level_name}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(S.Z.LabelXs,{weight:"regular",color:"text-light",children:(0,l.t)("leaderboard.n_points",{count:i.total_points})}),(0,r.jsx)(S.Z.LabelXs,{weight:"regular",color:"text-light",children:(0,l.t)("separator_dot")}),(0,r.jsx)(S.Z.LabelXs,{weight:"regular",color:"text-light",children:(0,l.t)("leaderboard.n_to_level_up",{count:i.points_to_next_level})})]})]}),!c&&n.bio&&(0,r.jsx)(p.$,{dataTestId:"biography-section",title:(0,l.t)("profile_drawer.biography"),children:(0,r.jsx)(f.C,{info:n.bio,dataTestId:"profile-member-bio"})}),(E||n.location)&&(0,r.jsxs)(p.$,{dataTestId:"profile-info-section",children:[E&&(0,r.jsx)(f.C,{iconType:"at-symbol",info:n.email,dataTestId:"profile-member-email"}),!c&&(0,r.jsx)(f.C,{iconType:"map-pin",iconProps:{viewBox:"0 0 14 18"},info:n.location,dataTestId:"profile-member-location"})]}),C&&(0,r.jsx)(p.$,{dataTestId:"activity-score-section",children:(0,r.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,r.jsx)(S.Z.LabelSm,{weight:"semibold",children:(0,l.t)("activity_score.activity_score_title")}),(0,r.jsx)(x.XR,{ids:[n.id],children:(0,r.jsx)(h.z,{memberId:n.id})})]})}),A&&!k&&(0,r.jsx)(p.$,{title:(0,l.t)("profile_drawer.tags"),children:(0,r.jsx)("div",{className:"profile-drawer__about__tags",children:(0,r.jsx)(O.m,{limit:1/0,memberTags:N})})}),P&&(0,r.jsx)(p.$,{title:(0,l.t)("profile_fields.upgrade_flow.title"),children:(0,r.jsx)(j.I,{})}),!c&&(0,v.sR)(n)&&(0,r.jsxs)(p.$,{title:(0,l.t)("profile_drawer.social"),children:[(0,r.jsx)(m.o,{iconType:"globe",link:n.website_url}),(0,r.jsx)(m.o,{iconType:"facebook",link:n.facebook_url}),(0,r.jsx)(m.o,{iconType:"twitter",link:n.twitter_url}),(0,r.jsx)(m.o,{iconType:"linkedin",link:n.linkedin_url}),(0,r.jsx)(m.o,{iconType:"instagram",link:n.instagram_url})]}),c&&(0,r.jsx)(d.s,{profileFields:n.profile_fields})]})},C=n(31960),I=function(){var e=(0,C.E)().member;return(0,r.jsx)(P,{member:e})},k=n(58533),N=n(20624),A=n(77201);function E(e){var t=e.title,n=e.subtitle;return(0,r.jsxs)("div",{className:"profile-drawer__empty",children:[(0,r.jsx)("div",{className:"profile-drawer__empty__title",children:t}),(0,r.jsx)("div",{className:"profile-drawer__empty__subtitle",children:n})]})}var T=n(67142),M=n(43271),R=n(52928),D=n(93440),L=n(41084),F=n(13532),U=n(80171),B=n(91704),q=function(e){var t=e.comment,n=e.onClose,o=e.member,i=(0,M.default)(new Date(t.created_at),"MMM dd");return(0,r.jsxs)(R.rU,{to:(0,F.LM)({slug:t.post_slug,spaceSlug:t.space_slug})+"#comment_wrapper_".concat(t.id),onClick:n,className:"flex items-start space-x-3 py-5 first:pt-0",children:[(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)(T.sJ,{isFullRounded:!0,name:o.name,src:o.avatar_url,size:"10"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between space-x-2",children:[(0,r.jsxs)("div",{className:"text-default w-full flex-1 truncate text-sm",children:[(0,l.t)("profile_drawer.comments.commented_on")," ",(0,r.jsx)("span",{className:"text-darkest font-medium",children:t.post_name||t.post_truncated_content})]}),(0,r.jsx)("div",{children:(0,r.jsx)(U.T,{interactive:!1,content:(0,L.s4)(t.created_at),children:(0,r.jsx)("span",{className:"text-default text-sm",children:i})})})]}),"tiptap"===t.editor?(0,r.jsx)(D.G,{tiptapBody:t.tiptap_body},t.updated_at):(0,r.jsx)(B.P,{content:t.body_trix_content})]})]})},z=function(){var e=(0,C.E)(),t=e.member,n=e.onClose,o=(0,A.F)({memberPublicId:t.public_uid}),i=o.fetchNextPage,a=o.comments,s=o.hasNextPage;return o.isLoading?(0,r.jsx)(N.m,{}):a.length<1?(0,r.jsx)(E,{title:(0,l.t)("profile_drawer.comments.empty_state.title"),subtitle:(0,l.t)("profile_drawer.comments.empty_state.subtitle")}):(0,r.jsx)(k.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:i,hasMore:!!s,loader:(0,r.jsx)(N.m,{}),dataLength:a.length,scrollableTarget:eq,className:"divide-primary space-y-2 divide-y",children:a.map(function(e){return(0,r.jsx)(q,{onClose:function(){return null==n?void 0:n()},comment:e,member:t},e.id)})})},Z=n(30581),H=n(73384),V=n(41342),Q=n(88241),W=n(62025),G=function(){var e=(0,C.E)().member,t=(0,W.t)({memberPublicId:e.public_uid}),n=t.fetchNextPage,o=t.posts,i=t.data,a=t.hasNextPage,s=t.isLoading,c=t.onPostChange;if(s)return(0,r.jsx)(N.m,{});if(o.length<1)return(0,r.jsx)(E,{title:(0,l.t)("profile_drawer.posts.empty_state.title"),subtitle:(0,l.t)("profile_drawer.posts.empty_state.subtitle")});var u=null==i?void 0:i.pages.map(function(e){return e.records.map(function(e){return e.id})});return(0,r.jsx)(Q._x,{perPagePostIds:u,children:(0,r.jsx)(H.Fk,{hasNextPage:!!a,children:(0,r.jsx)(k.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:n,hasMore:!!a,loader:(0,r.jsx)(N.m,{}),dataLength:o.length,scrollableTarget:eq,className:"space-y-2",children:o.map(function(e){return(0,r.jsx)(V.mE,{spaceId:e.space_id,children:(0,r.jsx)(Z.Y,{onPostChange:c,post:e,shouldForceSamePageInteractions:!1,usedIn:"profile-modal",className:"!rounded-2xl"},e.id)},e.id)})})})})},$=n(74776),K=n(23855),J=n(88767),X=n(93199),Y=n(95533),ee="rewards",et=function(e){var t,n,r=(0,J.useInfiniteQuery)([ee,e],function(t){var n,r=t.pageParam;return n=void 0===r?1:r,(0,X.UT)(Y.a.gamification.pointAwards({params:{member_id:e,page:n}}))},{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),i=(0,o.useMemo)(function(){var e,t;return r.isLoading?[]:(0,s.uniqBy)((0,s.flatten)(null!=(t=null==(e=r.data)?void 0:e.pages.map(function(e){return e.records}))?t:[]),function(e){return"".concat(e.id,"-").concat(e.event_name)})},[r.data]);return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},r),n=n={rewards:i},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t},en=function(e){var t=e.pointAwardId,n=(0,J.useQueryClient)();return(0,J.useMutation)({mutationFn:function(){return(0,X.pC)(Y.a.gamification.revokePointAward({pointAwardId:t}))},onSuccess:function(){n.invalidateQueries({queryKey:[ee]})}})},er=n(78456),eo=n(34870),ei=n(57363),ea=n(60878),es=n(43544),el=n(39905),ec=n(34519),eu="profile_drawer.rewards",ed=function(e){var t=e.isOpen,n=e.onClose,o=e.onConfirm,i=e.points,a=e.isLoading;return(0,r.jsxs)(ec.u_,{isOpen:t,onClose:n,children:[(0,r.jsx)(ec.u_.Overlay,{}),(0,r.jsxs)(ec.u_.Content,{size:"md",children:[(0,r.jsx)(ec.u_.Header,{children:(0,r.jsx)(ec.u_.Title,{children:(0,l.t)("".concat(eu,".revoke_confirmation.title"))})}),(0,r.jsx)(ec.u_.Body,{children:(0,r.jsx)("div",{className:"flex flex-col gap-4",children:(0,r.jsx)(S.Z.BodyMd,{color:"text-default",children:(0,l.t)("".concat(eu,".revoke_confirmation.description"),{points:Math.abs(i)})})})}),(0,r.jsx)(ec.u_.Footer,{children:(0,r.jsxs)("div",{className:"flex justify-end gap-x-3",children:[(0,r.jsx)(el.z,{variant:"secondary",onClick:n,children:(0,l.t)("cancel")}),(0,r.jsx)(el.z,{onClick:o,disabled:a,children:(0,l.t)("".concat(eu,".revoke_confirmation.confirm"))})]})})]})]})};function ef(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var em="profile_drawer.rewards",ep=function(e){var t,n=e.reward,i=(0,V.wh)().currentCommunityMember,a=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return ef(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ef(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],c=a[1],u=(0,ea.pm)(),d=n.points,f=n.triggered_at,m=n.reason,p=n.id,b=n.event_name,h=n.revoked,v=(0,K.default)(f),y=(0,eo.w)({dateTime:v,format:eo.f.short_month_and_date_with_year}),g=en({pointAwardId:p}),_=g.mutate,x=g.isLoading,j="gamification.member.points_revoked"===b,w=(0,er.vb)(i);return(0,r.jsxs)("div",{className:"border-primary mt-3 flex items-center justify-between border-b pb-3 pt-2 first:mt-0 last:border-b-0",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("div",{children:(0,r.jsx)(S.Z.LabelSm,{weight:"semibold",color:"text-dark",children:(0,l.t)("".concat(em,".n_points"),{points:j?"-"+d:"+"+d})})}),(0,r.jsxs)("div",{className:"text-default flex items-center gap-1",children:[(0,r.jsx)("div",{children:(0,r.jsx)(S.Z.LabelSm,{weight:"regular",color:"text-default",children:(0,l.t)("".concat(em,".").concat(j?"revoked":"rewarded"),{date:y})})}),n.reason&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-[10px]",children:(0,l.t)("separator_dot")}),(0,r.jsx)(S.Z.LabelSm,{weight:"regular",color:"text-default",children:m})]})]})]}),!j&&!h&&w&&(0,r.jsx)(es.Lt,{buttonClassName:"flex items-center h-9 w-9 flex justify-center !rounded-lg p-1 transition-colors duration-150 hover:bg-tertiary focus-visible:outline-secondary focus-visible:rounded-lg focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:bg-tertiary",button:(0,r.jsx)(ei.JO,{className:"text-default",type:"20-menu-dots-horizontal",size:20,"aria-label":(0,l.t)("".concat(em,".actions"))}),children:(0,r.jsx)(es.Lt.ItemLink,{onClick:function(){return c(!0)},forceClose:!0,children:(0,l.t)("".concat(em,".revoke_points"))})}),(0,r.jsx)(ed,{isOpen:s,onClose:function(){return c(!1)},onConfirm:function(){_(void 0,{onSuccess:function(){u.success((0,l.t)("".concat(em,".revoke_success"))),c(!1)},onError:function(){u.error((0,l.t)("".concat(em,".revoke_error")))}})},points:d,isLoading:x})]})},eb=function(){var e=et((0,C.E)().member.id),t=e.rewards,n=e.fetchNextPage,o=e.hasNextPage;return e.isLoading?(0,r.jsx)(N.m,{}):t.length<1?(0,r.jsx)($.Z,{title:(0,l.t)("profile_drawer.rewards.empty_state.title"),subtitle:(0,l.t)("profile_drawer.rewards.empty_state.subtitle")}):(0,r.jsx)(k.Z,{style:{overflow:"initial"},scrollThreshold:.5,next:n,hasMore:!!o,loader:(0,r.jsx)(N.m,{}),dataLength:t.length,scrollableTarget:eq,children:t.map(function(e){return(0,r.jsx)(ep,{reward:e},e.id+e.event_name)})})},eh=n(88159),ev=n(85924),ey=n(51433),eg=n(82859),e_=n(80219),ex=function(e){var t=e.onClose,n=e.space,o=n.emoji,i=n.custom_emoji_url,a=n.custom_emoji_dark_url,s=n.hide_members_count,c=n.name,u=n.slug,d=n.member_count,f=n.is_private,m=n.show_lock_icon_for_non_members,p=n.is_space_member,b=(0,ev.TC)().currentAppearance,h=(0,V.wh)().currentCommunityMember,v=(0,er.vb)(h),y=(0,ey.$)({shouldShowLockIconForNonMembers:m&&!p,isPrivate:f,isAdmin:v});return(0,r.jsxs)(R.rU,{to:(0,F._v)({spaceSlug:u}),onClick:function(e){return!(0,eg.n2)(e)&&t()},className:"hover:bg-secondary bg-primary flex items-center space-x-3 rounded-md px-4 py-3.5",children:[(0,r.jsx)(e_.S,{wrapperClassName:"profile-spaces__emoji self-start",className:"gated-or-not with-emoji",emoji:o,customEmojiUrl:i,customEmojiDarkUrl:a,appearance:b,shouldUseLockIcon:y,lockIcon:(0,r.jsx)("span",{className:"gated-or-not",children:(0,r.jsx)(ei.JO,{type:"lock",useWithFillCurrentColor:!0,className:"text-dark"})})}),(0,r.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,r.jsx)("span",{className:"text-darkest leading-none",children:(0,r.jsx)(S.Z.LabelMd,{weight:"semibold",children:c})}),!s&&(0,r.jsx)("span",{className:"text-light leading-none",children:(0,r.jsx)(S.Z.LabelSm,{children:(0,l.t)("profiles.members",{count:d})})})]})]})},ej=function(){var e=(0,C.E)(),t=e.member,n=e.onClose,o=(0,eh.u)({memberPublicId:t.public_uid}),i=o.spaces,a=o.isLoading,s=o.fetchNextPage,c=o.hasNextPage;return a?(0,r.jsx)(N.m,{}):i.length<1?(0,r.jsx)(E,{title:(0,l.t)("profile_drawer.spaces.empty_state.title"),subtitle:(0,l.t)("profile_drawer.spaces.empty_state.subtitle")}):(0,r.jsx)(k.Z,{scrollThreshold:.5,next:s,hasMore:!!c,loader:(0,r.jsx)(N.m,{}),dataLength:i.length,scrollableTarget:eq,children:i.map(function(e){return(0,r.jsx)(ex,{onClose:function(){return null==n?void 0:n()},space:e},e.id)})})},ew=n(86976),eO=n(96354),eS=n(16026),eP=function(){return(0,r.jsxs)(el.z,{variant:"secondary",disabled:!0,className:"flex items-center gap-x-2",children:[(0,r.jsx)(ei.JO,{type:"check",viewBox:"0 0 16 16"}),(0,l.t)("profile_drawer.connect_banner.states.active")]})},eC=n(16384),eI=n(93228);function ek(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var eN=function(e){var t=e.member,n=(0,ea.pm)(),o=(0,J.useQueryClient)(),i=(0,eC.s)({onSuccess:function(){var e;return(e=function(){var e;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,(0,eI._)(o,null!=(e=t.public_uid)?e:"")];case 1:return r.sent(),n.success((0,l.t)("profile_drawer.connect_banner.messages.connection_created")),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){ek(i,r,o,a,s,"next",e)}function s(e){ek(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){n.error((0,l.t)("profile_drawer.connect_banner.messages.connection_creation_error"))}}),a=i.mutate,s=i.isLoading;return(0,r.jsx)(el.z,{variant:"secondary",onClick:function(){return a({memberId:t.id})},disabled:s,children:s?(0,r.jsx)(ei.JO,{type:"loader",viewBox:"0 0 16 16"}):(0,l.t)("profile_drawer.connect_banner.states.empty")})},eA=function(){return(0,r.jsxs)(el.z,{variant:"secondary",disabled:!0,className:"flex items-center gap-x-2",children:[(0,r.jsx)(ei.JO,{type:"16-clock",viewBox:"0 0 16 16"}),(0,l.t)("profile_drawer.connect_banner.states.pending")]})},eE=n(72634),eT=n(92957),eM=function(e){var t=e.memberPublicUid,n=e.memberName,o=e.connectionId,i=(0,eE.T)({memberPublicUid:t,memberName:n}),a=i.acceptConnectionForUser,s=i.isAccepting,c=(0,eT.E)({memberPublicUid:t}),u=c.ignoreConnectionForUser,d=c.isIgnoring;return(0,r.jsxs)("div",{className:"flex gap-x-2",children:[(0,r.jsx)(el.z,{variant:"secondary",onClick:function(){o&&u(o)},disabled:d||s,children:d?(0,r.jsx)(ei.JO,{type:"loader",viewBox:"0 0 16 16"}):(0,l.t)("profile_drawer.connect_banner.states.ignore")}),(0,r.jsx)(el.z,{variant:"primary",onClick:function(){o&&a(o)},disabled:s||d,children:s?(0,r.jsx)(ei.JO,{type:"loader",viewBox:"0 0 16 16"}):(0,l.t)("profile_drawer.connect_banner.states.accept")})]})},eR=function(e){var t=e.member,n=null==t?void 0:t.connection_to_current_community_member,o=(0,eS.N)(n),i=o.isEmpty,a=o.isCurrentUserSentConnection,s=o.isOtherUserSentConnection,l=o.isActive;return t.name&&t.public_uid?i?(0,r.jsx)(eN,{member:t}):l?(0,r.jsx)(eP,{}):a?(0,r.jsx)(eA,{}):s&&n?(0,r.jsx)(eM,{memberName:t.name,memberPublicUid:t.public_uid,connectionId:n.id.toString()}):null:null},eD=function(e){var t=null==e?void 0:e.connection_to_current_community_member;return t&&"detached"!==t.status&&"ignored"!==t.status&&"withdrawn"!==t.status?(null==t?void 0:t.status)==="active"?(0,l.t)("profile_drawer.connect_banner.description.connected",{date:(0,eo.w)({dateTime:new Date(e.connection_to_current_community_member.created_at),format:eo.f.long_date})}):(null==t?void 0:t.status)==="pending"?t.initiator.id===e.id?(0,l.t)("profile_drawer.connect_banner.description.received",{memberName:e.first_name}):(0,l.t)("profile_drawer.connect_banner.description.sent",{memberName:e.first_name}):"":(0,l.t)("profile_drawer.connect_banner.description.default",{memberName:e.first_name})},eL=function(){var e,t,n=(0,C.E)().member,o=(0,V.wh)().currentCommunityMember;return(0,r.jsx)("div",{className:"border-primary mb-7 flex h-16 w-full items-center rounded-2xl border shadow-md",children:(0,r.jsxs)("div",{className:"flex w-full items-center gap-4 px-5 py-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-9 w-9 overflow-hidden rounded-full",children:(0,r.jsx)(T.sJ,{size:"9",name:null!=(e=null==n?void 0:n.name)?e:"",src:null==n?void 0:n.avatar_url})}),(0,r.jsx)("div",{className:"relative z-10 -ml-3 flex h-10 w-10 items-center justify-center overflow-hidden rounded-full bg-white",children:(0,r.jsx)("div",{className:"h-9 w-9 overflow-hidden rounded-full",children:(0,r.jsx)(T.sJ,{size:"9",name:null!=(t=null==o?void 0:o.name)?t:"",src:null==o?void 0:o.avatar_url})})})]}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col justify-center",children:[(0,r.jsx)(S.Z.LabelSm,{weight:"semibold",children:(0,l.t)("profile_drawer.connect_banner.title")}),(0,r.jsx)(S.Z.BodyXs,{children:eD(n)})]}),(0,r.jsx)(eR,{member:n})]})})},eF=function(e){var t=e.title,n=e.isActive,o=e.onClick,i=e.count;return(0,r.jsx)("button",{type:"button",className:a()("bg-primary border-primary hover:bg-secondary focus-visible:outline-secondary text-darkest cursor-pointer rounded-full border px-4 py-2 text-sm transition-colors duration-75 focus-visible:rounded-full focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",{"border-secondary":n}),onClick:o,children:(0,r.jsxs)(S.Z.LabelSm,{color:"text-darkest",weight:"medium",children:[t,(0,s.isNumber)(i)&&i>0&&(0,r.jsx)("span",{className:"ml-1",children:i})]})})};function eU(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eB=["posts","comments","spaces","about","rewards"],eq="profile-scrollable-target",ez=function(){var e,t=(0,C.E)(),n=t.member,i=t.isFullPageView,u=(0,V.wh)().currentCommunityMember,d=(e=(0,o.useState)("about"),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return eU(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eU(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=d[0],m=d[1],p=(0,ew.c8)().data,b=(0,c.y)(),h=(null==u?void 0:u.id)===n.id,v=(0,er.vb)(u),y=(h||(null==p?void 0:p.is_member_rewards_tab_public)||v)&&(null==p?void 0:p.enabled),g=(0,eO.t)().tab;return(0,o.useEffect)(function(){(0,s.isString)(g)&&-1!==eB.findIndex(function(e){return e===g})&&m(g)},[g]),(0,r.jsxs)("div",{className:a()("bg-primary flex flex-col overflow-auto",{"!md:pl-14 w-full p-4 !pl-8 md:w-2/3 md:p-8":i,"col-span-12 p-8 md:col-span-8":!i}),children:[b&&!h&&(0,r.jsx)(eL,{}),(0,r.jsxs)("div",{className:"mb-2 flex items-center space-x-2 overflow-x-auto pb-4","data-testid":"tab-list",children:[(0,r.jsx)(eF,{onClick:function(){return m("about")},title:(0,l.t)("profile_drawer.about"),isActive:"about"===f}),(0,r.jsx)(eF,{onClick:function(){return m("posts")},title:(0,l.t)("profile_drawer.posts.title"),isActive:"posts"===f,count:n.posts_count}),(0,r.jsx)(eF,{onClick:function(){return m("comments")},title:(0,l.t)("profile_drawer.comments.title"),isActive:"comments"===f,count:n.comments_count}),(0,r.jsx)(eF,{onClick:function(){return m("spaces")},title:(0,l.t)("profile_drawer.spaces.title"),isActive:"spaces"===f,count:n.spaces_count}),y&&(0,r.jsx)(eF,{onClick:function(){return m("rewards")},title:(0,l.t)("profile_drawer.rewards.title"),isActive:"rewards"===f})]}),(0,r.jsx)("div",{id:eq,className:"flex-1 overflow-auto pb-6","data-testid":"profile-modal-tab-content",children:(0,r.jsx)({posts:G,comments:z,spaces:ej,about:I,rewards:y?eb:function(){return null}}[f],{})})]})},eZ=n(9397),eH=n(56993),eV=n(70442),eQ=n(61853),eW=n(44102),eG=n(25820),e$=n(60622),eK=n(90926),eJ=n(3697),eX=function(e){var t=e.actions;return(0,r.jsx)(es.Lt,{size:"large",button:(0,r.jsx)(el.z,{type:"button",variant:"secondary","data-testid":"actions-dropdown-button",className:"!px-2.5",large:!0,children:(0,r.jsx)(ei.JO,{type:"16-menu-dots-horizontal",size:16,useWithFillCurrentColor:!0})}),menuButtonEl:"div",children:t.map(function(e){return(0,r.jsx)(es.Lt.ItemWithLink,{linkType:"button",onClick:e.onClick,"data-testid":e.testId,children:(0,r.jsxs)(es.Lt.IconContainer,{children:[(0,r.jsx)(ei.JO,{type:e.icon,size:16,className:"mr-2"}),(0,r.jsx)(S.Z.LabelSm,{weight:"regular",color:"text-very-dark",children:e.label})]})},e.label)})})};function eY(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var e0=function(){var e=(0,C.E)(),t=e.member,n=e.onClose,o=(0,V.wh)(),i=o.isViewOnlyMasquerading,a=o.currentCommunityMember,c=(0,eK.pB)().findOrCreateChatRoom,u=(0,eQ.nC)().setLiveChatRoomUuid,d=(0,eV.k6)(),f=(0,eG.w)({memberPublicId:t.public_uid,member:t,isFullPageProfile:!1,shouldHideMessageButton:!1}),m=f.onClickOpenEditProfileDrawer,p=f.shouldShowMemberChatIcon,b=f.canEditProfile,h=f.canViewOnlyMasquerade,v=f.handleCopyProfileLink,y=t.id===(null==a?void 0:a.id),g=[];p&&g.push({label:(0,l.t)("message"),icon:"chat",onClick:i?s.noop:function(){var e;return(e=function(){var e;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,c({kind:eJ.g8,community_member_ids:[t.id]})];case 1:if(!(e=r.sent()))return[2];if(d.location.pathname.includes("/live"))return u(e),[2];return d.push((0,F.co)({url:(0,F.so)({uuid:e})})),null==n||n(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){eY(i,r,o,a,s,"next",e)}function s(e){eY(i,r,o,a,s,"throw",e)}a(void 0)})})()},isPrimary:!0,testId:"chat-button",variant:"primary"}),(y||b)&&g.push({label:(0,l.t)("profile_drawer.edit"),icon:"16-edit",onClick:m,isPrimary:!g.some(function(e){return e.isPrimary}),testId:"edit-profile-button",variant:g.some(function(e){return e.isPrimary})?"secondary":"primary"}),h&&g.push({label:(0,l.t)("post.share.view_as",{member_first_name:t.first_name}),icon:"16-eye-open",onClick:function(){(0,eW.g)({entityId:t.id,entityType:"CommunityMember"}).then(function(e){return window.open(e.masquerade_url,"_self")}).catch(function(e){return console.error(e)})},testId:"view-only-masquerade-button"}),g.push({label:(0,l.t)("post.share.copy_link_to_profile"),icon:"16-link",onClick:v,testId:"copy-profile-link-button"});var _=g.find(function(e){return e.isPrimary}),x=g.filter(function(e){return!e.isPrimary});return(0,r.jsx)(e$.T,{children:(0,r.jsxs)("div",{className:"flex space-x-3",children:[_&&(0,r.jsx)(el.z,{variant:_.variant,onClick:_.onClick,"aria-label":_.label,"data-testid":_.testId,large:!0,children:_.label}),x.length>0&&(1===x.length?(0,r.jsx)(el.z,{variant:"secondary",onClick:x[0].onClick,"aria-label":x[0].label,"data-testid":x[0].testId,large:!0,className:"!px-2.5",children:(0,r.jsx)(ei.JO,{type:x[0].icon,size:16,useWithFillCurrentColor:!0})}):(0,r.jsx)(eX,{actions:x}))]})})},e1=function(e){var t=e.iconType,n=e.iconProps,o=e.info,i=e.dataTestId,s=e.className,l=e.iconClassName,c=e.color;return o?(0,r.jsxs)("div",{className:a()("flex items-start space-x-1.5 whitespace-pre-line [word-break:break-word]",void 0===s?"":s),"data-testid":i,children:[t?(0,r.jsx)(ei.JO,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({useWithFillCurrentColor:!0,className:void 0===l?"":l,type:t,size:16},void 0===n?{}:n)):null," ",(0,r.jsx)(S.Z.LabelSm,{color:void 0===c?"text-default":c,weight:"regular",children:o})]}):null},e2=n(85122),e3=n(8683),e4=function(){var e,t,n,o,i=(0,C.E)(),s=i.member,c=i.isLoading,u=(0,b.Y)({enabled:!c,member_ids:[null==s?void 0:s.id]}).data,d=null==u?void 0:u[0],f=null==s||null==(o=s.member_tags)?void 0:o.filter(function(e){var t;return(null==e?void 0:e.is_public)&&(null==e||null==(t=e.display_locations)?void 0:t.profile_page)}),m=(null==f?void 0:f.length)>0,p=(0,eH.O)(null==d?void 0:d.current_level);return(0,r.jsxs)("div",{className:a()("flex flex-col items-center px-4 py-9 pb-0",(e={},t=p.bgGradient,n=!!d,t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e)),"data-testid":"profile-modal-header",children:[(0,r.jsx)(eZ.i,{name:s.name,avatarUrl:s.avatar_url,size:"large",level:null==d?void 0:d.current_level,progress:null==d?void 0:d.level_progress}),(0,r.jsxs)("div",{className:"mt-4 flex flex-col items-center space-y-2 px-4 text-center",children:[(0,r.jsx)(S.Z.LabelLg,{weight:"semibold",color:"text-dark","data-testid":"member-name",children:s.name}),s.last_seen_at&&(0,r.jsx)(e1,{iconType:"16-clock",info:(0,l.t)("profile_drawer.last_seen",{last_seen:(0,e3.TF)(s.last_seen_at)}),dataTestId:"profile-member-email",className:"text-light"}),(0,r.jsx)(e1,{iconType:"16-calendar",info:(0,l.t)("profile_drawer.member_since",{member_since:(0,e2.ie)(s.created_at,{month:"long",year:"numeric",day:"numeric"})}),dataTestId:"profile-member-since",className:"text-light"})]}),m&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(O.m,{limit:1/0,memberTags:f,className:"justify-center"})}),(0,r.jsx)("div",{className:"mt-7",children:(0,r.jsx)(e0,{})})]})},e6=function(){var e=(0,C.E)(),t=e.isLoading,n=e.isFullPageView;return t?null:(0,r.jsx)("div",{className:a()("border-primary bg-primary overflow-auto border-r",n?"w-full md:w-1/3":"col-span-full md:col-span-4"),children:(0,r.jsx)(e4,{})})},e8=n(37538),e5=n(78188),e9=n(82942),e7=n(39265),te=function(e){var t=e.isFullPageView;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e9.J,{isFullPageView:t}),(0,r.jsxs)("div",{className:a()("col-span-12 flex flex-col overflow-auto px-4 pb-9 md:col-span-8 md:p-8",{"!md:pl-14 pl-4":t}),children:[(0,r.jsx)(e7.y,{}),(0,r.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,r.jsx)(e5.t,{}),(0,r.jsx)(e5.t,{}),(0,r.jsx)(e5.t,{}),(0,r.jsx)(e5.t,{})]})]})]})},tt=function(e){var t=e.member,n=e.isLoading,o=e.isFullPageView,i=e.onClose;return(0,r.jsx)(C.w,{isFullPageView:void 0!==o&&o,member:t,isLoading:n,onClose:i,children:t?t.is_deleted?(0,r.jsx)(e8.d,{wrapperClassName:"text-dark col-span-full"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e6,{}),(0,r.jsx)(ez,{})]}):(0,r.jsx)(te,{})})}},31960:function(e,t,n){n.d(t,{E:()=>s,w:()=>l});var r=n(85893),o=n(67294),i=n(96486),a=(0,o.createContext)({member:null,isLoading:!0,isFullPageView:!1,onClose:function(){}});a.displayName="ProfileContext";var s=function(){return(0,o.useContext)(a)},l=function(e){var t=e.member,n=e.isFullPageView,o=e.isLoading,s=e.children,l=e.onClose,c=void 0===l?i.noop:l;return(0,r.jsx)(a.Provider,{value:{member:t,isLoading:o,isFullPageView:void 0!==n&&n,onClose:c},children:s})}},19614:function(e,t,n){n.d(t,{M:()=>m});var r=n(85893),o=n(67294),i=n(31736),a=n(96486),s=n(97762),l=n(15953),c=n(84326),u=n(57363),d=n(39905);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){var t,n=e.cancelButtonText,m=void 0===n?(0,c.t)("quick_post.scheduled_post_ui.cancel"):n,p=e.children,b=e.className,h=e.datePickerVisible,v=e.enableTime,y=void 0===v||v,g=e.minDate,_=void 0===g?new Date:g,x=e.onCancel,j=e.onClickOutside,w=e.onSave,O=e.placement,S=e.saveButtonVariant,P=e.value,C=(t=(0,o.useState)(P),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return f(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),I=C[0],k=C[1];return(0,r.jsx)(i.ZP,{placement:void 0===O?"top-end":O,className:b,onClickOutside:j,content:(0,r.jsxs)("div",{className:"bg-primary border-primary rounded-lg border shadow-xl",style:{maxWidth:"284px"},children:[(0,r.jsx)(l.default,{options:{enableTime:y,dateFormat:y?"F d, Y G:i K":"F d, Y",disableMobile:!0,inline:!0,altInput:!0,altInputClass:"hidden",minDate:_,animate:!1,prevArrow:(0,s.renderToString)((0,r.jsx)(u.JO,{type:"20-chevron-left",size:20})),nextArrow:(0,s.renderToString)((0,r.jsx)(u.JO,{type:"20-chevron-right",size:20})),minuteIncrement:y?1:void 0},value:P,onValueUpdate:function(e){if((0,a.first)(e)){var t=e[0];y?k(t.toISOString()):k(new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),12,0,0)).toISOString())}}}),(0,r.jsxs)("div",{className:"border-primary flex gap-3 border-t px-5 py-3",children:[(0,r.jsx)(d.z,{type:"button",variant:"secondary",onClick:x,full:!0,children:m}),(0,r.jsx)(d.z,{type:"button",variant:void 0===S?"primary":S,disabled:!I,onClick:function(e){e&&e.preventDefault(),w(I)},full:!0,children:(0,c.t)("quick_post.scheduled_post_ui.save")})]})]}),visible:h,allowHTML:!0,interactive:!0,duration:0,arrow:!1,delay:0,theme:"modal-footer-actions",appendTo:"parent",children:(0,r.jsx)("div",{children:p})})}},69788:function(e,t,n){n.d(t,{Y:()=>ev});var r=n(85893),o=n(45697),i=n.n(o),a=n(96486),s=n(70442),l=n(84326),c=n(51630),u=n(3697),d=n(41084),f=n(83095),m=n(41342),p=n(51466),b=n(51169),h=n(60878),v=n(67294),y=n(52293),g=n(39905),_=function(e){var t=e.submitDisabled,n=e.post,o=e.isSubmitting,i=!!n.id,a=["quick_post","scheduled_post_ui"];a.push(o?"submitting_button":"submit_button"),n.status!==d.lv?a.push("publish_post"):a.push(i?"save":"post");var s=(0,l.t)(a.join("."));return(0,r.jsx)(g.z,{type:"submit",variant:"primary",disabled:t,children:s})};_.propTypes={post:i().object.isRequired,submitDisabled:i().bool.isRequired,isSubmitting:i().bool.isRequired};var x=n(60589),j=n(17617),w=n(94184),O=n.n(w),S=n(19614),P=n(24804),C=n(34870),I=n(57363),k=n(20220);function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var A=function(e){var t,n=e.publishedAt,o=e.updatePublishedAt,i=e.status,a=e.revertToDraftState,s=(t=(0,P.k)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,3)||function(e,t){if(e){if("string"==typeof e)return N(e,3);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}}(t,3)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=s[0],c=s[1],u=s[2],f=(0,v.useMemo)(function(){return n?(0,C.w)({dateTime:new Date(n),format:"date_time_with_short_timezone"}):null},[n]);return i!==d.W3?null:(0,r.jsx)(S.M,{value:n,datePickerVisible:l,onCancel:function(){event&&event.preventDefault(),u(!1)},onSave:function(e){o(e),u(!1)},children:(0,r.jsx)(k.C,{onButtonClick:function(e){e&&e.preventDefault(),c()},onClick:function(e){e&&e.preventDefault(),a(),u(!1)},children:(0,r.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(I.JO,{type:"16-calendar",className:"text-default",size:16}),(0,r.jsx)("span",{className:"font-medium",children:f})]})})})};A.propTypes={publishedAt:i().string,status:i().string.isRequired,updatePublishedAt:i().func.isRequired,revertToDraftState:i().func.isRequired};var E=n(5765);function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var M=function(e){var t,n=e.submitDisabled,o=e.isSubmitting,i=void 0!==o&&o,s=e.datepickerPlacement,c=void 0===s?"top":s,u=function(e){var t=["quick_post","scheduled_post_ui"];return t.push(i?"submitting_button":"submit_button"),t.push(e),(0,l.t)(t.join("."))},d={icon:"16-download",label:u("save_draft"),value:"draft"},f={icon:"16-calendar",label:u("schedule_post"),value:"scheduled"},m=[d,f,{icon:"16-publish",label:u("publish_post"),value:"published"}],p=(0,y.Gc)(),b=p.watch,h=p.setValue,v=b(),g=v.published_at,_=v.status,x=(t=(0,P.k)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,3)||function(e,t){if(e){if("string"==typeof e)return T(e,3);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}}(t,3)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),j=x[0],w=x[2],C=(0,a.find)(m,{value:_}),I=function(e){h("published_at",e)},k=function(e){(null==e?void 0:e.value)===f.value?w(!0):(h("status",null==e?void 0:e.value),w(!1),I(null))},N=function(){k(d)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A,{publishedAt:g,updatePublishedAt:I,status:_,revertToDraftState:N}),(0,r.jsx)(S.M,{datePickerVisible:j,onCancel:function(e){e&&e.preventDefault(),w(!1),_===f.value&&N()},value:g,onSave:function(e){I(e),h("status",f.value),w(!1)},className:O()({"-bottom-11":"top"===c,"-top-7":"bottom"===c}),children:j?(0,r.jsx)("span",{}):(0,r.jsx)(E.F,{type:"submit",disabled:void 0!==n&&n,selectedAction:C,setSelectedAction:k,options:m})})]})},R=function(e){var t=e.post,n=e.space,o=e.submitDisabled,i=e.isSubmitting,a=e.datepickerPlacement,s=!(0,j.Fs)()&&n&&(0,x.k8)(n)&&!(0,d.Hz)(t);return(0,r.jsx)(r.Fragment,{children:s?(0,r.jsx)(M,{submitDisabled:o,isSubmitting:i,datepickerPlacement:a}):(0,r.jsx)(_,{post:t,submitDisabled:o,isSubmitting:i})})};R.propTypes={post:i().object.isRequired,space:i().object,submitDisabled:i().bool.isRequired,isSubmitting:i().bool.isRequired,datepickerPlacement:i().string};var D="Are you sure you want to leave?",L=function(e){(0,v.useEffect)(function(){var t=function(t){e&&(t.preventDefault(),t.returnValue=D)},n=function(t){e&&!window.confirm(D)&&t.preventDefault()};return window.addEventListener("beforeunload",t),document.addEventListener("turbolinks:before-visit",n),function(){window.removeEventListener("beforeunload",t),document.removeEventListener("turbolinks:before-visit",n)}},[e])},F=n(12635),U=n(50420),B=n(93025),q=n(74343),z=n(73327),Z=n(17013),H=n(37919),V=n(6394),Q=n(5116),W=n(5521),G=function(e){var t=e.space,n=e.showAddCoverBtn,o=(0,(0,y.Gc)().watch)("id")?void 0:(0,W.k)();return(0,r.jsxs)("div",{className:"quickpost-modal__post-form",children:[(0,d.J4)(t)&&(0,r.jsx)("div",{className:"quickpost-modal__cover-image-container",children:(0,r.jsx)(V.D,{name:"cover_image",alt:"",showAddCoverBtn:n})}),(0,d.tp)(t)&&(0,r.jsx)("div",{className:"form-section__title-input",children:(0,r.jsx)(H.D,{ref:o,name:"name",autoComplete:"title",placeholder:(0,l.t)("quick_post_v2.title_placeholder"),maxLength:"255",size:"255",type:"text",id:"post_name",tabIndex:0})}),(0,r.jsx)("div",{className:"trix-content trix-content--post",children:(0,r.jsx)(Q.O,{ref:(0,d.tp)(t)?void 0:o,preventAccidentalLeave:!1,id:"post_body",name:"body",is_private_space:!1,space_id:t&&t.id,placeholder:(0,l.t)("quick_post_v2.body_placeholder"),tabIndex:0})})]})},$=n(27053),K=n(78456),J=n(13248),X=n(73262),Y=n(61641),ee=n(30889);function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function en(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var er=(0,v.forwardRef)(function(e,t){return(0,r.jsx)("textarea",en(et({},e),{ref:t}))});er.displayName="TextArea";var eo=(0,v.forwardRef)(function(e,t){return(0,r.jsx)("input",en(et({},e),{ref:t}))});eo.displayName="Input";var ei=function(e){var t=e.name,n=e.variant,o=e.label,i=void 0===o?"":o,a=e.description,s=void 0===a?"":a,l=e.autofocus,c=e.fullWidth;i=i||I18n.t("post.".concat(t)),s=s||I18n.t("post.".concat(t,"_description"));var u=(0,y.Gc)().register,d="post_".concat(t),f=eo;return"textarea"===(void 0===n?"":n)&&(f=er),(0,r.jsxs)("div",{className:w("form-group",{"form-group--column":void 0!==c&&c}),children:[(0,r.jsx)(ee.Q,{field:d,label:i,description:s}),(0,r.jsx)("div",{className:"form-input",children:(0,r.jsx)(f,en(et({},u(t)),{id:d,className:"form-control placeholder:text-light placeholder:opacity-100",name:t,autofocus:void 0!==l&&l}))})]})},ea=["meta_title","meta_description","opengraph_title","opengraph_description"],es=function(){return(0,r.jsxs)("div",{className:"form-section","data-controller":"toggle",children:[(0,r.jsx)("div",{className:"form-section__header has-toggle",children:(0,r.jsx)("button",{type:"button","data-action":"click->toggle#toggle","data-target":"toggle.toggleTrigger","data-open":"false",className:"block-toggle",children:(0,l.t)("meta_tag_attributes.meta_tags")})}),(0,r.jsxs)("div",{className:"form-section__content","data-target":"toggle.toggleable",children:[ea.map(function(e){return(0,r.jsx)(ei,{id:e,label:(0,l.t)("meta_tag_attributes.".concat(e)),description:(0,l.t)("meta_tag_attributes.".concat(e,"_description"),{obj:"post"}),name:"meta_tag_attributes.".concat(e)},e)}),(0,r.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,r.jsx)(ee.Q,{field:"opengraph_image",label:(0,l.t)("meta_tag_attributes.open_graph_image")}),(0,r.jsx)(Y.a,{name:"meta_tag_attributes.opengraph_image",aspectRatio:u.pI.OPEN_GRAPH})]})]})]})},el=function(e){var t=e.name;return(0,r.jsx)(p.l.Item,{id:"post_".concat(t),name:t,label:(0,l.t)("post.".concat(t)),hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,r.jsx)(p.l.ToggleSwitch,{variant:"small"})})};el.propTypes={name:i().string.isRequired};var ec=function(e){var t=e.space,n=(0,$.m)().post,o=(0,y.Gc)().watch,i=o("created_at"),a=o("is_comments_disabled"),s=!!(0,x.k8)(t||{}),c=(0,m.nT)().helpers.spacesWithPostCreationAllowed(),u=(0,m.wh)().currentCommunityMember,f=new Date().toUTCString(),h=(0,J.k)({enabled:(0,K.vb)(u)}),v=h.data,g=h.isLoading,_=!!n.id&&(0,d.Hz)(n);return g?(0,r.jsx)(b.a,{}):(0,r.jsx)("div",{className:"settings-menu__wrapper",children:(0,r.jsx)("div",{className:"form-wrapper quickpost-modal__form-settings",children:(0,r.jsxs)("div",{className:"form-content",children:[(0,r.jsxs)("div",{className:"-space-y-2",children:[(0,r.jsx)(el,{name:"hide_meta_info"}),(0,r.jsx)(el,{name:"is_comments_disabled"}),!a&&(0,r.jsx)(el,{name:"is_comments_closed"}),(0,r.jsx)(el,{name:"is_liking_disabled"}),(0,r.jsx)(el,{name:"is_truncation_disabled"}),_&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(el,{name:"pin_to_top"}),(0,r.jsx)(el,{name:"pinned_at"})]}),!t.hide_from_featured_areas&&(0,r.jsx)(el,{name:"hide_from_featured_areas"}),_&&(0,r.jsxs)("div",{className:"form-group form-group--column !mt-0",children:[(0,r.jsx)(ee.Q,{field:"created_at",label:(0,l.t)("publish_date"),description:(0,l.t)("publish_date_description")}),(0,r.jsx)(X.W,{name:"created_at",maxDate:f})]})]}),(0,r.jsx)(q.If,{condition:(0,d.rq)(t),children:(0,r.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,r.jsx)(ee.Q,{field:"cardview_thumbnail",label:(0,l.t)("cardview_thumbnail")}),(0,r.jsx)(Y.a,{name:"cardview_thumbnail",aspectRatio:2})]})}),(0,K.vb)(u)&&(void 0===v?{}:v).internal_custom_html_enabled&&(0,r.jsx)(ei,{name:"internal_custom_html",variant:"textarea",fullWidth:!0}),(0,r.jsx)(p.l.Item,{name:"space_id",translationRoot:"post",fullWidth:!0,children:(0,r.jsx)(Z.M,{name:"space_id",variant:"form-input",spaces:c})}),(0,r.jsx)(ei,{name:"slug",fullWidth:!0}),(0,r.jsx)(q.If,{condition:s,children:(0,r.jsx)(p.l.Item,{name:"user_id",translationRoot:"post",fullWidth:!0,children:(0,r.jsx)(p.l.CommunityMemberSelect,{direction:"up",valueField:"user_id"})})}),(0,r.jsx)(q.If,{condition:!!i,children:(0,r.jsx)(es,{})})]})})})};function eu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ed(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eu(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}ec.propTypes={space:i().object.isRequired};var ef=function(e){var t=e.show,n=e.closeModal,o=ed((0,v.useState)(!1),2),i=o[0],a=o[1],s=ed((0,v.useState)(!1),2),c=s[0],d=s[1],p=ed((0,v.useState)(),2),b=p[0],h=p[1],g=(0,m.nT)(),_=(0,m.Zh)().helpers.postForTrixEditor(),w=(0,j.kK)(),O=g.helpers.isDataLoaded()&&_,S=g.helpers.basicSpacesWithPostCreationAllowed(),P=(0,y.Gc)(),C=P.watch,k=P.formState,N=k.dirtyFields,A=k.errors,E=k.isSubmitting,T=k.isDirty,M=k.isSubmitSuccessful,D=C(),H=D.space_id,V=D.name,Q=D.body,W=D.id,$=S.find(function(e){return e.id===H}),K=function(){a(!1)},J=!V&&!Q||E||M,X=function(){Object.keys(N).length>0?confirm((0,l.t)("post.errors.unsaved_post_warning"))&&n():n()};(0,F.M)({enabled:!J}),L(T&&!M);var Y=!!W,ee=W?"Save":"Post";return(E||M)&&(ee=W?"Saving...":"Posting..."),(0,f.K)({cacheKey:u._7,fields:["name","body","space_id","cover_image"],enabled:!Y&&!M}),(0,r.jsxs)(z.Js,{show:t,onClose:X,fullscreen:!0,closeOnEscape:!i,trixMode:"quickpost-modal ".concat(c&&"quickpost-modal__fullpage"),children:[(0,r.jsxs)(z.Js.Header,{onClose:!i&&X,children:[(0,r.jsxs)("div",{className:"modal__header__inside",children:[(0,r.jsxs)("div",{className:"mr-4 flex items-center gap-4",children:[(0,r.jsxs)(q.If,{condition:!i,children:[(0,r.jsx)(q.If,{condition:!w,children:(0,r.jsx)("button",{type:"button",onClick:function(){return d(!c)},children:(0,r.jsx)(I.JO,{type:c?"shrink":"expand",size:16})})}),(0,r.jsx)(q.If,{condition:(0,x.Y_)($),children:(0,r.jsx)("button",{type:"button",onClick:function(){return a(!0)},children:(0,r.jsx)(I.JO,{type:"settings"})})})]}),(0,r.jsx)(q.If,{condition:!!i,children:(0,r.jsx)("button",{className:"flex",type:"button",onClick:K,children:(0,r.jsx)(I.JO,{type:"back-arrow-v2",size:16})})})]}),(0,r.jsxs)("div",{className:"modal__header--center",children:[(0,r.jsxs)("span",{className:"quickpost-modal__title",children:[(0,r.jsx)(q.If,{condition:i,children:(0,l.t)("post.post_settings")}),(0,r.jsxs)(q.If,{condition:!i,children:[Y?"Edit Post":"Create Post",(0,r.jsx)("span",{className:"title-separator",children:"/"})]})]}),(0,r.jsx)(q.If,{condition:!i,children:(0,r.jsx)(Z.M,{spaces:S,name:"space_id",rules:{required:(0,l.t)("post.errors.space_is_required")}})})]}),(0,r.jsxs)("div",{className:"modal__header--right",children:[!i&&c&&O&&(0,r.jsx)("div",{className:"flex items-center justify-end gap-4",children:(0,r.jsx)(R,{post:_,space:$,submitDisabled:J,isSubmitting:E||M,datepickerPlacement:"bottom"})}),(0,r.jsx)(q.If,{condition:i,children:(0,r.jsx)("button",{type:"submit",onClick:K,className:"btn modal__btn--save",children:(0,l.t)("post.done")})})]})]}),(0,r.jsx)(q.If,{condition:!i,children:(0,r.jsx)(B.X,{errors:A})})]}),(0,r.jsx)(z.Js.Body,{children:(0,r.jsx)("div",{className:"form-section form-section__topic-content trix-v2",children:(0,r.jsxs)("div",{className:"form-section__content",onMouseEnter:function(){return h(!0)},onMouseLeave:function(){return h(!1)},children:[$&&(0,x.Y_)($)&&i&&(0,r.jsx)(ec,{space:$,spaces:S}),(0,r.jsx)(U.L,{condition:!!i,children:(0,r.jsx)(G,{space:$,showAddCoverBtn:b})})]})})}),!i&&!c&&(0,r.jsx)("div",{className:"quickpost-modal__footer",children:(0,r.jsx)("div",{className:"quickpost-modal__footer--actions h-8 gap-4",children:(0,r.jsx)(R,{post:_,space:$,submitDisabled:J,submitButtonText:ee,isSubmitting:E||M})})})]})};ef.propTypes={show:i().bool,closeModal:i().func};var em=n(75457),ep=function(e){var t=e.open,n=e.onClose,o=e.children,i=e.version,a=e.maxZIndexEnabled;return(0,r.jsx)(em.V,{className:O()("z-150 standard-layout-modal fixed inset-0 md:overflow-y-auto",{"quick-post-wrapper--v2":2===(void 0===i?2:i)},{"z-2000":void 0!==a&&a}),open:t,onClose:n,children:(0,r.jsxs)("div",{className:"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0",children:[(0,r.jsx)(em.V.Overlay,{className:"fixed inset-0 transition-opacity"}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true",style:{content:"&#8203;"}}),(0,r.jsx)("div",{children:o})]})})};function eb(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function eh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}ep.propTypes={open:i().bool,onClose:i().func.isRequired,version:i().number,children:i().node,maxZIndexEnabled:i().bool};var ev=function(e){var t=e.maxZIndexEnabled,n=e.shouldSkipRedirectAfterSubmit,o=void 0!==n&&n,i=e.onSubmitSuccess,v=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["maxZIndexEnabled","shouldSkipRedirectAfterSubmit","onSubmitSuccess"]),y=v.show,g=v.closeModal,_=(0,m.nT)(),x=(0,m.Zh)(),j=x.helpers.postForTrixEditor(),w=_.helpers.isDataLoaded()&&x.record,O=(0,s.k6)(),S=(0,f.d)({cacheKey:u._7}).resetValues,P=(0,h.pm)(),C=P.success,I=P.error,k=function(e){var t=e.responseData,n=(0,d.RG)({post:t});x.onPostChange(t),O?(t.status===j.status?C((0,l.t)("quick_post.toasts.changes_saved")):C((0,l.t)("quick_post.toasts.".concat(t.status,"_saved"))),g(),S(),o||O.push(n)):(g(),S(),o||(window.location.href=n)),i&&i(t)},N=function(){j.id?I((0,l.t)("quick_post.toasts.failed_to_update")):I((0,l.t)("quick_post.toasts.failed_to_create"))},A=eh({status:d.lv},j);return w?(0,r.jsx)("div",{children:(0,r.jsx)(ep,{open:y,onClose:a.noop,version:2,maxZIndexEnabled:void 0!==t&&t,children:(0,r.jsx)(p.l,{onSubmit:function(e){var t;return(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:var r,o;return[4,c.Fv.createOrUpdate({post:(r=eh({},j),o=o={space_id:j.space_id||e.space_id},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}),r),formData:e})];case 1:if(!(t=n.sent()).ok)return[3,3];return[4,t.json()];case 2:return k({responseData:n.sent()}),[2,!0];case 3:return N(),[2,Promise.reject(Error("Failed to create or update the post"))]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){eb(i,r,o,a,s,"next",e)}function s(e){eb(i,r,o,a,s,"throw",e)}a(void 0)})})()},defaultValues:A,children:(0,r.jsx)(ef,eh({},v))})})}):(0,r.jsx)(b.a,{variant:"fullscreen"})};ev.propTypes={show:i().bool,closeModal:i().func.isRequired,maxZIndexEnabled:i().bool,shouldSkipRedirectAfterSubmit:i().bool,onSubmitSuccess:i().func}},30009:function(e,t,n){n.d(t,{a:()=>s});var r=n(85893),o=n(84326),i=n(43515),a=n(39905),s=function(e){var t=e.isDisabled,n=e.isEdit,s=(0,i.L)().isSubmitting;return(0,r.jsx)(a.z,{disabled:t,type:"submit",variant:"circle",children:(0,o.t)("quick_post.scheduled_post_ui.".concat(s?"submitting_button":"submit_button",".").concat(n?"save":"publish"))})}},77646:function(e,t,n){n.d(t,{e:()=>p});var r=n(85893),o=n(67294),i=n(84326),a=n(34870),s=n(19614),l=n(8413),c=n(57363),u=n(75148),d=n(12306),f=n(41553);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var p=function(e){var t,n=e.publishedAt,p=e.updatePublishedAt,b=e.status,h=e.revertToDraftState,v=e.variant,y=void 0===v?"default":v,g=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return m(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),_=g[0],x=g[1],j=function(){return x(!1)},w=(0,a.w)({dateTime:new Date(n),format:"short_date_at_short_time"});return"scheduled"!==b?null:(0,r.jsx)(d.h,{selectorQuery:"#".concat(l.U),children:(0,r.jsx)(s.M,{value:n,datePickerVisible:_,onCancel:j,onSave:function(e){p(e),j()},placement:"bottom-end",saveButtonVariant:"circle",children:(0,r.jsxs)("div",{className:"border-primary bg-secondary -mt-px flex flex-col border-y px-5 py-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(c.JO,{type:"16-clock",size:16}),(0,r.jsx)(f.Z.LabelSm,{weight:"2-lines"===y?"semibold":"medium",children:"default"===y?(0,i.t)("quick_post_v2.scheduled_for",{date:w}):(0,i.t)("quick_post_v2.post_scheduled")})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(u.h,{variant:"secondary",name:"16-edit",iconClassName:"!text-dark",onClick:function(){return x(!0)},ariaLabel:(0,i.t)("edit")}),(0,r.jsx)(u.h,{variant:"secondary",name:"16-trash-bin",iconClassName:"!text-dark",onClick:h,ariaLabel:(0,i.t)("delete")})]})]}),"2-lines"===y&&(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)(f.Z.LabelSm,{weight:"normal",children:w})})]})})})}},17757:function(e,t,n){n.d(t,{$:()=>k,F:()=>I});var r=n(85893),o=n(76234),i=n(94184),a=n.n(i),s=n(96486),l=n(84326),c=n(67294),u=n(52293),d=n(19614),f=n(30009),m=n(77646),p=n(87394),b=n(43515),h=n(41769),v=n(41342),y=n(41084),g=n(60589),_=n(80171),x=n(5765);function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var w=function(){var e,t,n=(0,v.wh)().currentCommunitySettings,o=!!(null==n?void 0:n.tiptap_post_enabled),i=(0,u.Gc)(),a=i.watch,w=i.setValue,O=i.getValues,S=a(),P=S.published_at,C=S.status,I=(e=(0,c.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return j(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),k=I[0],N=I[1],A=(0,b.L)().isSubmitting,E=O(),T=E.name,M=E.body,R=E.tiptap_body,D=E.space_id,L=E.topics,F=(0,v.Zh)(),U=F.record,B=F.helpers,q=F.isSubmitEnabled,z=!!(null==B?void 0:B.isTiptapPost),Z=!!(null==U?void 0:U.id),H=(0,y.Hz)(U),V=(Z?z:o)?(0,h.NU)(R):(0,h.bG)(M),Q="quick_post.scheduled_post_ui.".concat(A?"submitting_button":"submit_button"),W=[{icon:"16-download",label:(0,l.t)("".concat(Q,".save_draft")),value:"draft"},{icon:"16-calendar",label:(0,l.t)("".concat(Q,".schedule_post")),value:"scheduled"},{icon:"16-publish",label:(0,l.t)("".concat(Q,".publish")),value:"published"}],G=(0,s.find)(W,{value:C||"published"}),$=function(e){"scheduled"===e.value?N(!0):(w("status",e.value),N(!1),K(null))},K=function(e){w("published_at",e)},J=function(){$(W[0])},X=a("space_id"),Y=(0,v.nT)();(0,p.f)(Y)&&(t=Y.helpers.findById(X));var ee=(0,c.useMemo)(function(){return(0,h.r1)(T)||V?D?(null==t?void 0:t.require_topic_selection)&&0>=Number(null==L?void 0:L.length)?(0,l.t)("quick_post_v2.error_messages.no_topics"):null:(0,l.t)("quick_post_v2.error_messages.no_space"):(0,l.t)("quick_post_v2.error_messages.no_title_or_body")},[T,D,V,L,t]),et=!!ee||A||!q,en=t&&(0,g.k8)(t)&&!H;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.e,{publishedAt:P,revertToDraftState:J,status:C,updatePublishedAt:K}),(0,r.jsx)(d.M,{datePickerVisible:k,onCancel:function(e){e&&e.preventDefault(),N(!1),"scheduled"===C&&J()},value:P,onSave:function(e){K(e),w("status","scheduled"),N(!1)},className:"-bottom-11",saveButtonVariant:"circle",children:(0,r.jsx)(_.T,{disabled:!et,content:ee,trigger:"mouseenter click focus focusin",children:en?(0,r.jsx)(x.F,{type:"submit",disabled:et,selectedAction:G,setSelectedAction:$,options:W,variant:"circle"}):(0,r.jsx)(f.a,{isEdit:Z,isDisabled:et})})})]})},O=n(57363),S=n(17013),P=n(17617),C=n(41553),I=function(e){var t;return!!(null==e||null==(t=e.helpers)?void 0:t.basicSpacesWithPostCreationAllowed)},k=function(){var e=(0,P.Be)(),t=(0,v.nT)(),n=I(t)?t.helpers.basicSpacesWithPostCreationAllowed():[];return(0,r.jsxs)("footer",{className:"border-primary flex items-center justify-between border-t px-5 py-4","data-testid":"quick-post-footer",children:[(0,r.jsx)("nav",{"aria-label":(0,l.t)("quick_post_v2.footer_menu_aria_label"),id:"quick-post-v2-footer-toolbar"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(o.Z,{disablePortal:e,container:document.getElementById("space-select-for-mobile"),children:(0,r.jsx)(S.M,{dropdownClassName:e?"bottom-14":"bottom-32 right-1",spaces:n,containerClassname:a()("!max-w-full",{"border-t border-primary":!e}),name:"space_id",customButton:function(t){var n=t.toggleDropdown,o=t.selectedSpace,i=t.isOpen;return(0,r.jsxs)("button",{type:"button",className:a()("hover:bg-secondary focus-visible:bg-secondary flex w-full cursor-pointer items-center rounded-md",{"bg-secondary":i,"px-5 py-4":!e,"px-3 py-2":e}),onClick:n,children:[(0,r.jsx)("div",{className:a()("flex items-center space-x-1",{"flex-1":!e}),children:(null==o?void 0:o.name)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.Z.LabelSm,{weight:"medium",color:"text-default",children:[(0,l.t)("quick_post_v2.posting_in")," "]}),(0,r.jsx)(C.Z.LabelSm,{weight:"medium",color:"text-default",children:(0,r.jsx)("span",{className:"text-dark",title:o.name,children:(0,s.truncate)(o.name,{length:e?24:36})})})]}):(0,r.jsx)(C.Z.LabelSm,{weight:"medium",color:"text-default",children:(0,r.jsx)("span",{className:"text-light",children:(0,l.t)("quick_post_v2.choose_a_space")})})}),(0,r.jsx)(O.JO,{className:"!text-dark",type:"16-chevron-down",size:16})]})}})}),(0,r.jsx)(w,{})]})]})}},45308:function(e,t,n){n.d(t,{w:()=>a});var r=n(85893),o=n(52293),i=n(93989),a=function(e){var t=e.name,n=e.rules,a=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["name","rules"]),s=(0,o.Gc)().control;return(0,r.jsx)(o.Qr,{control:s,name:t,rules:n,render:function(e){var t=e.field;return(0,r.jsx)(i.ap,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({value:t.value,onChange:t.onChange},a))}})}},93989:function(e,t,n){n.d(t,{ap:()=>G,tt:()=>W});var r=n(85893),o=n(67294),i=n(95684),a=n(45587),s=n(8933),l=n(94184),c=n.n(l),u=n(87360),d=n.n(u),f=n(73935),m=n(35834),p=n(84326),b=n(96486),h=n(57363),v=n(30457),y=function(e){var t=e.filter,n=e.createTopicMutation;return(0,r.jsxs)(v.W,{option:"create",onClick:function(e){e.preventDefault(),e.stopPropagation(),n.isLoading||n.mutate(t)},className:"flex items-center",children:[(0,r.jsx)(h.JO,{className:"mr-1",size:16,type:n.isLoading?"loader":"plus-v2"}),(0,p.t)(n.isLoading?"quick_post_v2.topics.creating":"quick_post_v2.topics.create"),(0,r.jsx)("span",{className:"text-dark ml-1 font-semibold",children:(0,p.t)("quick_post_v2.topics.topic_quoted",{topic:t})})]},"create")},g=n(41553),_=function(){return(0,r.jsx)("div",{className:"px-5 py-1.5",children:(0,r.jsx)(g.Z.LabelSm,{color:"text-light",children:(0,p.t)("quick_post_v2.topics.loading")})})},x=n(73458),j=n(30021),w=function(e){var t,n,o=e.shouldShowDropdown,i=e.popperElement,a=e.styles,s=e.attributes,l=e.isLoading,u=e.filter,d=e.filteredTopics,f=e.shouldShowCreateTopic,m=e.createTopicMutation;return(0,r.jsx)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:c()("z-10 max-w-[min(90vw,288px)]",{invisible:!o}),ref:i,style:a.popper},s.popper),n=n={children:(0,r.jsx)(x.E,{className:"!relative",dataTestId:"topics-options-list",children:(0,r.jsxs)(j.H,{children:[l&&(0,r.jsx)(_,{}),d.map(function(e){return(0,r.jsx)(v.W,{option:e.id,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(g.Z.LabelSm,{children:(0,b.truncate)(e.name,{length:25})}),e.admin_only&&(0,r.jsx)(g.Z.LabelXs,{color:"text-light",children:(0,p.t)("quick_post_v2.topics.admin_only")})]})},e.id)}),f&&(0,r.jsx)(y,{createTopicMutation:m,filter:u})]})})},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},O=function(e){var t=e.targetElement,n=e.filter,o=e.maxTopicsAllowed,i=e.setFilter,a=e.buttonElement,l=e.activeOption,c=e.createTopicMutation,u=e.resetSelectedTopics,d=e.removeLastTopic;return(0,r.jsx)(s.h.Input,{className:"min-w-[200px] flex-1 border-none bg-transparent p-0 px-1 py-[5px] text-sm focus:ring-0",ref:t,value:n,placeholder:(0,p.t)("quick_post_v2.topics.search",{count:o}),onChange:function(e){return i(e.target.value)},onFocus:function(){var e;return null==a||null==(e=a.current)?void 0:e.click()},onKeyDown:function(e){(e.ctrlKey||e.metaKey)&&"Backspace"===e.key&&u(),"Backspace"===e.key&&(null==n?void 0:n.length)===0&&d(),"Enter"===e.key&&(null==n?void 0:n.trim())&&"create"===l&&(e.preventDefault(),c.isLoading||c.mutate(n))}})},S=n(41342),P=n(78456),C=n(80171),I=function(e){var t=e.topic,n=e.isDragOverlay,o=e.isDraggable,i=e.isDeletable,a=e.setActiveTopicIDs,s=(0,S.wh)().currentCommunityMember,l=(0,P.vb)(s)||(0,P.I$)(s),u=!l&&t.admin_only;return(0,r.jsx)(C.T,{placement:"top",content:(0,p.t)("quick_post_v2.topics.admin_only"),interactive:!1,disabled:!u,trigger:"mouseenter click focus focusin",children:(0,r.jsxs)("div",{className:c()("border-primary bg-primary text-dark inline-flex items-center justify-start gap-1.5 whitespace-nowrap rounded-[32px] border py-1.5 pr-2",n?"rotate-1 scale-[1.01] opacity-75 shadow-lg":o?"cursor-move":"cursor-default",u?"pl-2":"pl-3.5",{"pointer-events-none":u}),children:[(0,r.jsx)(g.Z.LabelXs,{weight:"medium",children:null==t?void 0:t.name}),(l||!t.admin_only)&&i&&(0,r.jsx)(h.JO,{className:"cursor-pointer",onClick:function(){null==a||a(function(e){return e.filter(function(e){return e!==t.id})})},type:"12-close",size:12})]})})},k=n(88767),N=n(93199),A=n(13532),E=n(60878);function T(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var M=function(e){var t=e.onSuccess,n=e.spaceId,r=(0,E.pm)();return(0,k.useMutation)({mutationFn:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){return[2,(0,N.Cu)(A.av.settings.topics.create(),{topic:{name:e,space_ids:[n]}})]})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){T(i,r,o,a,s,"next",e)}function s(e){T(i,r,o,a,s,"throw",e)}a(void 0)})})()},onSuccess:t,onError:function(e){"Name has already been taken"===e.errorDetails&&r.error("A topic with this name already exists. Add it to your space instead from the customize space screen.")}})},R=n(66249),D=function(e){var t=e.spaceId;return(0,k.useQuery)({queryKey:t?[R.Jl,t]:[R.Jl],queryFn:function(){return(0,N.UT)(t?A.av.topics.spaceTopics({spaceId:t}):A.av.settings.topics.index({params:{per_page:250}}))}})},L=function(e){var t=e.activeTopicIDs,n=e.topics,r=e.skipSort;return t.map(function(e){return null==n?void 0:n.records.find(function(t){return t.id===e})}).filter(function(e){return!!e}).sort(function(e,t){return r?0:e.admin_only&&!t.admin_only?-1:!e.admin_only&&t.admin_only?1:0})},F=function(e){var t=e.activeTopicIDs,n=e.topics;return t.sort(function(e,t){var r=null==n?void 0:n.records.find(function(t){return t.id===e}),o=null==n?void 0:n.records.find(function(e){return e.id===t});return(null==r?void 0:r.admin_only)&&!(null==o?void 0:o.admin_only)?-1:!(null==r?void 0:r.admin_only)&&(null==o?void 0:o.admin_only)?1:0})},U=n(64904),B=n(75148),q=n(24285);function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var Z=function(e){var t,n,o=e.topic,i=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["topic"]),s=(0,a.nB)({id:(null==o?void 0:o.id)||""}),l=s.attributes,c=s.listeners,u=s.setNodeRef,d=s.transform,f=s.transition,m=s.isDragging,p={transform:q.ux.Translate.toString(d),transition:f,opacity:m?.33:1};return(0,r.jsx)("div",(t=z({ref:u,style:p},l,c),n=n={children:(0,r.jsx)(I,z({topic:o},i))},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))};function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||Q(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e,t){if(e){if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}}var W=20,G=function(e){var t=e.value,n=e.onChange,l=e.spaceId,u=e.maxTopicsAllowed,b=void 0===u?5:u,h=e.sortable,v=void 0!==h&&h,y=e.creatable,g=e.deletable,_=void 0===g||g,x=e.containerClassName,j=V((0,o.useState)(void 0===t?[]:t),2),k=j[0],N=j[1],A=V((0,o.useState)(""),2),E=A[0],T=A[1],R=V((0,o.useState)(null),2),q=R[0],z=R[1],G=(0,S.wh)().currentCommunityMember,$=(0,o.useRef)(null),K=(0,o.useRef)(null),J=(0,o.useRef)(null),X=(null==k?void 0:k.length)>0,Y=(null==k?void 0:k.length)>=b,ee=D({spaceId:l}),et=ee.data,en=ee.isLoading,er=ee.refetch,eo=(0,i.Dy)((0,i.VT)(i.we,{activationConstraint:{distance:10}}),(0,i.VT)(i.Lg,{coordinateGetter:a.is})),ei=function(){return N((0,P.vb)(G)?[]:k.filter(function(e){var t=null==et?void 0:et.records.find(function(t){return t.id===e});return null==t?void 0:t.admin_only}))},ea=function(){return N(function(e){var t=v?e:F({activeTopicIDs:e,topics:et}),n=null==et?void 0:et.records.find(function(e){return e.id===t[t.length-1]});return!(0,P.vb)(G)&&(null==n?void 0:n.admin_only)?e:e.slice(0,-1)})};(0,o.useEffect)(function(){et&&N(function(e){return e.filter(function(e){return null==et?void 0:et.records.some(function(t){return t.id===e})})})},[et]),(0,o.useEffect)(function(){null==n||n(k.filter(function(e){return!isNaN(Number(e))}))},[n,k]);var es=(0,m.D)($.current,K.current,{placement:"top-start",strategy:"absolute",modifiers:[U.Z,{name:"offset",options:{offset:[0,2]}}]}),el=es.styles,ec=es.attributes,eu=es.forceUpdate,ed=function(){T(""),$.current&&($.current.value="")},ef=M({spaceId:l,onSuccess:function(e){ed(),er(),null==eu||eu(),N(function(t){return((function(e){if(Array.isArray(e))return H(e)})(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||Q(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e.id])})}}),em=((null==et?void 0:et.records)||[]).filter(function(e){return!e.admin_only||(0,P.vb)(G)||(0,P.I$)(G)}).filter(function(e){return!k.includes(e.id)}),ep=em.map(function(e){return e.name}),eb=d().go(E,ep,{all:!0}).map(function(e){return e.target}),eh=em.filter(function(e){return eb.includes(e.name)}),ev=void 0!==y&&y&&!Y&&E.length>0&&!ep.includes(E);l&&(ev=ev&&Number(null==et?void 0:et.count)<W);var ey=(en||eh.length>0||ev)&&k.length<b;(0,o.useEffect)(function(){null==eu||eu()},[eu,k]);var eg=function(e){return z(e.active.id)},e_=function(e){var t=e.active,n=e.over;t.id!==n.id&&N(function(e){return(0,a.Rp)(e,e.indexOf(t.id),e.indexOf(n.id))}),z(null)},ex=null==et?void 0:et.records.find(function(e){return e.id===q});return(null==et?void 0:et.records)&&(null==et?void 0:et.records.length)||(0,P.vb)(G)?(0,r.jsx)(s.h,{value:k,onChange:function(e){N(e),ed()},multiple:!0,nullable:!0,children:function(e){var t=e.activeOption;return(0,r.jsxs)("div",{className:c()("text-dark flex items-start justify-between p-2",x),children:[(0,r.jsxs)("div",{id:"quickpost-topics-picker-sortable",className:"w-full",children:[(0,r.jsx)(s.h.Button,{className:"hidden",ref:J}),(0,r.jsxs)(i.LB,{sensors:eo,collisionDetection:i.ey,onDragStart:eg,onDragEnd:e_,children:[(0,r.jsx)(a.Fo,{items:k,strategy:a.U2,disabled:!v,children:(0,r.jsxs)("div",{className:"flex w-full flex-row flex-wrap items-center gap-2",children:[L({activeTopicIDs:k,topics:et,skipSort:v}).map(function(e){return(0,r.jsx)(Z,{topic:e,isDraggable:v,isDeletable:_,setActiveTopicIDs:N},e.id)}),!Y&&(0,r.jsx)(O,{buttonElement:J,filter:E,setFilter:T,maxTopicsAllowed:b,targetElement:$,activeOption:t,createTopicMutation:ef,resetSelectedTopics:ei,removeLastTopic:ea})]})}),(0,f.createPortal)((0,r.jsx)(i.y9,{zIndex:99999,children:ex?(0,r.jsx)(I,{isDragOverlay:!0,topic:ex,isDeletable:_}):null}),document.body)]}),(0,r.jsx)(w,{shouldShowDropdown:ey,popperElement:K,styles:el,filter:E,attributes:ec,isLoading:en,filteredTopics:eh,shouldShowCreateTopic:ev,createTopicMutation:ef})]}),X&&_&&(0,r.jsx)(C.T,{content:(0,p.t)("quick_post_v2.topics.remove_all"),placement:"top-end",children:(0,r.jsx)(B.h,{className:"h-7 w-7",iconClassName:"!text-dark",onClick:ei,name:"16-trash-bin-2",ariaLabel:(0,p.t)("quick_post_v2.topics.remove_all")})})]})}}):null}},8413:function(e,t,n){n.d(t,{V:()=>q,U:()=>B});var r=n(85893),o=n(67294),i=n(52293),a=n(46977),s=n(43515),l=n(3697),c=n(41342),u=n(67379),d=n(83095),f=n(94184),m=n.n(f),p=n(84326),b=n(60589),h=n(70442),v=n(1168),y=n(72727),g=n(13087),_=n(75148),x=n(17617),j=n(80171),w=n(41553),O="quick-post-v2-thumbnail-button",S=function(){var e=(0,s.L)(),t=e.isFullscreen,n=e.toggleFullscreen,o=e.isDirty,a=(0,g.c)({shouldPrevent:o}),l=(0,h.k6)(),u=(0,c.Zh)().record,d=(0,c.nT)(),f=(0,i.Gc)().watch,m=!!(null==u?void 0:u.id),S=f("space_id"),P=d.helpers.findById(S),C=(0,x.kK)(),I=(0,y.L)().isElectron;return(0,r.jsxs)("header",{className:(0,v.A)("border-primary flex items-center justify-between border-b px-5 py-4",{"mt-6":I&&t}),"data-testid":"quick-post-header",children:[(0,r.jsx)(w.Z.TitleSm,{weight:"semibold",children:(0,p.t)(m?"quick_post_v2.edit_title":"quick_post_v2.create_title")}),(0,r.jsxs)("ul",{className:"text-darkest flex list-none items-center space-x-2",children:[(0,r.jsx)("li",{id:O}),P&&(0,b.Y_)(P)&&(0,r.jsx)("li",{children:(0,r.jsx)(j.T,{placement:"bottom",content:(0,p.t)("quick_post_v2.header.settings"),children:(0,r.jsx)(_.h,{variant:"secondary",iconSize:20,iconClassName:"!text-dark",name:"20-settings",onClick:function(){return l.push("/settings")},ariaLabel:(0,p.t)("quick_post_v2.header.settings")})})}),!C&&(0,r.jsx)("li",{children:(0,r.jsx)(j.T,{placement:"bottom",content:(0,p.t)("quick_post_v2.header.fullscreen"),children:(0,r.jsx)(_.h,{variant:"secondary",iconSize:20,className:"hidden sm:flex",onClick:n,iconClassName:"!text-dark",name:t?"20-fullscreen-exit":"20-fullscreen",ariaLabel:(0,p.t)("quick_post_v2.header.fullscreen")})})}),(0,r.jsx)("li",{children:(0,r.jsx)(j.T,{placement:"bottom",content:(0,p.t)("quick_post_v2.header.close"),children:(0,r.jsx)(_.h,{variant:"secondary",iconSize:20,onClick:a,iconClassName:"!text-dark",name:"20-close",ariaLabel:(0,p.t)("quick_post_v2.header.close")})})})]})]})},P=n(45308),C=n(87394),I=n(96619),k=n(59892),N=n(41084),A=n(5521),E=n(6394),T=n(12306),M=n(5116),R=n(52988);function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function L(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return D(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var F=function(){var e,t=(0,c.wh)().currentCommunitySettings,n=!!(null==t?void 0:t.tiptap_post_enabled),o=(0,i.Gc)(),a=o.watch,s=o.setValue,u=a("tiptap_body.sgids_to_object_map")||{},d=a("name"),f="tiptap_body.inline_attachments",h=a(f)||[],v=(0,c.Zh)(),y=v.record,g=v.helpers,x=!!(null==g?void 0:g.isTiptapPost),w=(0,A.k)(),S=y||{},D=S.id,F=S.tiptap_body,U=a("space_id"),B=a("cover_image"),q=(0,c.nT)();(0,C.f)(q)&&(e=q.helpers.findById(U));var z=e&&(0,b.Y_)(e);return(0,r.jsx)("div",{className:"flex-1 overflow-auto px-5 py-4","data-ai-scrollable":!0,children:(0,r.jsxs)("div",{className:"trix-v2 mx-auto grid h-full max-w-3xl grid-rows-[auto,auto,1fr]",children:[(0,r.jsx)("div",{children:(0,N.J4)(e)&&(0,r.jsx)(E.D,{name:"cover_image",className:m()("relative",{"mb-2":!!B}),showAddCoverBtn:!0,aspectRatio:l.pI.DEFAULT,changeImageText:(0,p.t)("replace"),customAddCoverBtn:(0,r.jsx)(T.h,{selectorQuery:"#".concat(O),children:(0,r.jsx)(j.T,{placement:"bottom",content:(0,p.t)("quick_post_v2.header.add_cover"),children:(0,r.jsx)(_.h,{variant:"secondary",iconSize:20,iconClassName:"!text-dark",name:"20-cover-image",ariaLabel:(0,p.t)("quick_post_v2.header.add_cover")})})})})}),(0,r.jsx)("div",{children:(0,N.tp)(e)&&(0,r.jsx)(I.n,{maxLength:255,draggable:!1,name:"name",autoFocus:!0,ref:w,placeholder:(0,p.t)("quick_post_v2.title_placeholder"),className:"bg-primary text-dark mb-2 block w-full resize-none border-none p-0 text-2xl font-bold focus:ring-0",rows:1,onKeyPress:function(e){"Enter"===e.key&&e.preventDefault()},tabIndex:0,"data-testid":"post_name"})}),(0,r.jsx)("div",{children:(D?x:n)?(0,r.jsx)(k.$,{placeholder:(0,p.t)("quick_post_v2.body_placeholder"),name:"tiptap_body.body",toolbars:[{portalId:"quick-post-v2-footer-toolbar",component:R.o}],className:"h-full",editorClassName:"h-full quick-post-modal--v2",spaceId:U,sgidToObjectMap:null==F?void 0:F.sgids_to_object_map,inlineAttachments:null==F?void 0:F.inline_attachments,onLocalSgidToObjectMapChange:function(e){s("tiptap_body.sgids_to_object_map",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},u,e))},onLocalAttachmentsChange:function(e){return s(f,L(h).concat(L(e)))},aiCopilotTitle:d,isVoiceMessageAllowed:!0}):(0,r.jsx)(M.O,{id:"post_body",name:"body",is_private_space:!1,space_id:U,placeholder:(0,p.t)("quick_post_v2.body_placeholder"),tabIndex:0,toolbarPortalId:"quick-post-v2-footer-toolbar"})}),!!U&&(0,r.jsx)(T.h,{selectorQuery:"#topics-picker-portal",children:(0,r.jsx)(P.w,{containerClassName:"border-t border-primary",name:"topics",spaceId:U,creatable:null!=z&&z})})]})})},U=n(17757),B="scheduled-post-date-render-portal",q=function(){var e=(0,s.L)().setIsDirty,t=(0,i.Gc)(),n=t.formState,f=n.isDirty,m=n.isSubmitSuccessful,p=(0,c.Zh)().record,b=!!(null==p?void 0:p.id);return(0,o.useEffect)(function(){e(f)},[e,f]),(0,d.K)({cacheKey:l._7,fields:["name","body","tiptap_body","space_id","cover_image"],enabled:!b&&!m}),(0,a.y1)("meta+enter, ctrl+enter",function(){(0,u.C)(t)&&t.triggerFormSubmit()},{enableOnContentEditable:!0,enableOnFormTags:["INPUT","TEXTAREA"]},[t]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S,{}),(0,r.jsx)("div",{id:B}),(0,r.jsx)(F,{}),(0,r.jsx)("div",{id:"space-select-for-mobile"}),(0,r.jsx)("div",{id:"topics-picker-portal"}),(0,r.jsx)(U.$,{})]})}},40274:function(e,t,n){n.d(t,{L:()=>w});var r=n(85893),o=n(96486),i=n(57105),a=n(34519),s=n(51169),l=function(){return(0,r.jsx)(a.u_.Content,{className:"flex min-h-[400px] items-center justify-center",children:(0,r.jsx)(s.a,{})})},c=n(86214),u=n(41342),d=n(88241),f=n(1892),m=function(e){var t=e.post,n=e.onSubmitSuccess,o=e.onPostChange,i=e.shouldSkipRedirectAfterSubmit,a=(0,f.t)({spaceId:t.space_id,postSlug:t.slug,queryOptions:{cacheTime:0},context:"edit-post-modal"}),s=a.post,m=a.isLoading,p=(0,d.hD)(t.id).isLoading;return m||p?(0,r.jsx)(l,{}):(0,r.jsx)(u.DW,{post:s,onPostChange:o,children:(0,r.jsx)(c.H,{shouldSkipRedirectAfterSubmit:i,onSubmitSuccess:n})})},p=n(43515),b=n(20987),h=n(13087),v=n(91149),y=n(56516),g=n(79895),_=n(6233),x=function(e){var t=e.post,n=e.onSubmitSuccess,s=e.onPostChange,l=e.shouldSkipRedirectAfterSubmit,c=(0,i.dd)(),u=(0,p.L)().isDirty,f=(0,h.c)({shouldPrevent:u}),x=(0,g.Z)(),j=(0,_.d)(),w=(0,y.d)(),O=x.visible||j.visible||w.visible;return(0,b.u)({disabled:O,onClose:f}),(0,r.jsxs)(a.u_,{isOpen:c.visible,onClose:o.noop,className:"quick-post-v2-modal w-full max-w-3xl",children:[(0,r.jsx)(a.u_.Overlay,{onClick:f}),(0,r.jsx)(v.H,{children:(0,r.jsx)(d._x,{perPagePostIds:[[t.id]],queryOptions:{cacheTime:0},queryContext:"edit-post-modal",children:(0,r.jsx)(m,{post:t,onPostChange:s,onSubmitSuccess:n,shouldSkipRedirectAfterSubmit:l})})})]})},j=i.gk.create(function(e){return(0,r.jsx)(x,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),w=function(){return(0,i.dd)(j)}},86214:function(e,t,n){n.d(t,{H:()=>F});var r=n(85893),o=n(67294),i=n(94184),a=n.n(i),s=n(96486),l=n(88767),c=n(70442),u=n(84326),d=n(78456),f=n(51630),m=n(57105),p=n(8413),b=n(87394),h=n(75148),v=n(39905),y=n(41553),g=function(){var e=(0,c.k6)(),t=function(){return e.push("/")};return(0,r.jsxs)("div",{className:"border-primary bg-primary sticky top-0 z-10 flex items-center justify-between border-b px-5 py-3.5 sm:rounded-t-2xl",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h.h,{name:"20-arrow-left",iconSize:20,className:"!p-0",iconClassName:"!h-5 !w-5",onClick:t,ariaLabel:(0,u.t)("previous")}),(0,r.jsx)(y.Z.TitleSm,{weight:"semibold",children:(0,u.t)("quick_post_v2.settings")})]}),(0,r.jsx)(v.z,{type:"button",onClick:t,variant:"circle",children:(0,u.t)("quick_post_v2.done")})]})},_=function(){return(0,r.jsxs)("div",{className:"h-full overflow-auto",children:[(0,r.jsx)(g,{}),(0,r.jsx)(b.l,{})]})},x=n(43515),j=n(41769),w=n(3697),O=n(41342),S=n(41084),P=n(83095),C=n(34519),I=n(51466),k=n(60878),N=n(25362),A=n(90431),E=n(57363),T=n(31089),M=n(57851),R=n(74520),D=m.gk.create(function(e){var t=e.post,n=(0,N.dd)(),o=(0,R.$)(),i=o.onShareViaBroadcast,a=o.isLoading;return(0,r.jsx)(A.o,{isOpen:n.visible,onClose:n.hide,title:(0,u.t)("quick_post_v2.connection_modal.title"),description:(0,u.t)("quick_post_v2.connection_modal.description",{space_name:t.space_name}),isLoading:a,"data-testid":"post-momentum-modal",children:(0,r.jsx)(M.X,{children:(0,r.jsx)(T.K,{iconEl:(0,r.jsx)(E.JO,{type:"20-page-edit-text",size:20}),onClick:function(){i({postId:t.id,onSuccess:function(){n.hide()}})},disabled:a,"data-testid":"send-announcement-button",children:(0,u.t)("momentum_modal.share_broadcast.review_draft")})})})});function L(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var F=function(e){var t=e.shouldSkipRedirectAfterSubmit,n=e.onSubmitSuccess,i=(0,m.dd)(),b=(0,x.L)(),h=b.isFullscreen,v=b.setIsSubmitting,y=(0,k.pm)(),g=y.success,N=y.error,A=(0,c.k6)(),E=(0,O.wh)(),T=E.currentCommunitySettings,M=E.currentCommunityMember,R=!!(null==T?void 0:T.tiptap_post_enabled),F=(0,O.Zh)(),U=F.onPostChange,B=F.helpers,q=null==B?void 0:B.postForTrixEditor,z=!!(null==B?void 0:B.isTiptapPost),Z=q&&q(),H=!!Z.id,V=(0,d.vb)(M),Q=(0,P.d)({cacheKey:w._7}).resetValues,W=(0,l.useMutation)(function(e){return f.Fv.createOrUpdate({post:{id:Z.id,slug:Z.slug,space_id:Z.space_id||e.space_id},formData:e})},{onSuccess:function(e){var r;return(r=function(){var r,o,a;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(l){switch(l.label){case 0:return[4,e.json()];case 1:return r=l.sent(),(0,s.isFunction)(U)&&U(r),(0,s.isFunction)(n)&&n(),H||Q(),o=function(){if(H)return void g((0,u.t)("quick_post.toasts.changes_saved"));var e="published"===r.status;if(V&&e)return void m.gk.show(D,{post:r});g((0,u.t)("quick_post.toasts.".concat(r.status,"_saved")))},i.remove(),o(),a=(0,S.RG)({post:r}),t||A.push(a),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){L(i,n,o,a,s,"next",e)}function s(e){L(i,n,o,a,s,"throw",e)}a(void 0)})})()},onError:function(){return N((0,u.t)("quick_post.toasts.failed_to_create"))}});return(0,o.useEffect)(function(){v(W.isLoading)},[W.isLoading,v]),(0,r.jsx)(I.l,{id:"quick-post-form",defaultValues:Z,mode:"all",className:"h-full",formClassName:"h-full flex flex-col",onSubmit:function(e){return W.mutate(e)},validationSchema:(H?z:R)?j.vY:j.gR,children:(0,r.jsx)(C.u_.Content,{size:h?"screen":"auto",className:a()("overflow-visible",{"max-h-none":h,"h-full max-h-full max-w-[720px] !rounded-t-none sm:h-full sm:!rounded-t-lg md:max-h-[80vh] lg:max-h-[550px]":!h}),animations:"fadeIn",children:(0,r.jsx)(c.VA,{children:(0,r.jsxs)(c.rs,{children:[(0,r.jsx)(c.AW,{component:p.V,path:"/",exact:!0}),(0,r.jsx)(c.AW,{component:_,path:"/settings"})]})})})})}},87394:function(e,t,n){n.d(t,{l:()=>C,f:()=>P});var r=n(85893),o=n(52293),i=n(84326),a=n(27053),s=n(30889),l=n(17013),c=n(41342),u=n(78456),d=n(41084),f=n(60589),m=n(13248),p=n(73262),b=n(51466),h=n(61641),v=n(51169),y=function(e){var t;return"function"==typeof(null==e||null==(t=e.helpers)?void 0:t.basicSpacesWithPostCreationAllowed)},g=function(e){var t;return"object"==((t=null==e?void 0:e.current_user_roles)&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t)},_=function(e){var t,n=e.space,o=(0,a.m)().post,_=!!g(n)&&!!(0,f.k8)(n),x=(0,c.nT)();y(x)&&(t=x.helpers.basicSpacesWithPostCreationAllowed());var j=(0,c.wh)().currentCommunityMember,w=new Date().toUTCString(),O=(0,m.k)({enabled:(0,u.vb)(j)}),S=O.data,P=void 0===S?{}:S,C=O.isLoading,I=(null==P?void 0:P.internal_custom_html_enabled)!==void 0&&P.internal_custom_html_enabled,k=!!o.id&&(0,d.Hz)(o);return C?(0,r.jsx)(v.a,{}):(0,r.jsxs)(r.Fragment,{children:[k&&(0,r.jsxs)("div",{className:"form-group form-group--column !mt-0",children:[(0,r.jsx)(s.Q,{field:"created_at",label:(0,i.t)("publish_date"),description:(0,i.t)("publish_date_description")}),(0,r.jsx)(p.W,{name:"created_at",maxDate:w})]}),(0,d.rq)(n)&&(0,r.jsxs)("div",{className:"form-group form-group--two-columns",children:[(0,r.jsx)(s.Q,{field:"cardview_thumbnail",label:(0,i.t)("cardview_thumbnail")}),(0,r.jsx)(h.a,{name:"cardview_thumbnail",aspectRatio:2,title:(0,i.t)("upload_a_cardview_thumbnail")})]}),(0,u.vb)(j)&&I&&(0,r.jsx)(b.l.Item,{hideBorder:!0,name:"internal_custom_html",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,variant:"extra-bottom-margin",children:(0,r.jsx)(b.l.TextArea,{name:"internal_custom_html"})}),(0,r.jsx)(b.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"space_id",translationRoot:"post",fullWidth:!0,children:(0,r.jsx)(l.M,{name:"space_id",variant:"form-input",spaces:t})}),(0,r.jsx)(b.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"slug",fullWidth:!0,translationRoot:"post",hidePlaceholder:!0,children:(0,r.jsx)(b.l.Input,{name:"slug"})}),_&&(0,r.jsx)(b.l.Item,{variant:"extra-bottom-margin",hideBorder:!0,name:"user_id",translationRoot:"post",fullWidth:!0,children:(0,r.jsx)(b.l.CommunityMemberSelect,{name:"user_id",direction:"up",valueField:"user_id"})})]})},x=n(3697),j=["meta_title","meta_description","opengraph_title","opengraph_description"],w=function(){return(0,r.jsx)("div",{className:"form-section",children:(0,r.jsxs)("div",{className:"form-section__content",children:[j.map(function(e){return(0,r.jsx)(b.l.Item,{label:(0,i.t)("meta_tag_attributes.".concat(e)),description:(0,i.t)("meta_tag_attributes.".concat(e,"_description"),{obj:"post"}),name:"meta_tag_attributes.".concat(e),hideBorder:!0,variant:"extra-bottom-margin",children:(0,r.jsx)(b.l.Input,{id:e,name:"meta_tag_attributes.".concat(e)},e)},e)}),(0,r.jsx)(b.l.Item,{name:"meta_tag_attributes.opengraph_image",label:(0,i.t)("meta_tag_attributes.opengraph_image"),hideBorder:!0,hideDescription:!0,variant:"extra-bottom-margin",children:(0,r.jsx)(h.a,{name:"meta_tag_attributes.opengraph_image",aspectRatio:x.pI.OPEN_GRAPH})})]})})},O=function(e){var t=e.name;return(0,r.jsx)(b.l.Item,{id:"post_".concat(t),name:t,label:(0,i.t)("post.".concat(t)),hideBorder:!0,hideDescription:!0,inlineReverse:!0,children:(0,r.jsx)(b.l.ToggleSwitch,{name:t,variant:"small"})})},S=function(e){var t=e.space,n=(0,a.m)().post,i=(0,(0,o.Gc)().watch)("is_comments_disabled"),s=!!n.id&&(0,d.Hz)(n);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O,{name:"hide_meta_info"}),(0,r.jsx)(O,{name:"is_comments_disabled"}),!i&&(0,r.jsx)(O,{name:"is_comments_closed"}),(0,r.jsx)(O,{name:"is_liking_disabled"}),(0,r.jsx)(O,{name:"is_truncation_disabled"}),s&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O,{name:"pin_to_top"}),!(null==t?void 0:t.hide_right_sidebar)&&(0,r.jsx)(O,{name:"pinned_at"})]}),!(null==t?void 0:t.hide_from_featured_areas)&&(0,r.jsx)(O,{name:"hide_from_featured_areas"})]})},P=function(e){var t;return"function"==typeof(null==e||null==(t=e.helpers)?void 0:t.findById)},C=function(){var e,t=(0,o.Gc)().watch,n=t("created_at"),i=t("space_id"),a=(0,c.nT)();return P(a)&&(e=a.helpers.findById(i)),(0,r.jsxs)("div",{className:"mx-auto max-w-3xl px-5 pb-5 pt-2",children:[(0,r.jsx)(S,{space:e}),(0,r.jsx)("div",{className:"my-4"}),(0,r.jsx)(_,{space:e}),!!n&&(0,r.jsx)(w,{})]})}},43515:function(e,t,n){n.d(t,{L:()=>r});var r=(0,n(64100).Ue)(function(e){return{isFullscreen:!1,toggleFullscreen:function(){return e(function(e){return{isFullscreen:!e.isFullscreen}})},isSubmitting:!1,setIsSubmitting:function(t){return e({isSubmitting:t})},isDirty:!1,setIsDirty:function(t){return e({isDirty:t})}}})},20987:function(e,t,n){n.d(t,{u:()=>o});var r=n(46977),o=function(e){var t=e.disabled,n=e.onClose;(0,r.y1)("esc",n,{enabled:!t,enableOnContentEditable:!0,enableOnFormTags:["INPUT","TEXTAREA"]},[t])}},74520:function(e,t,n){n.d(t,{$:()=>s});var r=n(70442),o=n(26371),i=n(43832),a=n(99037),s=function(){var e=(0,r.k6)(),t=(0,a.l)(),n=t.mutate,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,["mutate"]),l=(0,i.g)();return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({onShareViaBroadcast:function(t){var r=t.postId,i=t.onSuccess;if(!l){e.push(o.e.list()),null==i||i();return}n({source_content_id:r,source_content_type:"Post"},{onSuccess:function(t){null==i||i(),e.push(o.e.edit({broadcastId:t.broadcast.id}))}})}},s)}},13087:function(e,t,n){n.d(t,{c:()=>i});var r=n(84326),o=n(57105),i=function(e){var t=e.shouldPrevent,n=e.message,i=(0,o.dd)();return function(){(!t||confirm(n||(0,r.t)("quick_post_v2.accidental_leave_confirmation")))&&i.remove()}}},41769:function(e,t,n){n.d(t,{NU:()=>s,bG:()=>o,gR:()=>c,r1:()=>i,vY:()=>u});var r=n(65978),o=function(e){return!!e},i=function(e){return!!e},a=["image","file","embed","mention","horizontalRule"],s=function(e){var t,n;return null!=e&&null!=(n=e.body)&&null!=(t=n.content)&&!!t.length&&e.body.content.some(function(e){return!!e.content||a.includes(e.type)})},l=r.Ry().shape({space_id:r.Rx().required()}),c=r.Ry().shape({name:r.Z_().when("body",{is:function(e){return!o(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()}),body:r.Z_().when("name",{is:function(e){return!i(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()})},[["name","body"]]).concat(l),u=r.Ry().shape({name:r.Z_().when("tiptap_body",{is:function(e){return!s(e)},then:r.Z_().required(),otherwise:r.Z_().nullable()}),tiptap_body:r.Ry().when("name",{is:function(e){return!i(e)},then:r.Ry().test({test:function(e){return s(e)}}),otherwise:r.Ry().nullable()})},[["name","tiptap_body"]]).concat(l)},34335:function(e,t,n){n.d(t,{V:()=>r});var r={thumbsup:"\uD83D\uDC4D",heart:"❤️",tada:"\uD83C\uDF89",joy:"\uD83E\uDD23",open_mouth:"\uD83D\uDE2E",cry:"\uD83D\uDE22",pray:"\uD83D\uDE4F"}},65344:function(e,t,n){n.d(t,{D:()=>w});var r=n(85893),o=n(67294),i=n(84142),a=n(94184),s=n.n(a),l=n(73935),c=n(35834),u=n(84326),d=n(43340),f=n(57363),m=n(36353),p=n(80171),b=n(34335),h=n(96486),v=n(41342),y=n(93441),g=function(e){var t=e.emoji,n=e.reactionableId,o=e.reactionableType,i=e.currentCommunityMemberId,a=e.onClose,s=e.reactions,l=(0,v.wh)().isViewOnlyMasquerading,c=b.V[t],u=(0,y.z)({currentCommunityMemberId:i,emoji:t,reactionableId:n}),d=u.addReaction,f=u.removeReaction;return c?(0,r.jsx)("button",{type:"button",className:"hover:bg-secondary focus-visible:!outline-secondary relative flex gap-1 rounded-md border-transparent px-2 py-0.5 text-sm focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2",onClick:l?h.noop:function(){var e,r=(o in(e={emoji:t})?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n,e),l=s.find(function(e){return e.emoji===t});l&&l.community_member_ids.includes(i)?f(r):d(r),a()},children:c}):null},_=function(e){var t=e.reactionableId,n=e.reactionableType,o=e.reactions,i=e.onClose,a=e.currentCommunityMemberId;return(0,r.jsx)("div",{className:"bg-primary flex gap-1 rounded-lg p-1","data-testid":"popover-content",children:Object.keys(b.V).map(function(e){return(0,r.jsx)(g,{emoji:e,reactionableId:t,reactionableType:n,reactions:o,onClose:i,currentCommunityMemberId:a},e)})})};function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var w=function(e){var t=e.reactions,n=e.currentCommunityMemberId,a=e.reactionableId,b=e.reactionableType,h=e.showBorder,v=void 0!==h&&h,y=e.setActiveMessageId,g=e.isMessageThread,x=void 0!==g&&g,w=e.isRenderedOnHeader,O=j((0,o.useState)(null),2),S=O[0],P=O[1],C=j((0,o.useState)(null),2),I=C[0],k=C[1],N=(0,c.D)(S,I,{placement:v?"top-start":"bottom-end"}),A=N.styles,E=N.attributes,T=(0,m.Op)().scrollerId,M=void 0!==w&&w?document.getElementById("threads-scroll-view"):T&&document.getElementById(T)||(0,d.j_)();return(0,r.jsx)(i.J,{className:"relative",children:function(e){var o,c,m=e.open,h=e.close;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.J.Button,{ref:P,className:s()("hover:bg-secondary focus:bg-secondary flex h-[1.625rem] items-center justify-center rounded px-1.5 transition-transform",{"border-primary rounded-full border px-1 hover:border-gray-400":v,"h-6 w-6":!v}),onClick:function(){return!m&&y&&y((0,d.h7)(a,x))},children:(0,r.jsx)(p.T,{placement:"bottom",interactive:!1,content:(0,u.t)("tiptap.add_reaction"),dataTestId:"add_reaction",className:"flex",children:(0,r.jsx)(f.JO,{"aria-label":(0,u.t)("tiptap.add_reaction"),type:"16-reaction",viewBox:"-2 -2 20 20",className:"text-default"})})}),M&&(0,l.createPortal)((0,r.jsx)(i.J.Panel,(o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({ref:k,style:A.popper,className:"z-[21]","data-testid":"filter_component"},E.popper),c=c={children:(0,r.jsx)("div",{className:"border-primary mt-1 rounded-lg border shadow-xl",children:(0,r.jsx)(_,{reactions:t,reactionableId:a,reactionableType:b,onClose:h,currentCommunityMemberId:n})})},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(c)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(c)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(c,e))}),o)),M)]})}})}},93441:function(e,t,n){n.d(t,{z:()=>l});var r=n(67294),o=n(88767),i=n(51630),a=n(90926);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e){var t,n=e.currentCommunityMemberId,l=e.emoji,c=e.reactionableId,u=e.reactionableType,d=e.setCommunityMembers,f=e.communityMemberIds,m=void 0===f?[]:f,p=(0,a.QP)(),b=p.createReactionFromMessage,h=p.removeReactionFromMessage,v=(0,a.NF)(),y=v.createReactionFromThread,g=v.removeReactionFromThread,_=(t=(0,r.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return s(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),x=_[0],j=_[1],w=(0,o.useMutation)(function(e){return i.ob.addReaction(e)},{onSettled:function(){j(!1)}}).mutateAsync,O=(0,o.useMutation)(function(e){return i.ob.removeReaction(e)},{onSettled:function(){j(!1)}}).mutateAsync,S=(0,o.useQuery)(["reaction",c,u,l],function(){return i.ob.fetchCommunityMemberDetails({ids:m.join(",")})},{onSuccess:function(e){d&&d(e)},enabled:!1}).refetch,P=function(e){null==b||b(e),null==y||y(e)},C=function(e){null==h||h(e),null==g||g(e)};return{addReaction:function(e){j(!0),P({communityMemberId:n,emoji:e.emoji,reactionableId:e.chat_room_message}),w(e)},removeReaction:function(e){j(!0),C({communityMemberId:n,emoji:e.emoji,reactionableId:e.chat_room_message}),O(e)},fetchCommunityMembers:S,isLoading:x}}},68204:function(e,t,n){n.d(t,{Kj:()=>o,Rm:()=>i,pC:()=>r});var r="text-[#6C58E8]",o="copilot",i="activity_scores"},46582:function(e,t,n){n.d(t,{b:()=>M});var r=n(85893),o=n(57105),i=n(84326),a=n(81445),s=n(24869),l=n(69831),c=n(69075),u=n(34519),d=n(41553),f=function(e){var t=e.property,n=e.number,o=e.red,i=void 0!==o&&o,a=10*parseFloat(n);return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"mb-2 flex justify-between",children:[(0,r.jsx)(d.Z.BodyXs,{children:t}),(0,r.jsx)(d.Z.LabelXxs,{weight:"bold",color:i?"text-red-500":"text-green-700",children:n})]}),(0,r.jsx)("div",{className:"bg-tertiary h-1 w-full rounded",children:(0,r.jsx)("div",{className:"h-full rounded ".concat(i?"bg-red-500":"bg-green-700"),style:{width:"".concat(a,"%")}})})]})},m=function(){var e="settings.community_ai.marketing_modal";return(0,r.jsxs)("div",{className:"border-primary rounded border p-5",children:[(0,r.jsx)("div",{className:"mb-1",children:(0,r.jsx)(d.Z.LabelLg,{weight:"bold",color:"text-default",children:(0,i.t)("".concat(e,".activity_score.title"))})}),(0,r.jsx)(d.Z.BodySm,{color:"text-default",children:(0,i.t)("".concat(e,".activity_score.description"))}),(0,r.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,r.jsx)(f,{property:(0,i.t)("".concat(e,".params.presence")),number:"9.5"}),(0,r.jsx)(f,{property:(0,i.t)("".concat(e,".params.contribution")),number:"5.0",red:!0}),(0,r.jsx)(f,{property:(0,i.t)("".concat(e,".params.participation")),number:"8.3"}),(0,r.jsx)(f,{property:(0,i.t)("".concat(e,".params.connection")),number:"8.5"})]})]})},p=n(57363),b=function(e){var t=e.localeItem;return(0,r.jsx)("span",{className:"bg-primary rounded-full px-3 py-1",children:(0,r.jsx)(d.Z.BodyXs,{children:(0,i.t)(["settings.community_ai.marketing_modal","copilot_items",t])})})},h=n(68204),v=function(){var e="settings.community_ai.marketing_modal";return(0,r.jsxs)("div",{className:"border-primary rounded border p-5 pb-0",children:[(0,r.jsx)("div",{className:"mb-1",children:(0,r.jsx)(d.Z.LabelLg,{weight:"bold",color:"text-default",children:(0,i.t)("".concat(e,".copilot.title"))})}),(0,r.jsx)(d.Z.BodySm,{color:"text-default",children:(0,i.t)("".concat(e,".copilot.description"))}),(0,r.jsxs)("div",{className:"relative mt-4 grid grid-cols-2 gap-1 p-4",children:[(0,r.jsx)("div",{className:"absolute inset-0 z-[-1] rounded-t-lg bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600 opacity-5"}),(0,r.jsxs)("div",{className:"flex flex-row",children:[(0,r.jsx)(p.JO,{type:"16-artificial-intelligence",className:"text-blue-100"}),(0,r.jsx)(d.Z.LabelXs,{weight:"semibold",color:h.pC,children:(0,i.t)("".concat(e,".ask_ai_to"))})]}),(0,r.jsx)("div",{className:"col-span-2 flex justify-around",children:["give_me_ideas","translate","generate_a_paragraph"].map(function(e){return(0,r.jsx)(b,{localeItem:e},e)})}),(0,r.jsx)("div",{className:"col-span-2 mt-2 flex justify-around",children:["improve_writing","summarize","adjust_spelling"].map(function(e){return(0,r.jsx)(b,{localeItem:e},e)})})]})]})},y=n(795),g=function(e){var t=e.localeItem;return(0,r.jsxs)("li",{className:"mb-4 flex items-start justify-start last:mb-0",children:[(0,r.jsx)("div",{className:"mt-1 flex h-5 w-5 items-center justify-center",children:(0,r.jsx)(p.JO,{size:14,type:"14-magic-ai"})}),(0,r.jsx)("span",{className:"ml-3 text-blue-100",children:(0,r.jsx)(d.Z.BodySm,{color:"text-default",children:(0,r.jsx)(y.w,{content:(0,i.t)(["settings.community_ai.marketing_modal","marketing_items",t]),as:"span"})})})]})},_=function(e){var t=e.feature;return(0,r.jsx)(u.u_.Body,{children:(0,r.jsx)("div",{className:"flex h-full w-full pt-2",children:(0,r.jsxs)("div",{className:"max-w-xl",children:[t===h.Kj&&(0,r.jsx)(v,{}),t===h.Rm&&(0,r.jsx)(m,{}),(0,r.jsxs)("div",{className:"bg-tertiary mt-6 rounded p-4 pt-2",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(d.Z.LabelXxs,{color:"text-default",children:(0,i.t)("settings.community_ai.marketing_modal.plus")})}),t===h.Kj&&(0,r.jsx)(g,{localeItem:"activity_scores"}),t===h.Rm&&(0,r.jsx)(g,{localeItem:"copilot"}),(0,r.jsx)(g,{localeItem:"transcriptions"})]})]})})})},x=n(70442),j=n(13532),w=n(13847),O=n(79869),S=n(39905);function P(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){P(i,r,o,a,s,"next",e)}function s(e){P(i,r,o,a,s,"throw",e)}a(void 0)})}}function I(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var k=function(e){var t=e.plan,n=e.handleClose,o=e.onSuccess,a=e.source,s=(0,O.w)(),l=(0,x.k6)(),c=(0,w.$2)(),f=function(){return C(function(){return I(this,function(e){switch(e.label){case 0:return l.push(j.Lo.settings.community_ai),o&&o(),[4,n()];case 1:return e.sent(),[2]}})})()};return(0,r.jsxs)(u.u_.Footer,{children:[(0,r.jsx)("div",{children:(0,r.jsx)(S.z,{onClick:function(){return C(function(){return I(this,function(e){switch(e.label){case 0:if(!c)return[3,2];return l.push(j.Lo.settings.community_ai),[4,n()];case 1:return e.sent(),[3,4];case 2:return[4,s.show({planId:t.id,onSuccess:f,source:a,successButtonLabel:(0,i.t)("settings.community_ai.marketing_modal.go_to_community_ai"),showPlanDetails:!0})];case 3:e.sent(),e.label=4;case 4:return[2]}})})()},large:!0,full:!0,variant:"circle",children:(0,i.t)("settings.community_ai.marketing_modal.submit")})}),!c&&(0,r.jsx)("div",{className:"my-3 text-center",children:(0,r.jsx)(d.Z.BodySm,{color:"text-default",children:(0,r.jsx)(y.w,{content:(0,i.t)("settings.community_ai.marketing_modal.by_proceeding",{plan_name:t.display_name,price:t.monthly_base_amount_with_interval}),as:"span"})})})]})},N=function(e){var t=e.handleClose;return(0,r.jsxs)(u.u_.Header,{children:[(0,r.jsxs)(u.u_.Title,{size:"md",className:"w-full text-center",children:[(0,r.jsx)("div",{className:"my-2 inline-block w-auto",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)(d.Z.TitleLg,{children:[(0,i.t)("settings.community_ai.marketing_modal.title.unlock")," ",(0,r.jsx)("span",{className:h.pC,children:(0,i.t)("settings.community_ai.marketing_modal.title.community_ai")})]}),(0,r.jsx)(p.JO,{type:"16-artificial-intelligence",className:"absolute -right-5 -top-1 text-blue-100"})]})}),(0,r.jsx)(d.Z.BodyMd,{color:"text-default",children:(0,i.t)("settings.community_ai.marketing_modal.subtitle")})]}),(0,r.jsx)(u.u_.HeaderActions,{className:"absolute right-0 top-0 mr-6 mt-6",children:(0,r.jsx)(u.u_.CloseButton,{onClick:t})})]})};function A(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var E=function(e){var t=e.afterClose,n=e.feature,d=void 0===n?h.Rm:n,f=e.source,m=e.onSuccess,p=(0,s.E)().changePlanModalParams,b=(0,o.dd)(),v=p(a.o),y=v.planTier,g=v.planId,x=(0,c.R)({planTier:y,planId:String(g)||""}),j=x.plan,w=x.isPlanLoading,O=function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return t&&t(),[4,b.hide()];case 1:return e.sent(),b.remove(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){A(i,r,o,a,s,"next",e)}function s(e){A(i,r,o,a,s,"throw",e)}a(void 0)})})()};return(0,r.jsxs)(u.u_,{title:"".concat((0,i.t)("settings.community_ai.marketing_modal.title.unlock")," ").concat((0,i.t)("settings.community_ai.marketing_modal.title.community_ai")),isOpen:b.visible,onClose:O,children:[(0,r.jsx)(u.u_.Overlay,{}),(0,r.jsx)(u.u_.Content,{size:"md",children:w?(0,r.jsx)("div",{className:"my-28",children:(0,r.jsx)(l.u,{})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N,{handleClose:O}),(0,r.jsx)(_,{feature:d}),(0,r.jsx)(k,{handleClose:O,plan:j,source:f,onSuccess:m})]})})]})},T=o.gk.create(function(e){var t=e.afterClose,n=e.feature,o=void 0===n?h.Rm:n,i=e.source,a=e.onSuccess;return(0,r.jsx)(E,{afterClose:t,feature:o,source:i,onSuccess:a})}),M=function(){return(0,o.dd)(T)}},81445:function(e,t,n){n.d(t,{o:()=>r});var r=n(6082).Gb.business},40761:function(e,t,n){n.d(t,{n:()=>i});var r=n(85893),o=n(1168),i=function(e){var t,n,i=e.question,a=e.onClick,s=e.className,l=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["question","onClick","className"]);return(0,r.jsx)("button",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({type:"button",onClick:a,className:(0,o.A)("focus-visible:!outline-secondary transition-colors duration-200 focus-visible:!outline focus-visible:!outline-2 focus-visible:!outline-offset-2 disabled:cursor-not-allowed","border-primary border","text-secondary","hover:bg-tertiary","disabled:border-gray-300 disabled:text-gray-400 disabled:opacity-50 disabled:hover:bg-transparent","whitespace-normal","rounded-[1.25rem]","px-3.5 py-2","text-left","text-sm font-medium leading-5","dark:text-dark dark:disabled:border-gray-600 dark:disabled:text-gray-500",s)},l),n=n={children:i},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}},82847:function(e,t,n){n.d(t,{F:()=>s});var r=n(67294),o=n(88767),i=n(93199),a=n(95533),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=void 0===t?"":t,s=e.disabled,l=(0,o.useQuery)(["community-inbox","chat-bot","profiles",n],function(){return(0,i.UT)(a.a.communityInbox.botSearch({params:{name:n}}))},{enabled:!(void 0!==s&&s)}),c=l.data,u=l.isLoading;return{botProfiles:(0,r.useMemo)(function(){return(null==c?void 0:c.records)||[]},[null==c?void 0:c.records]),isBotsLoading:u}}},81772:function(e,t,n){n.d(t,{O:()=>a});var r=n(88767),o=n(93199),i=n(95533),a=function(){return{createChat:(0,r.useMutation)(function(e){return(0,o.Cu)(i.a.communityInbox.create(),{community_bot_profile_id:e.id,body:e.body||null})},{onError:function(e){console.error("Error while creating chat",e)}}).mutateAsync}}},10749:function(e,t,n){n.d(t,{Or:()=>s,aO:()=>a,vO:()=>l});var r=n(67294),o=n(61853);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var a={FIRST_LOAD:"FIRST_LOAD",PAGINATION:"PAGINATION",NEW_MESSAGE:"NEW_MESSAGE"},s="scrollableMessagesDiv",l=function(){var e,t=(e=(0,r.useState)(null),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return i(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],l=t[1],c=(0,o.Dk)(),u=c.scrollAction,d=c.setScrollAction,f=(0,r.useRef)(null),m=(0,r.useRef)(0),p=(0,r.useRef)(0),b=(0,r.useCallback)(function(){var e=document.getElementById(s);e&&(m.current=e.scrollHeight,p.current=e.scrollTop)},[]),h=(0,r.useCallback)(function(){var e=document.getElementById(s);if(e){var t=m.current,r=p.current;if(t){var o=e.scrollHeight-t;e.scrollTop=r+o}else if(n){var i,a=null==(i=n.id)?void 0:i.toString(),l=a?document.getElementById(a):null;null==l||l.scrollIntoView()}}},[n]),v=(0,r.useCallback)(function(){var e=document.getElementById(s);e&&(f.current=setTimeout(function(){e.scrollTop=e.scrollHeight},500))},[]),y=(0,r.useCallback)(function(){var e=document.getElementById(s);e&&(e.scrollTop=e.scrollHeight)},[]),g=(0,r.useCallback)(function(){switch(f.current&&u===a.PAGINATION&&clearTimeout(f.current),u){case a.PAGINATION:h();break;case a.FIRST_LOAD:v();break;case a.NEW_MESSAGE:y()}},[u,h,v,y]);return(0,r.useEffect)(function(){return function(){f.current&&clearTimeout(f.current)}},[]),{setFirstMessage:l,setScrollAction:d,preparePagination:b,adjustScroller:g}}},35471:function(e,t,n){n.d(t,{D:()=>i});var r=n(61853),o=n(82847),i=function(){var e=(0,o.F)({name:""}).botProfiles,t=(0,r.Dk)().memberChats;return(null==e?void 0:e.length)>0||(null==t?void 0:t.length)>0}},86976:function(e,t,n){n.d(t,{F8:()=>a,c8:()=>s,g:()=>l});var r=n(88767),o=n(93199),i=n(13532),a="gamification/settings",s=function(){return(0,r.useQuery)({queryKey:a,queryFn:function(){return(0,o.UT)(i.av.gamification.settings())}})},l=function(e){return(0,r.useMutation)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({mutationFn:function(e){return(0,o.aU)(i.av.gamification.settings(),e)}},e))}},56918:function(e,t,n){n.d(t,{z:()=>l});var r=n(85893),o=n(84326),i=n(13847),a=n(35565),s=n(41553);function l(e){var t=e.memberId,n=e.shortDisabledLabel,l=e.shouldHideIfNoScore,c=(0,a.wW)(),u=c.data,d=c.isLoading,f=(0,i.m3)();if(d)return null;if(f){var m={activityScore:{label:void 0!==n&&n?(0,o.t)("activity_score.view"):(0,o.t)("activity_score.view_score"),activity:"disabled"}};return(0,r.jsx)("div",{children:(0,r.jsx)(a.uy,{activityScore:m.activityScore})})}var p=null==u?void 0:u.get(t);return void 0!==l&&l&&!p?null:p?(0,r.jsx)(a.Yf,{scoreDetail:p}):(0,r.jsx)(s.Z.LabelSm,{color:"text-default",children:(0,o.t)("n/a")})}},41331:function(e,t,n){n.d(t,{Q:()=>b});var r=n(85893),o=n(84326),i=n(41553),a=n(94184),s=n.n(a),l=n(795),c=function(e){var t=e.reported_reason_type,n=e.profanity_filter_matches,a=e.reported_reason_body;return t&&n||a?(0,r.jsxs)("div",{className:s()("bg-tertiary ml-12 flex flex-col gap-1.5 rounded-lg px-4 py-3"),children:[t&&n&&(0,r.jsx)(i.Z.LabelSm,{children:(0,r.jsx)(l.w,{content:(0,o.t)(["settings.moderation.review_flagged_content_modal","report_reasons",t],{matches:n}),as:"span"})}),a&&(0,r.jsx)(i.Z.LabelSm,{as:"p","data-testid":"report-reason-body",children:a})]}):null},u=n(57363),d=n(98363),f=n(89745),m="settings.moderation.review_flagged_content_modal",p=function(e){var t=e.reporter,n=e.reported_at,a=e.reported_reason_type,s=e.profanity_filter_matches,l=[null==t?void 0:t.first_name,null==t?void 0:t.last_name].filter(function(e){return e}).join(" ");return t?(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(d.s,{name:l,src:t.avatar_url,size:"8"}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(i.Z.LabelSm,{weight:"semibold",children:l}),(0,r.jsx)(i.Z.LabelSm,{color:"text-dark",children:(0,o.t)([m,"reason_labels.reported_for"])}),(0,r.jsx)(i.Z.LabelSm,{color:"text-dark",weight:"semibold","data-testid":"report-reason-type",children:(0,o.t)([m,"report_reasons",a])})]}),(0,r.jsx)(i.Z.LabelXs,{color:"text-dark",children:(0,f.p)(n)})]})]}):(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-black",children:(0,r.jsx)(u.JO,{type:"lightning",size:16,className:"text-white"})}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(i.Z.LabelSm,{weight:"semibold","data-testid":"report-reason-type",children:(0,o.t)([m,"automatically_flagged"])}),s?(0,r.jsx)(i.Z.LabelSm,{color:"text-dark",children:(0,o.t)([m,"reason_labels.profanity_filter"])}):(0,r.jsx)(i.Z.LabelSm,{color:"text-dark",children:(0,o.t)([m,"reason_labels.for_approval"])})]}),(0,r.jsx)(i.Z.LabelXs,{color:"text-dark",children:(0,f.p)(n)})]})]})},b=function(e){var t=e.reports,n=void 0===t?[]:t;return(0,r.jsxs)("div",{className:"flex flex-col gap-6 px-8 py-6",children:[n.map(function(e){var t=e.id,n=e.reported_reason_type,o=void 0===n?"":n,i=e.reported_reason_body,a=e.reported_at,s=e.reporter,l=e.profanity_filter_matches,u=void 0===l?"":l;return(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)(p,{reporter:s,reported_at:void 0===a?"":a,reported_reason_type:o,profanity_filter_matches:u}),(0,r.jsx)(c,{reported_reason_type:o,profanity_filter_matches:u,reported_reason_body:i})]},t)}),0===n.length&&(0,r.jsx)(i.Z.LabelSm,{color:"text-lightest",children:(0,o.t)(["settings.moderation.review_flagged_content_modal","empty"])})]})}},18285:function(e,t,n){n.d(t,{z:()=>s});var r=n(85893),o=n(84326),i=n(41553),a="settings.moderation.review_flagged_content_modal.visibility_info",s=function(e){var t=e.content;if(!(null==t?void 0:t.flagged_contentable))return null;var n=t.flagged_contentable,s=n.flagged_for_approval_at,l=n.removed_at,c=s||l?(0,o.t)([a,"hidden_until_approved"]):(0,o.t)([a,"visible_to_all_members"]);return(0,r.jsx)("div",{className:"flex items-center gap-4 px-8 py-0",children:(0,r.jsx)(i.Z.LabelSm,{children:c})})}},89745:function(e,t,n){n.d(t,{p:()=>o});var r=n(89889),o=function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,r.Z)(new Date(e),new Date,{addSuffix:t})}},98716:function(e,t,n){n.d(t,{B:()=>a});var r=n(85893),o=n(63549),i=n(41553),a=function(e){var t=e.showModal,n=e.onClose,a=e.onConfirm,s=e.title,l=e.confirmText,c=e.description,u=e.isLoading;return(0,r.jsx)(o.c,{isOpen:t,onClose:n,confirmVariant:"circle",size:"md",onConfirm:a,title:s,confirmText:l,disabled:void 0!==u&&u,children:(0,r.jsx)(i.Z.LabelMd,{children:c})})}},3189:function(e,t,n){n.d(t,{D:()=>l});var r=n(67294),o=n(88767),i=n(93199),a=n(41342),s=n(13532),l=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,a.wh)().currentCommunityMember,n=!!(null==t?void 0:t.is_admin),l=(0,o.useQuery)(["community-current-plan"],function(){return(0,i.UT)(s.av.communities.plans.show({forceFromSubscription:e}))},{retry:2,enabled:!1}),c=l.data,u=l.isLoading,d=l.error,f=l.refetch,m=l.isRefetching;return(0,r.useEffect)(function(){n&&f().catch(function(e){console.error("Error fetching current plan"+e.message)})},[n]),{currentPlan:c,isCurrentPlanLoading:u,errorFetchingCurrentPlan:d,refetchCurrentPlan:f,isRefetchingCurrentPlan:m}}},56336:function(e,t,n){n.d(t,{G7:()=>f,Iq:()=>u,MG:()=>s,N$:()=>l,ij:()=>a,lU:()=>c});var r,o=n(84326);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=10,s="all",l="draft",c="scheduled",u="published",d="settings.posts",f=Object.freeze((i(r={},s,(0,o.t)([d,"tabs","all"])),i(r,l,(0,o.t)([d,"tabs","drafts"])),i(r,c,(0,o.t)([d,"tabs","scheduled"])),r))},76810:function(e,t,n){n.d(t,{D:()=>u,T:()=>d});var r=n(88767),o=n(93199),i=n(13532),a=n(56336);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var c=["settings","posts"],u=function(e){var t,n,u=e.page,d=void 0===u?1:u,f=e.filter,m=e.sort,p=(0,r.useQuery)(((function(e){if(Array.isArray(e))return s(e)})(c)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(c)||function(e,t){if(e){if("string"==typeof e)return s(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}}(c)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([f,d,m]),function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){return[2,(0,o.UT)(i.av.settings.posts.index({params:{filter:f,page:d,per_page:a.ij,sort:m}}))]})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)})})()},{keepPreviousData:!0}),b=p.data,h=p.isLoading,v=p.refetch;return{posts:null!=(t=null==b?void 0:b.records)?t:[],postsCount:null!=(n=null==b?void 0:b.count)?n:0,isLoadingPosts:h,refetchPosts:v}},d=function(){var e=(0,r.useQueryClient)();return{invalidatePostsApiQueries:function(){return e.invalidateQueries(c)}}}},26239:function(e,t,n){n.d(t,{AZ:()=>a,D9:()=>o.D9,FW:()=>f,G7:()=>m,PX:()=>u,Yp:()=>l,Z9:()=>o.Z9,_i:()=>d,av:()=>o.av,k_:()=>c,xg:()=>s});var r,o=n(71066);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a={LABEL:"label",FIELD_TYPE:"field_type",KEY:"key",PLACEHOLDER:"placeholder",DESCRIPTION:"description"},s={REQUIRED:"required",HIDDEN:"hidden"},l=Object.values(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){i(e,t,n[t])})}return e}({},a,s)),c="pages_attributes",u=(i(r={},o.Z9.TEXT,{}),i(r,o.Z9.SELECT,{CHOICES_ATTRIBUTES:"choices_attributes"}),i(r,o.Z9.CHECKBOX,{CHOICES_ATTRIBUTES:"choices_attributes"}),i(r,o.Z9.TEXTAREA,{}),i(r,o.Z9.LINK,{}),i(r,o.Z9.LOCATION,{}),i(r,o.Z9.NUMBER,{NUMBER_OPTIONS:"number_options_attributes"}),r),d=["twitter","facebook","instagram","linkedin"],f=[0,1,2,3,4,5],m={ACTIVE:"active",ARCHIVED:"archived"}},5404:function(e,t,n){n.d(t,{e:()=>c});var r=n(85893),o=n(84326),i=n(57363),a=n(41553),s=n(1168),l=n(75148),c=function(e){var t=e.onCollapseClick;return(0,r.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center p-6",children:[(0,r.jsx)(l.h,{name:"20-close",iconSize:20,onClick:t,variant:"secondary",ariaLabel:(0,o.t)("collapse"),className:(0,s.A)("bg-primary !border-primary absolute right-5 top-5 z-50 rounded-full border")}),(0,r.jsx)("div",{className:"animate-fade-in-slow flex h-full items-center justify-center p-6 opacity-0",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,r.jsx)(i.JO,{type:"48-sun",size:48,className:"scale-[2.5]"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(a.Z.TitleMd,{children:(0,o.t)("ai_spaces_summaries.all_caught_up")}),(0,r.jsx)("div",{className:"max-w-[280px]",children:(0,r.jsx)(a.Z.BodySm,{color:"text-default dark:text-dark",children:(0,o.t)("ai_spaces_summaries.no_posts_found")})})]})]})})]})}},32002:function(e,t,n){n.d(t,{u:()=>k});var r=n(85893),o=n(67294),i=n(60716),a=n(7069),s=n(54559),l=n(84326),c=n(5404),u=n(74527),d=n(73660),f=n(21541),m=n(66162),p=n(71829),b=n(29959),h=n(63676),v=n(1168),y=n(19347),g=n(88767),_=n(93199),x=n(13532),j=n(4393);function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function O(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||S(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}}var P=function(e){var t,n,r,i,a=e.space,s=e.dateFrom,l=e.enabled,c=e.type,u=e.firstUnreadMessageId,d=e.dateRange,m=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||S(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),p=m[0],b=m[1],h=["post"===c?"post-space-summary":"chat-space-summary",a.id].concat(O("post"===c?[a.posts_count]:[]),[d],O(d===f.n.FROM_UNREAD&&u?[u]:[])),v=(0,g.useQueryClient)(),y=(0,g.useQuery)(h,function(){var e={};return s&&(e.date_from=s),u&&(e.first_unread_message_id=u),(0,_.UT)(x.av.spaces.aiSummaries.index({spaceId:String(a.id),params:e}))},{enabled:l,staleTime:6e5,retry:function(e,t){return(null==t?void 0:t.status)!==404&&(null==t?void 0:t.status)!==401&&(null==t?void 0:t.status)!==400}}),w=y.data,P=y.isLoading,C=y.error,I=y.refetch;return(0,o.useEffect)(function(){var e,t;(null==C||null==(t=C.body)||null==(e=t.error_details)?void 0:e.noDataToSummarize)?(0,j.Cp)(Promise.resolve(),3e3).then(function(){b(!0)}):b(!1)},[C]),{spaceSummary:w,isLoadingSpaceSummary:P,refetchSpaceSummary:I,clearSpaceSummary:function(){v.resetQueries({queryKey:h,exact:!0})},isNoDataError:p,contentCutOffMessage:(null==C||null==(r=C.body)||null==(n=r.error_details)?void 0:n.isContentCutOff)&&null!=(i=C.body.message)?i:null}};function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=function(e){var t,n=e.isOpen,g=e.onClose,_=e.space,x=e.dateRange,j=e.type,w=e.shouldHideRailbarDragger,O=e.firstUnreadMessageId,S=(0,o.useMemo)(function(){if(x!==f.n.FROM_UNREAD){var e=(0,i.Z)();return x===f.n.LAST_7_DAYS?(0,a.default)(e,7).toISOString():(0,s.default)(e,1).toISOString()}},[x]),C=P({space:_,dateFrom:x===f.n.FROM_UNREAD?void 0:S,enabled:n,type:j,firstUnreadMessageId:x===f.n.FROM_UNREAD?O:void 0,dateRange:x}),k=C.spaceSummary,N=C.isLoadingSpaceSummary,A=C.isNoDataError,E=C.contentCutOffMessage,T=I((0,o.useState)(!1),2),M=T[0],R=T[1],D=I((0,o.useState)(0),2),L=D[0],F=D[1],U=S?(0,d.An)(new Date(S),new Date):(0,l.t)("ai_spaces_summaries.from_unread"),B=_.name;(0,o.useEffect)(function(){F(function(e){return e+1})},[x]);var q=function(){R(!0),setTimeout(function(){R(!1),g()},p.HL)},z="#rail-bar-header",Z=I((0,o.useState)(null),2),H=Z[0],V=Z[1];if((0,o.useEffect)(function(){V(document.querySelector(z))},[z]),!H)return null;var Q=(k||{}).topics,W=void 0===Q?[]:Q,G=null!=(t=W.flatMap(function(e){return e.relevant_posts}).filter(function(e){return void 0!==e}))?t:[],$=null==k?void 0:k.total_records;return(0,r.jsx)(b.x,{shouldShowRailBar:n,shouldHideRailbarDragger:void 0===w||w,children:(0,r.jsx)(y.S0.Content,{heightGap:16,children:(0,r.jsxs)("div",{className:(0,v.A)("transition-opacity duration-300",{"opacity-0":M,"opacity-100":!M}),children:[(0,r.jsx)("div",{className:"bg-ai-summary absolute inset-0 bg-cover bg-center bg-no-repeat"}),A&&!N?(0,r.jsx)(c.e,{onCollapseClick:q}):(0,r.jsx)("div",{className:"relative",children:(0,r.jsxs)(u.w,{onCollapseClick:q,children:[(0,r.jsx)(m.C,{spaceSummary:k,sourceName:B,formattedDateRange:U,isLoadingSpaceSummary:N,allSources:G,topics:W,contentCutOffMessage:E}),"number"==typeof $&&$>0&&(0,r.jsx)(u.w.Footer,{children:(0,r.jsx)("div",{className:"animate-fade-in-slow opacity-0",style:{animationDelay:(0,p.fZ)(5,W.length),animationFillMode:"forwards"},children:(0,r.jsx)(u.w.FooterNote,{children:(0,l.t)("ai_spaces_summaries.".concat("chat"===j?"messages":"posts","_summarized"),{count:$,formatted_count:(0,h.HA)($)})})})})]})},L)]})})})}},66162:function(e,t,n){n.d(t,{C:()=>f});var r=n(85893),o=n(84326),i=n(71829),a=n(74527),s=n(33609),l=n(32050),c=n(41553),u=function(e){var t=e.formattedDateRange,n=e.sourceName;return(0,r.jsxs)("div",{className:"text-tertiary animate-fade-in-slow mb-2 text-sm opacity-0",style:{animationDelay:(0,i.fZ)(0),animationFillMode:"forwards"},children:[t," ",(0,o.t)("ai_spaces_summaries.bullet")," ",(0,o.t)("ai_spaces_summaries.summary_of"),(0,r.jsx)("div",{className:"animate-fade-in-slow opacity-0",style:{animationDelay:(0,i.fZ)(1),animationFillMode:"forwards"},children:(0,r.jsx)(c.Z.TitleMd,{children:n})})]})},d=function(e){var t=e.topics;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-fade-in-slow mb-2 opacity-0",style:{animationDelay:(0,i.fZ)(3),animationFillMode:"forwards"},children:(0,r.jsx)(c.Z.BodySm,{weight:"medium",as:"strong",children:(0,o.t)("ai_spaces_summaries.takeaways")})}),(0,r.jsx)("ul",{className:"space-y-2",children:t.map(function(e,t){return(0,r.jsx)("li",{className:"animate-fade-in-slow flex items-baseline opacity-0",style:{animationDelay:(0,i.fZ)(t+4),animationFillMode:"forwards"},children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"pt-1",children:(0,r.jsx)(c.Z.BodySm,{weight:"bold",as:"strong",children:e.topic_name})}),(0,r.jsx)(a.w.TextWithUserLinks,{text:e.summary,relevantPosts:e.relevant_posts}),e.summary_subcategories_by_author&&e.summary_subcategories_by_author.length>0&&(0,r.jsx)("ul",{className:"space-y-1",children:e.summary_subcategories_by_author.map(function(n){return(0,r.jsxs)("li",{className:"animate-fade-in-slow flex items-baseline pl-2 opacity-0",style:{animationDelay:(0,i.fZ)(t+4),animationFillMode:"forwards"},children:[(0,r.jsx)("span",{className:"mr-2",children:(0,r.jsx)(c.Z.BodySm,{as:"span",children:(0,o.t)("ai_spaces_summaries.bullet")})}),(0,r.jsx)(a.w.TextWithUserLinks,{text:n})]},"".concat(e.topic_name,"-").concat(n))})})]})},e.topic_name)})})]})},f=function(e){var t=e.spaceSummary,n=e.sourceName,c=e.formattedDateRange,f=e.isLoadingSpaceSummary,m=e.allSources,p=e.topics,b=e.contentCutOffMessage,h=e.events;return(0,r.jsxs)(a.w.Content,{children:[(0,r.jsx)(a.w.Header,{animate:f,isHidden:!f&&(!!t||!!b),children:(0,o.t)("ai_spaces_summaries.generating")}),b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{formattedDateRange:c,sourceName:n}),(0,r.jsx)(l.b,{type:"alert",description:b,className:"text-dark !rounded-2xl !border-2 !border-red-200 bg-red-50 !py-2 !pl-4 !pr-3 text-justify dark:!border-red-800 dark:bg-red-900/20",showIcon:!1})]}),t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{formattedDateRange:c,sourceName:n}),(0,r.jsx)("div",{className:"animate-fade-in-slow opacity-0",style:{animationDelay:(0,i.fZ)(2),animationFillMode:"forwards"},children:(0,r.jsx)(a.w.TextWithUserLinks,{text:t.overview||""})}),(0,r.jsx)("div",{className:"mt-2",children:p.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d,{topics:p}),m.length>0&&(0,r.jsx)("div",{className:"animate-fade-in-slow mt-4 opacity-0",style:{animationDelay:(0,i.fZ)(4,p.length),animationFillMode:"forwards"},children:(0,r.jsx)(s.F,{sources:m})})]})}),h&&(0,r.jsx)("div",{className:"animate-fade-in-slow opacity-0",style:{animationDelay:(0,i.fZ)(5,p.length),animationFillMode:"forwards"},children:(0,r.jsx)(a.w.Section,{title:(0,o.t)("ai_spaces_summaries.events"),text:h})})]})]})}},71829:function(e,t,n){n.d(t,{HL:()=>r,fZ:()=>o});var r=200,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;switch(e){case 0:return"0ms";case 1:return"300ms";case 2:return"600ms";case 3:return"900ms";case 4:return"".concat(1200+(t+1)*300,"ms");case 5:return"".concat(1200+(t+2)*300,"ms");default:return"".concat(1200+(e-4)*300,"ms")}}},38580:function(e,t,n){n.d(t,{V:()=>A});var r=n(85893),o=n(67294),i=n(96486),a=n(58533),s=n(88767),l=n(70442),c=n(84326),u=n(7383),d=n(96533),f=n(3697),m=n(13532),p=n(90926),b=n(41553),h=n(41342),v=n(93199),y=n(63549),g=n(16089),_=n(80132),x=n(75148),j=n(43544),w=n(60878),O=n(32701),S=function(){var e=(0,h.wh)().currentCommunityMember,t=(0,O.L7)();return{shouldShowMessageOption:function(n){return(null==e?void 0:e.id)!==n.community_member_id&&(null==e?void 0:e.messaging_enabled)&&(n.messaging_enabled||e.is_admin)&&t},shouldShowRemoveOption:function(t){return(null==e?void 0:e.id)!==t.community_member_id&&(null==e?void 0:e.is_admin)}}};function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function I(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){C(i,r,o,a,s,"next",e)}function s(e){C(i,r,o,a,s,"throw",e)}a(void 0)})}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var A=function(e){var t=e.spaceMembers,n=e.space,O=e.refetchSpaceMembers,P=e.hasMoreSpaceMembers,C=e.fetchNextPage,A=(0,w.pm)(),E=(0,l.k6)(),T=(0,p.pB)().findOrCreateChatRoom,M=k((0,o.useState)(!1),2),R=M[0],D=M[1],L=k((0,o.useState)(null),2),F=L[0],U=L[1],B=(0,d.r)(),q=(0,h.wh)().isViewOnlyMasquerading,z=S(),Z=z.shouldShowMessageOption,H=z.shouldShowRemoveOption,V="members_directory.community_members.actions.space",Q=(0,s.useMutation)(function(){return I(function(){return N(this,function(e){switch(e.label){case 0:return[4,(0,v.pC)(m.av.spaceMembers.leaveSpace({spaceId:n.id,memberId:null==F?void 0:F.community_member_id}))];case 1:return e.sent(),[2]}})})()},{onError:function(e){A.error(e.message)},onSuccess:function(){A.success((0,c.t)("".concat(V,".successfully_removed"))),O()},onSettled:function(){D(!1)}}),W=Q.mutate,G=Q.isLoading,$=function(e){var t=[{value:"profile",label:(0,c.t)("view_profile"),onClick:function(){return B.show({memberPublicId:null==e?void 0:e.user_public_uid})}}];return Z(e)&&t.push({value:"message",label:(0,c.t)("message"),onClick:q?i.noop:function(){return I(function(){var t;return N(this,function(n){switch(n.label){case 0:return[4,T({kind:f.g8,community_member_ids:[null==e?void 0:e.community_member_id]})];case 1:return(t=n.sent())&&E.push((0,m.co)({url:(0,m.so)({uuid:t})})),[2]}})})()}}),H(e)&&t.push({value:"remove",label:(0,c.t)("remove"),onClick:function(){U(e),D(!0)}}),t},K=(0,u.bb)(t),J=K.onlineParticipants,X=K.offlineParticipants,Y=function(e){return e.map(function(e){return(0,r.jsxs)("button",{type:"button",className:"hover:bg-tertiary chat-space-rail__content--member group flex w-full cursor-pointer justify-between",onClick:function(){return B.show({memberPublicId:null==e?void 0:e.user_public_uid})},children:[(0,r.jsxs)("div",{className:"text-dark flex w-[90%] items-center text-left",children:[(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(g.g,{name:null==e?void 0:e.name,src:null==e?void 0:e.avatar_url,status:null==e?void 0:e.status,size:"8"})}),(0,r.jsx)("div",{className:"truncate font-medium",children:null==e?void 0:e.name}),(null==e?void 0:e.community_admin)?(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)(_.I,{label:(0,c.t)("admin"),isAdmin:!0})}):(null==e?void 0:e.moderator)&&(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)(_.I,{label:(0,c.t)("moderator")})})]}),(0,r.jsx)("button",{type:"button",onClick:function(e){e.stopPropagation()},children:!q&&(0,r.jsx)(j.Lt,{direction:"bottom-start",menuButtonEl:"div",button:(0,r.jsx)(j.Lt.MenuButton,{id:"action-block",children:(0,r.jsx)(x.h,{name:"20-menu-dots-horizontal",iconSize:20,ariaLabel:(0,c.t)("chat_space.view_member_actions")})}),options:$(e)})})]},null==e?void 0:e.id)})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{id:"scrollableDiv",className:"chat-space-rail__content p-0 md:pb-4",style:{height:"100%",overflow:"auto"},children:(0,r.jsxs)(a.Z,{scrollThreshold:.8,next:C,hasMore:void 0!==P&&P,dataLength:t.length,className:"p-0 px-6 pb-12",scrollableTarget:"scrollableDiv",loader:(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(b.Z.LabelXxs,{children:(0,c.t)("toggle_with_loader.loading")})}),children:[J.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-default mb-2",children:(0,r.jsx)(b.Z.LabelXxs,{weight:"bold",color:"text-default",children:(0,c.t)("chat_space.online")})}),Y(J)]}),X.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-default my-2",children:(0,r.jsx)(b.Z.LabelXxs,{weight:"bold",color:"text-default",children:(0,c.t)("chat_space.offline")})}),Y(X)]})]})}),(0,r.jsx)(y.c,{isOpen:R,title:(0,c.t)("remove"),onClose:function(){return D(!1)},onCancel:function(){return D(!1)},onConfirm:W,confirmText:G?(0,c.t)("removing"):(0,c.t)("remove"),disabled:G,confirmVariant:"danger",children:(0,c.t)("".concat(V,".confirm_remove"),{community_member:null==F?void 0:F.name,space:n.name})})]})}},18409:function(e,t,n){n.d(t,{G:()=>g});var r=n(85893),o=n(84326),i=n(34519),a=n(57105),s=n(11944),l=n(70434),c=n(21804),u=n(39905),d=n(51466),f=n(41553),m=function(e){var t=e.createEmbed,n=e.onClose;return(0,r.jsx)(d.l,{onSubmit:function(e){t(e.url),n()},validationSchema:(0,c.o)(),children:(0,r.jsxs)("div",{className:"mx-8 flex h-full flex-col items-center rounded-md",role:"tabpanel",children:[(0,r.jsx)(d.l.Item,{name:"url",fullWidth:!0,hideBorder:!0,hideLabel:!0,hideDescription:!0,className:"!pt-0",placeholder:(0,o.t)("courses.edit.lesson.embed_placeholder"),children:(0,r.jsx)(d.l.Input,{})}),(0,r.jsxs)("div",{className:"mt-12 text-center",children:[(0,r.jsx)(u.z,{type:"submit",variant:"primary",children:(0,o.t)("courses.edit.lesson.embed_media")}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)(f.Z.LabelSm,{weight:"semibold",children:[(0,o.t)("courses.edit.lesson.embed_description")," ",(0,r.jsx)("span",{className:"border-primary inline-flex border-b border-dotted",children:(0,r.jsx)(l.Y,{placement:"bottom-end",content:(0,o.t)("courses.edit.lesson.embed_providers_list"),className:"inline-flex",children:(0,o.t)("courses.edit.lesson.embed_description_more")})})]})})]})]})})},p=n(57363),b=function(e){var t,n,i=e.getRootProps,a=e.openFilePicker;return(0,r.jsxs)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:"border-primary mx-8 my-6 flex flex-col items-center justify-center rounded-md border border-dotted py-6",role:"tabpanel"},i()),n=n={children:[(0,r.jsx)(p.JO,{size:42,className:"h-[42px] !w-[42px]",type:"new-file-plus"}),(0,r.jsx)("div",{className:"text-dark mb-1 mt-5",children:(0,r.jsx)(f.Z.LabelSm,{weight:"semibold",children:(0,o.t)("courses.edit.lesson.drop_here")})}),(0,r.jsx)("div",{className:"text-default mb-6",children:(0,r.jsx)(f.Z.LabelSm,{children:(0,o.t)("courses.edit.lesson.drop_placeholder")})}),(0,r.jsx)(u.z,{type:"button",onClick:a,variant:"primary",children:(0,o.t)("courses.edit.lesson.choose_a_file")})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))},h={upload:(0,o.t)("courses.edit.lesson.upload"),embed:(0,o.t)("courses.edit.lesson.embed")},v=function(e){var t=e.createEmbed,n=e.openFilePicker,o=e.getRootProps,l=(0,a.dd)(),c=l.remove;return(0,r.jsxs)(i.u_,{isOpen:l.visible,onClose:l.remove,children:[(0,r.jsx)(i.u_.Overlay,{}),(0,r.jsx)(i.u_.Content,{size:"lg",className:"h-64 py-3",children:(0,r.jsxs)(s.O.Group,{className:"mt-3 overflow-hidden md:mt-0",children:[(0,r.jsxs)(s.O.List,{className:"border-b px-8",children:[(0,r.jsx)(s.O,{className:"!text-sm md:!text-base",children:h.upload}),(0,r.jsx)(s.O,{className:"!text-sm md:!text-base",children:h.embed})]}),(0,r.jsxs)(s.O.Panels,{children:[(0,r.jsx)(s.O.Panel,{children:(0,r.jsx)(b,{getRootProps:o,openFilePicker:n})}),(0,r.jsx)(s.O.Panel,{className:"py-[52px]",children:(0,r.jsx)(m,{onClose:c,createEmbed:t})})]})]})})]})},y=a.gk.create(function(e){return(0,r.jsx)(v,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),g=function(){return(0,a.dd)(y)}},29832:function(e,t,n){n.d(t,{S:()=>f});var r=n(67294),o=n(29656),i=n(51606),a=n(96486),s=n(23428),l=n(18409);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=function(e){var t=e.onUploadStarted,n=void 0===t?a.noop:t,c=e.onUploadComplete,f=void 0===c?a.noop:c,m=e.onUploadFailed,p=void 0===m?a.noop:m,b=e.allowedFileTypes,h=void 0===b?void 0:b,v=d((0,r.useState)(!1),2),y=v[0],g=v[1],_=d((0,r.useState)(!1),2),x=_[0],j=_[1],w=d((0,r.useState)(0),2),O=w[0],S=w[1],P=d((0,r.useState)(!1),2),C=P[0],I=P[1],k=(0,l.G)(),N=(0,r.useMemo)(function(){return new i.Z({restrictions:{maxNumberOfFiles:1,allowedFileTypes:h},autoProceed:!1}).use(o.Z,{limit:10,endpoint:"/",getChunkSize:function(e){return Math.max(0x1900000,Math.ceil(e.size/500))},shouldUseMultipart:!0}).on("file-added",function(e){var t;return(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(n){switch(n.label){case 0:k.hide(),g(!0),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(0,s.L)(e.data)];case 2:return t=n.sent(),N.setState(t),N.setState({retries:2}),N.setFileMeta(e.id,{key:t.key}),N.upload(),[3,4];case 3:return console.error(n.sent()),g(!1),p(),[3,4];case 4:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)})})()}).on("upload",function(){g(!1),j(!0),n()}).on("upload-progress",function(e,t){var n=0;0!==t.bytesUploaded&&(n=t.bytesUploaded/t.bytesTotal),S(100*n)}).on("upload-success",function(e){var t=N.getState(),n=t.checksum,r=t.id,o=t.created_at,i=t.attachable_sgid,a=t.service_name,s=t.signed_id,l=t.key;f({attachable_sgid:i,byte_size:e.size,checksum:n,content_type:e.type,created_at:o,filename:e.name,id:r,service_name:a,signed_id:s,key:l}),j(!1)}).on("error",function(){g(!1),j(!1);var e=N.getState().retries;if(0===e)return void p();I(!0),setTimeout(function(){N.setState({retries:e-1}),I(!1),N.retryAll()},5e3)}).on("cancel-all",function(){j(!1),g(!1)})},[]);return{uppy:N,isUploading:x,isRetrying:C,progress:O,isProcessingChecksum:y}}},58808:function(e,t,n){n.d(t,{z:()=>d});var r=n(88767),o=n(70442),i=n(84326),a=n(93199),s=n(13532),l=n(41342),c=n(18580),u=n(60878),d=function(e){var t=e.forEdition,n=void 0!==t&&t,d=(0,o.UO)(),f=d.lessonId,m=d.sectionId,p=(0,r.useQueryClient)(),b=(0,l.L2)().data,h=(0,u.pm)(),v=(0,r.useQuery)(["lesson",f,null==b?void 0:b.id,m],function(){return(0,a.UT)(s.av.courses.getLesson({courseId:b.id,lessonId:f,sectionId:m,params:{for_edition:n}}))},{enabled:!!f&&!!b&&!!m,refetchOnWindowFocus:!1,retry:0,onError:function(e){(null==e?void 0:e.status)===401&&(window.location.href="/")}}),y=v.data,g=v.isLoading,_=v.remove,x=(0,r.useMutation)(function(e){return(0,a.aU)(s.av.courses.updateLesson({courseId:b.id,lessonId:f,sectionId:m}),{course_lesson:e})},{onSuccess:function(){_(),p.removeQueries((0,c.hE)(f)),h.success(i.Z.t("courses.edit.lesson.changes_saved"))},onError:function(e){h.error(e.errorDetails)}}),j=x.mutate,w=x.isLoading,O=(0,r.useMutation)(function(e){var t=e.spaceId,n=e.sectionId,r=e.lessonId;return(0,a.Cu)(s.av.courses.duplicateLesson({courseId:t,sectionId:n,lessonId:r}))},{onError:function(){return h.error(i.Z.t("courses.edit.lesson.duplication_error"))}}).mutateAsync;return{currentLesson:y,isLoading:g,updateLesson:j,isUpdatingLesson:w,updateFilesOrder:(0,r.useMutation)(function(e){var t=e.filesOrder;return(0,a.aU)(s.av.courses.updateLesson({courseId:b.id,lessonId:f,sectionId:m}),{course_lesson:{files_order:t}})}).mutate,duplicateLesson:O}}},24512:function(e,t,n){n.d(t,{d:()=>i});var r=n(84326),o=n(41342),i=function(){var e=(0,o.L2)().data,t=(null==e?void 0:e.lesson_label)||"lesson",n=(null==e?void 0:e.section_label)||"section";return{lessonLabel:t,sectionLabel:n,translatedLabels:{lesson:{singular:(0,r.t)("courses.labels.".concat(t,".singular")),plural:(0,r.t)("courses.labels.".concat(t,".plural"))},section:{singular:(0,r.t)("courses.labels.".concat(n,".singular")),plural:(0,r.t)("courses.labels.".concat(n,".plural"))}}}}},40382:function(e,t,n){n.d(t,{l:()=>Z});var r=n(85893),o=n(67294),i=n(94184),a=n.n(i),s=n(96486),l=n(21044),c=n(27053),u=n(54252),d=n(57105),f=n(41342),m=n(88241),p=n(34519),b=function(e){var t=e.post,n=e.spaceId,o=e.startingImageIndex,i=(0,d.dd)();return(0,r.jsx)(f.mE,{spaceId:n,children:(0,r.jsx)(m._x,{perPagePostIds:[[null==t?void 0:t.id]],children:(0,r.jsx)(f.DW,{post:t,usedIn:"mobile-full-carousel-modal",children:(0,r.jsxs)(p.u_,{isOpen:i.visible,onClose:i.remove,contentPortalId:"mobile-full-carousel-modal-portal",children:[(0,r.jsx)(p.u_.Overlay,{}),(0,r.jsx)(p.u_.Content,{size:"full",className:"h-full",children:(0,r.jsx)(Z,{startingImageIndex:o})})]})})})})},h=d.gk.create(function(e){return(0,r.jsx)(b,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),v=n(84326),y=n(57363),g=n(51945),_=function(e){var t=e.image,n=e.canDownload,o=(0,d.dd)();return(0,r.jsxs)("div",{className:"flex justify-end gap-2 pr-2 pt-2",children:[n&&(0,r.jsx)("a",{href:t.original_url,download:!0,"aria-label":(0,v.t)("download"),className:"text-dark hover:text-dark focus:text-dark",children:(0,r.jsx)(y.JO,{type:"16-download",size:16,useWithFillCurrentColor:!0})}),(0,r.jsx)(g.o,{onClick:o.remove})]})},x=n(17617),j=function(e){var t,n=e.image,o=(0,f.Zh)().record,i=(0,x.en)();return(0,r.jsx)("div",{className:a()("absolute right-4 top-4 z-[2] flex",{"hidden group-hover:flex":i}),children:(null==o||null==(t=o.gallery)?void 0:t.downloadable_images)&&(0,r.jsx)("a",{href:n.original_url,download:!0,"aria-label":(0,v.t)("download"),className:"flex h-8 w-8 justify-center rounded-full bg-black p-1 text-white transition-transform hover:text-white focus:text-white",children:(0,r.jsx)(y.JO,{type:"16-download",size:16,useWithFillCurrentColor:!0})})})};function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var S=function(e){var t=e.image,n=e.positionClassName,i=e.containerWidth,s=e.currentImageIndex,l=e.index,c=e.usedIn,u=e.shouldAnimate,d=e.zoomLevel,f=e.zoomPosition,m=O((0,o.useState)(),2),p=m[0],b=m[1],h=O((0,o.useState)("lazy"),2),v=h[0],y=h[1];return!p&&s+1>=l&&(b(t.url),l>1&&y("eager")),p&&p!==t.url&&b(t.url),(0,r.jsxs)("div",{className:a()("relative flex h-full w-full shrink-0 grow-0 basis-full items-center justify-center",{"transition-transform duration-300":u,"z-[1]":s===l}),style:{transform:i?"translateX(-".concat(i*s,"px)"):void 0},children:["full-post-modal"===c&&s===l&&(0,r.jsx)(j,{image:t}),"mobile-full-carousel-modal"!==c&&(0,r.jsx)("div",{className:"carousel-image absolute inset-0 scale-110 bg-cover bg-center blur-lg",style:{backgroundImage:p&&"url(".concat(p,")")}}),(0,r.jsx)("img",{className:a()("carousel-image relative select-none",{"transition-transform":d},n),draggable:!1,loading:v,alt:"",src:p,style:{transform:d&&d>1?"translate(".concat(f[0],"px, ").concat(f[1],"px) scale(").concat(d,")"):void 0}})]})},P=n(75148),C=function(e){var t=e.direction,n=e.onClick;return(0,r.jsx)(P.h,{name:"20-chevron-".concat("prev"===t?"left":"right"),iconSize:20,onClick:n,iconClassName:"!text-gray-600",className:a()("absolute top-1/2 z-[2] hidden -translate-y-1/2 rounded-full border border-gray-300 bg-white hover:!bg-[#F7F9FA] focus:!bg-[#F7F9FA] sm:group-hover:flex",{"left-4":"prev"===t,"right-4":"next"===t}),ariaLabel:"prev"===t?(0,v.t)("previous"):(0,v.t)("next")})},I=function(e,t){var n;return e&&t&&(n=e>t?"w-full":e<t?"h-full":"h-full w-full"),n};function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var A=16/9,E=function(e,t,n){var r,i=N((0,o.useState)(),2),a=i[0],s=i[1],l=N((0,o.useState)(),2),c=l[0],u=l[1],d=N((0,o.useState)(),2),f=d[0],m=d[1];return(0,o.useEffect)(function(){if(e&&t.current){var r=t.current,o=r.clientWidth,i=r.clientHeight,a=e>A?A:e,l=o/a;"full-post-modal"===n?(s("100%"),m(o/i)):l>678?(s(678),m(o/678)):(s(l),m(a)),u(o)}},[t,e,n,null==(r=t.current)?void 0:r.clientWidth]),{containerCalculatedHeight:a,containerWidth:c,containerRatio:f}},T=function(e){var t=e.images,n=e.currentImageIndex,i=e.onPrevImage,s=e.onNextImage,l=e.usedIn,c=e.shouldAnimate,u=e.zoomLevel,d=e.zoomPosition,f=e.shouldHaveRoundedBottomCorners,m=(0,o.useRef)(null),p=t[0].width/t[0].height,b=E(p,m,l),h=b.containerRatio,v=b.containerCalculatedHeight,y=b.containerWidth,g=I(p,h);return(0,r.jsxs)("div",{className:a()("group relative flex items-center overflow-hidden",{"lg:h-full":"full-post-modal"===l,"md:rounded-b-lg":void 0!==f&&f}),style:{height:"full-post-modal"!==l?v:void 0},ref:m,children:[t.map(function(e,t){return(0,r.jsx)(S,{image:e,currentImageIndex:n,index:t,positionClassName:g,containerWidth:y,usedIn:l,shouldAnimate:c,zoomLevel:u,zoomPosition:d},e.id)}),n>0&&(0,r.jsx)(C,{onClick:i,direction:"prev"}),n<t.length-1&&(0,r.jsx)(C,{onClick:s,direction:"next"})]})},M=function(e){var t=e.images,n=e.currentImageIndex,o=e.setCurrentImageIndex,i=e.usedIn,s=(0,x.en)(),l=(0,c.m)().isPostBodyEmpty;return t.length<2?"mobile-full-carousel-modal"===i?(0,r.jsx)("div",{className:"!pt-0 pb-12"}):null:(0,r.jsx)("div",{className:a()("z-[2] w-full justify-center pt-5",{"absolute bottom-4 left-1/2 flex w-auto -translate-x-1/2 !pt-0":s,"pb-5":!s&&("full-post-modal"===i||l),"!pt-0 pb-12":"mobile-full-carousel-modal"===i}),children:(0,r.jsx)("div",{className:a()("bg-primary flex justify-center gap-1 rounded-xl p-0",{"!bg-white !p-2":s}),children:t.map(function(e,i){return(0,r.jsx)("button",{type:"button","aria-label":(0,v.t)("image_space.carousel.indicator_button",{image_index:i+1,total_images:t.length}),onClick:function(){return o(i)},className:a()("border-3 h-1.5 w-1.5 rounded-full",{"border-dark":!s&&i!==n,"border-gray-300":s&&i!==n,"border-darkest":!s&&i===n,"border-gray-900":s&&i===n})},e.id)})})})};function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function D(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var F=function(e){var t,n;return"clientX"in e&&"clientY"in e?(t=e.clientX,n=e.clientY):"touches"in e&&e.touches.length>0&&(t=e.touches[0].clientX,n=e.touches[0].clientY),[t,n]},U=function(e,t,n){if(void 0===t||1===t||!D(e.target,HTMLImageElement))return n;var r=e.target,o=r.parentNode;if(!D(o,HTMLDivElement))return n;var i=o.getBoundingClientRect(),a=r.getBoundingClientRect(),s=i.left+i.width/2,l=i.top+i.height/2,c=L(F(e),2),u=c[0],d=c[1];if(void 0===u||void 0===d)return n;var f=(s-u)*(t-1),m=(l-d)*(t-1),p=f-n[0],b=m-n[1];return(a.left+p>i.left||a.right+p<i.right)&&(f=n[0]),(a.top+b>i.top||a.bottom+b<i.bottom)&&(m=n[1]),[f,m]},B=function(e){var t=L((0,o.useState)(e?1:void 0),2),n=t[0],r=t[1],i=L((0,o.useState)([0,0]),2),a=i[0],l=i[1],c=(0,o.useMemo)(function(){return(0,s.throttle)(function(e){l(function(t){return U(e,n,t)})},50)},[n,l]);return{zoomLevel:n,resetZoom:function(){l([0,0]),r(1)},cycleZoom:function(){r(function(e){return 1===e?2:2===e?3:1})},zoomPosition:a,setZoomPosition:l,onMouseMove:(0,o.useCallback)(function(e){e.persist(),c(e)},[c])}};function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Z=function(e){var t,n,i,m,p=e.onPostChange,b=void 0===p?s.noop:p,v=e.onPostDestroy,y=void 0===v?s.noop:v,g=e.startingImageIndex,j=void 0===g?0:g,w=e.className,O=(0,f.Zh)(),S=O.record,P=O.usedIn,C="full-post-modal"===P,I="mobile-full-carousel-modal"===P,k="full-post-modal"!==P&&"mobile-full-carousel-modal"!==P,N=(0,c.m)().isPostBodyEmpty,A=k&&(null==S?void 0:S.is_liking_disabled)&&(null==S?void 0:S.is_comments_disabled)&&N,E=z((0,o.useState)(j),2),R=E[0],D=E[1],L=B(C),F=L.zoomLevel,U=L.onMouseMove,q=L.resetZoom,Z=L.cycleZoom,H=L.zoomPosition,V=z((0,o.useState)(0===j),2),Q=V[0],W=V[1],G=(0,f.L2)().data,$=(0,u.F)(),K=(0,d.dd)(h),J=(0,x.WJ)(),X=!(0,x.WJ)(),Y=C||I,ee=(0,c.m)(),et=ee.isSharedPostView,en=ee.isSharedPostWithTeaserLayout,er=null==S||null==(i=S.gallery)?void 0:i.images,eo=en&&er?er.slice(0,1):er,ei=function(){C&&q(),W(!0),D(function(e){return Math.min(e+1,eo?eo.length-1:e+1)})},ea=function(){C&&q(),W(!0),D(function(e){return Math.max(e-1,0)})},es=(0,l.QS)({onSwipedRight:F&&F>1?void 0:ea,onSwipedLeft:F&&F>1?void 0:ei,onTap:function(e){e.event.target.classList.contains("carousel-image")&&!en&&(C?Z():X?K.show({post:S,spaceId:null==G?void 0:G.id,startingImageIndex:R}):J&&$.show({post:S,spaceId:null==G?void 0:G.id,onPostChange:b,onPostDestroy:y,isSharedPostView:et,startingImageIndex:R}))},trackMouse:!0});return S&&eo?(0,r.jsxs)("div",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({className:a()("group relative w-full cursor-pointer px-0 pt-5",{"!py-0 lg:h-full":C,"flex h-full flex-col justify-between !py-0":I,"!cursor-zoom-in":C,"!pt-0":!N,"mb-5":!N&&!Y},void 0===w?"":w),onMouseMove:C?U:void 0,onTouchMove:C?U:void 0},es),n=n={children:[I&&(0,r.jsx)(_,{canDownload:null==S||null==(m=S.gallery)?void 0:m.downloadable_images,image:eo[R]}),(0,r.jsx)(T,{images:eo,currentImageIndex:R,onPrevImage:ea,onNextImage:ei,usedIn:P,shouldAnimate:Q,zoomLevel:F,zoomPosition:H,shouldHaveRoundedBottomCorners:A}),(0,r.jsx)(M,{images:eo,currentImageIndex:R,setCurrentImageIndex:function(e){C&&q(),D(e)},usedIn:P})]},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t)):null}},54252:function(e,t,n){n.d(t,{F:()=>w});var r=n(85893),o=n(67294),i=n(94184),a=n.n(i),s=n(88767),l=n(7992),c=n(1892),u=n(57105),d=n(41342),f=n(88241),m=n(34519),p=n(40382),b=n(84326),h=n(24921),v=n(51945),y=n(41553),g=function(e){var t=e.onPostChange,n=e.onPostDestroy,o=e.autofocusReplyForm,i=e.scrollableTarget,a=(0,u.dd)(),c=(0,d.Zh)().record,f=(0,s.useQueryClient)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"border-primary flex justify-between border-y p-6 pb-5 sm:border-t-0",children:[(0,r.jsx)(y.Z.TitleSm,{weight:"semibold",children:(0,b.t)("image_space.grid_view.post_details")}),(0,r.jsx)(v.o,{onClick:function(){f.invalidateQueries([l.b,c.id]),a.remove()}})]}),(0,r.jsx)(h.D,{defaultShowComment:!0,autofocusReplyForm:o,onPostChange:t,onPostDestroy:function(e){a.remove(),n(e)},hideShareLink:!0,hidePinnedToTopIcon:!0,hideBookmarkButton:!0,tagsLimit:1,tagsShowMoreLabelVariant:"numbers",metaInfoWrapperClassName:"!pr-0",scrollableTarget:i})]})},_=function(e){var t=e.onPostChange,n=e.onPostDestroy,i=e.startingImageIndex,a=e.autofocusReplyForm,s=(0,o.useRef)(null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex max-h-full w-full flex-col overflow-auto lg:h-full lg:w-3/5 xl:w-2/3",children:(0,r.jsx)(p.l,{startingImageIndex:i})}),(0,r.jsx)("div",{className:"border-primary flex w-full flex-col lg:h-full lg:w-2/5 lg:overflow-scroll lg:border-l xl:w-1/3",ref:s,children:(0,r.jsx)(g,{onPostChange:t,onPostDestroy:n,autofocusReplyForm:a,scrollableTarget:s})})]})},x=function(e){var t=e.post,n=e.spaceId,i=e.onPostChange,p=e.onPostDestroy,b=e.startingImageIndex,h=e.autofocusReplyForm,v=e.isSharedPostView,y=(0,u.dd)(),g=(0,o.useRef)(null),x=(0,c.t)({spaceId:null==t?void 0:t.space_id,spaceSlug:null==t?void 0:t.space_slug,postSlug:null==t?void 0:t.slug}),j=x.post,w=x.onPostChange,O=(0,s.useQueryClient)();return(0,r.jsx)(d.mE,{spaceId:n,children:(0,r.jsx)(f._x,{perPagePostIds:[[null==t?void 0:t.id]],isSharedPostView:void 0!==v&&v,children:(0,r.jsx)(d.DW,{post:j||t,usedIn:"full-post-modal",children:(0,r.jsxs)(m.u_,{initialFocus:g,isOpen:y.visible,onClose:function(){O.invalidateQueries([l.b,null==t?void 0:t.id]),y.remove()},contentPortalId:"full-post-modal-portal",children:[(0,r.jsx)(m.u_.Overlay,{}),(0,r.jsxs)(m.u_.Content,{size:"full",className:a()("flex !flex-row flex-wrap content-start sm:!max-h-[836px] sm:!max-w-[1256px]"),children:[(0,r.jsx)("div",{ref:g,tabIndex:-1}),(0,r.jsx)(_,{onPostChange:function(e,t){i(e),w(e,t)},onPostDestroy:p,startingImageIndex:b,autofocusReplyForm:void 0!==h&&h})]})]})})})})},j=u.gk.create(function(e){return(0,r.jsx)(x,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e))}),w=function(){return(0,u.dd)(j)}},66249:function(e,t,n){n.d(t,{Jl:()=>a,NU:()=>s,X2:()=>l});var r=n(88767),o=n(93199),i=n(13532),a="topics",s="courseTopics",l=function(e){var t=e.isCourseDirectory,n=e.spaceId,l=(0,r.useQuery)(t?[s]:[a,n],function(){return t?(0,o.UT)(i.av.courseTopics.index()):(0,o.UT)(i.av.topics.spaceTopics({spaceId:n}))},{enabled:t||!!n}),c=l.data,u=l.isLoading;return{topics:(null==c?void 0:c.records)||[],isLoading:u}}},51433:function(e,t,n){n.d(t,{$:()=>r});var r=function(e){var t=e.shouldShowLockIconForNonMembers,n=e.isPrivate,r=e.isAdmin;return!(void 0!==r&&r)&&n&&t}},99666:function(e,t,n){n.d(t,{O:()=>s});var r=n(85893),o=n(94184),i=n.n(o),a=n(84326),s=function(e){var t=e.value,n=e.handleFeedback,o=e.isFeedbackGiven,s=void 0===o?null:o;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:i()("w-full rounded-lg border px-6 py-2.5 align-baseline font-medium",{"text-dark border-gray-300 dark:border-gray-500":null===t||!1===t,"border-circle text-circle border-2":!0===t,"!cursor-not-allowed":s,"hover:border-secondary dark:hover:border-secondary":!s}),onClick:function(){return!0!==t&&n(!0)},type:"button",children:(0,a.t)("support_widget.feedback_yes")}),(0,r.jsx)("button",{className:i()("w-full rounded-lg border px-6 py-2.5 align-baseline font-medium",{"text-dark border-gray-300 dark:border-gray-500":null===t||!0===t,"border-circle text-circle border-2":!1===t,"!cursor-not-allowed":s,"hover:border-secondary dark:hover:border-secondary":!s}),onClick:function(){return!1!==t&&n(!1)},type:"button",children:(0,a.t)("support_widget.feedback_no")})]})}},34755:function(e,t,n){n.d(t,{H:()=>u});var r=n(85893),o=n(67294),i=n(52293),a=n(41342),s=n(65631),l=n(51466),c=n(51169),u=function(e){var t=e.formItemName,n=e.formItemTranslationRoot,u=e.formItemRules,d=e.formItemTooltipText,f=e.formItemClassName,m=e.disabled,p=e.markDefaultCurrencyDirty,b=void 0!==p&&p,h=e.dataTestId,v=(0,i.Gc)(),y=v.watch,g=v.setValue,_=y(t),x=(0,a.wh)(),j=x.data,w=x.isLoading,O=null==j?void 0:j.current_community_settings,S=(0,s.K)(),P=S.data,C=S.isLoading;if((0,o.useEffect)(function(){if(!_){var e=(P||[]).find(function(e){return e.is_default});e&&(b?g(t,"".concat(e.id),{shouldDirty:!0}):g(t,"".concat(e.id)))}},[t,g,P,_]),w||C||!P)return(0,r.jsx)(c.a,{});if(!(null==O?void 0:O.currencies_enabled))return null;var I=P.map(function(e){return{label:e.code.toUpperCase(),value:"".concat(e.id)}});return(0,r.jsx)(l.l.Item,{className:f,fullWidth:!1,hideBorder:!0,hideDescription:!0,hidePlaceholder:!0,name:t,rules:u,translationRoot:n,tooltipText:d,children:(0,r.jsx)(l.l.SelectNative,{name:t,options:I,disabled:m,"data-testid":h})})}},23428:function(e,t,n){n.d(t,{L:()=>c});var r=n(8322),o=n.n(r),i=n(13532);function a(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)})}}function l(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var c=function(e){return s(function(){var t,n;return l(this,function(r){switch(r.label){case 0:return[4,u(e)];case 1:return t=r.sent(),n=document.querySelector("meta[name=csrf-token]").content,[4,fetch((0,i.hq)(),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":n},body:JSON.stringify({blob:{filename:e.name,content_type:e.type,byte_size:e.size,checksum:t}})})];case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}})})()},u=function(e){return s(function(){return l(this,function(t){return[2,new Promise(function(t,n){var r=Math.ceil(e.size/2097152),i=0,a=new(o()).ArrayBuffer,s=new FileReader,l=function(){if(i<r||0===i&&0===r){var t=2097152*i,n=Math.min(t+2097152,e.size),o=(File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice).call(e,t,n);return s.readAsArrayBuffer(o),i++,!0}return!1};s.addEventListener("load",function(e){a.append(e.target.result),l()||t(btoa(a.end(!0)))}),s.addEventListener("error",function(){return n("Error reading ".concat(e.name))}),l()})]})})()}},60622:function(e,t,n){n.d(t,{T:()=>i});var r=n(85893),o=n(41342),i=function(e){var t=e.children;return(0,o.wh)().isViewOnlyMasquerading?(0,r.jsx)("div",{className:"!cursor-not-allowed",children:(0,r.jsx)("div",{className:"!pointer-events-none",children:t})}):(0,r.jsx)(r.Fragment,{children:t})}},13382:function(e,t,n){n.d(t,{X:()=>r});var r={USD:{code:"USD",flag:"\uD83C\uDDFA\uD83C\uDDF8",symbol:"$"},BRL:{code:"BRL",flag:"\uD83C\uDDE7\uD83C\uDDF7",symbol:"R$"}};r.USD},40539:function(e,t,n){n.d(t,{D:()=>c,d:()=>l});var r=n(85893),o=n(67294);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=(0,o.createContext)({});s.displayName="CurrentLessonContext";var l=function(e){var t=e.children,n=a((0,o.useState)(!0),2),i=n[0],l=n[1],c=a((0,o.useState)({}),2),u=c[0],d=c[1];return(0,r.jsx)(s.Provider,{value:{isSubmitEnabled:i,setIsSubmitEnabled:l,currentLesson:u,setCurrentLesson:d},children:t})},c=function(){var e=(0,o.useContext)(s);if(!e)throw Error("useCurrentLessonContext must be used within a CurrentLessonContextProvider");return e}},76012:function(e,t,n){n.d(t,{hg:()=>U,Vu:()=>B});var r=n(85893),o=n(67294),i=n(96486),a=n(57105),s=n(88767),l=n(69293),c=n(93199),u=n(13532),d=n(44102),f=n(48298),m=n(34519),p=n(84326),b=n(57363),h=n(41553),v=function(){return(0,r.jsx)("div",{className:"bg-primary m-auto text-center",children:(0,r.jsxs)("div",{className:"m-auto flex h-32 max-w-md flex-col items-center justify-center gap-4 p-8","data-testid":"empty-search",children:[(0,r.jsx)(b.JO,{type:"32-search-v2",className:"text-default !h-8 !w-8",size:32}),(0,r.jsx)("div",{className:"flex flex-col gap-2",children:(0,r.jsx)(h.Z.BodySm,{color:"text-default",children:(0,p.t)("view_only_masquerading.empty_search_placeholder")})})]})})},y=n(46681),g=function(e){var t=e.setCategory,n=e.setQuery;return(0,r.jsxs)("div",{className:"mx-auto flex h-32 flex-col items-center justify-center pb-8 pt-6 leading-tight",children:[(0,r.jsx)("div",{className:"pb-2",children:(0,r.jsx)(h.Z.TitleSm,{weight:"semibold",children:(0,p.t)("view_only_masquerading.no_results")})}),(0,r.jsx)("div",{children:(0,r.jsx)(h.Z.BodySm,{color:"text-default",children:(0,p.t)("view_only_masquerading.try_a_different_term")})}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)("button",{type:"button",onClick:function(){"function"==typeof t&&t(""),n("")},children:(0,r.jsx)(y.Di,{color:"text-circle",weight:"semibold",children:(0,p.t)("view_only_masquerading.back")})})})]})},_=function(e){var t=e.isLoading,n=e.query,o=e.setQuery;return(0,r.jsx)("div",{className:"bg-primary sticky top-0 isolate z-10 flex items-center justify-between p-4 md:static md:top-auto md:p-0",children:(0,r.jsx)("div",{className:"mr-0 flex w-full items-center md:p-5",children:(0,r.jsxs)("div",{className:"bg-secondary sm:bg-primary border-secondary flex w-full items-center gap-3 rounded-md border px-2 py-1 sm:rounded-md sm:px-2 sm:py-1",children:[(0,r.jsx)("div",{className:"flex",children:t?(0,r.jsx)(b.JO,{type:"loader",className:"text-default",size:20,useWithFillCurrentColor:!0}):(0,r.jsx)(b.JO,{type:"16-search",className:"text-default",size:16,useWithFillCurrentColor:!0})}),(0,r.jsx)("input",{className:"text-dark sm:bg-primary placeholder:text-light h-6 w-full rounded bg-transparent text-sm outline-none placeholder:opacity-100 sm:rounded-none",placeholder:(0,p.t)("view_only_masquerading.input_placeholder"),"aria-autocomplete":"list",value:n,onChange:function(e){return o(e.target.value)}}),(0,r.jsx)("button",{type:"submit",className:"text-default flex pt-1",onClick:function(){return o("")},children:!!n&&(0,r.jsx)(b.JO,{type:"20-close-md",useWithFillCurrentColor:!0})})]})})})},x=n(8807),j=n(98363),w=function(e){var t,n=e.id,o=e.type,i=e.name,a=e.avatarUrl,s=e.onClick;return"CommunityMember"==o?t=(0,r.jsx)(j.s,{src:a,name:i,size:"5"}):"Paywall"==o?t=(0,r.jsx)(b.JO,{type:"credit-card",className:"text-default shrink-0",size:16}):"InvitationLink"==o&&(t=(0,r.jsx)(b.JO,{type:"16-link",className:"text-default shrink-0",size:16})),(0,r.jsx)("li",{children:(0,r.jsx)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:function(){return s(n,o)},children:(0,r.jsxs)("div",{className:"truncate-one-line flex items-center gap-3",children:[t,(0,r.jsx)(x.T1,{children:i})]})})})};function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var P=function(){var e=(0,a.dd)(),t=(0,o.useRef)(null),n=(0,o.useRef)(null);(0,l.Z)(t,function(){e.remove()});var i=S((0,o.useState)(""),2),p=i[0],b=i[1],h=S((0,o.useState)([]),2),y=h[0],x=h[1],j=S((0,o.useState)(!1),2),O=j[0],P=j[1],C=(0,f.c)(p,500),I=(0,s.useQuery)({queryKey:["masquerading/entities",C],queryFn:function(){return(0,c.UT)(u.av.masquerading.entities.index({query:C,members_only:!0}))},refetchOnWindowFocus:!1,enabled:!!C,staleTime:3e5}),k=I.data,N=I.isLoading;(0,o.useEffect)(function(){C||(P(!1),x([]))},[C]),(0,o.useEffect)(function(){if(k){var e=k.records,t=k.category,n=k.query;t||n?(P(0===e.length),x(e)):(P(!1),x([]))}},[k]);var A=function(e,t){return(0,d.g)({entityId:e,entityType:t,mode:"edit"}).then(function(e){return window.open(e.masquerade_url,"_self")}).catch(function(e){console.error(e)})};return(0,r.jsx)(m.u_,{isOpen:e.visible,onClose:e.remove,children:(0,r.jsx)(m.u_.Content,{position:"top",className:"border-primary w-full rounded-[0px] sm:rounded-lg sm:border md:!mt-[3.25rem] md:w-[335px]",size:"xl",children:(0,r.jsxs)("div",{ref:t,children:[(0,r.jsx)(_,{isLoading:N,query:p,setQuery:b}),y.length>0?(0,r.jsx)("div",{className:"overflow-y-auto md:max-h-96",ref:n,children:(0,r.jsx)("ul",{className:"list-none",children:y.map(function(e){return(0,r.jsx)(w,{id:e.id,type:e.type,name:e.name,avatarUrl:e.avatar_url,onClick:A},"".concat(e.type,"-").concat(e.id))})})}):O?(0,r.jsx)(g,{setQuery:b}):(0,r.jsx)(v,{})]})})})},C=n(38369),I=function(e){var t=e.category,n=e.setCategory;return(0,r.jsx)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:function(){return n("")},children:(0,r.jsxs)("div",{className:"flex items-center gap-3 text-gray-500",children:[(0,r.jsx)(b.JO,{type:"chevron-left",className:"text-default",size:16}),(0,r.jsx)(C.c,{color:"text-gray-500",children:(0,p.t)("view_only_masquerading.categories.".concat(t))})]})})},k=function(e){var t=e.name,n=e.icon,o=e.onClick;return(0,r.jsx)("li",{children:(0,r.jsxs)("button",{tabIndex:0,type:"button",className:"text-dark bg-primary hover:bg-secondary focus:bg-secondary flex w-full cursor-pointer items-center justify-between gap-4 px-5 py-2.5 transition-colors",onClick:o,children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(b.JO,{type:n,className:"text-default",size:16}),(0,r.jsx)(x.T1,{children:t})]}),(0,r.jsx)(b.JO,{type:"16-chevron-right",className:"text-default",size:16})]})})},N=function(e){var t=e.setCategory;return(0,r.jsx)("div",{className:"mb-2 overflow-y-auto md:max-h-96",children:(0,r.jsxs)("ul",{className:"list-none",children:[(0,r.jsx)(k,{name:(0,p.t)("view_only_masquerading.categories.members"),icon:"16-account",onClick:function(){return t("members")}}),(0,r.jsx)(k,{name:(0,p.t)("view_only_masquerading.categories.paywalls"),icon:"credit-card",onClick:function(){return t("paywalls")}}),(0,r.jsx)(k,{name:(0,p.t)("view_only_masquerading.categories.links"),icon:"16-link",onClick:function(){return t("links")}}),(0,r.jsx)(k,{name:(0,p.t)("view_only_masquerading.categories.access_groups"),icon:"16-lock",onClick:function(){return t("access_groups")}})]})})};function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var T=function(){var e=(0,a.dd)(),t=(0,o.useRef)(null),n=(0,o.useRef)(null);(0,l.Z)(t,function(){e.remove()});var i=E((0,o.useState)(""),2),p=i[0],b=i[1],h=E((0,o.useState)(""),2),v=h[0],y=h[1],x=E((0,o.useState)(""),2),j=x[0],O=x[1],S=E((0,o.useState)(""),2),P=S[0],C=S[1],k=E((0,o.useState)([]),2),A=k[0],T=k[1],M=E((0,o.useState)(!1),2),R=M[0],D=M[1],L=(0,f.c)(v,500),F=(0,s.useQuery)({category:p,queryKey:["masquerading/entities",L,p],queryFn:function(){return(0,c.UT)(u.av.masquerading.entities.index({query:L,category:p}))},refetchOnWindowFocus:!1,enabled:!!(L||p),staleTime:3e5}),U=F.data,B=F.isLoading;(0,o.useEffect)(function(){L||p||(D(!1),T([]))},[L,p]),(0,o.useEffect)(function(){if(U){var e=U.records,t=U.category,n=U.query;O(t),C(n),t||n?(D(0===e.length),T(e)):(D(!1),T([]))}},[U]);var q=function(e,t){return(0,d.g)({entityId:e,entityType:t}).then(function(e){return window.open(e.masquerade_url,"_self")}).catch(function(e){console.error(e)})};return(0,r.jsx)(m.u_,{isOpen:e.visible,onClose:e.remove,children:(0,r.jsx)(m.u_.Content,{position:"top",className:"border-primary w-full rounded-[0px] sm:rounded-lg sm:border md:!mt-[3.25rem] md:w-[335px]",size:"xl",children:(0,r.jsxs)("div",{ref:t,children:[(0,r.jsx)(_,{isLoading:B,query:v,setQuery:y}),A.length>0?(0,r.jsxs)("div",{className:"mb-2 overflow-y-auto md:max-h-96",ref:n,children:[j&&!P&&(0,r.jsx)(I,{category:j,setCategory:b}),(0,r.jsx)("ul",{className:"list-none",children:A.map(function(e){return(0,r.jsx)(w,{id:e.id,type:e.type,name:e.name,avatarUrl:e.avatar_url,onClick:q},"".concat(e.type,"-").concat(e.id))})})]}):R?(0,r.jsx)(g,{setCategory:b,setQuery:y}):(0,r.jsx)(N,{setCategory:b})]})})})},M=a.gk.create(function(){return(0,r.jsx)(P,{})}),R=a.gk.create(function(){return(0,r.jsx)(T,{})});function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var L={isBannerVisible:!1,showBanner:i.noop,hideBanner:i.noop,openViewMasqueradingSearch:i.noop,openEditMasqueradingSearch:i.noop},F=(0,o.createContext)(L);F.displayName="MasqueradeContext";var U=function(e){var t,n=e.children,i=(t=(0,o.useState)(!1),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return D(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=i[0],l=i[1],c=(0,a.dd)(R),u=(0,a.dd)(M);return(0,r.jsx)(F.Provider,{value:{isBannerVisible:s,showBanner:function(){l(!0),c.show()},hideBanner:function(){return l(!1)},openViewMasqueradingSearch:function(){c.show()},openEditMasqueradingSearch:function(){u.show()}},children:n})},B=function(){var e=(0,o.useContext)(F);if(!e)throw Error("useMasqueradeContext must be used within a MasqueradeContextProvider");return e}},18059:function(e,t,n){n.d(t,{Rl:()=>f,Wj:()=>p,h4:()=>m});var r=n(85893),o=n(67294);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}var l=function(e,t){var n=t.type,r=t.payload;switch(n){case"SET_SPACE_NOTIFICATIONS":return r;case"UPDATE_SPACE_NOTIFICATIONS":var o,i,s=e.spaces,l=s.findIndex(function(e){return e.id===r.space.id});if(l>-1)return o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),i=i={spaces:a(s.slice(0,l)).concat([r.space],a(s.slice(l+1)))},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(i)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(i,e))}),o;return e;default:throw Error("Unhandled action type: ".concat(n))}},c=(0,o.createContext)(null);c.displayName="SpaceNotificationsStateContext";var u=(0,o.createContext)(null);u.displayName="SpaceNotificationsDispatchContext";var d={spaces:[]},f=function(e){var t,n=e.children,i=(t=(0,o.useReducer)(l,d),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||s(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],f=i[1];return(0,r.jsx)(c.Provider,{value:a,children:(0,r.jsx)(u.Provider,{value:f,children:n})})},m=function(){var e=(0,o.useContext)(c);if(void 0===e)throw Error("useSpaceNotificationsState must be used within a SpaceNotificationsProvider");return e},p=function(){var e=(0,o.useContext)(u);if(void 0===e)throw Error("useSpaceNotificationsDispatch must be used within a SpaceNotificationsProvider");return e}},17679:function(e,t,n){n.d(t,{I:()=>i});var r=n(88767),o=n(13532),i=function(e){var t,n,i,a=e.spaceId,s=e.enabled,l=o.av.spaces.activeMembersCount({id:a}),c=(0,r.useQuery)(l,{enabled:!!a&&(void 0===s||s)});return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},c),n=n={count:(null==(i=c.data)?void 0:i.members_count)||0},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},10958:function(e,t,n){n.d(t,{BU:()=>l,G5:()=>s,GL:()=>a,ND:()=>i,el:()=>c});var r=n(62375),o=function(e){var t=[],n=Math.random().toString(36).slice(2);return{contentWithoutAttachments:e.replace(/data-trix-attachment="([^"]*)"/g,function(e,r){var o=t.push(r)-1;return'data-trix-attachment="__TRIX_'.concat(n,"_").concat(o,'__"')}),attachments:t,uniqueId:n}},i=function(e){if(!e)return e;var t,n=o(e),i=n.contentWithoutAttachments,a=n.attachments,s=n.uniqueId;return t=(0,r.Z)(i,{defaultProtocol:"https",target:{url:"_blank"},ignoreTags:["a","style","script","img","iframe","action-text-attachment","video","audio"],validate:{url:function(e){return/^[^A-Z]/.test(e)}}}),t.replace(RegExp('data-trix-attachment="__TRIX_'.concat(s,'_(\\d+)__"'),"g"),function(e,t){return'data-trix-attachment="'.concat(a[Number(t)],'"')})},a=function(e){e.querySelectorAll("video").forEach(function(e){e.setAttribute("controlsList","nodownload")})},s=function(e){var t=e.containerElement,n=e.shouldIncludeInternalLinks,r=void 0!==n&&n;t.querySelectorAll("a").forEach(function(e){"A"===e.tagName&&!e.isContentEditable&&(r||e.host!==window.location.host)&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noreferrer"))})},l=function(e){e.querySelectorAll("[data-background-image]").forEach(function(e){var t=e.getAttribute("data-background-image")||"",n=document.createElement("img");n.src=t,e.setAttribute("style",'background-image: url("'.concat(t,'")')),n.onload=function(){var t=e.parentElement;t&&(t.classList.add("show"),t.classList.remove("hide"))}})};function c(e){e.querySelectorAll("[data-target~='downloadAttachment']").forEach(function(e){e.addEventListener("click",function(e){var t,n;if(t=e.currentTarget,null!=(n=HTMLElement)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](t):t instanceof n){e.preventDefault(),e.stopPropagation();var r,o,i,a,s,l,c,u=e.currentTarget.dataset;u.url&&u.fileName&&u.logUrl&&(o=(r={url:u.url,fileName:u.fileName,logUrl:u.logUrl}).url,i=r.fileName,a=r.logUrl,s=o,l=i,(c=document.createElement("a")).href=s,c.download=l,c.setAttribute("download",l),c.click(),fetch(a,{method:"POST"}))}})})}},810:function(e,t,n){n.d(t,{B:()=>r,K:()=>o});var r=function(e){var t=e.type;return!t||"CommunityMember"===t},o=function(e){return"CommunityLead"===e.type}},82859:function(e,t,n){n.d(t,{Dt:()=>u,G6:()=>l,OP:()=>p,P4:()=>d,n2:()=>f,qx:()=>c,s2:()=>a,vF:()=>m});var r=n(31795),o=n.n(r),i=n(85518),a=function(){return window.MOBILE_DEVICE},s=function(){return{name:o().name,version:o().version,os:o().os,description:o().description,product:o().product,layout:o().layout,manufacturer:o().manufacturer,ua:o().ua}},l=function(){return"Safari"===s().name},c=function(){return"iPhone"===s().product},u=function(){var e;return(null==(e=s().os)?void 0:e.family)==="Android"},d=function(){var e;return["iOS","Android"].includes((null==(e=s().os)?void 0:e.family)||"")},f=function(e){if(!e)return!1;var t=e.ctrlKey||e.metaKey,n=e.button&&1===e.button;return t||n},m=function(){return l()&&i.isMacOs&&15>=parseFloat(i.browserVersion)},p=function(){return m()?"vh":"dvh"}},52770:function(e,t,n){n.d(t,{b:()=>a,d:()=>s});var r=n(64061),o=n.n(r),i=n(34860),a=function(){o().start({apiKey:i.l5,releaseStage:window.RAILS_ENV,enabledReleaseStages:i.OO,autoDetectErrors:!1})},s=function(e){o().notify(e)}},94260:function(e,t,n){n.d(t,{BH:()=>p,Kz:()=>x,Lb:()=>y,Om:()=>d,Q_:()=>a,RA:()=>s,U8:()=>_,YG:()=>f,Yr:()=>g,ac:()=>u,d_:()=>m,eV:()=>h,mB:()=>l,rB:()=>v,vw:()=>b});var r=n(84326),o=n(29378),i=n(46051),a={INCOMPLETE:"incomplete",PROCESSING:"processing",PAID:"paid",CANCELED:"canceled",REFUNDED:"refunded",FAILED:"failed",PARTIAL_REFUNDED:"partial_refunded"},s={PARTIAL_REFUND:(0,r.t)("community_member_charge_presenter.display_status.partial_refund"),INCOMPLETE:(0,r.t)("community_member_charge_presenter.display_status.incomplete"),PROCESSING:(0,r.t)("community_member_charge_presenter.display_status.processing"),PAID:(0,r.t)("community_member_charge_presenter.display_status.paid"),CANCELED:(0,r.t)("community_member_charge_presenter.display_status.canceled"),REFUNDED:(0,r.t)("community_member_charge_presenter.display_status.refunded"),FAILED:(0,r.t)("community_member_charge_presenter.display_status.failed")},l=[a.PAID,a.PARTIAL_REFUNDED,a.REFUNDED,a.FAILED],c=function(e){var t;return!!e&&e.status!==a.REFUNDED&&(null!=(t=e.amount_refunded_raw)?t:0)>0},u=function(e){return!!e&&(e.status===a.REFUNDED||c(e))},d=function(e){return!!e&&e.status===a.PAID},f=function(e){return!!e&&e.payment_method_type===i.Lt.PIX},m=function(e){return!!e&&e.payment_method_type===i.Lt.CARD},p=function(e){return!!e&&e.payment_method_type===i.Lt.GOOGLE_PAY},b=function(e){return!!e&&e.payment_method_type===i.Lt.APPLE_PAY},h=function(e){return!!e&&e.payment_method_type===i.Lt.LINK},v=function(e){return!!e&&e.payment_method_type===i.Lt.KLARNA},y=function(e){return!!e&&e.payment_method_type===i.Lt.AFTERPAY_CLEARPAY},g=function(e){return!!e&&e.payment_method_type===i.Lt.AFFIRM},_=function(e){return!!e&&null===e.payment_method_type},x=function(e){return!!e&&[o.VT.APP_STORE,o.VT.PLAY_STORE].some(function(t){return t===(e.platform||"")})}},52723:function(e,t,n){n.d(t,{N:()=>i});var r=n(96486),o=n(16823),i=function(e,t){try{var n,i,a,s,l,c,u=new Date(e),d=(0,o.Ed)(),f=new Intl.DateTimeFormat(d,{day:"numeric",month:"short",timeZone:t}).formatToParts(u);s=null==(l=f.find(function(e){return"month"===e.type}))?void 0:l.value,i=null==(c=f.find(function(e){return"day"===e.type}))?void 0:c.value,a=(0,r.upperFirst)(s).replace(".","")}catch(e){(null!=(n=Error)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):e instanceof n)&&console.error("dateComponents - Could not parse date: ".concat(e.message))}return{dayOfMonth:i,shortMonthString:a}}},57338:function(e,t,n){n.d(t,{H:()=>s});var r=n(28366),o=n(34587),i=n(84326),a=n(34870),s=function(e){var t=new Date(e),n=new Date,s=(0,r.Z)(),l=(0,o.Z)();return{day:t.getFullYear()===n.getFullYear()?t>s?(0,i.t)("today"):t>l?(0,i.t)("yesterday"):(0,a.w)({dateTime:t,format:"short_month_and_date"}):(0,a.w)({dateTime:t,format:"short_date"}),time:(0,a.w)({dateTime:t,format:"short_time"})}}},85122:function(e,t,n){n.d(t,{Dk:()=>s,ie:()=>a,r_:()=>l});var r=n(96486),o=n(11638),i=n(16823),a=function(e,t){try{if(!e)throw Error("Missing date string");var n,a=(0,i.Ed)(),s=new Intl.DateTimeFormat(a,t);return(0,r.upperFirst)(s.format(new Date(e)))}catch(e){return(null!=(n=Error)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](e):e instanceof n)&&!(0,o.n5)()&&console.error("Could not parse date: ".concat(e.message)),""}},s=function(e,t){return a(e,{hour12:!0,hour:"2-digit",minute:"2-digit",timeZone:t})},l=function(e,t){return a(e,{month:"long",year:"numeric",timeZone:t})}},73660:function(e,t,n){n.d(t,{An:()=>s,lo:()=>c,mI:()=>d,tH:()=>u});var r=n(49160),o=n(43271),i=n(96486),a=n(16823),s=function(e,t){return(0,r.default)(e,t)?"".concat((0,o.default)(e,"dd")," - ").concat((0,o.default)(t,"dd MMM")):"".concat((0,o.default)(e,"dd MMM")," - ").concat((0,o.default)(t,"dd MMM"))},l=function(e,t,n){try{var r,o=(0,a.Ed)(),s=new Intl.DateTimeFormat(o,n);return(0,i.upperFirst)(s.formatRange(e,t))}catch(e){return(null!=(r=Error)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?!!r[Symbol.hasInstance](e):e instanceof r)&&console.error("Could not parse date range: ".concat(e.message)),""}},c=function(e,t,n){return l(e,t,{weekday:"long",month:"short",day:"numeric",hour:"numeric",minute:"numeric",timeZone:n})},u=function(e,t,n){return l(e,t,{weekday:"long",hour:"numeric",minute:"numeric",timeZone:n})},d=function(e,t,n){return l(e,t,{hour:"numeric",minute:"numeric",timeZone:n})}},43945:function(e,t,n){n.d(t,{Rc:()=>d,UZ:()=>s,ZY:()=>l,cz:()=>c});var r=n(43271),o=n(96486),i=n(84326),a=n(4393),s=function(e){try{return(0,o.capitalize)((0,r.default)(new Date(e),"EEEE"))}catch(e){return console.error(e),""}},l=function(e){try{return(0,o.capitalize)((0,r.default)(new Date(e),"MMMM"))}catch(e){return console.error(e),""}},c=function(e){try{return(0,r.default)(new Date(e),"do")}catch(e){return console.error(e),""}},u={1:(0,i.t)("date.ordinal.first"),2:(0,i.t)("date.ordinal.second"),3:(0,i.t)("date.ordinal.third"),4:(0,i.t)("date.ordinal.fourth"),5:(0,i.t)("date.ordinal.last")},d=function(e){try{var t=(0,a.SA)(e),n=s(e),r=u[t]||"";return"".concat(r," ").concat(n)}catch(e){return console.error(e),""}}},4393:function(e,t,n){n.d(t,{Cp:()=>d,DT:()=>j,ED:()=>v,Gs:()=>b,He:()=>u,SA:()=>g,TP:()=>m,Xz:()=>f,ZX:()=>p,aA:()=>l,bl:()=>y,eC:()=>s,qB:()=>x,qG:()=>c,qe:()=>_,tq:()=>h});var r=n(16823);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n(43945);var s=function(e,t){return Math.round((t.getTime()-e.getTime())/864e5)},l=function(e){var t=new Date,n=new Date(e);return!n.valueOf()||n<t},c=function(e){var t=new Date,n=new Date(e);return Math.floor((t.getTime()-n.getTime())/1e3)},u=function(e){var t=function(e){return("0"+e).slice(-2)};if(e>=0&&e<3600){var n=Math.floor(e/60);return"".concat(t(n),":").concat(t(e-60*n))}var r=Math.floor(e/3600),o=Math.floor((e-3600*r)/60);return"".concat(t(r),":").concat(t(o),":").concat(t(e-60*o-3600*r))},d=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return[4,Promise.all([e,new Promise(function(e){return setTimeout(e,n)})])];case 1:return[2,a.apply(void 0,[t.sent(),1])[0]]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function s(e){i(a,r,o,s,l,"next",e)}function l(e){i(a,r,o,s,l,"throw",e)}s(void 0)})})()},f=function(e,t){var n=new Date(e);return n.setDate(n.getDate()+t),n},m=function(e){return e.setMinutes(e.getMinutes()+60),e.setMinutes(0,0,0),e},p=function(e,t){var n=e?new Date(e):new Date;return n.setSeconds(n.getSeconds()+t),n},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;return new Date().getTime()>=new Date(e).getTime()-60*t*1e3},h=Intl.DateTimeFormat().resolvedOptions().timeZone,v=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,o=(0,r.Ed)();return(null==(t=new Intl.DateTimeFormat([o,"en-US"],{timeZone:e,timeZoneName:"short"}).formatToParts(n).find(function(e){return"timeZoneName"==e.type}))?void 0:t.value)||""},y=function(e){return e?new Date(e):new Date},g=function(e){return Math.ceil(new Date(e).getDate()/7)},_=function(e){return new Date(9e5*Math.ceil(e.getTime()/9e5))},x=function(e){return 0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()},j=new Date(Date.now()+864e5)},8683:function(e,t,n){n.d(t,{TF:()=>m,lc:()=>u});var r=n(11699),o=n(69295),i=n(48370),a=n(99106),s=n(34430),l=n(84326),c=n(16823);i.Z.addDefaultLocale(a.Z),i.Z.addLocale(s.Z);var u={default:"default",short:"short"},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,n=new Date;return(0,r.Z)(n,e)<t},f=function(e){var t=new Date;return 0===(0,o.Z)(t,e)},m=function(e,t){return p(new Date(e),t)},p=function(e,t){var n=(null==t?void 0:t.format)||"default",r=(0,c.Ed)(),o=new i.Z(r);return"short"===n?d(e)?(0,l.t)("time_format.just_now"):f(e)?o.format(e,"mini"):o.format(e,"twitter-minute-now"):o.format(e)}},11638:function(e,t,n){n.d(t,{aD:()=>i,n5:()=>o});var r=Object.freeze({PRODUCTION:"production",DEVELOPMENT:"development",STAGING:"staging"}),o=function(){return window.RAILS_ENV===r.PRODUCTION},i=function(){return window.RAILS_ENV===r.DEVELOPMENT}},18317:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}n.d(t,{q:()=>c,y:()=>l});var a="OvDGLovptOPNSO5JjplEIssLF1x8Yxc3",s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new URL("".concat("https://api.giphy.com/v1/gifs","/").concat(e)),o=!0,i=!1,a=void 0;try{for(var s,l=Object.entries(t)[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c,u=(c=s.value,function(e){if(Array.isArray(e))return e}(c)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(c,2)||function(e,t){if(e){if("string"==typeof e)return r(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(c,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1];n.searchParams.set(d,f)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}return n.toString()},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(s("search",i(o({},t),{q:e,api_key:a}))).then(function(e){return e.json()})},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fetch(s("trending",i(o({},e),{api_key:a}))).then(function(e){return e.json()})}},67379:function(e,t,n){n.d(t,{C:()=>r});var r=function(e){return"triggerFormSubmit"in e}},67132:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{E9:()=>a,Ig:()=>l,kK:()=>s,ug:()=>i});var o=/^```html\s*([\s\S]*?)\s*```$/gm,i=function(e){return o.test(e)};function a(e){return e.replace(o,"$1").trim()}var s=function(e){return e.nodeType===Node.ELEMENT_NODE},l=function(e){var t=document.createElement("div");t.innerHTML=e;var n=[],o=function(e){if(e.nodeType===Node.TEXT_NODE){var t=(e.textContent||"").match(/\S+\s*/g)||[];n.push.apply(n,function(e){if(Array.isArray(e))return r(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return r(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}else if(s(e)){n.push((null==(i=e.outerHTML.match(/^<[^>]+>/))?void 0:i[0])||""),e.childNodes.forEach(o);var i,a=e.tagName.toLowerCase();n.push("</".concat(a,">"))}};return t.childNodes.forEach(o),n}},31510:function(e,t,n){n.d(t,{U:()=>r});var r=function(){var e=window.location.pathname;return/^\/c\/[^/]+\/[^/]+\/?$/.test(e)}},37588:function(e,t,n){n.d(t,{$e:()=>v,B8:()=>p,Bk:()=>a,Gi:()=>y,H0:()=>o,HN:()=>g,Hq:()=>E,If:()=>j,L6:()=>I,LV:()=>r,SS:()=>f,UT:()=>b,VM:()=>s,Vq:()=>N,Zo:()=>_,_V:()=>C,_d:()=>i,a_:()=>k,cf:()=>S,eM:()=>O,ee:()=>h,fN:()=>m,g5:()=>M,iD:()=>l,jN:()=>T,kx:()=>x,lH:()=>P,ln:()=>d,mP:()=>A,pp:()=>R,vX:()=>w,wA:()=>c});var r=Object.freeze({INITIALIZING:"initializing",BACKSTAGE:"backstage",LIVE:"active",ENDED:"inactive",CLOSING:"closing"}),o=Object.freeze({CONFERENCE:"conference",STREAM:"stream",EVENT:"event"}),i=Object.freeze({OPEN:"open",SECRET:"secret",PUBLIC_STREAM:"public_stream"}),a=Object.freeze({SPEAKER:"speaker_view",SPEAKER_VARIANT:"speaker_variant_view",GRID:"grid_view"}),s=Object.freeze({HOST:"host",HLS_SPECTATOR:"hlsspectator",MODERATOR:"moderator"}),l=Object.freeze({HOST:"host",MODERATOR:"moderator",COHOST:"cohost",PARTICIPANT:"participant"}),c={JOINING:"joining",ACTIVE:"active",INACTIVE:"inactive"},u=Object.freeze({HMS:"hms",LIVEKIT:"livekit"}),d=1,f=function(e){return(null==e?void 0:e.status)===r.BACKSTAGE},m=function(e){return(null==e?void 0:e.status)===r.LIVE},p=function(e){return(null==e?void 0:e.status)===r.CLOSING},b=function(e){return(null==e?void 0:e.status)===r.ENDED},h=function(e){return(null==e?void 0:e.room_type)===o.STREAM},v=function(e){return(null==e?void 0:e.room_type)===o.CONFERENCE},y=function(e){return!!(null==e?void 0:e.recording_enabled)},g=function(e){return!!(null==e?void 0:e.can_manage)},_=function(e){return!!(null==e?void 0:e.can_host)},x=function(e){return!!(null==e?void 0:e.host_capacity_reached)},j=function(e){return!!(null==e?void 0:e.spectator_capacity_reached)},w=function(e){return(null==e?void 0:e.room_type)||o.STREAM},O=function(e){return!(null==e?void 0:e.view_type)||(null==e?void 0:e.view_type)===a.SPEAKER||(null==e?void 0:e.view_type)===a.SPEAKER_VARIANT},S=function(e){return(null==e?void 0:e.view_type)===a.SPEAKER_VARIANT},P=function(e){return(null==e?void 0:e.view_type)===a.GRID},C=function(e){return(null==e?void 0:e.access_type)===i.SECRET},I=function(e){return(null==e?void 0:e.access_type)===i.PUBLIC_STREAM},k=function(e){return(null==e?void 0:e.status)===c.INACTIVE},N=function(e){return(null==e?void 0:e.role)===s.HLS_SPECTATOR},A=function(e){return(null==e?void 0:e.room_provider)===u.LIVEKIT},E=function(e){return I(e)&&g(e)},T=function(e){return null==e?void 0:e.limit_url_sharing},M=function(e){return!!(null==e?void 0:e.hide_participants_list)&&!g(e)&&!(null==e?void 0:e.can_moderate)},R=function(e){var t=null==e?void 0:e.metadata;if(!t)return null;try{var n,r,o=JSON.parse(t);return n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},o),r={role:e.roleName},r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(r)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}),n}catch(e){return console.error("Error parsing peer metadata",e),null}}},81261:function(e,t,n){n.d(t,{$q:()=>i,cT:()=>r,sR:()=>o});var r=function(e){var t,n;return(null!=(n=null==e||null==(t=e.member_tags)?void 0:t.length)?n:0)>0},o=function(e){return!!e.website_url||!!e.facebook_url||!!e.twitter_url||!!e.linkedin_url||!!e.instagram_url},i={SIGNUP:"signup",EDIT_PROFILE:"edit_profile",PROFILE_VIEW:"profile_view"}},63676:function(e,t,n){n.d(t,{HA:()=>r,Ri:()=>o,dm:()=>i});var r=function(e){return e.toLocaleString(void 0,{maximumFractionDigits:0})};function o(e){return Math.floor(e)===e?0:e.toString().split(".")[1].length||0}var i=function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=[{value:1e9,suffix:"b"},{value:1e6,suffix:"m"},{value:1e3,suffix:"k"}][Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(e>=a.value)return(e/a.value).toFixed(1).replace(/\.0$/,"")+a.suffix}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e.toString()}},6082:function(e,t,n){n.d(t,{BD:()=>c,Dr:()=>l,FZ:()=>b,Gb:()=>o,_D:()=>m,_c:()=>_,_q:()=>h,cY:()=>f,fm:()=>v,gR:()=>d,gq:()=>g,kw:()=>u,pE:()=>s,pj:()=>y,sR:()=>p});var r=n(48097),o=Object.freeze({basic:"basic",professional:"professional",enterprise:"enterprise",plus:"plus",business:"business"}),i=Object.freeze({basic:1,professional:2,business:3,enterprise:4,plus:5}),a=Object.freeze({month:"month",year:"year",quarter:"quarter",biannual:"biannual"}),s=function(e){return e===a.year},l=function(e){return e===o.basic},c=function(e){return e===o.professional},u=function(e){return e===o.enterprise},d=function(e){return e===o.plus},f=function(e){return e===o.business},m=function(e,t){return i[t]<i[e]},p=function(e,t){return i[t]>i[e]},b=function(e){var t=Object.keys(i),n=t.indexOf(e),r=n<t.length-1,o=t[n+1];return r?o:null},h=function(e){var t=Object.keys(i),n=t.indexOf(e),r=t[n-1];return n>0?r:null},v=function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e},y=function(e,t){return t?e===r.V.SCHEDULED_DOWNGRADE_BANNER?t.name:v(t.tier):""},g=function(e){return l(e)||c(e)?o.business:o.enterprise},_=function(e){return b(e)===o.plus}},80932:function(e,t,n){n.d(t,{$v:()=>u,FV:()=>l,GY:()=>x,KC:()=>p,Kj:()=>g,Km:()=>a,NU:()=>v,Sy:()=>o,UU:()=>_,Vp:()=>i,_D:()=>y,ff:()=>s,q2:()=>b,s5:()=>h,sR:()=>m,sq:()=>f,tL:()=>c});var r=n(84326),o=function(e){return e.interval===s.year?(0,r.t)("pricing_plans.billing_cycle.annually"):(0,r.t)("pricing_plans.billing_cycle.monthly")},i=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},a=function(e){var t;return null!=(t=null==e?void 0:e.alternative_plan)&&t},s=Object.freeze({month:"month",year:"year",quarter:"quarter",biannual:"biannual"}),l=function(e){return[x.live_stream_max_host_capacity,x.live_stream_max_spectator_capacity].includes(e)},c=function(e){return e>=1e6},u={upgrade:"upgrade",current_plan:"current_plan",resume:"resume",redeem_offer:"redeem_offer",renew:"renew",change_plan:"change_plan",downgrade:"downgrade",contact_support:"contact_support"},d=function(e){return function(t){return t===e}},f=d(u.current_plan),m=d(u.upgrade),p=d(u.redeem_offer),b=d(u.resume),h=d(u.renew),v=d(u.change_plan),y=d(u.downgrade),g=d(u.contact_support),_=function(e){var t=e.checkout_succeeded;return!!(void 0!==t&&t)},x=Object.freeze({sso:"sso",max_admin_count:"max_admin_count",max_space_count:"max_space_count",custom_css:"custom_css",api_access:"api_access",automated_moderation:"automated_moderation",advanced_reporting:"advanced_reporting",custom_domain:"custom_domain",max_moderator_count:"max_moderator_count",internal_custom_html:"internal_custom_html",post_admin_change:"post_admin_change",max_member_count:"max_member_count",payments_fee_percentage:"payments_fee_percentage",allow_addons:"allow_addons",email_whitelist:"email_whitelist",live_stream_max_host_capacity:"live_stream_max_host_capacity",live_stream_max_spectator_capacity:"live_stream_max_spectator_capacity",live_stream_monthly_stream_hours:"live_stream_monthly_stream_hours",live_stream_recording_hours:"live_stream_recording_hours",chat_space_members_limit:"chat_space_members_limit",profile_fields_enabled:"profile_fields_enabled",max_bulk_import_member_limit_tier_1:"max_bulk_import_member_limit_tier_1",max_bulk_import_member_limit_tier_2:"max_bulk_import_member_limit_tier_2",max_bulk_import_member_limit_on_trial:"max_bulk_import_member_limit_on_trial",live_room_participants_capacity:"live_room_participants_capacity",courses:"courses",customize_community:"customize_community",paywall_conversion_tracking_code:"paywall_conversion_tracking_code",max_dynamic_workflows_count:"max_dynamic_workflows_count",max_bulk_action_workflows_count:"max_bulk_action_workflows_count",max_scheduled_workflows_count:"max_scheduled_workflows_count",zapier_token_automatic_creation:"zapier_token_automatic_creation",affiliates:"affiliates",analytics_filters:"analytics_filters"})},59459:function(e,t,n){n.d(t,{B:()=>s,H:()=>l});var r=n(96486),o=n(84326),i=n(13532);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e){return(0,r.isString)(e)?e.replace(/(^\w+:|^)\/\//,""):e},l=function(e){var t=e.name,n=e.params,s=e.publicUid,l=e.shouldOpenInNewTab,c=e.showMemberProfileDrawer,u=t||(0,o.t)("view_user_profile_name"),d=(0,o.t)("view_user_profile",{user:u});return s?void 0!==l&&l?a({href:(0,i.zd)({public_uid:s,params:n}),target:"_blank",rel:"noreferrer"},"aria-label",d):a({onClick:function(e){e.preventDefault(),c({memberPublicId:s,params:n})},href:(0,i.zd)({public_uid:s})},"aria-label",d):a({onClick:r.noop,href:"#"},"aria-label","")}},93276:function(e,t,n){n.d(t,{S:()=>r});var r=function(e){return{body:{type:"doc",content:[{type:"paragraph",content:[{type:"text",text:e}]}]},attachments:[],localAttachments:[],localSgidToObjectMap:{}}}},26371:function(e,t,n){n.d(t,{e:()=>r});var r={list:function(){return"/settings/emails/broadcast"},edit:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/edit")},visualBuilder:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/visual-builder")},content:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/content")},listTemplates:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/content/templates")},previewTemplate:function(e){var t=e.broadcastId,n=e.templateId;return"/settings/emails/broadcast/".concat(t,"/content/templates/").concat(void 0===n?":templateId":n)},view:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/view")},viewAnalytics:function(e){var t=e.broadcastId;return"/settings/emails/broadcast/".concat(t,"/view/analytics")}}},73622:function(e,t,n){n.d(t,{OT:()=>i,i4:()=>o,lu:()=>r});var r=/[(http(s)?)://(www.)?a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,15}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/,o=/^[-a-zA-Z0-9%_+.~#?&//=]+$/,i=/(^mailto:(?!.*\.\.)[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$)|(^https?:\/\/(?!.*\.\.)[-a-zA-Z0-9_]+\.[a-zA-Z0-9-.]+[^ ]*$)/},27175:function(e,t,n){n.d(t,{r:()=>o});var r=n(85924),o=function(){return(0,r.ww)().isAdminUsageContext?"circle":"primary"}},42613:function(e,t,n){n.d(t,{z:()=>a});var r=n(88767),o=n(93199),i=n(13532),a=function(e){var t=e.agentId,n=e.params,a=void 0===n?{}:n,s=["AI_AGENT_PROFILE_INFO",t,a];return{getAgentProfileInfoQuery:(0,r.useQuery)({queryKey:s,queryFn:function(){return(0,o.UT)(i.av.communityAiAgentProfile.show({agentId:t,params:a}))},retry:!1,enabled:!!t})}}},74322:function(e,t,n){n.d(t,{W:()=>q});var r=n(67294),o=n(85893),i=n(25362),a=n(84326),s=n(42613),l=n(81261),c=n(34519),u=n(51945),d=n(41553),f=n(70442),m=n(13532),p=n(40761),b=n(81772),h=n(93276),v=n(96486),y=(0,r.createContext)({agent:null,isLoading:!0,isFullPageView:!1,onClose:function(){}});y.displayName="AgentProfileContext";var g=function(){return(0,r.useContext)(y)},_=function(e){var t=e.agent,n=e.isFullPageView,r=e.isLoading,i=e.children,a=e.onClose,s=void 0===a?v.noop:a;return(0,o.jsx)(y.Provider,{value:{agent:t,isLoading:r,isFullPageView:void 0!==n&&n,onClose:s},children:i})},x=function(){var e=g().agent,t=e.can_interact,n=(0,f.k6)(),r=(0,b.O)().createChat,i=function(e,t){r({id:e.id,body:(0,h.S)(t)}).then(function(e){n.push((0,m.Gr)({id:e.id.toString()}))}).catch(function(e){console.error(e)})};return(0,o.jsx)("div",{className:"bg-primary flex h-[50vh] min-h-[640px] flex-col overflow-auto p-8",children:(0,o.jsxs)("div",{className:"flex flex-col items-start gap-6",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,o.jsx)(d.Z.LabelSm,{weight:"semibold",children:(0,a.t)("community_bot.profiles.bio_label")}),(0,o.jsx)(d.Z.BodySm,{children:e.bio})]}),(0,o.jsx)("div",{className:"flex flex-col gap-3",children:t&&e.suggested_questions&&e.suggested_questions.length>0&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d.Z.LabelSm,{weight:"semibold",children:(0,a.t)("community_bot.profiles.suggested_questions_label")}),(0,o.jsx)("div",{className:"flex flex-wrap gap-2",children:e.suggested_questions.map(function(t){return(0,o.jsx)(p.n,{question:t,onClick:function(){return i(e.profile,t)}},t)})})]})})]})})},j=n(78188),w=n(82942),O=n(39265),S=n(1168),P=function(e){var t=e.isFullPageView;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(w.J,{isFullPageView:t}),(0,o.jsxs)("div",{className:(0,S.A)("col-span-12 flex flex-col overflow-auto px-4 pb-9 md:col-span-8 md:p-8",{"!md:pl-14 pl-4":t}),children:[(0,o.jsx)(O.y,{}),(0,o.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,o.jsx)(j.t,{}),(0,o.jsx)(j.t,{}),(0,o.jsx)(j.t,{}),(0,o.jsx)(j.t,{})]})]})]})},C=n(61853),I=n(57363),k=n(39905),N=function(){var e=g(),t=e.isLoading,n=e.agent,r=n.can_interact,i=(0,f.k6)(),s=(0,C.Dk)().setCurrentBotProfile;return t?null:(0,o.jsxs)("div",{className:"border-primary bg-primary flex w-[320px] shrink-0 flex-col items-center gap-3 overflow-auto border-r bg-[linear-gradient(180deg,#F5ECFC_19.48%,#FFF_50%)] p-6 pt-8",children:[(0,o.jsx)("img",{loading:"eager",src:n.avatar_url,alt:n.name,className:"h-[152px] w-[152px] rounded-full"}),(0,o.jsxs)("div",{className:"flex flex-col items-center gap-[28px] self-stretch",children:[(0,o.jsxs)("div",{className:"flex flex-col items-center gap-4 self-stretch",children:[(0,o.jsx)("div",{className:"text-center",children:(0,o.jsx)(d.Z.LabelLg,{weight:"semibold",children:n.name})}),(0,o.jsxs)("div",{className:"flex h-6 items-center justify-center gap-2 rounded-full bg-[#F0F3F5] px-2 py-[3px]",children:[(0,o.jsx)(I.JO,{type:"16-ask-ai-gradient",size:16}),(0,o.jsx)("span",{className:"text-[12px] font-medium",children:(0,a.t)("community_bot.profile_tag")})]})]}),r&&(0,o.jsx)("div",{children:(0,o.jsx)(k.z,{variant:"circle",onClick:function(){s(n.profile),i.push({pathname:(0,m.W9)()})},children:(0,a.t)("community_inbox.new_conversation")})})]})]})},A=function(e){var t=e.agent,n=e.isLoading,r=e.isFullPageView,i=e.onClose;return(0,o.jsx)(_,{isFullPageView:void 0!==r&&r,agent:t,isLoading:n,onClose:i,children:t?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(N,{}),(0,o.jsx)(x,{})]}):(0,o.jsx)(P,{})})},E={page_name:l.$q.PROFILE_VIEW},T=function(e){var t=e.agentId,n=(0,i.dd)(),r=(0,s.z)({agentId:t,params:E}).getAgentProfileInfoQuery,l=r.data,f=r.isLoading,m=function(){n.remove()};return(0,o.jsxs)(c.u_,{isOpen:n.visible,onClose:m,contentPortalId:"post-modal-portal",children:[(0,o.jsx)(c.u_.Overlay,{}),(0,o.jsxs)(c.u_.Content,{size:"2xl",className:"max-w-screen-xl",children:[(0,o.jsxs)("div",{className:"border-primary text-dark flex justify-between border-b !px-9 !py-4",children:[(0,o.jsx)(d.Z.TitleSm,{weight:"semibold",children:(0,a.t)("profile")}),(0,o.jsx)(u.o,{onClick:m})]}),(0,o.jsx)(c.u_.Body,{className:"!md:px-0 !md:pt-0 !md:overflow-hidden flex !p-0",children:(0,o.jsx)(A,{agent:l,isLoading:f,onClose:function(){return n.remove()}})})]})]})},M=n(57105),R=M.gk.create(function(e){var t=e.agentId,n=e.params;return(0,o.jsx)(T,{agentId:t,params:n})});function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(e){var t=e.name,n=e.params,r=e.agentId,o=e.shouldOpenInNewTab,i=e.showAgentProfileDrawer,s=t||(0,a.t)("view_user_profile_name"),l=(0,a.t)("view_user_profile",{user:s});return!r||void 0!==o&&o?D({onClick:v.noop,href:"#"},"aria-label",""):D({onClick:function(e){e.preventDefault(),i({agentId:r,params:n})},href:"#"},"aria-label",l)},F=n(82859),U=n(15731),B=n(90926),q=function(e){var t,n,o=e.name,i=e.params,a=void 0===i?{}:i,s=e.id,l=(0,M.dd)(R).show,c=(0,U.I)(),u=(0,B.xX)().isDrawer,d=(0,r.useCallback)(function(e){(0,F.n2)(e)||c||u||(e.preventDefault(),l({agentId:s,params:a}))},[c,u,a,l]);return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},L({name:o,params:a,agentId:s,shouldOpenInNewTab:c,showAgentProfileDrawer:l})),n=n={onClick:d},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},90809:function(e,t,n){n.d(t,{C:()=>l});var r=n(67294),o=n(50636),i=n(23501),a=n(91525),s=function(e,t){var n,r;return{community:e?{id:e.id,slug:e.slug,name:e.name,is_on_trial:e.is_on_trial,owner_id:e.owner_id,is_private:e.is_private,is_expired_trial:e.is_expired_trial,trial_ends_at:e.trial_ends_at,locale:e.locale,created_at:e.created_at,current_plan_interval:e.current_plan_interval,current_plan_name:e.current_plan_name,current_plan_tier:e.current_plan_tier,current_plan:e.current_plan,plan_status:e.plan_status,default_currency:e.default_currency}:void 0,user:t?{id:t.id,is_admin:t.is_admin,is_moderator:t.is_moderator}:void 0,path:null==(n=window.location)?void 0:n.pathname,user_agent:null==(r=window.navigator)?void 0:r.userAgent}},l=function(){var e=(0,a.wh)(),t=e.currentCommunity,n=e.currentCommunityMember,l=e.experimentation,c=(0,i.c)().currentCommunity||t;return{trackEvent:(0,r.useCallback)(function(e,t){var r,i=(r=null==l?void 0:l.flags,{community_id:null==c?void 0:c.id,specific:t,common:s(c,n),context:r});setTimeout(function(){o.n.trackEvent(e,i)},0)},[c,n,l])}}},77384:function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(a=function(){return!!e})()}n.d(t,{K:()=>s});var s=new(function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function t(){var e,n,i;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");return n=o(n=t),r(e=function(e,t){var n;if(t&&("object"==((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)||"function"==typeof t))return t;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,a()?Reflect.construct(n,[],o(this).constructor):n.apply(this,i)),"toggleMessageBookmark",function(t){e.emit("onBookmarkToggle",t)}),r(e,"sendSuggestedQuestion",function(t){e.emit("sendSuggestedQuestion",t)}),e}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e),t}(n(17187).EventEmitter))},42992:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function i(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.d(t,{y:()=>a,z:()=>s});var a=function(e){var t=e.chatMessages,n=e.setChatRoomMessages,r=e.newMessage,a=r.parent_message_id,s=r.sent_at,l=r.sender,c=t.findIndex(function(e){return e.id===a});if(c>-1){var u,d,f=t[c],m=f.thread_participants_preview,p=void 0===m?[]:m,b=f.replies_count,h=(u=o({},f),d=d={replies_count:(void 0===b?0:b)+1,last_reply_at:s},Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(d)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(d)).forEach(function(e){Object.defineProperty(u,e,Object.getOwnPropertyDescriptor(d,e))}),u);l&&p.length<3&&!p.some(function(e){return e.community_member_id===l.community_member_id})&&(h.thread_participants_preview=i(p).concat([o({},l)])),n(i(t.slice(0,c)).concat([h],i(t.slice(c+1))))}},s=function(e){if(!e)return!1;var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.right<=window.innerWidth&&t.bottom<=window.innerHeight}},90926:function(e,t,n){n.d(t,{xX:()=>k.x,rZ:()=>B,_q:()=>s._,ub:()=>r.u,NF:()=>et,K$:()=>o.K,pB:()=>H.p,Tl:()=>l.T,Nh:()=>a.N,uk:()=>i.u,aK:()=>V.a,TC:()=>a.T,Bk:()=>X,x3:()=>U,Mk:()=>I,Lx:()=>z,gJ:()=>Z.g,Cz:()=>s.C,Kb:()=>Q.K,G5:()=>k.G,KR:()=>N.K,QP:()=>K,nw:()=>h});var r=n(2952),o=n(98694),i=n(44428),a=n(55757),s=n(1800),l=n(38825),c=n(67294),u=n(96486),d=n(88767),f=n(93199),m=n(13532),p=n(60878);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var h=function(e){var t,n=e.parentMessage,r=e.threadMessageId,o=e.successCallback,i=void 0===o?u.noop:o,a=(t=(0,c.useState)([]),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return b(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],l=a[1],h=(0,p.pm)().error,v=(0,d.useQuery)(["THREAD_MESSAGES",null==n?void 0:n.id,null==n?void 0:n.chat_room_uuid],function(e){var t=e.previousPerPage,o=e.nextPerPage,i={previous_per_page:void 0===t?15:t,next_per_page:void 0===o?0:o,parent_message_id:n.id,id:r};return(0,f.UT)(m.av.chatRoomMessages.index({uuid:n.chat_room_uuid,params:i}))},{enabled:!!n,onSuccess:function(e){l(e.records),i()},onError:function(e){h(e.message)}}),y=v.isLoading;return{fetchThreadMessages:v.refetch,threadMessages:s,isLoading:y}},v=n(14218),y=n(41342);function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function _(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var x=function(){var e=(0,v.d)().findAndReplaceRecord,t=function(t){e(t,["chat-threads-list"])},n=function(e,n,i){var a=i?r:o;if(e.parent_message_id){var s=n.find(function(t){return t.parent_message.id===e.parent_message_id});if(s){var l=a(s.replies,e);l&&t(_(g({},s),{replies:l}))}}else{var c=n.find(function(t){return t.parent_message.id===e.reactionable_id});if(c){var u=a([c.parent_message],e);u&&t(_(g({},c),{parent_message:u[0]}))}}},r=function(e,t){var n,r,o=t.community_member_id,i=t.emoji,a=t.reactionable_id,s=structuredClone(e),l=s.findIndex(function(e){return e.id===a});if(-1!==l){var c=s[l],u=c.reactions.findIndex(function(e){return e.emoji===i});if(!(-1!==u&&(null==(r=c.reactions[u])||null==(n=r.community_member_ids)?void 0:n.includes(o))))return -1!==u?(c.reactions[u].community_member_ids.push(o),c.reactions[u].count+=1):c.reactions.push({emoji:i,community_member_ids:[o],count:1}),s}},o=function(e,t){var n,r,o=t.community_member_id,i=t.emoji,a=t.reactionable_id,s=structuredClone(e),l=s.findIndex(function(e){return e.id===a});if(-1!==l){var c=s[l],u=c.reactions.findIndex(function(e){return e.emoji===i});if(-1!==u&&(null==(r=c.reactions[u])||null==(n=r.community_member_ids)?void 0:n.includes(o)))return 1===c.reactions[u].count?c.reactions.splice(u,1):(c.reactions[u].community_member_ids=c.reactions[u].community_member_ids.filter(function(e){return e!==o}),c.reactions[u].count-=1),s}};return{handleReactionFromWebsocket:function(e,t){"ChatRoomMessage"===e.json_message.reactionable_type&&("createReaction"===e.event?n(e.json_message,t,!0):"destroyReaction"===e.event&&n(e.json_message,t,!1))}}};function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function S(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function P(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return j(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=["chat-threads-list"],I=function(){var e,t=(0,y.wh)().currentCommunityMember,n=(0,v.d)(),r=n.updateAllRecords,o=n.findAndReplaceRecord,i=x().handleReactionFromWebsocket,a=function(e){r(e,C,10)},s=function(e){o(e,C)},l=(0,d.useInfiniteQuery)(C,function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,f.UT)(m.av.chatThreads.index({params:{page:t,per_page:10}}))},{select:function(e){return{pages:e.pages,pageParams:e.pageParams}},enabled:!!(null==t||null==(e=t.policies)?void 0:e.can_access_threads_tab),getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),c=l.data,p=l.isLoading,b=l.refetch,h=l.hasNextPage,g=l.fetchNextPage,_=(null==c?void 0:c.pages.flatMap(function(e){return e.records}))||[],j=function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,f.UT)(m.av.chatThreads.show({id:e}))];case 1:return a([t.sent()].concat(P(_))),[3,3];case 2:return console.error(t.sent()),[3,3];case 3:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){w(i,r,o,a,s,"next",e)}function s(e){w(i,r,o,a,s,"throw",e)}a(void 0)})})()},I=function(e){if((null==e||!e.unread_flow)&&(null==e?void 0:e.chat_room_parent_type)!=="Live::Room")if(_.every(function(t){return t.parent_message.id!==e.parent_message_id}))j(e.chat_thread_id);else{var t=_.find(function(t){return t.parent_message.id===e.parent_message_id});if(t){var n=t.parent_message,r=t.replies;s(S(O({},t),{parent_message:S(O({},n),{replies_count:n.replies_count+1}),replies:P(r).concat([e])}))}}},k=function(e){var t=_.find(function(t){return t.parent_message.id===e.id});if(t){var n=t.parent_message;s(S(O({},t),{parent_message:O({},n,e)}))}},N=function(e){if((0,u.isNull)(e.parent_message_id))k(e);else{var t=_.find(function(t){return t.parent_message.id===e.parent_message_id});if(t){var n=t.replies.map(function(t){return t.id===e.id?e:t});s(S(O({},t),{replies:n}))}}},A=function(e){var t=e||{},n=t.id,r=t.parent_message,o=r||{},i=o.id,s=o.replies_count;_.some(function(e){return e.parent_message.id===n})?a(_.filter(function(e){return e.parent_message.id!==n})):0===s?a(_.filter(function(e){return e.parent_message.id!==i})):a(_.map(function(e){if(e.parent_message.id!==i)return e;var t=e.replies.filter(function(e){return e.id!==n});return S(O({},e),{parent_message:r,replies:t})}))},E=_.length>0;return{chatThreads:_,setChatThreads:a,isLoading:p,refetchChatThreads:b,isChatThreadsAvailable:E,hasNextPage:h,fetchNextPage:g,onEventReceive:function(e){switch(e.event){case"newMessage":I(e.json_message);break;case"updatedMessage":N(e.json_message);break;case"deletedMessage":A(e)}},updateChatThreads:function(e){var t=e[0].parent_message_id;a(_.map(function(n){return n.parent_message.id===t?S(O({},n),{replies:(0,u.uniqBy)(P(e).concat(P(n.replies)),"id")}):n}))},onReactionEventReceive:function(e){i(e,_)},findAndReplaceThread:s}},k=n(59413),N=n(48880),A=n(85893),E=n(70442),T=n(63271),M=n(42992);function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||L(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){if(e){if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}}var F=(0,c.createContext)({chatThreadIds:[]});F.displayName="UnreadChatThreadsContext";var U=function(e){var t,n=e.children,r=(0,y.wh)().currentCommunityMember,o=D((0,c.useState)([]),2),i=o[0],a=o[1],s=D((0,c.useState)(!1),2),l=s[0],u=s[1],b=(0,p.pm)().error,h="/threads"===(0,E.TH)().pathname;(0,T.s)({channel:"Chats::CommunityMemberThreadsChannel",onMessageReceive:function(e){x(e)},community_member_id:null==r?void 0:r.id,canCreateConnection:!!(null==r?void 0:r.id)},[null==r?void 0:r.id]);var v=(0,d.useQuery)(["thread_messages","unread",null==r?void 0:r.id],function(){return(0,f.UT)(m.av.chatThreads.unreadChatThreads())},{enabled:!!(null==r||null==(t=r.policies)?void 0:t.can_access_threads_tab),onSuccess:function(e){a(e.chat_thread_ids)},onError:function(e){b(e.message)}}),g=v.isLoading,_=v.refetch,x=function(e){"chatThreadRead"===e.event?j(e.chat_thread_id):"newMessage"===e.event&&w(e.json_message)},j=function(e){i.includes(e)&&a(i.filter(function(t){return t!==Number(e)}))},w=function(e){(null==e?void 0:e.unread_flow)&&u(!0);var t,n=(null==(t=e.sender)?void 0:t.community_member_id)===(null==r?void 0:r.id),o=!e.chat_thread_id,s=(null==e?void 0:e.chat_room_parent_type)==="Live::Room",l=i.includes(e.chat_thread_id);if(!o&&!n&&!s&&!l){if(h){var c=e.chat_thread_id,d=document.getElementById(String(c));if(d&&(0,M.z)(d))return}a(function(t){return((function(e){if(Array.isArray(e))return R(e)})(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||L(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e.chat_thread_id])})}},O={fetchUnreadChatThreads:_,unreadChatThreadIds:i,unreadThreadsCount:i.length,isLoading:g,onEventReceive:x,isUnreadThreadFlow:l};return(0,A.jsx)(F.Provider,{value:O,children:n})},B=function(){return(0,c.useContext)(F)},q=n(3697),z=function(e){var t=e.current_participant,n=e.chat_room_kind===q.g8,r=(0,u.isEmpty)(t)||(null==t?void 0:t.can_send_message_in_room),o=!(0,u.isEmpty)(t)&&!(null==t?void 0:t.deleted_at);return{canSendMessage:n?r:o,canParticipantsMessage:r}},Z=n(7355),H=n(5326),V=n(21368),Q=n(77384),W=n(61853),G=n(36353);function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var K=function(){var e=(0,W.f4)(),t=e.chatRoomMessages,n=void 0===t?[]:t,r=e.setChatRoomMessages,o=e.setScrollInfo,i=(0,G.Op)().calculateScrollInfo,a=(0,k.x)(),s=a.parentMessage,l=a.updateParentMessage,c=function(e){var t,a,c=e.communityMemberId,u=e.emoji,d=e.reactionableId,f=structuredClone(n),m=f.findIndex(function(e){return e.id===d});if(-1!==m){var p=f[m],b=p.reactions.findIndex(function(e){return e.emoji===u});if(!(-1!==b&&(null==(a=p.reactions[b])||null==(t=a.community_member_ids)?void 0:t.includes(c)))&&(-1!==b?(p.reactions[b].community_member_ids.push(c),p.reactions[b].count+=1):p.reactions.push({emoji:u,community_member_ids:[c],count:1}),o(i({event:"reaction"})),r(f),(null==s?void 0:s.id)===d)){var h=f.find(function(e){return e.id===s.id});h&&l($({},h))}}},u=function(e){var t,a,c=e.communityMemberId,u=e.emoji,d=e.reactionableId,f=structuredClone(n),m=f.findIndex(function(e){return e.id===d});if(-1!==m){var p=f[m],b=p.reactions.findIndex(function(e){return e.emoji===u});if(-1!==b&&(null==(a=p.reactions[b])||null==(t=a.community_member_ids)?void 0:t.includes(c))&&(1===p.reactions[b].count?p.reactions.splice(b,1):(p.reactions[b].community_member_ids=p.reactions[b].community_member_ids.filter(function(e){return e!==c}),p.reactions[b].count-=1),o(i({event:"reaction"})),r(f),(null==s?void 0:s.id)===d)){var h=f.find(function(e){return e.id===s.id});h&&l($({},h))}}},d=function(e){if("ChatRoomMessage"===e.json_message.reactionable_type){var t=e.json_message,n={communityMemberId:t.community_member_id,emoji:t.emoji,reactionableId:t.reactionable_id};"createReaction"===e.event?c(n):"destroyReaction"===e.event&&u(n)}};return{createReactionFromMessage:c,removeReactionFromMessage:u,handleReactionFromWebsocket:d,onReactionWebsocketEvent:function(e){switch(e.event){case"createReaction":case"destroyReaction":d(e)}}}};function J(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var X=function(e,t){var n=(0,c.useCallback)(function(n){var r;return(r=function(){var r,o;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(i){switch(i.label){case 0:var a,s;if(!(r=e.find(function(e){return e.id===n})))return[2];if(!(null==r?void 0:r.bookmark_id))return[3,1];return a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},r),s=s={bookmark_id:null},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(s)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(s,e))}),o=a,[3,3];case 1:return[4,(0,f.UT)(m.av.chatRoomMessages.show({uuid:r.chat_room_uuid,id:r.id}))];case 2:o=i.sent(),i.label=3;case 3:if(!o)return[2];return t(e.map(function(e){return e.id===r.id?o:e})),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){J(i,n,o,a,s,"next",e)}function s(e){J(i,n,o,a,s,"throw",e)}a(void 0)})})()},[e,t]);return(0,c.useEffect)(function(){var e=function(e){n(e)};return Q.K.on("onBookmarkToggle",e),function(){Q.K.off("onBookmarkToggle",e)}},[n]),n};function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function ee(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}n(72202);var et=function(){var e=(0,k.x)(),t=e.parentMessage,n=e.updateParentMessage,r=(0,W.qN)(),o=r.chatMessages,i=r.setChatMessages,a=r.scrollInfo,s=r.setScrollInfo,l=function(e,t,n){var r=t.communityMemberId,o=t.emoji,i=e.reactions.findIndex(function(e){return e.emoji===o});if(-1===i){n&&e.reactions.push({emoji:o,community_member_ids:[r],count:1});return}var a=e.reactions[i],s=a.community_member_ids.includes(r);(!n||!s)&&(n||s)&&(n?(a.community_member_ids.push(r),a.count+=1):1===a.count?e.reactions.splice(i,1):(a.community_member_ids=a.community_member_ids.filter(function(e){return e!==r}),a.count-=1))},c=function(e){var r=e.communityMemberId,c=e.emoji,u=e.reactionableId;if((null==t?void 0:t.id)===u){var d=structuredClone(t);l(d,{communityMemberId:r,emoji:c},!0),n(d);return}var f=structuredClone(o),m=f.findIndex(function(e){return e.id===u});-1!==m&&(l(f[m],{communityMemberId:r,emoji:c},!0),s(ee(Y({},a),{action:"noScroll"})),i(f))},u=function(e){var r=e.communityMemberId,c=e.emoji,u=e.reactionableId;if((null==t?void 0:t.id)===u){var d=structuredClone(t);l(d,{communityMemberId:r,emoji:c},!1),n(d);return}var f=structuredClone(o),m=f.findIndex(function(e){return e.id===u});-1!==m&&(l(f[m],{communityMemberId:r,emoji:c},!1),s(ee(Y({},a),{action:"noScroll"})),i(f))};return{createReactionFromThread:c,removeReactionFromThread:u,handleReactionFromWebsocket:function(e){if("ChatRoomMessage"===e.json_message.reactionable_type){var t=e.json_message,n={communityMemberId:t.community_member_id,emoji:t.emoji,reactionableId:t.reactionable_id};"createReaction"===e.event?c(n):"destroyReaction"===e.event&&u(n)}}}}},61853:function(e,t,n){n.d(t,{AP:()=>y,CD:()=>v,Dk:()=>h,Dq:()=>c,G9:()=>x,Iv:()=>u,Kv:()=>f,Rv:()=>_,XT:()=>g,f4:()=>j,iX:()=>m,nC:()=>b,qN:()=>p,yf:()=>d});var r=n(39295),o=n(21368),i=function(e){return e.threads},a=function(e){return e.ui},s=function(e){return e.inbox},l=function(e){return e.unread},c=function(e){return Array.from(e.chatRoomMap.values()).reverse()},u=function(e){return e.messageActions},d=function(e){return e.actions},f=function(e){return function(t){return t.chatRoomMap.get(e)}},m=function(e){return e.messageActions.sendRichTextMessage},p=function(){return(0,o.a)(i)},b=function(){return(0,o.a)(a)},h=function(){return(0,o.a)(s)},v=function(){return(0,o.a)(l)},y=function(){var e=(0,o.a)(d).createNewChatRoom,t=(0,r.q)().chatRoomUuid,n=(0,o.a)(function(e){var n;return null==(n=e.chatRoomStateMap.get(t))?void 0:n.uiState});return null!=n?n:e(t)},g=function(){var e=(0,r.q)().chatRoomUuid;return{chatRoomMessages:(0,o.a)(function(t){var n;return null==(n=t.chatRoomStateMap.get(e))?void 0:n.chatRoomMessages})}},_=function(){var e=(0,r.q)().chatRoomUuid;return(0,o.a)(f(e))},x=function(){var e=(0,o.a)().messageActions,t=(0,r.q)(),n=t.chatRoomUuid,i=t.isMessaging;return{setChatRoomMessages:function(t){return e.setChatRoomMessages(n,t)},fetchChatMessages:function(t){return e.fetchChatMessages(n,i,t)},setIsLoading:function(t){return e.setIsLoading(n,t)},setIsInitialPageLoaded:function(t){return e.setIsInitialPageLoaded(n,t)},setHasNextPage:function(t){return e.setHasNextPage(n,t)},setHasPrevPage:function(t){return e.setHasPrevPage(n,t)},setScrollInfo:function(t){return e.setScrollInfo(n,t)},setFirstMessageId:function(t){return e.setFirstMessageId(n,t)},setLastMessageId:function(t){return e.setLastMessageId(n,t)},setTopMessageId:function(t){return e.setTopMessageId(n,t)},setActiveMessageId:function(t){return e.setActiveMessageId(n,t)},appendLastMessage:function(t){return e.appendLastMessage(n,t)},deleteMessage:function(t){return e.deleteMessage(n,t)},updateMessage:function(t){return e.updateMessage(n,t)}}},j=function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},y(),g(),x(),{chatRooms:(0,o.a)(c)})}},21368:function(e,t,n){n.d(t,{a:()=>B});var r=n(69612),o=n(64100),i=n(24522),a=n(93199),s=n(13532),l={isLoading:!1,hasNextPage:!1,hasPrevPage:!1,scrollInfo:{},firstMessageId:null,lastMessageId:null,topMessageId:null,isInitialPageLoaded:!1,activeMessageId:null},c={uiState:l,chatRoomMessages:[]};function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)})}}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function m(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function p(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var b=function(e,t){return{actions:{createNewChatRoom:function(t){return e(function(e){e.chatRoomStateMap.set(t,f({},c))}),l},fetchChatRoom:function(n){return d(function(){var r,o,i,u,d;return p(this,function(p){switch(p.label){case 0:o=(null==(r=t().chatRoomStateMap.get(n)||c)?void 0:r.uiState)||l,i=m(f({},r),{uiState:m(f({},o),{isLoading:!0})}),e(function(e){e.chatRoomStateMap.set(n,i)}),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,(0,a.UT)(s.av.chatRooms.show({uuid:n}))];case 2:return(u=p.sent()).chat_room&&e(function(e){var t=u.chat_room;e.chatRoomMap.set(n,t);var r=e.chatRoomStateMap.get(n);r&&(r.uiState.isLoading=!1)}),[3,4];case 3:return d=p.sent(),e(function(e){var t=e.chatRoomStateMap.get(n);t&&(t.uiState.isLoading=!1)}),console.error(d),[3,4];case 4:return[2]}})})()},ensureChatRoomParticipant:function(e){return d(function(){var n;return p(this,function(r){switch(r.label){case 0:if(null==(n=t().chatRoomMap.get(e))?void 0:n.current_participant)return[3,2];return[4,t().actions.fetchChatRoom(e)];case 1:r.sent(),r.label=2;case 2:return[2]}})})()},updateChatRoom:function(n){return e(function(e){var r=t().chatRoomMap.get(n.uuid);r&&e.chatRoomMap.set(n.uuid,f({},r,n))})},appendChatRoom:function(t){return e(function(e){e.chatRoomMap.delete(t.uuid),e.chatRoomMap.set(t.uuid,t)})},removeChatRoom:function(t){return e(function(e){e.chatRoomMap.delete(t)})},markChatRoomAsRead:function(t){return e(function(e){var n=e.chatRoomMap.get(t);n&&(n.has_unread_messages=!1)})}}}},h=n(96486),v=n(43340);function y(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var _=n(36353);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function j(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function w(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return x(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var O=function(e,t){return{messageActions:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},{setChatRoomMessages:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.chatRoomMessages=n)})},appendLastMessage:function(n,r){var o,i=null==(o=t().chatRoomStateMap.get(n))?void 0:o.uiState,a=!!(null==i?void 0:i.isInitialPageLoaded),s=!!(null==i?void 0:i.hasNextPage);a&&!s&&e(function(e){var t,o=e.chatRoomStateMap.get(n);if(o){var i=null!=(t=null==o?void 0:o.chatRoomMessages)?t:[];i.length>60&&(i=i.slice(-40),o.uiState.firstMessageId=i[0].id,o.uiState.hasPrevPage=!0,o.chatRoomMessages=i);var a=(0,h.last)(i);if((null==a?void 0:a.id)!=r.id&&!(0,v.wJ)(a,r)){var s=i.findIndex(function(e){return e.creation_uuid===r.creation_uuid});s>-1?i[s]=r:i.push(r),o.chatRoomMessages=i}}})},updateMessage:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);if(r){var o=r.chatRoomMessages.findIndex(function(e){return e.id===n.id});o>-1&&(r.chatRoomMessages[o]=g({},r.chatRoomMessages[o],n))}})},deleteMessage:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.chatRoomMessages=r.chatRoomMessages.filter(function(e){return e.id!==n}))})},clearSpotlightedMessages:function(t){return e(function(e){var n=e.chatRoomStateMap.get(t);n&&(n.chatRoomMessages=n.chatRoomMessages.map(function(e){var t,n;return t=g({},e),n=n={spotlighted:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}))})},sendRichTextMessage:function(e,n,r,o,i){var l;return(l=function(){var l,c,u,d,f,m;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(p){switch(p.label){case 0:return[4,t().actions.ensureChatRoomParticipant(e)];case 1:if(p.sent(),u=null==(c=null==(l=t().chatRoomMap.get(e))?void 0:l.current_participant)?void 0:c.id,!l||!c||!u)return[2];return d={chat_room_participant_id:u,rich_text_body:n},i&&(d.parent_message_id=i),[4,(0,a.Cu)(s.av.chatRoomMessages.create({uuid:e}),{chat_room_message:d})];case 2:if(f=p.sent(),i||!(m=(0,v.yf)({chatRoom:l,richTextBody:n,localAttachments:r,localSgidToObjectMap:o,parentMessageId:i,creationUuid:f.creation_uuid,sentAt:f.sent_at})))return[2];return t().messageActions.appendLastMessage(e,m),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var o=l.apply(e,t);function i(e){y(o,n,r,i,a,"next",e)}function a(e){y(o,n,r,i,a,"throw",e)}i(void 0)})})()}},{fetchChatMessages:function(n){var r,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,l=i.id,c=void 0===l?null:l,u=i.previousPerPage,d=void 0===u?20:u,f=i.nextPerPage,m=void 0===f?0:f,p=i.isInitialPage,b=void 0!==p&&p,h=i.parentMessageId;return(r=function(){var r,i,l,u,f,p,v,y,g;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(x){switch(x.label){case 0:if(r=(0,_.nc)(o,n),u=(l=(null==(i=t().chatRoomStateMap.get(n))?void 0:i.uiState)||{}).isLoading,f=l.hasNextPage,p=l.hasPrevPage,(v=0===d)&&u)return[2];return e(function(e){var t=e.chatRoomStateMap.get(n);t&&(t.uiState.isLoading=!0)}),y={previous_per_page:d,next_per_page:m},c&&(y.id=c),h&&(y.parent_message_id=h),[4,(0,a.UT)(s.av.chatRoomMessages.index({uuid:n,params:y}))];case 1:return g=x.sent(),e(function(e){var t=e.chatRoomStateMap.get(n);if(t)if(b)t.chatRoomMessages=g.records,t.uiState.scrollInfo=(0,_.kL)({event:"chatRoomLoad",scrollerId:r}),t.uiState.hasNextPage=g.has_next_page,t.uiState.hasPrevPage=g.has_previous_page,t.uiState.firstMessageId=g.first_id,t.uiState.lastMessageId=g.last_id,t.uiState.isInitialPageLoaded=!0;else{v?(t.uiState.scrollInfo=(0,_.kL)({event:"nextPaginatedMessageLoad",scrollerId:r}),t.uiState.lastMessageId=g.last_id):(t.uiState.scrollInfo=(0,_.kL)({event:"paginatedMessageLoad",scrollerId:r}),t.uiState.firstMessageId=g.first_id);var o=w(t.chatRoomMessages);if(o.length>60)if(v)o=o.slice(0,40),t.uiState.firstMessageId=o[0].id,t.uiState.hasPrevPage=!0;else{var i=g.records[g.records.length-1];t.uiState.topMessageId=i.id,o=o.slice(0,40),t.uiState.lastMessageId=o[o.length-1].id,t.uiState.hasNextPage=!0}else t.uiState.topMessageId=null;t.chatRoomMessages=v?w(o).concat(w(g.records)):w(g.records).concat(w(o)),f&&(t.uiState.hasNextPage=g.has_next_page),p&&(t.uiState.hasPrevPage=g.has_previous_page)}}),e(function(e){var t=e.chatRoomStateMap.get(n);t&&(t.uiState.isLoading=!1)}),[2,g]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){j(i,n,o,a,s,"next",e)}function s(e){j(i,n,o,a,s,"throw",e)}a(void 0)})})()}},{setIsLoading:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.isLoading=n)})},setIsInitialPageLoaded:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.isInitialPageLoaded=n)})},setHasNextPage:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.hasNextPage=n)})},setHasPrevPage:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.hasPrevPage=n)})},setScrollInfo:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.scrollInfo=n)})},setFirstMessageId:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.firstMessageId=n)})},setLastMessageId:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.lastMessageId=n)})},setTopMessageId:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.topMessageId=n)})},setActiveMessageId:function(t,n){return e(function(e){var r=e.chatRoomStateMap.get(t);r&&(r.uiState.activeMessageId=n)})}})}},S=function(){return{chatRoomMap:new Map,chatRoomStateMap:new Map}},P=n(10749),C=n(36394);function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function N(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return I(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var A=function(e,t){return{inbox:{currentChatId:null,setCurrentChatId:function(t){return e(function(e){e.inbox.currentChatId=t})},memberChats:[],adminChats:[],previewChat:null,totalUnreadChatsCount:0,totalUnreadPausedAiChatsCount:0,isTotalUnreadPausedAiChatsCountLoaded:!1,setChats:function(t,n){var r="member"===n?"memberChats":"adminChats";e(function(e){e.inbox[r]=t})},appendChats:function(n,r){var o="member"===r?"memberChats":"adminChats";e(function(e){e.inbox[o]=(0,h.uniq)(N(t().inbox[o]).concat(N(n)))})},setPreviewChat:function(t){e(function(e){e.inbox.previewChat=t})},fetchChat:function(n,r){var o;return(o=function(){var o,i;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(a){switch(a.label){case 0:return[4,C.MW.fetchChat({id:n})];case 1:return o=a.sent(),i="member"===r?"memberChats":"adminChats",t().inbox[i].find(function(e){return e.id===o.id})?e(function(e){e.inbox.updateChat(o,r)}):e(function(e){e.inbox.appendChat(o,r)}),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var i=o.apply(e,t);function a(e){k(i,n,r,a,s,"next",e)}function s(e){k(i,n,r,a,s,"throw",e)}a(void 0)})})()},appendChat:function(n,r){var o="member"===r?"memberChats":"adminChats";t().inbox[o].some(function(e){return e.id===n.id})||e(function(e){e.inbox[o]=[n].concat(N(e.inbox[o]))})},updateChat:function(n,r){var o="member"===r?"memberChats":"adminChats",i=t().inbox[o].findIndex(function(e){return e.id===n.id});-1!==i?e(function(e){e.inbox[o][i]=n}):t().inbox.appendChat(n,r)},destroyChat:function(t,n){var r="member"===n?"memberChats":"adminChats";e(function(e){e.inbox[r]=e.inbox[r].filter(function(e){return e.id!==t})})},adminMarkAsRead:function(t){C.MW.adminMarkAsRead({id:t}).then(function(){e(function(e){var n=e.inbox.adminChats.findIndex(function(e){return e.id===t});-1!==n&&(e.inbox.adminChats[n].has_unread_messages_for_admin=!1,e.inbox.adminChats[n].ai_snoozed&&(e.inbox.totalUnreadPausedAiChatsCount=e.inbox.totalUnreadPausedAiChatsCount-1))})}).catch(function(e){console.error(e)})},memberMarkAsRead:function(t){C.MW.memberMarkAsRead({id:t}).then(function(){e(function(e){var n=e.inbox.memberChats.findIndex(function(e){return e.id===t});-1!==n&&(e.inbox.memberChats[n].has_unread_messages_for_member=!1,e.inbox.totalUnreadChatsCount=e.inbox.totalUnreadChatsCount-1)})}).catch(function(e){console.error(e)})},messages:[],setMessages:function(t){return e(function(e){e.inbox.messages=t})},appendMessage:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"member";if(n.community_inbox_chat_id!==Number(t().inbox.currentChatId))return void e(function(e){var t=e.inbox["member"===r?"memberChats":"adminChats"].findIndex(function(e){return e.id===n.community_inbox_chat_id});-1!==t&&("member"===r?(e.inbox.memberChats[t].has_unread_messages_for_member=!0,e.inbox.totalUnreadChatsCount=e.inbox.memberChats.filter(function(e){return e.has_unread_messages_for_member}).length):(e.inbox.adminChats[t].has_unread_messages_for_admin=!0,e.inbox.totalUnreadPausedAiChatsCount=e.inbox.adminChats.filter(function(e){return e.has_unread_messages_for_admin&&e.ai_snoozed}).length))});t().inbox.messages.some(function(e){return e.id===n.id})||e(function(e){e.inbox.messages=N(e.inbox.messages).concat([n])})},updateMessage:function(n){n.community_inbox_chat_id===Number(t().inbox.currentChatId)&&e(function(e){var t=e.inbox.messages.findIndex(function(e){return e.id===n.id});-1!==t&&(e.inbox.messages[t]=n)})},destroyMessage:function(t){e(function(e){e.inbox.messages=e.inbox.messages.filter(function(e){return e.id!==t})})},resetMessages:function(){return e(function(e){e.inbox.messages=[]})},scrollAction:P.aO.FIRST_LOAD,setScrollAction:function(t){e(function(e){e.inbox.scrollAction=t})},currentBotProfile:null,setCurrentBotProfile:function(t){e(function(e){e.inbox.currentBotProfile=t})},fetchTotalUnreadChatsCount:function(){return C.MW.unreadMemberChatsCount().then(function(t){var n=t.unread_chats_count;e(function(e){e.inbox.totalUnreadChatsCount=n})}).catch(function(e){console.error(e)})},fetchPausedAiUnreadChatsCount:function(){return C.MW.unreadAdminPausedAiChatsCount().then(function(t){var n=t.unread_chats_count;e(function(e){e.inbox.totalUnreadPausedAiChatsCount=n,e.inbox.isTotalUnreadPausedAiChatsCountLoaded=!0})}).catch(function(e){console.error(e)})},setIsProcessing:function(t,n){e(function(e){var r=e.inbox["member"===n?"memberChats":"adminChats"].find(function(t){return t.id===e.inbox.currentChatId});r&&(r.is_processing=t)})},setPreviewChatProcessing:function(t){e(function(e){var n=e.inbox.previewChat;n&&(n.is_processing=t)})}}}};function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function T(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var M={chatMessages:[],isLoading:!1,hasNextPage:!1,hasPrevPage:!1,scrollInfo:{},firstMessageId:null,lastMessageId:null,totalMessagesCount:0,metaData:{}},R=function(e){return{threads:T(E({},M),{setChatMessages:function(t){return e(function(e){e.threads.chatMessages=t})},setIsLoading:function(t){return e(function(e){e.threads.isLoading=t})},setHasNextPage:function(t){return e(function(e){e.threads.hasNextPage=t})},setHasPrevPage:function(t){return e(function(e){e.threads.hasPrevPage=t})},setScrollInfo:function(t){return e(function(e){e.threads.scrollInfo=t})},setFirstMessageId:function(t){return e(function(e){e.threads.firstMessageId=t})},setLastMessageId:function(t){return e(function(e){e.threads.lastMessageId=t})},setTotalMessagesCount:function(t){return e(function(e){e.threads.totalMessagesCount=t})},setMetaData:function(t){return e(function(e){e.threads.metaData=t})},clearSpotlightedMessages:function(){return e(function(e){e.threads.chatMessages=e.threads.chatMessages.map(function(e){return T(E({},e),{spotlighted:!1})})})}})}},D=function(e){return{ui:{liveChatRoomUuid:null,setLiveChatRoomUuid:function(t){return e(function(e){e.ui.liveChatRoomUuid=t})},dmSelectedTabIndex:0,setDmSelectedTabIndex:function(t){return e(function(e){e.ui.dmSelectedTabIndex=t})}}}},L=function(e){return{unread:{unreadChatRoomUuids:{},setUnreadChatRoomUuids:function(t,n){return e(function(e){e.unread.unreadChatRoomUuids[t]=n})},appendUnreadChatRoomUuids:function(t,n){return e(function(e){e.unread.unreadChatRoomUuids[t]||(e.unread.unreadChatRoomUuids[t]=[]),e.unread.unreadChatRoomUuids[t].push(n)})}}}};function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function U(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return F(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(0,r.MD)();var B=(0,o.Ue)()((0,i.n)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},S.apply(void 0,U(t)),b.apply(void 0,U(t)),O.apply(void 0,U(t)),R.apply(void 0,U(t)),L.apply(void 0,U(t)),D.apply(void 0,U(t)),A.apply(void 0,U(t)))}))},2952:function(e,t,n){n.d(t,{u:()=>b});var r=n(67294),o=n(7999),i=n(91525),a=n(61853),s=n(59413),l=n(42992),c=n(95834),u=n(36353);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)})}}function p(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var b=function(){var e,t=(0,a.G9)(),n=t.setChatRoomMessages,f=t.setScrollInfo,b=t.appendLastMessage,h=t.deleteMessage,v=t.updateMessage,y=t.fetchChatMessages,g=(0,i.wh)().isViewOnlyMasquerading,_=(0,a.AP)(),x=_.scrollInfo,j=_.topMessageId,w=(0,a.Rv)(),O=null==w?void 0:w.current_participant,S=(e=(0,r.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return d(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),P=S[0],C=S[1],I=(0,s.x)(),k=I.parentMessage,N=I.updateParentMessage,A=(0,c.w)().markChatRoomAsRead,E=(0,u.Op)(),T=E.calculateScrollInfo,M=E.getScrollingElement,R=function(e){return m(function(){return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,y(e)];case 1:return t.sent().has_next_page||P||g||null==w||!w.uuid||A({uuid:null==w?void 0:w.uuid}),[3,3];case 2:return console.error(t.sent()),[3,3];case 3:return[2]}})})()},D=function(e){var t=e.id,n=e.parent_message;n?v(n):h(t)},L=function(e){f(T({event:"messageUpdated"}));var t=e.json_message;v(t),t.id===(null==k?void 0:k.id)&&N(t)},F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.json_message;if(!r.parent_message_id){f(T({event:(0,o.OG)(r,O)?"messageSent":"messageReceived"})),b(r);return}f(T({event:"parentMessageUpdated"})),(0,l.y)({chatMessages:t,setChatRoomMessages:n,newMessage:r})};return{fetchChatMessages:R,fetchChatMessagesFirstPage:function(e){return m(function(){var t;return p(this,function(n){switch(n.label){case 0:var r,o;return n.trys.push([0,2,,3]),t={isInitialPage:!0},e&&(r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},t),o=o={id:e,previousPerPage:20,nextPerPage:20},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))}),t=r),[4,R(t)];case 1:return n.sent(),[3,3];case 2:return console.error(n.sent()),[3,3];case 3:return[2]}})})()},adjustScroller:function(){var e=M();if(e){var t=document.getElementById("unread-message-breakpoint");switch(x.action){case"scrollToBottom":e.scrollTop=e.scrollHeight;break;case"adjustTop":if(j){var n=document.getElementById(j.toString());null==n||n.scrollIntoView()}else{var r,o,i=null!=(r=x.scrollHeightValue)?r:0,a=null!=(o=x.scrollTopValue)?o:0;e.scrollTop=e.scrollHeight-(i-a)}break;case"scrollToUnreadMessageIndicator":t?t.scrollIntoView({block:"center"}):e.scrollTop=e.scrollHeight}}},onEventReceive:function(e,t){switch(e.event){case"newMessage":F(e,t);break;case"deletedMessage":D(e);break;case"updatedMessage":L(e)}},setUnreadMessageFlow:C}}},98694:function(e,t,n){n.d(t,{K:()=>j});var r=n(67294),o=n(88767),i=n(93199),a=n(13532),s=n(84326),l=n(3697),c=n(61853),u=n(72202),d=n(2504),f=n(51630);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||v(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}var y=function(e){var t=e.communityId,n=(0,c.CD)().setUnreadChatRoomUuids,m=(0,d.t)().sendNotificationToDesktopApp,v=(0,u.i)({communityId:t}),y=b((0,r.useState)([]),2),g=y[0],_=y[1],x=b((0,r.useState)(null),2),j=x[0],w=x[1],O=(0,r.useRef)(v),S=(0,r.useRef)(g),P=(0,o.useMutation)(function(){return f.MS.getChatRoomCurrentParticipant(j)},{mutationKey:["chatroom","participant",j]}),C=function(e,t,n){var r;return(r=function(){var r,o,i,a,c,u,d,f,p,b,v,y;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(g){switch(g.label){case 0:if(!(o=t.json_message)||(i=o.chat_room_uuid,a=o.chat_room_kind,c=o.sender,u=o.embedded,d=null==(r=window.location.pathname)?void 0:r.split("messages/")[1],f=c.community_member_id,p=d===i,b=a===l.g8,f!==n&&m({title:"".concat(o.sender.name," ").concat((0,s.t)("desktop_app.notifications.new_message_text")),body:o.body,metadata:o,type:"message"}),u||p))return[2];if(w(i),b)return[3,2];return[4,P.mutateAsync()];case 1:v=null==(y=g.sent())?void 0:y.chat_room_participant,g.label=2;case 2:if(f===Number(n)||(null==v?void 0:v.muted))return[2];return(null==e?void 0:e.find(function(e){return e===i}))||(_(h(S.current).concat([i])),setTimeout(function(){return I()},2e3)),[2]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)})})()},I=function(){n(Number(t),h(new Set(h(O.current).concat(h(S.current))))),_([])},k=function(e,r){var o,i=r.chat_room_uuid;if(i){var a=null==e?void 0:e.filter(function(e){return e!==i});_(null==S||null==(o=S.current)?void 0:o.filter(function(e){return e!==i})),n(Number(t),a)}};return O.current=v,S.current=g,{unreadChatRoomUuids:v,onEventReceive:function(e,t,n){switch(t.event){case"newMessage":C(e,t,n);break;case"chatRoomRead":k(e,t)}},fetchUnreadChatRoomUuids:function(e){(0,i.UT)(a.av.chatRooms.unreadChatRooms({params:{community_id:e}})).then(function(t){t.chat_room_uuids&&n(Number(e),t.chat_room_uuids)}).catch(function(e){console.error(e)})},unreadChatRoomUuidsRef:O,newUnreadChatRoomBatch:g,newUnreadChatRoomBatchRef:S,setUnreadChatRoomUuids:n}},g=n(63271),_=n(41342),x=n(32701),j=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).community,t=(0,_.wh)(),n=t.currentCommunity,s=t.currentCommunityMember,l=(0,x.gq)().showMessagesTab,c=e?e.community_member_id:null==s?void 0:s.id,u=e?e.id:null==n?void 0:n.id,d=y({communityId:u}),f=d.unreadChatRoomUuids,m=d.onEventReceive,p=d.setUnreadChatRoomUuids,b=d.unreadChatRoomUuidsRef,h=d.newUnreadChatRoomBatch,v=d.newUnreadChatRoomBatchRef;return(0,o.useQuery)(["UNREAD_CHAT_ROOMS_COUNT",u,c],function(){return(0,i.UT)(a.av.chatRooms.unreadChatRooms({params:{community_id:u}}))},{enabled:!!(u&&c&&l),onSuccess:function(e){e.chat_room_uuids&&p(u,e.chat_room_uuids)}}),(0,g.s)({channel:"ChatRoomChannel",onMessageReceive:function(e){m(b.current,e,c)},community_member_id:c,canCreateConnection:!!(u&&c)}),(0,r.useEffect)(function(){b.current=f},[f]),(0,r.useEffect)(function(){v.current=h},[h]),{unreadChatCount:f.length,unreadChatRoomUuids:f}}},44428:function(e,t,n){n.d(t,{U:()=>c,u:()=>u});var r=n(67294),o=n(96486),i=n(88767),a=n(93199),s=n(13532),l=n(52478),c=100,u=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shouldDisableCache:!1,per_page:c},u=["chat-participants",e],d=n.shouldDisableCache,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(n,["shouldDisableCache"]),m=(0,r.useCallback)(function(){var e=l.E.getQueryData(u),t=(0,o.flatten)(((null==e?void 0:e.pages)||[]).map(function(e){return e.records}));return(0,o.uniqBy)(t,"id")},[u]),p=(0,i.useInfiniteQuery)(u,function(t){var n,r=t.pageParam;return n=void 0===r?1:r,(0,a.UT)(s.av.chatRoomParticipants.index({uuid:e,params:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({page:n},f)}))},{select:function(e){return{pages:e.pages,pageParams:e.pageParams,participants:(0,o.uniqBy)((0,o.flatten)((e.pages||[]).map(function(e){return e.records})),"id"),totalCount:e.pages[0].count}},enabled:((null==(t=m())?void 0:t.length)===0||d)&&!!e,getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),b=p.data,h=p.isLoading,v=p.refetch,y=p.hasNextPage,g=p.fetchNextPage,_=(b||{}).totalCount;return{chatParticipants:(0,r.useMemo)(function(){return m()},[null==b?void 0:b.pages]),isLoading:h,refetchChatParticipants:e?v:o.noop,hasNextPage:y,totalCount:void 0===_?0:_,fetchNextPage:g}}},5326:function(e,t,n){n.d(t,{p:()=>m});var r=n(70442),o=n(84326),i=n(93199),a=n(52770),s=n(13532),l=n(60878);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})}}function d(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function f(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var m=function(){var e=(0,r.k6)(),t=(0,l.pm)();return{findChatRoom:function(n){return u(function(){var r,l,c,u,m,p;return f(this,function(f){switch(f.label){case 0:l=void 0!==(r=n.shouldNavigate)&&r,c=d(n,["shouldNavigate"]),f.label=1;case 1:return f.trys.push([1,3,,4]),u=c.community_member_ids,[4,(0,i.UT)(s.av.chatRooms.fetch({params:{community_member_ids:u}}))];case 2:return m=f.sent().uuid,l&&e.push((0,s.so)({uuid:m})),[2,m];case 3:return p=f.sent(),t.error((0,o.t)("something_went_wrong")),(0,a.d)(p),[3,4];case 4:return[2]}})})()},findOrCreateChatRoom:function(n){return u(function(){var r,o,l,c,u,m,p,b;return f(this,function(f){switch(f.label){case 0:o=void 0!==(r=n.shouldNavigate)&&r,l=d(n,["shouldNavigate"]),f.label=1;case 1:return f.trys.push([1,3,,4]),c={chat_room:l},[4,(0,i.Cu)(s.av.chatRooms.create(),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},c))];case 2:return m=(u=f.sent()).chat_room.uuid,o&&e.push((0,s.so)({uuid:u.chat_room.uuid})),[2,m];case 3:return p=f.sent(),t.error((null==(b=p.errorDetails)?void 0:b.message)||p.message),(0,a.d)(p),[3,4];case 4:return[2]}})})()}}}},39295:function(e,t,n){n.d(t,{A:()=>a,q:()=>s});var r=n(85893),o=n(67294),i=(0,o.createContext)({chatRoomUuid:"main",isMessaging:!1});i.displayName="ChatRoomContext";var a=function(e){var t=e.chatRoomUuid,n=e.isMessaging,o=e.children;return(0,r.jsx)(i.Provider,{value:{chatRoomUuid:t,isMessaging:void 0!==n&&n},children:o})},s=function(){return(0,o.useContext)(i)}},38825:function(e,t,n){n.d(t,{T:()=>v});var r=n(67294),o=n(96486),i=n(84326),a=n(93199),s=n(13532),l=n(61853),c=n(51630),u=n(59413),d=n(60878),f=n(90047);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function b(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}}var v=function(){var e,t=(0,l.qN)(),n=t.chatMessages,m=t.setChatMessages,v=t.isLoading,y=t.setIsLoading,g=t.hasNextPage,_=t.hasPrevPage,x=t.setHasNextPage,j=t.setHasPrevPage,w=t.scrollInfo,O=t.setScrollInfo,S=t.setFirstMessageId,P=t.setLastMessageId,C=t.setTotalMessagesCount,I=t.setMetaData,k=(e=(0,r.useState)(!1),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||h(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),N=k[0],A=k[1],E=(0,f.j)().isMobileView,T=(0,u.x)(),M=T.parentMessage,R=T.updateParentMessage,D=(0,d.pm)().error,L=function(e){var t=e.event,n=document.getElementById("message-thread-scroll-view");if(!n)return{action:"noScroll",scrollTopValue:0,scrollHeightValue:0};var r="noScroll";switch(t){case"messageSent":r="scrollToBottom";break;case"messageReceived":var o=n.scrollTop-n.scrollHeight+n.offsetHeight;(E()&&0===o||o<=1||o>14)&&(r="scrollToBottom");break;case"chatThreadsLoad":r="scrollToUnreadMessageIndicator";break;case"paginatedMessageLoad":r="adjustTop";break;case"nextPaginatedMessageLoad":case"messageUpdated":case"messageDeleted":r="noScroll"}return{action:r,scrollTopValue:n.scrollTop,scrollHeightValue:n.scrollHeight}},F=function(e,t){var n=e.id;m(t.filter(function(e){return e.id!==n}))},U=function(e,t){var n=e.json_message;n&&(m(b(t.reduce(function(e,t){return t.id===n.id?e.push(n):e.push(t),e},[]))),n.id===(null==M?void 0:M.id)&&R(n))},B=function(e,t){var r=e.json_message;r&&(O(L({event:r.sender.id===t.id?"messageSent":"messageReceived"})),m(b(n).concat([r])))};return{fetchChatMessages:function(e){var t,r=e.id,l=e.previousPerPage,u=void 0===l?20:l,d=e.nextPerPage,f=void 0===d?0:d,h=e.chatRoomUuid,w=e.isInitialPage,k=void 0!==w&&w,N=e.parentMessage;return(t=function(){var e,t,l,d,p;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(w){switch(w.label){case 0:if(((e=0===u)||k)&&v)return[2];y(!0),t={previous_per_page:u,next_per_page:f,parent_message_id:N.id},r&&(t.id=r),w.label=1;case 1:return w.trys.push([1,3,4,5]),[4,(0,a.UT)(s.av.chatRoomMessages.index({uuid:h,params:t}))];case 2:return l=w.sent(),k?((null==(d=l.meta)?void 0:d.chat_thread_participant_id)&&(O(L({event:"chatThreadsLoad"})),(0,c.ex)(N.chat_thread_id)),I(l.meta),m(l.records),x(l.has_next_page),j(l.has_previous_page),C(l.total_count),S(l.first_id),P(l.last_id),A(!0)):(e?(O(L({event:"nextPaginatedMessageLoad"})),P(l.last_id)):(O(L({event:"paginatedMessageLoad"})),S(l.first_id)),m((0,o.uniqBy)(b(l.records).concat(b(n)),"id")),g&&x(l.has_next_page),_&&j(l.has_previous_page)),[3,5];case 3:return p=w.sent(),D((0,i.t)("request_failure_message")),console.error(p),[3,5];case 4:return y(!1),[7];case 5:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)})})()},calculateScrollInfo:L,adjustScroller:function(){var e=document.getElementById("message-thread-scroll-view");if(e){var t=document.getElementById("unread-thread-message-breakpoint");switch(w.action){case"scrollToBottom":e.scrollTop=e.scrollHeight;break;case"adjustTop":e.scrollTop=e.scrollHeight-(w.scrollHeightValue-w.scrollTopValue);break;case"scrollToUnreadMessageIndicator":t?t.scrollIntoView({behavior:"smooth"}):e.scrollTop=e.scrollHeight}}},onEventReceive:function(e,t,n){switch(e.event){case"newMessage":B(e,n);break;case"deletedMessage":F(e,t);break;case"updatedMessage":U(e,t)}},isInitialPageLoaded:N,setIsInitialPageLoaded:A}}},55757:function(e,t,n){n.d(t,{N:()=>v,T:()=>g});var r=n(67294),o=n(96486),i=n(88767),a=n(70442),s=n(93199),l=n(14218),c=n(41342),u=n(13532);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function p(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function b(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return d(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=["sidebar","chat-rooms","all"],v=["messaging","chat-rooms","all"],y=["sidebar","chat-rooms","unread"],g=function(e){var t=e.openChatRoomUuid,n=e.uuids,d=(0,i.useQueryClient)(),g=((0,c.wh)().currentCommunitySettings||{}).cached_unread_chat_room_ids_enabled,_=(0,l.d)().updateAllRecords,x=(0,a.TH)().pathname.startsWith("/messages"),j=(0,r.useMemo)(function(){return n?y:x?v:h},[n,x]),w=function(e){_(e,j)},O=function(e){var t={page:e,per_page:x?20:10};return n&&(g?t.only_unread=!0:t.uuids=n),(0,s.UT)(u.av.chatRooms.index({params:t}))},S=(0,i.useInfiniteQuery)(j,function(e){var t=e.pageParam;return O(void 0===t?1:t)},{select:function(e){var t=e.pages,n=void 0===t?[]:t;return{pages:(0,o.uniqBy)((0,o.flatten)(n.map(function(e){return e.records})),"uuid"),pageParams:n.map(function(e){return e.page})}},onSuccess:function(){D(t)},getNextPageParam:function(e){return e.has_next_page?Number(e.page)+1:void 0}}),P=S.isLoading,C=S.refetch,I=S.data,k=(void 0===I?{}:I).pages,N=void 0===k?[]:k,A=S.hasNextPage,E=void 0!==A&&A,T=S.fetchNextPage,M=function(e){return N.find(function(t){return t.uuid===e})},R=function(e){(0,s.UT)(u.av.chatRooms.show({uuid:e})).then(function(e){e.chat_room&&w([e.chat_room].concat(b(N)))})},D=function(e){e&&"new"!==e&&N.find(function(e){return!!e.isOpen})&&R(e)},L=function(e){if(e.pinned_at)w(N.map(function(t){return t.uuid===e.uuid?e:t}));else{var t=[],n=[];N.forEach(function(r){r.pinned_at?t.push(r):r.uuid!==e.uuid&&n.push(r)}),w(b(t).concat([e],b(n)))}},F=function(e,t){var n=e.json_message,r=n.chat_room_uuid,o=n.sender.community_member_id,i=n.embedded,a=M(r);if(a){var s=a.isOpen;L(p(m({},a),{last_message:n,has_unread_messages:!s&&o!==t}))}else!0!==i&&R(r)},U=function(e){var t=e.chat_room_uuid,n=N.findIndex(function(e){return e.uuid===t});if(n>-1){var r=N[n];w(b(N.slice(0,n)).concat([p(m({},r),{has_unread_messages:!1})],b(N.slice(Number(n)+1))))}},B=function(e){var t="string"==typeof e.chat_room?JSON.parse(e.chat_room):e.chat_room;w(N.map(function(e){return e.uuid===t.uuid?p(m({},e),{chat_room_name:t.chat_room_name}):e}))},q=function(e){var t=e.chat_room_uuid;w(N.filter(function(e){return e.uuid!==t}))},z=function(e){var t=(0,o.isObject)(e.chat_room)?e.chat_room:JSON.parse(e.chat_room);w(N.map(function(e){return e.uuid===t.uuid?t:e}))},Z=function(){var e;return(e=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(e){switch(e.label){case 0:return[4,d.invalidateQueries(j)];case 1:return e.sent(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,s,"next",e)}function s(e){f(i,r,o,a,s,"throw",e)}a(void 0)})})()},H=function(e){var t=e||{},n=t.chat_room_id,r=t.pinned_at,o={},i=[];N.forEach(function(e){e.id!==n?i.push(e):o=p(m({},e),{pinned_at:r})}),w([o].concat(b(i)))},V=function(e){var t=(e||{}).chat_room_id;w(b(N.map(function(e){return e.id===t?p(m({},e),{pinned_at:null}):e}))),C()};return{chatRooms:N,setChatRooms:w,fetchChatRoomForUuid:M,onEventReceive:function(e,t){switch(e.event){case"newMessage":F(e,t);break;case"chatRoomRead":U(e);break;case"chatRoomCreated":Z();break;case"chatRoomUpdated":B(e);break;case"chatRoomDeleted":case"chatRoomParticipantDestroy":q(e);break;case"chatRoomParticipantsUpdated":z(e);break;case"chatRoomPinned":H(e);break;case"chatRoomUnPinned":V(e)}},chatRoomsHasNextPage:E,hasNextPage:E,fetchNextPage:T,fetchUserChatRooms:C,isLoading:P}}},1800:function(e,t,n){n.d(t,{C:()=>O,_:()=>S});var r=n(85893),o=n(67294),i=n(88767),a=n(70442),s=n(84326),l=n(93199),c=n(52770),u=n(13532),d=n(60878),f=n(3697),m=n(99385),p=n(39964);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var h=function(){var e=(0,o.useRef)(null);return(0,o.useEffect)(function(){return clearTimeout(e.current)},[]),{debouncedFunction:(0,o.useCallback)(function(t,n){for(var r=arguments.length,o=Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];clearTimeout(e.current),e.current=setTimeout(function(){t.apply(void 0,function(e){if(Array.isArray(e))return b(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return b(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}}(o)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())},n)},[])}},v=n(61853),y=n(21368),g=n(95834);function _(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function x(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){_(i,r,o,a,s,"next",e)}function s(e){_(i,r,o,a,s,"throw",e)}a(void 0)})}}function j(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}var w=(0,o.createContext)({chatRooms:[]});w.displayName="ChatRoomsContext";var O=function(e){var t=e.children,n=(0,y.a)(v.Dq),b=(0,y.a)(v.yf),_=b.fetchChatRoom,O=b.updateChatRoom,S=b.appendChatRoom,P=b.removeChatRoom,C=b.markChatRoomAsRead,I=(0,p.j)().addDirectMessageParticipantNameInTitle,k=(0,g.w)().markChatRoomAsRead,N=(0,a.k6)(),A=(0,d.pm)(),E=(0,i.useQueryClient)(),T=h().debouncedFunction,M=(0,o.useCallback)(function(e){return n.find(function(t){return t.uuid===e})},[n]),R=(0,o.useCallback)(function(e,t,n){var r=e.json_message,o=r.chat_room_uuid,i=r.sender.community_member_id,a=r.embedded;if(!r.parent_message_id){var s,l,c=M(o);c?(n&&T(k,2e3,{uuid:o}),S((s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},c),l=l={last_message:r,has_unread_messages:!n&&i!==t},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(l)).forEach(function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(l,e))}),s))):!0!==a&&_(o)}},[S,T,_,M]),D=(0,o.useCallback)(function(e){C(e.chat_room_uuid)},[C]),L=(0,o.useCallback)(function(e){S((e||{}).chat_room)},[S]),F=(0,o.useCallback)(function(e){O((e||{}).chat_room)},[O]),U=(0,o.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};O(e.chat_room)},[O]),B=(0,o.useCallback)(function(e){var t,n="object"==((t=e.chat_room)&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t)?e.chat_room:JSON.parse(e.chat_room);O(n),E.invalidateQueries((0,m.S)(n.uuid))},[E,O]),q=(0,o.useCallback)(function(e){P(e.chat_room_uuid),N.push((0,u.yg)())},[N,P]),z=(0,o.useCallback)(function(e,t,n){switch(e.event){case"newMessage":R(e,t,n);break;case"chatRoomRead":D(e);break;case"chatRoomCreated":L(e);break;case"chatRoomUpdated":F(e);break;case"chatRoomParticipantsUpdated":B(e);break;case"chatRoomParticipantDestroy":case"chatRoomDeleted":q(e)}},[L,q,B,D,F,R]),Z=(0,o.useCallback)(function(e){switch(e.event){case"chatRoomRead":D(e);break;case"chatRoomUpdated":U(e);break;case"chatRoomParticipantsUpdated":B(e);break;case"chatRoomParticipantDestroy":q(e)}},[U,q,B,D]),H=(0,o.useCallback)(function(e){var t,n,r=M(e);r&&I(r.chat_room_kind===f.g8?null==(n=r.other_participants_preview)||null==(t=n[0])?void 0:t.name:r.chat_room_name)},[I]),V=(0,o.useCallback)(function(e){var t=e.chatRoomUuid,n=e.rich_text_body,r=e.messageId;return x(function(){var e;return j(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(0,l.gN)(u.av.chatRoomMessages.update({uuid:t,id:r}),{chat_room_message:{rich_text_body:n}})];case 1:return o.sent(),[3,3];case 2:return e=o.sent(),A.error((0,s.t)("something_went_wrong")),(0,c.d)(e),[3,3];case 3:return[2]}})})()},[A]),Q=(0,o.useCallback)(function(e){var t=e.chatRoomUuid,n=e.messageId;return x(function(){var e;return j(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,l.pC)(u.av.chatRoomMessages.delete({uuid:t,id:n}))];case 1:return r.sent(),[3,3];case 2:return e=r.sent(),A.error((0,s.t)("something_went_wrong")),(0,c.d)(e),[3,3];case 3:return[2]}})})()},[A]),W=(0,o.useMemo)(function(){return{chatRooms:n,fetchChatRoomForUuid:M,onEventReceive:z,onEmbedEventReceive:Z,updateTitleBar:H,updateRichTextMessage:V,deleteRichTextMessage:Q}},[n,Q,M,Z,z,V,H]);return(0,r.jsx)(w.Provider,{value:W,children:t})},S=function(){return(0,o.useContext)(w)}},95834:function(e,t,n){n.d(t,{w:()=>s});var r=n(96486),o=n(88767),i=n(93199),a=n(13532),s=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onSuccess;return{markChatRoomAsRead:(0,o.useMutation)(function(e){var t=e.uuid;return(0,i.Cu)(a.av.chatRooms.markAllAsRead({uuid:t}))},{onSuccess:function(){(0,r.isFunction)(e)&&e()},onError:function(e){console.error(e.message)}}).mutateAsync}}},59413:function(e,t,n){n.d(t,{G:()=>ex,x:()=>ej});var r=n(85893),o=n(67294),i=n(70442),a=n(21541),s=n(7999),l=n(96486),c=n(84326),u=n(5603),d=n(17617),f=n(48298),m=n(71807),p=n(41342),b=n(1168),h=n(90926),v=n(33516),y=n(75148),g=n(51169),_=n(19347),x=n(57363),j=n(41553),w=function(e){var t=e.name;return(0,r.jsxs)("div",{className:"flex h-full flex-col items-center justify-center gap-2",children:[(0,r.jsx)(x.JO,{type:"20-search-v3",size:24,className:"text-disabled !w-6"}),(0,r.jsxs)("div",{className:"w-48 text-center",children:[(0,r.jsx)("div",{className:"mr-1",children:(0,r.jsx)(j.Z.LabelSm,{color:"text-default",children:(0,c.t)("chat_space.search_messages.empty_state")})}),(0,r.jsx)(j.Z.LabelSm,{color:"text-default",children:t||""})]})]})},O=n(58533),S=n(20624),P=n(35556),C=n(78252),I=n(57338),k=n(98363),N=function(e){var t=e.message,n=e.activeMessageId,o=e.setActiveMessageId,i=t.sender,a=t.sent_at,s=(0,I.H)(a),l=s.day,u=s.time,f=(0,C.O1)().redirectToMessage,m=(0,h.xX)(),p=m.toggleShowEmbeddedRailBar,v=m.shouldShowEmbeddedRailBar,y=m.closeThreadsRailbar,g=(0,d.BT)(),_="Today"===l;return(0,r.jsxs)("button",{type:"button",className:(0,b.A)("bg-primary hover:border-light w-full cursor-pointer rounded-xl border px-4 py-3 text-left",n===t.id?"border-light":"border-primary"),onClick:function(){v&&p(),g&&y(),o(t.id),f(t)},children:[(0,r.jsx)("div",{className:"mb-px flex items-center gap-1.5",children:(0,r.jsxs)("div",{className:"mb-1 flex items-center gap-1",children:[(0,r.jsx)("div",{className:"mr-1 self-start",children:(0,r.jsx)(k.s,{src:i.avatar_url,name:i.name,size:"6",hasBorder:!0})}),(0,r.jsx)("div",{className:(0,b.A)("text-darkest truncate text-left text-sm font-semibold"),children:(null==i?void 0:i.name)||""}),(0,r.jsx)("div",{className:"text-timestamp mx-0.5 inline min-w-fit text-sm font-medium",children:(0,c.t)("separator_dot")}),(0,r.jsx)("div",{className:"text-light inline min-w-fit text-sm font-normal",children:_?u:l})]})}),(0,r.jsx)(P.z,{message:t,shouldShowPreviewBlocks:!1})]},t.id)};function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var E=function(e){var t,n=e.messages,i=e.fetchNextPage,a=e.hasNextPage,s=(t=(0,o.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return A(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=s[0],u=s[1];return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsxs)(j.Z.LabelXs,{color:"text-dark",weight:"medium",children:[n.length," ",(0,c.t)("chat_space.search_messages.results")]})}),(0,r.jsx)(O.Z,{style:{overflow:"initial",height:"100%"},scrollThreshold:.8,next:i,hasMore:a,loader:(0,r.jsx)(S.m,{}),scrollableTarget:"scrollableMessageSearch",dataLength:(null==n?void 0:n.length)||0,className:"pb-6",children:(0,r.jsx)("div",{className:"space-y-2",children:n.map(function(e){return(0,r.jsx)(N,{message:e,activeMessageId:l,setActiveMessageId:u},e.id)})})})]})},T=n(88767),M=n(93199),R=n(13532),D=function(e){var t,n=e.debouncedValue,r=e.isDmsPage,o=e.currentSpace,a=(0,i.UO)().uuid,s=r?a:null==o?void 0:o.chat_room_uuid,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(0,M.UT)(R.av.search.chatRoomMessages.index({params:{page:e,query:n},chat_room_uuid:null!=s?s:""}))},u=(0,T.useInfiniteQuery)(["chat-room-message-search",n,s],function(e){var t=e.pageParam;return c(void 0===t?1:t)},{enabled:!!n,getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},select:function(e){var t=e.pages,n=void 0===t?[]:t;return{pages:(0,l.flatten)(n.map(function(e){return e.records})),pageParams:n.map(function(e){return e.page}),pagesList:n}}}),d=u.data,f=u.fetchNextPage,m=u.hasNextPage,p=u.isLoading;return{messages:null!=(t=null==d?void 0:d.pages)?t:[],fetchNextPage:f,hasNextPage:m,isLoading:p}};function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var F=function(){var e,t=(0,p.L2)().data,n=(0,h.xX)(),i=n.isDmsPage,a=n.closeThreadsRailbar,s=(0,d.BT)(),x=t?t.name:"DMs",j=(e=(0,o.useState)(""),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return L(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),O=j[0],S=j[1],P=(0,v.T)(),C=P.ref,I=P.height,k=(0,f.c)(O,300),N=D({debouncedValue:k,isDmsPage:i,currentSpace:t}),A=N.messages,T=N.isLoading,M=N.fetchNextPage,R=N.hasNextPage,F=!!k;return(0,r.jsxs)(m.x,{children:[(0,r.jsx)("div",{ref:C,children:(0,r.jsxs)(_.S0.Header,{className:(0,b.A)(s?"!px-4":"!px-2",{"h-[56px]":i}),children:[s&&(0,r.jsx)(y.h,{name:"16-arrow-left",onClick:a,className:"flex-none",ariaLabel:(0,c.t)("close")}),(0,r.jsx)(u.M,{onChange:S,searchValue:O,onKeyPress:l.noop,onClickCancel:function(){return S("")},placeholder:(0,c.t)("chat_space.search_messages.placeholder",{spaceName:(0,l.toLower)(x)}),className:(0,b.A)("!bg-primary !border-dark !hover:border-secondary-dark rounded-full",{"!h-9":!i})})]})}),(0,r.jsx)(_.S0.Content,{noPadding:!0,heightGap:I,className:"bg-secondary-dark",id:"scrollableMessageSearch",children:F?T?(0,r.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,r.jsx)(g.a,{})}):(0,r.jsx)(E,{messages:A,fetchNextPage:M,hasNextPage:!!R}):(0,r.jsx)(w,{name:x})})]})},U=n(92771),B=n(3697),q=n(81261),z=n(44428),Z=n(8054),H=n(87685),V=n(51630),Q=n(96533),W=n(80171),G=n(16089),$=n(80132),K=n(43544),J=n(60878),X=n(7383);function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ee=function(e){var t,n=e.chatRoom,o=e.refetchChatRoom,i=(0,J.pm)(),a=(0,Q.r)(),s=n.uuid,l=n.current_participant,u=(0,h.uk)(s),d=u.chatParticipants,f=u.refetchChatParticipants,m=u.totalCount,p=u.hasNextPage,v=u.fetchNextPage,_=function(e){if(Array.isArray(e))return Y(e)}(t=(0,X.F2)(void 0===d?[]:d))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return Y(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),x=(0,T.useMutation)(function(e){var t=e.participantId,n=e.status;return V.M.update({uuid:s,id:t,admin:n})},{onSuccess:function(e){var t=e.chat_room_participant,n=t.name,r=t.roles.admin,a=n||(0,c.t)("messaging.member");f(),o(),i.success(r?(0,c.t)("messaging.member_made_admin",{name:a}):(0,c.t)("messaging.member_removed_as_admin",{name:a}),{duration:"short",shouldUseProgress:!1})},onError:function(){i.error((0,c.t)("request_failure_message"))}}).mutateAsync,w=(0,T.useMutation)(function(e){var t=e.participantId;return V.M.destroy({uuid:s,id:t})},{onSuccess:function(e){var t=e.message;f(),o(),i.success(t)},onError:function(){i.error((0,c.t)("request_failure_message"))}}).mutateAsync,S=function(e){return a.show({memberPublicId:e})},P=(0,X.bb)(_),C=P.onlineParticipants,I=P.offlineParticipants,k=function(e){return e.map(function(e){var t=[{value:"view-profile",label:(0,c.t)("messaging.actions.view_profile"),onClick:function(){return S(e.user_public_uid)}},{value:e.admin?"remove-admin":"make-admin",label:e.admin?(0,c.t)("messaging.remove_admin"):(0,c.t)("messaging.make_admin"),onClick:function(){return x({participantId:e.id,status:!e.admin})}},{value:"remove",label:(0,c.t)("messaging.remove"),onClick:function(){return w({participantId:e.id})}}],n=l.id===e.id,o=!n&&l.admin;return(0,r.jsx)(W.T,{content:(0,c.t)("messaging.member_disabled_messaging"),disabled:e.messaging_enabled,children:(0,r.jsxs)("button",{type:"button",className:"hover:bg-tertiary messaging-rail__content--member focus-visible:bg-tertiary group w-full","aria-label":(0,c.t)("messaging.open_member_profile_button_aria_label",{name:e.name}),onClick:function(){return S(e.user_public_uid)},children:[(0,r.jsxs)("div",{className:(0,b.A)("text-dark flex w-[90%] items-center text-left",{"opacity-50":!e.messaging_enabled}),children:[(0,r.jsx)("div",{className:"mr-3",children:(0,r.jsx)(G.g,{name:e.name,src:e.avatar_url,status:e.status,size:"8"})}),(0,r.jsx)("div",{className:"truncate font-medium",children:n?(0,c.t)("messaging.you"):e.name}),e.admin&&(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)($.I,{label:(0,c.t)("moderator")})})]}),o&&(0,r.jsx)(K.Lt,{direction:"bottom-start",menuButtonEl:"div",button:(0,r.jsx)(K.Lt.MenuButton,{id:"action-block",children:(0,r.jsx)(y.h,{name:"20-menu-dots-horizontal",iconSize:20,ariaLabel:(0,c.t)("options_dropdown")})}),options:t})]},e.id)},e.id)})};return(0,r.jsx)("div",{id:"scrollableDiv",className:"messaging-rail__content h-full overflow-auto",children:(0,r.jsxs)(O.Z,{scrollThreshold:.8,next:v,hasMore:!!p,dataLength:m,className:"px-6 pb-6",scrollableTarget:"scrollableDiv",loader:(0,r.jsx)(g.a,{center:!0}),children:[C.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-default mb-2",children:(0,r.jsx)(j.Z.LabelXxs,{weight:"bold",color:"text-default",children:(0,c.t)("chat_space.online")})}),k(C)]}),I.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"text-default my-2",children:(0,r.jsx)(j.Z.LabelXxs,{weight:"bold",color:"text-default",children:(0,c.t)("chat_space.offline")})}),k(I)]})]})})},et=function(e){var t=e.chatRoom,n=e.isDirect,o=e.refetchChatRoom,i=e.otherParticipant,a=e.member;return n?(0,r.jsx)(H.N,{memberPublicId:(null==i?void 0:i.user_public_uid)||"",member:a,isFullPageProfile:!1,isRenderedOnRailBar:!0,shouldHideMessageButton:!0,shouldHideBadge:!0,shouldFixTabsOnTop:!0}):(0,r.jsx)(ee,{chatRoom:t,refetchChatRoom:o})},en=n(97485),er={page_name:q.$q.PROFILE_VIEW},eo=function(e){var t=e.chatRoom,n=e.chatRoomUuid,o=e.refetchChatRoom,i=t||{},a=i.chat_room_name,s=i.chat_room_kind,l=i.chat_room_description,u=i.current_participant,d=s===B.g8,f=(0,z.u)(n),p=f.chatParticipants,b=f.isLoading,h=f.totalCount,y=(p||[]).find(function(e){return e.id!==(null==u?void 0:u.id)}),g=ej().toggleShowRailBar,x=(0,Z.P$)({publicId:null==y?void 0:y.user_public_uid,params:er}).getProfileInfoQuery,j=x.data,w=x.isLoading,O=(0,v.T)(),S=O.ref,P=O.height;return(0,r.jsxs)(m.x,{isLoading:d&&w||b,loaderVariant:d?"rail-profile":"rail-member-list",children:[(0,r.jsx)("div",{ref:S,children:(0,r.jsx)(_.S0.Header,{className:"!min-h-[56px]",children:(0,r.jsx)(en.h,{title:d?(0,c.t)("profile"):a,memberCount:h,isDirect:d,description:l,onClose:g})})}),(0,r.jsx)(_.S0.Content,{noPadding:!0,heightGap:P,children:(0,r.jsx)(et,{chatRoom:t,isDirect:d,otherParticipant:y,member:void 0===j?{}:j,refetchChatRoom:o})})]})},ei=n(32002),ea=function(){var e=(0,p.L2)().data,t=ej(),n=t.shouldShowRailBar,o=t.dateRange,i=t.closeSpaceSummaryRailbar,a=t.firstUnreadMessageId;return e?(0,r.jsx)(ei.u,{isOpen:n,onClose:i,space:e,dateRange:o,type:"chat",shouldHideRailbarDragger:!1,firstUnreadMessageId:a}):null},es=n(38580),el=function(e){var t=e.description,n=e.shouldHideMembersCount,o=e.memberCount,i=void 0===o?0:o,a=e.onClose,s=void 0===a?l.noop:a,u=(0,d.BT)();return(0,d.kK)()?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"border-primary flex items-center justify-between border-b px-6 py-4",children:[(0,r.jsx)(y.h,{name:"16-arrow-left",onClick:s,ariaLabel:(0,c.t)("chat_space.details")}),(0,r.jsx)(j.Z.TitleSm,{as:"h2",weight:"semibold",children:(0,c.t)("chat_space.details")}),!n&&(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"text-default mr-2",children:(0,r.jsx)(j.Z.LabelSm,{weight:"medium",children:i})}),(0,r.jsx)(x.JO,{type:"20-members",size:20,className:"text-dark",useWithFillCurrentColor:!0})]})]}),t&&(0,r.jsx)("div",{className:"text-default mt-4 max-h-[200px] overflow-y-auto whitespace-pre-line px-6 py-4",children:(0,r.jsx)(j.Z.BodySm,{children:t})})]}):(0,r.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsx)(j.Z.TitleSm,{as:"h2",weight:"semibold",children:(0,c.t)("chat_space.details")}),u?(0,r.jsx)("button",{type:"submit",onClick:s,children:(0,r.jsx)(x.JO,{type:"close-v2",className:"text-dark mr-1 mt-2.5 cursor-pointer",useWithFillCurrentColor:!0})}):(0,r.jsx)(r.Fragment,{children:!n&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"text-dark mr-2",children:(0,r.jsx)(j.Z.LabelSm,{weight:"medium",children:i})}),(0,r.jsx)(x.JO,{type:"space-chat-members",className:"mt-1"})]})})]}),t&&(0,r.jsx)("div",{className:"text-dark max-h-[200px] overflow-y-auto whitespace-pre-line",children:(0,r.jsx)(j.Z.BodySm,{children:t})})]})},ec=function(e){var t=e.space,n=(0,z.u)(t.chat_room_uuid),o=n.chatParticipants,i=n.isLoading,a=n.refetchChatParticipants,s=n.hasNextPage,l=n.fetchNextPage,c=n.totalCount,u=ej().toggleShowRailBar,d=(0,v.T)(),f=d.ref,p=d.height;return(0,r.jsxs)(m.x,{isLoading:i,loaderVariant:"rail-member-list",children:[(0,r.jsx)(_.S0.Header,{className:"mb-4 border-none !p-0 sm:!px-6 md:mb-0 md:!py-4",children:(0,r.jsx)("div",{ref:f,className:"w-full",children:(0,r.jsx)(el,{shouldHideMembersCount:t.hide_members_count,memberCount:c,description:t.chat_room_description,onClose:u})})}),(0,r.jsx)(_.S0.Content,{heightGap:p,noPadding:!0,children:(0,r.jsx)(es.V,{spaceMembers:o,hasMoreSpaceMembers:s,space:t,refetchSpaceMembers:a,fetchNextPage:l})})]})},eu=n(96354),ed=n(24804);function ef(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function em(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ep(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ef(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ef(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var eb="PARTICIPANTS",eh="CHAT_THREADS",ev="CHAT_ROOM_MESSAGE_SEARCH",ey="CHAT_SPACE_SUMMARY",eg={chatRoom:null,closeThreadsRailbar:function(){},isCourseSpace:!1,isLiveStream:!1,isDrawer:!1,messageHighlightId:null,openThreadsRailbar:function(){},parentMessage:null,RailbarComponent:function(){return null},setMessageHighlightId:function(){},shouldShowRailBar:!1,toggleShowRailBar:function(){},type:eb,updateParentMessage:function(){},isChatSpace:!1,isDmsPage:!1,toggleChatRoomMessageSearchRailbar:function(){},isMessageSearchRailbarOpen:!1,EmbeddedRailbarComponent:function(){return null},shouldShowEmbeddedRailBar:!1,toggleShowEmbeddedRailBar:function(){},messageHashId:void 0,dateRange:a.n.LAST_7_DAYS,setDateRange:function(){},openSpaceSummaryRailbar:function(){},closeSpaceSummaryRailbar:function(){},firstUnreadMessageId:void 0},e_=(0,o.createContext)(eg);e_.displayName="RailbarContext";var ex=function(e){var t,n=e.isChatSpace,l=void 0!==n&&n,c=e.children,u=e.isLiveStream,f=e.isCourseSpace,m=e.isDrawer,p=(0,s.YQ)(),b=(0,eu.t)().message_id,h=ep((0,o.useState)(eg.type),2),v=h[0],y=h[1],g=ep((0,ed.k)(!1),3),_=g[0],x=g[1],j=g[2],w=ep((0,ed.k)(!1),3),O=w[0],S=w[1],P=w[2],C=ep((0,o.useState)(eg.parentMessage),2),I=C[0],k=C[1],N=ep((0,o.useState)(eg.chatRoom),2),A=N[0],E=N[1],T=ep((0,o.useState)(b),2),M=T[0],R=T[1],D=(0,i.TH)().pathname.startsWith("/messages"),L=(0,d.BT)(),B=v===ev,q=ep((0,o.useState)(a.n.LAST_7_DAYS),2),z=q[0],Z=q[1],H=ep((0,o.useState)(),2),V=H[0],Q=H[1];(0,o.useEffect)(function(){j(!L)},[L]);var W=(0,o.useCallback)(function(e,t){k(e),E(t),B&&b?P(!0):(P(!1),y(eh),j(!0))},[B,b]),G=(0,o.useCallback)(function(){k(null),E(null),y(eb),L&&j(!1)},[L]),$=(0,o.useCallback)(function(){y(v===ev?eb:ev),j(!0)},[v]),K=(0,o.useCallback)(function(){return l?ec:eo},[l]),J=(0,o.useCallback)(function(e,t){Z(e),Q(t),y(ey),j(!0)},[]),X=(0,o.useCallback)(function(){y(eb),L&&j(!1)},[L]),Y=(em(t={},eb,K()),em(t,eh,U.I),em(t,ev,F),em(t,ey,ea),t),ee=Y[v],et=Y[eh];return(0,r.jsx)(e_.Provider,{value:{chatRoom:A,closeThreadsRailbar:G,isCourseSpace:void 0!==f&&f,isLiveStream:void 0!==u&&u,isChatSpace:l,isDrawer:void 0!==m&&m,messageHighlightId:M,openThreadsRailbar:W,parentMessage:I,RailbarComponent:ee,EmbeddedRailbarComponent:et,setMessageHighlightId:R,shouldShowRailBar:_,toggleShowRailBar:x,type:v,updateParentMessage:function(e){k(e)},isDmsPage:D,toggleChatRoomMessageSearchRailbar:$,isMessageSearchRailbarOpen:B,shouldShowEmbeddedRailBar:O&&B,toggleShowEmbeddedRailBar:S,messageHashId:p,dateRange:z,setDateRange:Z,openSpaceSummaryRailbar:J,closeSpaceSummaryRailbar:X,firstUnreadMessageId:V},children:c})},ej=function(){return(0,o.useContext)(e_)}},36353:function(e,t,n){n.d(t,{Op:()=>s,kL:()=>i,nc:()=>a});var r=n(90047),o=n(39295),i=function(e){var t=e.event,n=e.scrollerId,o=(0,r.j)().isMobileView,i=document.getElementById(void 0===n?"message-scroll-view":n);if(!i)return{};var a="noScroll";switch(t){case"messageSent":a="scrollToBottom";break;case"messageReceived":var s=i.scrollTop-i.scrollHeight+i.offsetHeight,l=o()&&0===s,c=s>=-(.8*i.offsetHeight)||s>14;(l||c)&&(a="scrollToBottom");break;case"chatRoomLoad":a="scrollToUnreadMessageIndicator";break;case"paginatedMessageLoad":a="adjustTop";break;case"nextPaginatedMessageLoad":case"messageUpdated":case"messageDeleted":case"parentMessageUpdated":a="noScroll";break;case"reaction":i.scrollTop-i.scrollHeight+i.offsetHeight>=-80&&(a="scrollToBottom")}return{action:a,scrollTopValue:i.scrollTop,scrollHeightValue:i.scrollHeight}},a=function(e,t){return e&&t?"message-scroll-view-".concat(t):"message-scroll-view"},s=function(){var e=(0,o.q)(),t=e.chatRoomUuid,n=a(e.isMessaging,t);return{calculateScrollInfo:function(e){return i({event:e.event,scrollerId:n})},scrollerId:n,getScrollingElement:function(){return document.getElementById(n)}}}},48880:function(e,t,n){n.d(t,{K:()=>s});var r=n(96486),o=n(70442),i=n(96354),a=n(59413),s=function(){var e=(0,o.k6)(),t=(0,a.x)(),n=t.openThreadsRailbar,s=t.setMessageHighlightId,l=t.messageHighlightId,c=t.shouldShowEmbeddedRailBar,u=(0,i.t)().message_id;return{removeThreadIdUrlParam:function(){l&&(e.replace({search:"",hash:window.location.hash}),s(null))},openThreadsRailbarOnThreadsNotification:function(e){var t=e.messageHashId,o=e.chatRoomMessages,i=e.chatRoom;if(u){var a=o.find(function(e){return e.id===Number(t)});a&&(0,r.delay)(function(){s(Number(u)),n(a,i)},500*!c)}}}}},72202:function(e,t,n){n.d(t,{i:()=>a});var r=n(96486),o=n(41342),i=n(61853),a=function(e){var t=e.communityId,n=(0,o.wh)().currentCommunity,a=t||(null==n?void 0:n.id),s=(0,i.CD)().unreadChatRoomUuids;return(0,r.isNull)(a)?[]:s[a]||[]}},7355:function(e,t,n){n.d(t,{g:()=>f});var r=n(96486),o=n(88767),i=n(93199),a=n(13532),s=n(44428);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function u(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function d(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return l(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=function(e){var t=e.uuid,n=e.ids,l=e.enabled,f=e.shouldUpdateCache,m=void 0===f||f,p=(0,o.useQueryClient)(),b=function(e){p.setQueryData(["chat-participants",t],function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pages:[]},n=d((0,r.flatten)((t.pages||[]).map(function(e){return e.records}))).concat(d(e)),o=Math.ceil(n.length/s.U);return o>t.pages.length&&(t.pages=Array.from({length:o}).fill(t.pages[o]||t.pages[t.pages.length-1])),u(c({},t),{pages:t.pages.map(function(e,t){return u(c({},e||{}),{records:n.slice(s.U*t,s.U*(t+1))})})})})},h=(0,o.useQuery)(["chatroom","missing-participants",n],function(){return(0,i.UT)(a.av.chatRoomParticipants.index({uuid:t,params:{ids:n}}))},{enabled:l,select:function(e){return e.records},onSuccess:function(e){m&&b(e)},onError:function(e){console.error("err:",e)}}),v=h.isLoading,y=h.data;return{isLoading:v,participants:void 0===y?[]:y}}},42480:function(e,t,n){n.d(t,{K:()=>i});var r=n(88767),o=n(51630),i=function(e){return(0,r.useMutation)(function(e){return o.e5.acceptConnection(e)},e)}},16384:function(e,t,n){n.d(t,{s:()=>i});var r=n(88767),o=n(51630),i=function(e){return(0,r.useMutation)(o.e5.createConnection,e)}},67146:function(e,t,n){n.d(t,{k:()=>i});var r=n(88767),o=n(51630),i=function(e){return(0,r.useMutation)(function(e){return o.e5.ignoreConnection(e)},e)}},18580:function(e,t,n){n.d(t,{RN:()=>c,bD:()=>a,hE:()=>l,rF:()=>s});var r=n(88767),o=n(93199),i=n(13532),a=function(e){return"course-sections-".concat(e)},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.useQuery)(a(e),function(){return(0,o.UT)(i.av.courses.listSections({courseId:e}))},t)},l=function(e){return"lesson-".concat(e)},c=function(e){var t=e.courseId,n=e.lessonId,a=e.sectionId,s=e.options;return(0,r.useQuery)(l(n),function(){return(0,o.UT)(i.av.courses.getLesson({courseId:t,lessonId:n,sectionId:a}))},void 0===s?{}:s)}},90047:function(e,t,n){n.d(t,{j:()=>r});var r=function(){return{isMobileView:function(){return window.matchMedia("(max-width: 992px)").matches}}}},99385:function(e,t,n){n.d(t,{S:()=>c,m:()=>u});var r=n(96486),o=n(88767),i=n(93199),a=n(13532),s=n(61853),l=n(21368),c=function(e){return"embeddable-chat-room-".concat(e)},u=function(e){var t=(0,l.a)(s.yf).updateChatRoom,n=(0,s.Rv)(),u=(0,o.useQuery)({queryKey:c(e),queryFn:function(){return(0,i.UT)(a.av.chatRooms.show({uuid:e}))},enabled:!!e&&"new"!==e,refetchOnWindowFocus:!1,onSuccess:function(e){var n=e.chat_room;n&&t(n)}}),d=u.isLoading,f=u.refetch,m=u.data,p=(void 0===m?{}:m).chat_room;return{isLoading:d,chatRoom:p,refetchChatRoom:e?f:r.noop,onEventReceive:function(e){var r,o;if("chatRoomUpdated"===e.event){var i,a,s=e.chat_room;t((i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},s),a=a={pinned_message:s.pinned_message},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(a)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))}),i))}"updatedMessage"===e.event&&(null==n||null==(r=n.pinned_message)?void 0:r.id)===e.json_message.id&&t({uuid:null==p?void 0:p.uuid,pinned_message:e.json_message}),"deletedMessage"===e.event&&(null==n||null==(o=n.pinned_message)?void 0:o.id)===e.id&&t({uuid:null==p?void 0:p.uuid,pinned_message:null})}}}},84530:function(e,t,n){n.d(t,{j:()=>o});var r=n(41342),o=function(e){var t,n=(0,r.wh)().experimentation;return(null!=(t=null==n?void 0:n.experiments)?t:[]).some(function(t){return t.flag_name===e})}},32244:function(e,t,n){n.d(t,{f:()=>i});var r=n(85593),o=n(84530),i=function(){var e=(0,o.j)("professional_price_test"),t=(0,o.j)("business_price_test");return e||t||(0,r.np)()}},39964:function(e,t,n){n.d(t,{j:()=>s});var r=n(67294);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=/^\(\d+\)\s/,a=/| [a-z 0-9@_\-#.!]+ $/i,s=function(){var e,t=(e=(0,r.useState)(document.title.replace(i,"")),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,1)||function(e,t){if(e){if("string"==typeof e)return o(e,1);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e,1)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return{originalTitle:t,prependTitle:function(e){return document.title="".concat(e).concat(t)},resetTitleToOriginal:function(){return document.title=t},addDirectMessageParticipantNameInTitle:function(e){var n=document.title.match(i),r=t.replace(a,"".concat(e," "));n&&(r="".concat(n[0]).concat(r)),document.title=r}}}},2504:function(e,t,n){n.d(t,{t:()=>s});var r=n(84326),o=n(91525),i=n(72727),a=function(e){var t=e.notification;try{return t.notification_text_structure.map(function(e){return t[e]||""}).join(" ")}catch(e){return""}},s=function(){var e=(0,o.wh)().currentCommunity,t=(0,i.L)().electronAPI,n=(null==e?void 0:e.icon_url)||"https://assets-v3.circle.so/qv2902nizkth5o752l2cugc6y09e";return{sendNotificationToDesktopApp:function(o){var i=o.title,s=o.body,l=o.metadata,c=o.type;if(null==t?void 0:t.sendNotification){if("notification"===c&&!l)return;t.sendNotification({title:i||(0,r.t)("desktop_app.notifications.new_notification_generic_title"),body:s||a(l||{}),icon:n,metadata:l,currentCommunityData:{id:null==e?void 0:e.id,name:null==e?void 0:e.name,slug:null==e?void 0:e.slug,root_url:null==e?void 0:e.root_url,full_url:null==e?void 0:e.full_url},type:c})}},setDesktopAppNotificationCount:function(n){(null==t?void 0:t.setNotificationCount)&&t.setNotificationCount(n,null==e?void 0:e.id)},setDesktopAppUnreadMessageCount:function(n){(null==t?void 0:t.setUnreadMessageCount)&&t.setUnreadMessageCount(n,null==e?void 0:e.id)}}}},84579:function(e,t,n){n.d(t,{I:()=>i});var r=n(63271),o=n(2504),i=function(e,t){var n=(0,o.t)().sendNotificationToDesktopApp;(0,r.s)({channel:"NotificationChannel",onMessageReceive:function(e){n({type:"notification",metadata:null==e?void 0:e.data}),t(e)},community_member_id:e,canCreateConnection:!!e},[e])}},65631:function(e,t,n){n.d(t,{K:()=>l});var r=n(88767),o=n(93199),i=n(13532),a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,o.UT)(i.av.supportedCurrencies.index(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e?{include_traded:!0}:{})))},s={includeTraded:!1},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=e.includeTraded,n=void 0!==t&&t;return(0,r.useQuery)(["paywalls-currencies",n],function(){return a(n)})}},23583:function(e,t,n){n.d(t,{P:()=>b,N:()=>p});var r=n(67294),o=n(96486),i=n(88767),a=n(93199),s=n(14218),l=n(41342),c=n(60589),u=n(95533),d=function(e){var t=e.lastPage,n=e.isCalendarView,o=e.fetchNextPage;(0,r.useEffect)(function(){n&&(null==t?void 0:t.has_next_page)&&(null==t?void 0:t.page)<11&&o()},[t,n,o])};function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{per_page:12},t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop,p=(0,i.useQueryClient)(),b=(0,s.d)(),h=b.removeRecord,v=b.findAndReplaceRecord,y=(0,l.L2)().data,g=Object.fromEntries(Object.entries(e).filter(function(e){return void 0!==(function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return f(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[1]})),_=["posts",null==y?void 0:y.id,g],x=(null==g?void 0:g.used_on)==="calendar",j=(0,i.useInfiniteQuery)(_,function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,a.UT)(u.a.posts.index({spaceId:null==y?void 0:y.id,params:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({page:t},g)}))},{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},keepPreviousData:x,enabled:t&&!!(null==y?void 0:y.id)&&(0,c.BT)(y),onSuccess:n}),w=j.data,O=j.hasNextPage,S=j.isLoading,P=j.refetch,C=j.fetchNextPage,I=(0,r.useCallback)(function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.refetch,o=void 0===r||r;return(t=function(){var t,n;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:if(t=e,!o)return[3,6];r.label=1;case 1:return r.trys.push([1,3,4,5]),n=u.a.posts.show({spaceId:e.space_id,postSlug:e.slug}),[4,p.fetchQuery(n)];case 2:return t=r.sent(),[3,5];case 3:return console.error(r.sent()),[3,5];case 4:return v(t,_),[7];case 5:return[3,7];case 6:v(t,_),r.label=7;case 7:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){m(i,r,o,a,s,"next",e)}function s(e){m(i,r,o,a,s,"throw",e)}a(void 0)})})()},[v,_]),k=(0,r.useCallback)(function(e){h(e,_)},[h]),N=[];return!S&&w&&(N=(0,o.uniqBy)((0,o.flatten)(w.pages.map(function(e){return e.records})),"id")),d({lastPage:null==w?void 0:w.pages[(null==w?void 0:w.pages.length)-1],isCalendarView:x,fetchNextPage:C}),{mapPages:function(e){return S||!w?[]:w.pages.map(e)},hasNextPage:O,refetch:P,isLoading:S,fetchNextPage:C,posts:N,onPostChange:I,onPostDestroy:k}},b=function(e){return p({only_pinned:!0,per_page:e||50,used_on:"pinned_post_sidebar"})}},1892:function(e,t,n){n.d(t,{j:()=>c,t:()=>u});var r=n(88767),o=n(93199),i=n(13532);function a(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function l(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var c="post-show",u=function(e){var t=e.spaceId,n=e.postSlug,u=e.spaceSlug,d=void 0===u?"":u,f=e.queryOptions,m=e.context,p=e.disabled,b=[c,n,t||d,void 0===m?"default":m],h=i.av.posts.show({spaceId:t,spaceSlug:d,postSlug:n}),v=(0,r.useQuery)(b,function(){return(0,o.UT)(h)},l(s({enabled:!(void 0!==p&&p)&&!!((t||d)&&n),staleTime:0},void 0===f?{}:f),{retry:function(e,t){return(null==t?void 0:t.status)!==404}})),y=(0,r.useQueryClient)();return l(s({},v),{post:v.data,onPostChange:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.refetch,o=void 0===r||r;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){return o?[2,v.refetch()]:[2,y.setQueryData(b,function(){return e})]})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)})})()}})}},86307:function(e,t,n){n.d(t,{Z:()=>a});var r=n(88767),o=n(93199),i=n(13532),a=function(e){var t=e.post,n=["post-summary",t.id],a=(0,r.useQueryClient)(),s=(0,r.useQuery)(n,function(){return(0,o.UT)(i.av.posts.summary({postId:String(t.id)}))},{enabled:!1,staleTime:6e5,retry:function(e,t){return(null==t?void 0:t.status)!==404}}),l=s.data,c=s.isLoading,u=s.refetch,d=function(){c&&a.cancelQueries(n),a.resetQueries({queryKey:n,exact:!0})};return{summary:l,isLoadingSummary:c,refetchSummary:u,clearSummary:d,toggleSummary:function(){l||c?d():u()}}}},77201:function(e,t,n){n.d(t,{F:()=>c});var r=n(67294),o=n(96486),i=n(88767),a=n(93199),s=n(13532);function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var c=function(e){var t,n,c=e.memberPublicId,u=e.params,d=void 0===u?{per_page:10}:u,f=(0,i.useInfiniteQuery)(["profile-comments",c],function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,a.UT)(s.av.profile.comments({memberPublicId:c,params:l({page:t},d)}))},{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),m=(0,r.useMemo)(function(){return f.isLoading?[]:(0,o.uniqBy)((0,o.flatten)(f.data.pages.map(function(e){return e.records})),"id")},[f.data]);return t=l({},f),n=n={comments:m},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},8054:function(e,t,n){n.d(t,{FC:()=>m,P$:()=>f,Wx:()=>d});var r=n(88767),o=n(84326),i=n(41342),a=n(810),s=n(93199),l=n(13532),c=n(60878);function u(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var d="PROFILE_INFO",f=function(e){var t=e.publicId,n=e.params,f=void 0===n?{}:n,m=e.type,p=(0,c.pm)(),b=(0,r.useQueryClient)(),h=(0,i.wh)().refetch,v=[d,t,f],y=function(){return(0,s.UT)(l.av.profile.show({memberPublicId:t,params:f}))},g=(0,r.useQuery)(v,(0,a.B)({type:void 0===m?"CommunityMember":m})?y:function(){return(0,s.UT)(l.av.profile.leadShow({leadPublicId:t,params:f}))},{retry:!1,enabled:!!t}),_=(0,r.useMutation)(function(e){return(0,s.aU)(l.av.profile.update({memberPublicId:t}),e)},{onSuccess:function(){var e;return(e=function(){var e,t,n,r,i,a;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(s){switch(s.label){case 0:return r=null==(n=null==g?void 0:g.data)?void 0:n.locale,p.success((0,o.t)("profile_saved_successfully")),[4,h()];case 1:return s.sent(),[4,b.invalidateQueries(d)];case 2:return s.sent(),[4,b.fetchQuery(v,y)];case 3:return a=null==(i=s.sent())?void 0:i.locale,null==(t=window.webview)||null==(e=t.onProfileInfoSaved)||e.call(t),r!==a&&window.location.reload(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)})})()},onError:function(e){p.error(e.message)}});return{getProfileInfoQuery:g,updateProfileInfoMutation:_}},m=function(e){var t=e.publicId;return(0,r.useMutation)(function(e){return(0,s.aU)(l.av.profile.update({memberPublicId:t}),e)})}},59834:function(e,t,n){n.d(t,{O:()=>c});var r=n(67294),o=n(96533),i=n(82859),a=n(59459),s=n(15731),l=n(90926),c=function(e){var t,n,c=e.name,u=e.params,d=void 0===u?{}:u,f=e.public_uid,m=(0,o.r)().show,p=(0,s.I)(),b=(0,l.xX)().isDrawer,h=(0,r.useCallback)(function(e){(0,i.n2)(e)||p||b||(e.preventDefault(),m({memberPublicId:f,params:d}))},[p,b,f,d,m]);return t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},(0,a.H)({name:c,params:d,publicUid:f,shouldOpenInNewTab:p,showMemberProfileDrawer:m})),n=n={onClick:h},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},62025:function(e,t,n){n.d(t,{t:()=>d});var r=n(67294),o=n(96486),i=n(88767),a=n(93199),s=n(13532),l=n(14218);function c(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var d=function(e){var t,n,d=e.memberPublicId,f=e.params,m=void 0===f?{per_page:10}:f,p=e.enabled,b=e.onSuccess,h=void 0===b?o.noop:b,v=["profile-posts",d],y=(0,l.d)().findAndReplaceRecord,g=(0,i.useQueryClient)(),_=(0,i.useInfiniteQuery)(v,function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,a.UT)(s.av.profile.posts({memberPublicId:d,params:u({page:t},m)}))},{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0},enabled:void 0===p||p,onSuccess:function(e){(0,o.isFunction)(h)&&h(e)}}),x=(0,r.useMemo)(function(){var e,t;return _.isLoading?[]:(0,o.uniqBy)((0,o.flatten)(null!=(t=null==(e=_.data)?void 0:e.pages.map(function(e){return e.records}))?t:[]),"id")},[_.data,_.isLoading]);return t=u({},_),n=n={onPostChange:function(e){var t;return(t=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return[4,g.fetchQuery(s.av.posts.show({spaceId:e.space_id,postSlug:e.slug}))];case 1:return[2,y(t.sent(),v)]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)})})()},posts:x},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},88159:function(e,t,n){n.d(t,{u:()=>c});var r=n(67294),o=n(96486),i=n(88767),a=n(93199),s=n(13532);function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var c=function(e){var t,n,c=e.memberPublicId,u=e.params,d=void 0===u?{per_page:12}:u,f=(0,i.useInfiniteQuery)(["PROFILE_SPACES",c,d],function(e){var t,n=e.pageParam;return t=void 0===n?1:n,(0,a.UT)(s.av.profile.spaces({memberPublicId:c,params:l({page:t},d)}))},{getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}}),m=(0,r.useMemo)(function(){return f.isLoading?[]:(0,o.uniqBy)((0,o.flatten)(f.data.pages.map(function(e){return e.spaces})),"id")},[f.data]);return t=l({},f),n=n={spaces:m},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t}},14598:function(e,t,n){n.d(t,{H:()=>b});var r=n(67294),o=n(70442),i=n(84326),a=new(n(69453)).Z({minLength:8,alphabet:"vRx5keXBhG3b0Z1nJgPiNMqsItjLuE2dOWz9DQCmScylaUfKFV7HA4pw6o8YTr"}),s=n(41342),l=n(93199),c=n(52770),u=n(78456),d=n(81261),f=n(13532),m=function(){var e=(0,o.TH)(),t=(0,o.k6)();return function(n){var r=n.sqid;t.push((0,f.Zm)({sqid:r,previousLocation:e}).index)}},p={page_name:d.$q.PROFILE_VIEW},b=function(){var e=(0,o.TH)(),t=(0,o.k6)(),n=(0,s.wh)().currentCommunityMember,d=(0,u.vb)(n),b=m(),h=(0,r.useCallback)(function(){t.push(f.du.profile(e))},[t,e]),v=(0,r.useCallback)(function(e){b({sqid:a.encode([e])})},[b]),y=(0,r.useCallback)(function(e){return(0,l.UT)(f.av.profile.show({memberPublicId:e,params:p})).then(function(e){return(null==e?void 0:e.sqid)?b({sqid:e.sqid}):(null==e?void 0:e.id)?v(e.id):void console.error((0,i.t)("show_member_profile_has_no_sqid_or_id"),{profileData:e})}).catch(function(e){console.error((0,i.t)("show_member_profile_fetch_error"),{error:e})})},[b,v]);return{showOwnProfileEdit:h,showMemberProfileEdit:(0,r.useCallback)(function(e){var t=e.member;if(!d)return void console.error((0,i.t)("show_member_profile_no_admin"),{currentCommunityMember:n});if(!t)return void console.error((0,i.t)("show_member_profile_no_member"));if(t.sqid)return b({sqid:t.sqid});if(t.id){var r="Missing sqid for audience edit navigation ".concat(t.public_uid," ").concat(t.id," generating sqid");return(0,c.d)(r),console.warn(r),v(t.id)}if(t.public_uid){var o="Missing id or sqid for audience edit navigation ".concat(t.public_uid," ").concat(t.id," fetching the profile data and navigating");(0,c.d)(o),console.warn(o),y(t.public_uid);return}console.error((0,i.t)("show_member_profile_fallback_error"),{member:t})},[d,n,b,v,y])}}},14218:function(e,t,n){n.d(t,{d:()=>s});var r=n(67294),o=n(88767);function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}var s=function(){var e=(0,o.useQueryClient)();return{findAndReplaceRecord:(0,r.useCallback)(function(t,n){if(!n)throw Error("queryKey is required");return e.setQueryData(n,function(e){return{pages:e.pages.map(function(e){return a(i({},e),{records:e.records.map(function(e){return e.id===t.id?t:e})})}),pageParams:e.pageParams}})},[e]),removeRecord:(0,r.useCallback)(function(t,n){if(!n)throw Error("queryKey is required");return e.setQueryData(n,function(e){return{pages:e.pages.map(function(e){return a(i({},e),{records:e.records.filter(function(e){return e.id!==t})})}),pageParams:e.pageParams}})},[e]),updateAllRecords:(0,r.useCallback)(function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;if(!n)throw Error("queryKey is required");e.setQueryData(n,function(e){return a(i({},e),{pages:e.pages.map(function(e,n){return a(i({},e||{}),{records:t.slice(r*n,r*(Number(n)+1))})})})})},[e])}}},83780:function(e,t,n){n.d(t,{m:()=>s});var r=n(88767),o=n(93199);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}var s=function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,c=Array.isArray(s)?s:[s||e],u=(0,r.useInfiniteQuery)(c,function(t){var n,r=t.pageParam;return n=void 0===r?1:r,(0,o.UT)(l(e,{page:n}))},a({getNextPageParam:function(e){return e.has_next_page?e.page+1:void 0}},i));return t=a({},u),n=n={mapPages:function(e){var t=u.isLoading,n=u.data;return t||!n?[]:n.pages.map(e)}},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t},l=function(e,t){var n=new URL(window.location.origin+e),r=!0,o=!1,a=void 0;try{for(var s,l=Object.entries(t)[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c,u=(c=s.value,function(e){if(Array.isArray(e))return e}(c)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(c,2)||function(e,t){if(e){if("string"==typeof e)return i(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(c,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),d=u[0],f=u[1];n.searchParams.set(d,String(f))}}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n.pathname+n.search}},57335:function(e,t,n){function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(i=function(){return!!e})()}n.d(t,{Z:()=>a});var a=new(function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function t(){var e,n,o,a,s,l;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");return n=r(n=t),a=e=function(e,t){var n;if(t&&("object"==((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)||"function"==typeof t))return t;if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,i()?Reflect.construct(n,[],r(this).constructor):n.apply(this,o)),s="emitSubscriptionStateChange",l=function(t){"Chats::RoomChannel"===t.channel?e.emit("chatRoomSubscriptionStateChange",t):e.emit("subscriptionStateChange",t)},s in a?Object.defineProperty(a,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[s]=l,e}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e),t}(n(17187).EventEmitter))},33382:function(e,t,n){n.d(t,{H:()=>o});var r=n(67294),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,r.useEffect)(function(){if(e){var t=e.split(" ");return t.forEach(function(e){document.body.classList.add(e)}),function(){t.forEach(function(e){document.body.classList.remove(e)})}}},[e])}},64743:function(e,t,n){n.d(t,{U:()=>o});var r=n(3697),o=function(){return{isMessagingModalOpen:!!document.getElementById(r.vl)}}},52950:function(e,t,n){n.d(t,{k:()=>o});var r=n(67294),o=function(e){return(0,r.useCallback)(function(t){("Enter"===t.key||" "===t.key)&&(t.preventDefault(),e(t))},[e])}},5521:function(e,t,n){n.d(t,{k:()=>i});var r=n(67294);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,r.useRef)(null);return(0,r.useEffect)(function(){var e;t.current&&(null==(e=t.current)||e.focus())},[t,t.current].concat(function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),t}},51896:function(e,t,n){n.d(t,{$4:()=>a,aH:()=>l,su:()=>s});var r=n(88767),o=n(93199),i=n(13532),a="email-hub-status",s=function(e){return!!e&&"limits"in e},l=function(e){var t,n;return(0,r.useQuery)((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},e),n=n={queryKey:a,queryFn:function(){return(0,o.UT)(i.av.emailHubStatus.show())},staleTime:6e5,notifyOnChangeProps:"tracked"},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}},89424:function(e,t,n){n.d(t,{$:()=>a});var r=n(67294),o=n(55637);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e){var t,n=(t=(0,r.useState)("unset"),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return i(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=n[0],s=n[1],l=(0,o.Y)(e);(0,r.useEffect)(function(){return l&&(s(l.style.display||"unset"),l.style.display="none"),function(){l&&(l.style.display=a)}},[l])}},32589:function(e,t,n){n.d(t,{V:()=>o});var r=n(41342);function o(){var e=(0,r.wh)(),t=e.currentCommunity,n=e.currentCommunityMember;return!!(!(null==n?void 0:n.is_admin)&&(null==t?void 0:t.hide_emails_on_member_profiles))}},89131:function(e,t,n){n.d(t,{t:()=>o});var r=n(89424),o=function(){(0,r.$)("#beacon-container")}},13847:function(e,t,n){n.d(t,{$2:()=>a,m3:()=>s,ov:()=>o,rV:()=>i});var r=n(41342);function o(){var e=(0,r.wh)().currentCommunity;return!!(null==e?void 0:e.activity_score_ui_enabled)}function i(){var e=(0,r.wh)(),t=e.currentCommunitySettings,n=e.currentCommunityMember,i=null==n?void 0:n.is_admin,a=o(),s=null==t?void 0:t.upgrade_flows_for_activity_scores_enabled;return!!(i&&(a||s))}function a(){var e=(0,r.wh)().currentCommunity;return!!(null==e?void 0:e.community_ai_feature_flag_enabled)}function s(){var e=(0,r.wh)(),t=e.currentCommunitySettings,n=e.currentCommunityMember,i=null==n?void 0:n.is_admin,s=null==t?void 0:t.upgrade_flows_for_activity_scores_enabled,l=!a(),c=!o();return i&&s&&(l||c)}},19323:function(e,t,n){n.d(t,{y:()=>o});var r=n(41342),o=function(){var e=(0,r.wh)().currentCommunitySettings;return!!((null==e?void 0:e.connect_core_enabled)&&(null==e?void 0:e.connect_enabled))}},43832:function(e,t,n){n.d(t,{E:()=>i,g:()=>o});var r=n(51896),o=function(){var e=(0,r.aH)().data;return!!(null==e?void 0:e.enabled)},i=function(){return(0,r.aH)().isLoading}},32701:function(e,t,n){n.d(t,{B5:()=>l,L7:()=>c,gq:()=>u,wO:()=>s,z1:()=>a});var r=n(35471),o=n(41342),i=n(78456),a=function(){var e=(0,o.wh)().currentCommunityMember;return!!(null==e?void 0:e.messaging_enabled)},s=function(){var e=(0,o.Cc)().record.group_messaging_enabled,t=(0,o.wh)().currentCommunityMember||{},n=t.messaging_enabled,r=t.messaging_enabled_by_admin,i=t.messaging_enabled_by_member;return e&&void 0!==n&&n&&void 0!==r&&r&&void 0!==i&&i},l=function(){return!0},c=function(){var e,t=(0,o.wh)(),n=t.currentCommunitySettings,r=t.currentCommunityMember,a=(0,i.vb)(r),s=!!(null==n||null==(e=n.messaging_settings)?void 0:e.member_to_member_messaging_enabled);return a||s},u=function(){var e,t=(0,o.wh)().currentCommunityMember,n=(0,r.D)(),i=!!(a()||(null==t||null==(e=t.policies)?void 0:e.can_access_direct_messages));return{shouldShowMessagingRoutes:!!(n||i),showMessagesTab:i}}},504:function(e,t,n){n.d(t,{f:()=>i});var r=n(76012),o=n(85924),i=function(){var e=(0,o.wC)().masquerade_referrer_url,t=(0,r.Vu)().isBannerVisible;return!!e||t}},61217:function(e,t,n){n.d(t,{k:()=>a});var r=n(67294),o=n(63271);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e){var t,n,a=e.enabled,s=e.signedId,l=e.mediaTranscoding,c=e.onSuccess,u=e.onError,d=(t=(0,r.useState)(null!=(n=null==l?void 0:l.status)?n:"pending"),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return i(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=d[0],m=d[1];return(0,o.s)({canCreateConnection:(void 0===a||a)&&!!s&&("pending"===f||"started"===f),channel:"MediaTranscodingChannel",blob_signed_id:s,onMessageReceive:function(e){"transcodingStatusUpdated"===e.event&&(m(e.json_message.status),"succeeded"===e.json_message.status?null==c||c(e.json_message.hls_url):"failed"===e.json_message.status&&(null==u||u()))}}),{status:f}}},30133:function(e,t,n){n.d(t,{v:()=>i});var r=n(41342),o=n(17617),i=function(){var e=(0,r.wh)().currentCommunitySettings,t=(0,o.Be)(),n=(0,o.a7)();return{isMobileWebNewSpaceCustomizationUIEnabled:!!(null==e?void 0:e.mobile_web_new_space_customization_ui_enabled)&&!t&&!n}}},13248:function(e,t,n){n.d(t,{k:()=>i});var r=n(88767),o=n(13532),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.useQuery)(o.av.planFeatureFlags.show(),e)}},24869:function(e,t,n){n.d(t,{E:()=>u});var r=n(29378),o=n(6082),i=n(41342),a=n(3189),s=function(){var e,t=(0,a.D)().currentPlan;return!!(null==t||null==(e=t.api_billing)?void 0:e.is_admin_api_subscription_active)},l=function(){var e,t=(0,a.D)().currentPlan;return!!(null==t||null==(e=t.api_billing)?void 0:e.is_headless_api_subscription_active)},c=n(43832),u=function(){var e,t,n,a,u,d,f=(0,i.wh)().currentCommunity,m=null!=f?f:{},p=m.is_on_trial,b=m.default_currency,h=m.is_expired_trial,v=void 0!==h&&h,y=m.can_choose_currency,g=m.current_plan_tier,_=m.current_plan_interval,x=m.has_addons,j=void 0!==x&&x,w=m.has_active_offer,O=m.current_plan,S=m.subscription,P=null!=S?S:{},C=P.current_period_end,I=P.current_period_start,k=(0,c.g)(),N=s(),A=l(),E=!!p,T=(0,o.gR)(g),M=(0,o.kw)(g),R=(0,o.BD)(g),D=(0,o.Dr)(g),L=(0,o.cY)(g),F=(0,r.Aq)(f),U="incomplete_expired"===(null==f||null==(e=f.subscription)?void 0:e.status),B="incomplete"===(null==f||null==(t=f.subscription)?void 0:t.status),q=!!((null==f||null==(n=f.subscription)?void 0:n.is_cancelled)&&!(null==f||null==(a=f.subscription)?void 0:a.on_grace_period)),z=!!(null==f||null==(u=f.subscription)?void 0:u.on_grace_period),Z=!!(null==f||null==(d=f.subscription)?void 0:d.has_incomplete_payment),H=!!(!E&&!v&&(null==f?void 0:f.subscription)&&!U&&!q);return{isCommunityOnTrial:E,isCommunityOnEnterprise:M,isCommunityOnProfessional:R,isCommunityOnBasic:D,isCommunityOnPlus:T,isCommunityOnBusiness:L,isCommunityOnPaidPlan:H,currentPlanTier:g,currentPlanInterval:_,currentPeriodEnd:C,currentPeriodStart:I,hasActiveOffer:void 0!==w&&w,defaultCurrency:void 0===b?null:b,canChooseCurrency:void 0!==y&&y,isExpiredTrial:v,shouldShowProration:function(e){return!k&&!N&&!A&&!!e&&!E&&!v&&(!!(_!=e.interval||(0,o.pE)(_)&&(0,o.pE)(e.interval))||j)},isCommunitySubscriptionIncompleteExpired:U,isCommunitySubscriptionIncomplete:B,isCommunitySubscriptionFullyCancelled:q,isCommunitySubscriptionOnGracePeriod:z,hasCommunityIncompletePayment:Z,isPromoCodeEnabledForCommunity:F,changePlanModalParams:function(e){var t=g&&(0,o.sR)(g,e);return E?(null==O?void 0:O.public)?t?{planTier:e}:{planTier:g}:t?{planTier:e}:{planId:null==O?void 0:O.id}:{planTier:e}},currentPlan:O}}},86670:function(e,t,n){n.d(t,{J:()=>i});var r=n(67294);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(e,t){var n,i=(n=(0,r.useReducer)(e,t),function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(n,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1],l=(0,r.useRef)(function(){return a});(0,r.useEffect)(function(){l.current=function(){return a}},[a]);var c=(0,r.useCallback)(function(e){"function"==typeof e?e(c,l.current):s(e)},[]);return[a,c]}},56664:function(e,t,n){n.d(t,{$:()=>u});var r=n(88767),o=n(70442),i=n(84326),a=n(93199),s=n(13532),l=n(60878),c=n(94375),u=function(){var e=(0,l.pm)(),t=e.success,n=e.error,u=(0,o.k6)(),d=(0,r.useMutation)(function(e){var t;return t=Number(e),(0,a.Cu)(s.av.scheduleDowngrades.create(t),{})},{onSuccess:function(){u.push(c.OS.SCHEDULED_DOWNGRADE_SUCCESS),t((0,i.t)("pricing_plans.subscription_updated"))},onError:function(){n((0,i.t)("pricing_plans.errors.schedule_downgrade_error"))}}),f=d.mutate,m=d.isLoading,p=(0,r.useMutation)(function(){return(0,a.Cu)(s.av.scheduleDowngrades.cancel(),{})},{onSuccess:function(){t((0,i.t)("pricing_plans.downgrade_schedule_cancelation.success"))},onError:function(){n((0,i.t)("pricing_plans.downgrade_schedule_cancelation.error"))}});return{scheduleDowngrade:f,isSchedulingDowngrade:m,cancelScheduledDowngrade:p.mutate,isCancelingDowngrade:p.isLoading}}},26801:function(e,t,n){n.d(t,{L:()=>l,d:()=>c});var r=n(88767),o=n(41342),i=n(18059),a=n(93199),s=n(13532),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,i.Wj)(),n=(0,r.useQuery)(["space-sidebar-notifications",e],function(){return(0,a.UT)(s.av.sidebarNotifications.index({space_ids:e}))},{enabled:!1,onSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];1===e.length?t({type:"UPDATE_SPACE_NOTIFICATIONS",payload:{space:e[0]}}):t({type:"SET_SPACE_NOTIFICATIONS",payload:{spaces:e||[]}})},onError:function(e){console.error("Something went wrong",e)}}),o=n.isLoading;return{refetchSpaceNotifications:n.refetch,isLoading:o}},c=function(e){var t=(0,o.nT)(),n=l([e]).refetchSpaceNotifications;return{resetUnreadCount:(0,r.useMutation)(function(){return(0,a.Cu)(s.av.spaces.resetUnreadCount({spaceId:e}),{forReactQuery:!0})},{onSuccess:function(e){t.actions.updateSpace(e),n()},onError:function(e){console.error("Error while resetting the unread count",e)}}).mutateAsync}}},55637:function(e,t,n){n.d(t,{Y:()=>s});var r=n(67294),o=n(17279);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}var s=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,s=(t=(0,r.useState)(null),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(t,2)||function(e,t){if(e){if("string"==typeof e)return i(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=s[0],c=s[1];return(0,r.useEffect)(function(){var t;(t=function(){var t;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:return[4,(0,o.g)(e,{timeout:n})];case 1:var i,a;return i=t=r.sent(),(null!=(a=HTMLElement)&&"undefined"!=typeof Symbol&&a[Symbol.hasInstance]?!!a[Symbol.hasInstance](i):i instanceof a)&&c(t),[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)})})()},[e,n]),l}},63271:function(e,t,n){n.d(t,{s:()=>p});var r=n(67294),o=n(96486),i=n(57335),a=(0,n(70256).tx)();function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=new Map,u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.channel,r=l(e,["channel"]);if(n&&t){c.has(n)||c.set(n,[]);var u=c.get(n),d=u.find(function(e){var t=e.params;return(0,o.isEqual)(r,t)});return d?d.callbacks.push(t):(d={subscription:a.subscribeTo(n,r),params:r,callbacks:[t]},u.push(d),d.subscription.on("message",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];d.callbacks.forEach(function(e){return e.apply(void 0,function(e){if(Array.isArray(e))return s(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return s(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())})}),d.subscription.on("connect",function(){i.Z.emitSubscriptionStateChange({channel:n,subscriptionState:"connected"})}),d.subscription.on("disconnect",function(){i.Z.emitSubscriptionStateChange({channel:n,subscriptionState:"disconnected"})})),d}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.channel,r=l(e,["channel"]);if(n&&t){var i=c.get(n);if(i){var a=i.find(function(e){var t=e.params;return(0,o.isEqual)(r,t)});a&&(a.callbacks=a.callbacks.filter(function(e){return e!==t}),a.callbacks.length||(a.subscription.disconnect(),c.set(n,i.filter(function(e){var t=e.params;return!(0,o.isEqual)(r,t)}))))}}};function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){f(e,t,n[t])})}return e}var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.channel,o=e.onMessageReceive,i=e.canCreateConnection,a=void 0===i||i,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["channel","onMessageReceive","canCreateConnection"]),l=(0,r.useRef)(o),c=(0,r.useRef)({});return(0,r.useEffect)(function(){l.current=o},[n,o]),(0,r.useEffect)(function(){if(a){var e,t,r=u(m({channel:n},s),l.current);return r&&(e=m({},c.current),t=null!=(t=f({},n,r))?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),c.current=e),function(){d(m({channel:n},s),l.current),c.current[n]=null}}},[n,a,s,t]),c.current[n]}},4870:function(e,t,n){n.d(t,{m:()=>r});var r=function(e,t){var n={};return Object.keys(t).forEach(function(t){n["".concat(e,"--").concat(t)]=t}),{modifiers:n}}},24804:function(e,t,n){n.d(t,{k:()=>i});var r=n(67294);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=(e=(0,r.useState)(t),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],a=n[1];return[i,(0,r.useCallback)(function(){return a(function(e){return!e})},[a]),a]}},48298:function(e,t,n){n.d(t,{c:()=>i});var r=n(67294);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(e,t){var n,i=(n=(0,r.useState)(e),function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(n,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1];return(0,r.useEffect)(function(){var n=setTimeout(function(){s(e)},t);return function(){clearTimeout(n)}},[e,t]),a}},72727:function(e,t,n){n.d(t,{L:()=>u,Z:()=>c});var r=n(67294),o=n(41609),i=n.n(o);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var c=function(e,t){var n=l(e.split(".").map(Number),3),r=n[0],o=n[1],i=n[2],a=l(t.split(".").map(Number),3),s=a[0],c=a[1],u=a[2];return r>s||r===s&&(o>c||o===c&&i>=u)},u=function(){var e=l((0,r.useState)(null),2),t=e[0],n=e[1],o=l((0,r.useState)(!1),2),a=o[0],c=o[1],u=l((0,r.useState)(!0),2),d=u[0],f=u[1],m=l((0,r.useState)(null),2),p=m[0],b=m[1];(0,r.useEffect)(function(){var e=!0,t=null,r=function(o){if(e){var a,s=null==(a=window)?void 0:a.electronAPI;if(!i()(s)){console.warn("Electron API found by hook"),n(s),c(!0),f(!1),b(null);return}o>0?t=setTimeout(function(){return r(o-1)},500):(b("Electron API not available."),f(!1))}};return r(3),function(){e=!1,t&&clearTimeout(t)}},[]);var h=(0,r.useMemo)(function(){return(null==t?void 0:t.runningOn)==="darwin"},[t]);return{electronAPI:t,isLoading:d,error:p,isElectron:a,navigateToUrl:function(e){var n;return(n=function(){var n;return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){var c=[s,l];if(n)throw TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}}(this,function(r){return t?(n="".concat(window.location.origin).concat(e),[2,t.openUrl(n,[])]):[2,!1]})},function(){var e=this,t=arguments;return new Promise(function(r,o){var i=n.apply(e,t);function a(e){s(i,r,o,a,l,"next",e)}function l(e){s(i,r,o,a,l,"throw",e)}a(void 0)})})()},electronVersion:null==t?void 0:t.version,platform:null==t?void 0:t.runningOn,isMacOS:h}}},33516:function(e,t,n){n.d(t,{T:()=>i});var r=n(67294);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e,t=(e=(0,r.useState)(void 0),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),n=t[0],i=t[1];return{ref:(0,r.useCallback)(function(e){e&&i(e.clientHeight)},[]),height:n}}},94556:function(e,t,n){n.d(t,{A:()=>i});var r=n(67294);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e,t=(0,r.useRef)(null),n=(e=(0,r.useState)(!0),function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,s=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),i.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(s)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],a=n[1];return(0,r.useEffect)(function(){var e=new IntersectionObserver(function(e){a(null==e?void 0:e[0].isIntersecting)});return t.current&&e.observe(t.current),function(){e.disconnect()}},[]),[t,i]}},75730:function(e,t,n){n.d(t,{t:()=>i});var r=n(67294),o=n(96486),i=function(e){var t=e.onArrowDown,n=e.onArrowUp,i=e.onEnter,a=e.onEscape,s=e.enabled,l=void 0===s||s,c=e.elementRef,u=void 0===c?null:c;(0,r.useEffect)(function(){var e=(null==u?void 0:u.current)||document,r={ArrowDown:t,ArrowUp:n,Enter:i,Escape:a},s=function(e){if("key"in e){var t=r[e.key];(0,o.isFunction)(t)&&t(e)}};return l&&e?e.addEventListener("keydown",s):null==e||e.removeEventListener("keydown",s),function(){return null==e?void 0:e.removeEventListener("keydown",s)}},[l,t,n,i,a,u])}},83095:function(e,t,n){n.d(t,{K:()=>s,d:()=>l});var r=n(67294),o=n(96486),i=n(52293),a=n(31841),s=function(e){var t=e.cacheKey,n=e.fields,s=e.enabled,l=void 0===s||s,c=(0,i.qo)(),u=(0,o.pick)(c,void 0===n?[]:n),d=(0,a._)(t).setValue;(0,r.useEffect)(function(){l&&t&&d(u)},[u,t,l,d])},l=function(e){var t=e.cacheKey;if(!t)throw Error("CacheKey is required");var n=(0,a._)(t);return{getPersistedFormFieldValues:n.getValue,resetValues:n.resetValue}}},5179:function(e,t,n){n.d(t,{g:()=>o});var r=n(67294),o=function(e){var t=(0,r.useRef)(null);return(0,r.useLayoutEffect)(function(){var n=t.current;e&&n&&n.scrollIntoView({behavior:"smooth",block:"center"})},[e]),t}},12635:function(e,t,n){n.d(t,{M:()=>a});var r=n(67294),o=n(52293),i=n(67379),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.enabled,n=void 0===t||t,a=(0,o.Gc)();(0,r.useEffect)(function(){if(n){var e=function(e){"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(0,i.C)(a)&&a.triggerFormSubmit()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}},[n,a])}},21541:function(e,t,n){n.d(t,{n:()=>r});var r={LAST_7_DAYS:"last_7_days",LAST_MONTH:"last_month",FROM_UNREAD:"from_unread"}},64843:function(e,t,n){n.d(t,{Q:()=>r});var r={PENDING:"pending",DETACHED:"detached",IGNORED:"ignored",WITHDRAWN:"withdrawn",ACTIVE:"active"}},94571:function(e,t,n){n.d(t,{d:()=>r});var r={APPROVED:"approved",ANSWERED:"answered",UNANSWERED:"unanswered",PENDING:"pending",DISMISSED:"dismissed"}},47190:function(e,t,n){n.d(t,{o:()=>i});var r=n(85893),o=n(59834),i=function(e){var t,n,i=e.member,a=e.children,s=i.name,l=i.public_uid,c=(0,o.O)({public_uid:l});return(0,r.jsx)("a",(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}({},c),n=n={title:s,children:a},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t))}},29504:function(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{W:()=>o});var o=function(){var e;function t(e){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");this.element=e}return e=[{key:"addAttachmentClickEventHandler",value:function(e){var t=this;this.element.addEventListener("click",function(n){var r=n.target.closest("action-text-attachment");if(r){var o=t.parseAttachmentAttributes(r);if(t.isPreviewableAttachment(o)){var i=t.getSimilarAttachments(o),a=i.findIndex(function(e){return e.sgid===o.sgid});e({attachments:i,currentIndex:a})}}})}},{key:"getSimilarAttachments",value:function(e){var t,n=this.isImageAttachment(e)&&this.isImageAttachment||this.isPdfAttachment(e)&&this.isPdfAttachment;return((function(e){if(Array.isArray(e))return r(e)})(t=this.element.querySelectorAll("action-text-attachment"))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return r(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(this.parseAttachmentAttributes).filter(n)}},{key:"isPreviewableAttachment",value:function(e){return this.isPdfAttachment(e)||this.isImageAttachment(e)}},{key:"isImageAttachment",value:function(e){return["image/png","image/jpeg","image/jpg","image/gif"].includes(e.contentType)}},{key:"isPdfAttachment",value:function(e){return["application/pdf"].includes(e.contentType)}},{key:"parseAttachmentAttributes",value:function(e){var t,n;return{sgid:e.getAttribute("sgid"),contentType:e.getAttribute("content-type"),url:null==(n=e.querySelector("[data-target~='blob-container']"))||null==(t=n.dataset)?void 0:t.blobUrl,filename:e.getAttribute("filename"),filesize:e.getAttribute("filesize"),width:e.getAttribute("width"),height:e.getAttribute("height")}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}()}}]);
//# sourceMappingURL=/packs/js/7535-546c68a20736eac3.js.map